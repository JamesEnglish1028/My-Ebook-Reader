const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-7Mi_DyoV.js","assets/pdf-D-gusrb1.js"])))=>i.map(i=>d[i]);
function sg(r,s){for(var n=0;n<s.length;n++){const o=s[n];if(typeof o!="string"&&!Array.isArray(o)){for(const c in o)if(c!=="default"&&!(c in r)){const l=Object.getOwnPropertyDescriptor(o,c);l&&Object.defineProperty(r,c,l.get?l:{enumerable:!0,get:()=>o[c]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const l of c)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function n(c){const l={};return c.integrity&&(l.integrity=c.integrity),c.referrerPolicy&&(l.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?l.credentials="include":c.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(c){if(c.ep)return;c.ep=!0;const l=n(c);fetch(c.href,l)}})();var jo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oc(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ol={exports:{}},ii={},Il={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zd;function ig(){if(Zd)return Xe;Zd=1;var r=Symbol.for("react.element"),s=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),b=Symbol.iterator;function x(P){return P===null||typeof P!="object"?null:(P=b&&P[b]||P["@@iterator"],typeof P=="function"?P:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,g={};function S(P,W,ye){this.props=P,this.context=W,this.refs=g,this.updater=ye||v}S.prototype.isReactComponent={},S.prototype.setState=function(P,W){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,W,"setState")},S.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function C(){}C.prototype=S.prototype;function R(P,W,ye){this.props=P,this.context=W,this.refs=g,this.updater=ye||v}var I=R.prototype=new C;I.constructor=R,k(I,S.prototype),I.isPureReactComponent=!0;var _=Array.isArray,F=Object.prototype.hasOwnProperty,M={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function L(P,W,ye){var he,fe={},Ae=null,be=null;if(W!=null)for(he in W.ref!==void 0&&(be=W.ref),W.key!==void 0&&(Ae=""+W.key),W)F.call(W,he)&&!$.hasOwnProperty(he)&&(fe[he]=W[he]);var xe=arguments.length-2;if(xe===1)fe.children=ye;else if(1<xe){for(var Ne=Array(xe),De=0;De<xe;De++)Ne[De]=arguments[De+2];fe.children=Ne}if(P&&P.defaultProps)for(he in xe=P.defaultProps,xe)fe[he]===void 0&&(fe[he]=xe[he]);return{$$typeof:r,type:P,key:Ae,ref:be,props:fe,_owner:M.current}}function B(P,W){return{$$typeof:r,type:P.type,key:W,ref:P.ref,props:P.props,_owner:P._owner}}function Q(P){return typeof P=="object"&&P!==null&&P.$$typeof===r}function oe(P){var W={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(ye){return W[ye]})}var z=/\/+/g;function H(P,W){return typeof P=="object"&&P!==null&&P.key!=null?oe(""+P.key):W.toString(36)}function N(P,W,ye,he,fe){var Ae=typeof P;(Ae==="undefined"||Ae==="boolean")&&(P=null);var be=!1;if(P===null)be=!0;else switch(Ae){case"string":case"number":be=!0;break;case"object":switch(P.$$typeof){case r:case s:be=!0}}if(be)return be=P,fe=fe(be),P=he===""?"."+H(be,0):he,_(fe)?(ye="",P!=null&&(ye=P.replace(z,"$&/")+"/"),N(fe,W,ye,"",function(De){return De})):fe!=null&&(Q(fe)&&(fe=B(fe,ye+(!fe.key||be&&be.key===fe.key?"":(""+fe.key).replace(z,"$&/")+"/")+P)),W.push(fe)),1;if(be=0,he=he===""?".":he+":",_(P))for(var xe=0;xe<P.length;xe++){Ae=P[xe];var Ne=he+H(Ae,xe);be+=N(Ae,W,ye,Ne,fe)}else if(Ne=x(P),typeof Ne=="function")for(P=Ne.call(P),xe=0;!(Ae=P.next()).done;)Ae=Ae.value,Ne=he+H(Ae,xe++),be+=N(Ae,W,ye,Ne,fe);else if(Ae==="object")throw W=String(P),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.");return be}function X(P,W,ye){if(P==null)return P;var he=[],fe=0;return N(P,he,"","",function(Ae){return W.call(ye,Ae,fe++)}),he}function me(P){if(P._status===-1){var W=P._result;W=W(),W.then(function(ye){(P._status===0||P._status===-1)&&(P._status=1,P._result=ye)},function(ye){(P._status===0||P._status===-1)&&(P._status=2,P._result=ye)}),P._status===-1&&(P._status=0,P._result=W)}if(P._status===1)return P._result.default;throw P._result}var ee={current:null},ie={transition:null},re={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:ie,ReactCurrentOwner:M};function Z(){throw Error("act(...) is not supported in production builds of React.")}return Xe.Children={map:X,forEach:function(P,W,ye){X(P,function(){W.apply(this,arguments)},ye)},count:function(P){var W=0;return X(P,function(){W++}),W},toArray:function(P){return X(P,function(W){return W})||[]},only:function(P){if(!Q(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Xe.Component=S,Xe.Fragment=n,Xe.Profiler=c,Xe.PureComponent=R,Xe.StrictMode=o,Xe.Suspense=p,Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,Xe.act=Z,Xe.cloneElement=function(P,W,ye){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var he=k({},P.props),fe=P.key,Ae=P.ref,be=P._owner;if(W!=null){if(W.ref!==void 0&&(Ae=W.ref,be=M.current),W.key!==void 0&&(fe=""+W.key),P.type&&P.type.defaultProps)var xe=P.type.defaultProps;for(Ne in W)F.call(W,Ne)&&!$.hasOwnProperty(Ne)&&(he[Ne]=W[Ne]===void 0&&xe!==void 0?xe[Ne]:W[Ne])}var Ne=arguments.length-2;if(Ne===1)he.children=ye;else if(1<Ne){xe=Array(Ne);for(var De=0;De<Ne;De++)xe[De]=arguments[De+2];he.children=xe}return{$$typeof:r,type:P.type,key:fe,ref:Ae,props:he,_owner:be}},Xe.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:l,_context:P},P.Consumer=P},Xe.createElement=L,Xe.createFactory=function(P){var W=L.bind(null,P);return W.type=P,W},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(P){return{$$typeof:f,render:P}},Xe.isValidElement=Q,Xe.lazy=function(P){return{$$typeof:w,_payload:{_status:-1,_result:P},_init:me}},Xe.memo=function(P,W){return{$$typeof:h,type:P,compare:W===void 0?null:W}},Xe.startTransition=function(P){var W=ie.transition;ie.transition={};try{P()}finally{ie.transition=W}},Xe.unstable_act=Z,Xe.useCallback=function(P,W){return ee.current.useCallback(P,W)},Xe.useContext=function(P){return ee.current.useContext(P)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(P){return ee.current.useDeferredValue(P)},Xe.useEffect=function(P,W){return ee.current.useEffect(P,W)},Xe.useId=function(){return ee.current.useId()},Xe.useImperativeHandle=function(P,W,ye){return ee.current.useImperativeHandle(P,W,ye)},Xe.useInsertionEffect=function(P,W){return ee.current.useInsertionEffect(P,W)},Xe.useLayoutEffect=function(P,W){return ee.current.useLayoutEffect(P,W)},Xe.useMemo=function(P,W){return ee.current.useMemo(P,W)},Xe.useReducer=function(P,W,ye){return ee.current.useReducer(P,W,ye)},Xe.useRef=function(P){return ee.current.useRef(P)},Xe.useState=function(P){return ee.current.useState(P)},Xe.useSyncExternalStore=function(P,W,ye){return ee.current.useSyncExternalStore(P,W,ye)},Xe.useTransition=function(){return ee.current.useTransition()},Xe.version="18.3.1",Xe}var Yd;function ac(){return Yd||(Yd=1,Il.exports=ig()),Il.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jd;function og(){if(Jd)return ii;Jd=1;var r=ac(),s=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,p,h){var w,b={},x=null,v=null;h!==void 0&&(x=""+h),p.key!==void 0&&(x=""+p.key),p.ref!==void 0&&(v=p.ref);for(w in p)o.call(p,w)&&!l.hasOwnProperty(w)&&(b[w]=p[w]);if(f&&f.defaultProps)for(w in p=f.defaultProps,p)b[w]===void 0&&(b[w]=p[w]);return{$$typeof:s,type:f,key:x,ref:v,props:b,_owner:c.current}}return ii.Fragment=n,ii.jsx=d,ii.jsxs=d,ii}var ef;function ag(){return ef||(ef=1,Ol.exports=og()),Ol.exports}var a=ag(),T=ac();const dt=oc(T),lg=sg({__proto__:null,default:dt},[T]);var Eo={},Ll={exports:{}},nr={},Dl={exports:{}},Fl={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tf;function cg(){return tf||(tf=1,(function(r){function s(ie,re){var Z=ie.length;ie.push(re);e:for(;0<Z;){var P=Z-1>>>1,W=ie[P];if(0<c(W,re))ie[P]=re,ie[Z]=W,Z=P;else break e}}function n(ie){return ie.length===0?null:ie[0]}function o(ie){if(ie.length===0)return null;var re=ie[0],Z=ie.pop();if(Z!==re){ie[0]=Z;e:for(var P=0,W=ie.length,ye=W>>>1;P<ye;){var he=2*(P+1)-1,fe=ie[he],Ae=he+1,be=ie[Ae];if(0>c(fe,Z))Ae<W&&0>c(be,fe)?(ie[P]=be,ie[Ae]=Z,P=Ae):(ie[P]=fe,ie[he]=Z,P=he);else if(Ae<W&&0>c(be,Z))ie[P]=be,ie[Ae]=Z,P=Ae;else break e}}return re}function c(ie,re){var Z=ie.sortIndex-re.sortIndex;return Z!==0?Z:ie.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;r.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();r.unstable_now=function(){return d.now()-f}}var p=[],h=[],w=1,b=null,x=3,v=!1,k=!1,g=!1,S=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(ie){for(var re=n(h);re!==null;){if(re.callback===null)o(h);else if(re.startTime<=ie)o(h),re.sortIndex=re.expirationTime,s(p,re);else break;re=n(h)}}function _(ie){if(g=!1,I(ie),!k)if(n(p)!==null)k=!0,me(F);else{var re=n(h);re!==null&&ee(_,re.startTime-ie)}}function F(ie,re){k=!1,g&&(g=!1,C(L),L=-1),v=!0;var Z=x;try{for(I(re),b=n(p);b!==null&&(!(b.expirationTime>re)||ie&&!oe());){var P=b.callback;if(typeof P=="function"){b.callback=null,x=b.priorityLevel;var W=P(b.expirationTime<=re);re=r.unstable_now(),typeof W=="function"?b.callback=W:b===n(p)&&o(p),I(re)}else o(p);b=n(p)}if(b!==null)var ye=!0;else{var he=n(h);he!==null&&ee(_,he.startTime-re),ye=!1}return ye}finally{b=null,x=Z,v=!1}}var M=!1,$=null,L=-1,B=5,Q=-1;function oe(){return!(r.unstable_now()-Q<B)}function z(){if($!==null){var ie=r.unstable_now();Q=ie;var re=!0;try{re=$(!0,ie)}finally{re?H():(M=!1,$=null)}}else M=!1}var H;if(typeof R=="function")H=function(){R(z)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,X=N.port2;N.port1.onmessage=z,H=function(){X.postMessage(null)}}else H=function(){S(z,0)};function me(ie){$=ie,M||(M=!0,H())}function ee(ie,re){L=S(function(){ie(r.unstable_now())},re)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ie){ie.callback=null},r.unstable_continueExecution=function(){k||v||(k=!0,me(F))},r.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<ie?Math.floor(1e3/ie):5},r.unstable_getCurrentPriorityLevel=function(){return x},r.unstable_getFirstCallbackNode=function(){return n(p)},r.unstable_next=function(ie){switch(x){case 1:case 2:case 3:var re=3;break;default:re=x}var Z=x;x=re;try{return ie()}finally{x=Z}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(ie,re){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Z=x;x=ie;try{return re()}finally{x=Z}},r.unstable_scheduleCallback=function(ie,re,Z){var P=r.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?P+Z:P):Z=P,ie){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Z+W,ie={id:w++,callback:re,priorityLevel:ie,startTime:Z,expirationTime:W,sortIndex:-1},Z>P?(ie.sortIndex=Z,s(h,ie),n(p)===null&&ie===n(h)&&(g?(C(L),L=-1):g=!0,ee(_,Z-P))):(ie.sortIndex=W,s(p,ie),k||v||(k=!0,me(F))),ie},r.unstable_shouldYield=oe,r.unstable_wrapCallback=function(ie){var re=x;return function(){var Z=x;x=re;try{return ie.apply(this,arguments)}finally{x=Z}}}})(Fl)),Fl}var rf;function ug(){return rf||(rf=1,Dl.exports=cg()),Dl.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nf;function dg(){if(nf)return nr;nf=1;var r=ac(),s=ug();function n(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,c={};function l(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(c[e]=t,e=0;e<t.length;e++)o.add(t[e])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},b={};function x(e){return p.call(b,e)?!0:p.call(w,e)?!1:h.test(e)?b[e]=!0:(w[e]=!0,!1)}function v(e,t,i,u){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return u?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function k(e,t,i,u){if(t===null||typeof t>"u"||v(e,t,i,u))return!0;if(u)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function g(e,t,i,u,m,y,O){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=u,this.attributeNamespace=m,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=y,this.removeEmptyString=O}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){S[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];S[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){S[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){S[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){S[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){S[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){S[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){S[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){S[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function R(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(C,R);S[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(C,R);S[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(C,R);S[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){S[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),S.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){S[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});function I(e,t,i,u){var m=S.hasOwnProperty(t)?S[t]:null;(m!==null?m.type!==0:u||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(k(t,i,m,u)&&(i=null),u||m===null?x(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):m.mustUseProperty?e[m.propertyName]=i===null?m.type===3?!1:"":i:(t=m.attributeName,u=m.attributeNamespace,i===null?e.removeAttribute(t):(m=m.type,i=m===3||m===4&&i===!0?"":""+i,u?e.setAttributeNS(u,t,i):e.setAttribute(t,i))))}var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),M=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),Q=Symbol.for("react.provider"),oe=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),ie=Symbol.iterator;function re(e){return e===null||typeof e!="object"?null:(e=ie&&e[ie]||e["@@iterator"],typeof e=="function"?e:null)}var Z=Object.assign,P;function W(e){if(P===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return`
`+P+e}var ye=!1;function he(e,t){if(!e||ye)return"";ye=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(ge){var u=ge}Reflect.construct(e,[],t)}else{try{t.call()}catch(ge){u=ge}e.call(t.prototype)}else{try{throw Error()}catch(ge){u=ge}e()}}catch(ge){if(ge&&u&&typeof ge.stack=="string"){for(var m=ge.stack.split(`
`),y=u.stack.split(`
`),O=m.length-1,G=y.length-1;1<=O&&0<=G&&m[O]!==y[G];)G--;for(;1<=O&&0<=G;O--,G--)if(m[O]!==y[G]){if(O!==1||G!==1)do if(O--,G--,0>G||m[O]!==y[G]){var Y=`
`+m[O].replace(" at new "," at ");return e.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",e.displayName)),Y}while(1<=O&&0<=G);break}}}finally{ye=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?W(e):""}function fe(e){switch(e.tag){case 5:return W(e.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return e=he(e.type,!1),e;case 11:return e=he(e.type.render,!1),e;case 1:return e=he(e.type,!0),e;default:return""}}function Ae(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $:return"Fragment";case M:return"Portal";case B:return"Profiler";case L:return"StrictMode";case H:return"Suspense";case N:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case oe:return(e.displayName||"Context")+".Consumer";case Q:return(e._context.displayName||"Context")+".Provider";case z:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case X:return t=e.displayName||null,t!==null?t:Ae(e.type)||"Memo";case me:t=e._payload,e=e._init;try{return Ae(e(t))}catch{}}return null}function be(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ae(t);case 8:return t===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xe(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ne(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function De(e){var t=Ne(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),u=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var m=i.get,y=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return m.call(this)},set:function(O){u=""+O,y.call(this,O)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return u},setValue:function(O){u=""+O},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function $e(e){e._valueTracker||(e._valueTracker=De(e))}function Ye(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),u="";return e&&(u=Ne(e)?e.checked?"true":"false":e.value),e=u,e!==i?(t.setValue(e),!0):!1}function Ve(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function j(e,t){var i=t.checked;return Z({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function ue(e,t){var i=t.defaultValue==null?"":t.defaultValue,u=t.checked!=null?t.checked:t.defaultChecked;i=xe(t.value!=null?t.value:i),e._wrapperState={initialChecked:u,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ce(e,t){t=t.checked,t!=null&&I(e,"checked",t,!1)}function V(e,t){ce(e,t);var i=xe(t.value),u=t.type;if(i!=null)u==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?q(e,t.type,i):t.hasOwnProperty("defaultValue")&&q(e,t.type,xe(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function D(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var u=t.type;if(!(u!=="submit"&&u!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function q(e,t,i){(t!=="number"||Ve(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var te=Array.isArray;function ae(e,t,i,u){if(e=e.options,t){t={};for(var m=0;m<i.length;m++)t["$"+i[m]]=!0;for(i=0;i<e.length;i++)m=t.hasOwnProperty("$"+e[i].value),e[i].selected!==m&&(e[i].selected=m),m&&u&&(e[i].defaultSelected=!0)}else{for(i=""+xe(i),t=null,m=0;m<e.length;m++){if(e[m].value===i){e[m].selected=!0,u&&(e[m].defaultSelected=!0);return}t!==null||e[m].disabled||(t=e[m])}t!==null&&(t.selected=!0)}}function J(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(n(91));return Z({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function A(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(n(92));if(te(i)){if(1<i.length)throw Error(n(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:xe(i)}}function E(e,t){var i=xe(t.value),u=xe(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),u!=null&&(e.defaultValue=""+u)}function U(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function K(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?K(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ee,ve=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,u,m){MSApp.execUnsafeLocalFunction(function(){return e(t,i,u,m)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ee=Ee||document.createElement("div"),Ee.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ee.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ke(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var Te={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Oe=["Webkit","ms","Moz","O"];Object.keys(Te).forEach(function(e){Oe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Te[t]=Te[e]})});function Re(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||Te.hasOwnProperty(e)&&Te[e]?(""+t).trim():t+"px"}function We(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var u=i.indexOf("--")===0,m=Re(i,t[i],u);i==="float"&&(i="cssFloat"),u?e.setProperty(i,m):e[i]=m}}var yt=Z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qe(e,t){if(t){if(yt[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(n(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(n(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(n(61))}if(t.style!=null&&typeof t.style!="object")throw Error(n(62))}}function ot(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Je=null;function bt(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ct=null,Ct=null,Tt=null;function qt(e){if(e=Vs(e)){if(typeof ct!="function")throw Error(n(280));var t=e.stateNode;t&&(t=Ui(t),ct(e.stateNode,e.type,t))}}function vn(e){Ct?Tt?Tt.push(e):Tt=[e]:Ct=e}function Vn(){if(Ct){var e=Ct,t=Tt;if(Tt=Ct=null,qt(e),t)for(e=0;e<t.length;e++)qt(t[e])}}function $r(e,t){return e(t)}function Ft(){}var xn=!1;function Ss(e,t,i){if(xn)return e(t,i);xn=!0;try{return $r(e,t,i)}finally{xn=!1,(Ct!==null||Tt!==null)&&(Ft(),Vn())}}function Wr(e,t){var i=e.stateNode;if(i===null)return null;var u=Ui(i);if(u===null)return null;i=u[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(n(231,t,typeof i));return i}var Hn=!1;if(f)try{var sr={};Object.defineProperty(sr,"passive",{get:function(){Hn=!0}}),window.addEventListener("test",sr,sr),window.removeEventListener("test",sr,sr)}catch{Hn=!1}function Vr(e,t,i,u,m,y,O,G,Y){var ge=Array.prototype.slice.call(arguments,3);try{t.apply(i,ge)}catch(Ce){this.onError(Ce)}}var wn=!1,cr=null,qn=!1,Cs=null,Ko={onError:function(e){wn=!0,cr=e}};function Qo(e,t,i,u,m,y,O,G,Y){wn=!1,cr=null,Vr.apply(Ko,arguments)}function Ns(e,t,i,u,m,y,O,G,Y){if(Qo.apply(this,arguments),wn){if(wn){var ge=cr;wn=!1,cr=null}else throw Error(n(198));qn||(qn=!0,Cs=ge)}}function Tr(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function bi(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bn(e){if(Tr(e)!==e)throw Error(n(188))}function Xo(e){var t=e.alternate;if(!t){if(t=Tr(e),t===null)throw Error(n(188));return t!==e?null:e}for(var i=e,u=t;;){var m=i.return;if(m===null)break;var y=m.alternate;if(y===null){if(u=m.return,u!==null){i=u;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===i)return bn(m),e;if(y===u)return bn(m),t;y=y.sibling}throw Error(n(188))}if(i.return!==u.return)i=m,u=y;else{for(var O=!1,G=m.child;G;){if(G===i){O=!0,i=m,u=y;break}if(G===u){O=!0,u=m,i=y;break}G=G.sibling}if(!O){for(G=y.child;G;){if(G===i){O=!0,i=y,u=m;break}if(G===u){O=!0,u=y,i=m;break}G=G.sibling}if(!O)throw Error(n(189))}}if(i.alternate!==u)throw Error(n(190))}if(i.tag!==3)throw Error(n(188));return i.stateNode.current===i?e:t}function js(e){return e=Xo(e),e!==null?ki(e):null}function ki(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ki(e);if(t!==null)return t;e=e.sibling}return null}var Si=s.unstable_scheduleCallback,Ci=s.unstable_cancelCallback,Zo=s.unstable_shouldYield,Yo=s.unstable_requestPaint,vt=s.unstable_now,Jo=s.unstable_getCurrentPriorityLevel,we=s.unstable_ImmediatePriority,Ie=s.unstable_UserBlockingPriority,Be=s.unstable_NormalPriority,Ke=s.unstable_LowPriority,Me=s.unstable_IdlePriority,et=null,at=null;function Hr(e){if(at&&typeof at.onCommitFiberRoot=="function")try{at.onCommitFiberRoot(et,e,void 0,(e.current.flags&128)===128)}catch{}}var lt=Math.clz32?Math.clz32:mt,ft=Math.log,Pt=Math.LN2;function mt(e){return e>>>=0,e===0?32:31-(ft(e)/Pt|0)|0}var tt=64,Ot=4194304;function Bt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function qr(e,t){var i=e.pendingLanes;if(i===0)return 0;var u=0,m=e.suspendedLanes,y=e.pingedLanes,O=i&268435455;if(O!==0){var G=O&~m;G!==0?u=Bt(G):(y&=O,y!==0&&(u=Bt(y)))}else O=i&~m,O!==0?u=Bt(O):y!==0&&(u=Bt(y));if(u===0)return 0;if(t!==0&&t!==u&&(t&m)===0&&(m=u&-u,y=t&-t,m>=y||m===16&&(y&4194240)!==0))return t;if((u&4)!==0&&(u|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=u;0<t;)i=31-lt(t),m=1<<i,u|=e[i],t&=~m;return u}function Sp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cp(e,t){for(var i=e.suspendedLanes,u=e.pingedLanes,m=e.expirationTimes,y=e.pendingLanes;0<y;){var O=31-lt(y),G=1<<O,Y=m[O];Y===-1?((G&i)===0||(G&u)!==0)&&(m[O]=Sp(G,t)):Y<=t&&(e.expiredLanes|=G),y&=~G}}function ea(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function _c(){var e=tt;return tt<<=1,(tt&4194240)===0&&(tt=64),e}function ta(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Es(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-lt(t),e[t]=i}function Np(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<i;){var m=31-lt(i),y=1<<m;t[m]=0,u[m]=-1,e[m]=-1,i&=~y}}function ra(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var u=31-lt(i),m=1<<u;m&t|e[u]&t&&(e[u]|=t),i&=~m}}var it=0;function Ac(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Rc,na,Tc,Pc,Oc,sa=!1,Ni=[],Gr=null,Kr=null,Qr=null,_s=new Map,As=new Map,Xr=[],jp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ic(e,t){switch(e){case"focusin":case"focusout":Gr=null;break;case"dragenter":case"dragleave":Kr=null;break;case"mouseover":case"mouseout":Qr=null;break;case"pointerover":case"pointerout":_s.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":As.delete(t.pointerId)}}function Rs(e,t,i,u,m,y){return e===null||e.nativeEvent!==y?(e={blockedOn:t,domEventName:i,eventSystemFlags:u,nativeEvent:y,targetContainers:[m]},t!==null&&(t=Vs(t),t!==null&&na(t)),e):(e.eventSystemFlags|=u,t=e.targetContainers,m!==null&&t.indexOf(m)===-1&&t.push(m),e)}function Ep(e,t,i,u,m){switch(t){case"focusin":return Gr=Rs(Gr,e,t,i,u,m),!0;case"dragenter":return Kr=Rs(Kr,e,t,i,u,m),!0;case"mouseover":return Qr=Rs(Qr,e,t,i,u,m),!0;case"pointerover":var y=m.pointerId;return _s.set(y,Rs(_s.get(y)||null,e,t,i,u,m)),!0;case"gotpointercapture":return y=m.pointerId,As.set(y,Rs(As.get(y)||null,e,t,i,u,m)),!0}return!1}function Lc(e){var t=kn(e.target);if(t!==null){var i=Tr(t);if(i!==null){if(t=i.tag,t===13){if(t=bi(i),t!==null){e.blockedOn=t,Oc(e.priority,function(){Tc(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ji(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=oa(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var u=new i.constructor(i.type,i);Je=u,i.target.dispatchEvent(u),Je=null}else return t=Vs(i),t!==null&&na(t),e.blockedOn=i,!1;t.shift()}return!0}function Dc(e,t,i){ji(e)&&i.delete(t)}function _p(){sa=!1,Gr!==null&&ji(Gr)&&(Gr=null),Kr!==null&&ji(Kr)&&(Kr=null),Qr!==null&&ji(Qr)&&(Qr=null),_s.forEach(Dc),As.forEach(Dc)}function Ts(e,t){e.blockedOn===t&&(e.blockedOn=null,sa||(sa=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,_p)))}function Ps(e){function t(m){return Ts(m,e)}if(0<Ni.length){Ts(Ni[0],e);for(var i=1;i<Ni.length;i++){var u=Ni[i];u.blockedOn===e&&(u.blockedOn=null)}}for(Gr!==null&&Ts(Gr,e),Kr!==null&&Ts(Kr,e),Qr!==null&&Ts(Qr,e),_s.forEach(t),As.forEach(t),i=0;i<Xr.length;i++)u=Xr[i],u.blockedOn===e&&(u.blockedOn=null);for(;0<Xr.length&&(i=Xr[0],i.blockedOn===null);)Lc(i),i.blockedOn===null&&Xr.shift()}var Gn=_.ReactCurrentBatchConfig,Ei=!0;function Ap(e,t,i,u){var m=it,y=Gn.transition;Gn.transition=null;try{it=1,ia(e,t,i,u)}finally{it=m,Gn.transition=y}}function Rp(e,t,i,u){var m=it,y=Gn.transition;Gn.transition=null;try{it=4,ia(e,t,i,u)}finally{it=m,Gn.transition=y}}function ia(e,t,i,u){if(Ei){var m=oa(e,t,i,u);if(m===null)Sa(e,t,u,_i,i),Ic(e,u);else if(Ep(m,e,t,i,u))u.stopPropagation();else if(Ic(e,u),t&4&&-1<jp.indexOf(e)){for(;m!==null;){var y=Vs(m);if(y!==null&&Rc(y),y=oa(e,t,i,u),y===null&&Sa(e,t,u,_i,i),y===m)break;m=y}m!==null&&u.stopPropagation()}else Sa(e,t,u,null,i)}}var _i=null;function oa(e,t,i,u){if(_i=null,e=bt(u),e=kn(e),e!==null)if(t=Tr(e),t===null)e=null;else if(i=t.tag,i===13){if(e=bi(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return _i=e,null}function Fc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jo()){case we:return 1;case Ie:return 4;case Be:case Ke:return 16;case Me:return 536870912;default:return 16}default:return 16}}var Zr=null,aa=null,Ai=null;function Bc(){if(Ai)return Ai;var e,t=aa,i=t.length,u,m="value"in Zr?Zr.value:Zr.textContent,y=m.length;for(e=0;e<i&&t[e]===m[e];e++);var O=i-e;for(u=1;u<=O&&t[i-u]===m[y-u];u++);return Ai=m.slice(e,1<u?1-u:void 0)}function Ri(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ti(){return!0}function Mc(){return!1}function ir(e){function t(i,u,m,y,O){this._reactName=i,this._targetInst=m,this.type=u,this.nativeEvent=y,this.target=O,this.currentTarget=null;for(var G in e)e.hasOwnProperty(G)&&(i=e[G],this[G]=i?i(y):y[G]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ti:Mc,this.isPropagationStopped=Mc,this}return Z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Ti)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Ti)},persist:function(){},isPersistent:Ti}),t}var Kn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},la=ir(Kn),Os=Z({},Kn,{view:0,detail:0}),Tp=ir(Os),ca,ua,Is,Pi=Z({},Os,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fa,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Is&&(Is&&e.type==="mousemove"?(ca=e.screenX-Is.screenX,ua=e.screenY-Is.screenY):ua=ca=0,Is=e),ca)},movementY:function(e){return"movementY"in e?e.movementY:ua}}),Uc=ir(Pi),Pp=Z({},Pi,{dataTransfer:0}),Op=ir(Pp),Ip=Z({},Os,{relatedTarget:0}),da=ir(Ip),Lp=Z({},Kn,{animationName:0,elapsedTime:0,pseudoElement:0}),Dp=ir(Lp),Fp=Z({},Kn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Bp=ir(Fp),Mp=Z({},Kn,{data:0}),zc=ir(Mp),Up={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$p={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$p[e])?!!t[e]:!1}function fa(){return Wp}var Vp=Z({},Os,{key:function(e){if(e.key){var t=Up[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ri(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?zp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fa,charCode:function(e){return e.type==="keypress"?Ri(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ri(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Hp=ir(Vp),qp=Z({},Pi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$c=ir(qp),Gp=Z({},Os,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fa}),Kp=ir(Gp),Qp=Z({},Kn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xp=ir(Qp),Zp=Z({},Pi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Yp=ir(Zp),Jp=[9,13,27,32],ha=f&&"CompositionEvent"in window,Ls=null;f&&"documentMode"in document&&(Ls=document.documentMode);var em=f&&"TextEvent"in window&&!Ls,Wc=f&&(!ha||Ls&&8<Ls&&11>=Ls),Vc=" ",Hc=!1;function qc(e,t){switch(e){case"keyup":return Jp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gc(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Qn=!1;function tm(e,t){switch(e){case"compositionend":return Gc(t);case"keypress":return t.which!==32?null:(Hc=!0,Vc);case"textInput":return e=t.data,e===Vc&&Hc?null:e;default:return null}}function rm(e,t){if(Qn)return e==="compositionend"||!ha&&qc(e,t)?(e=Bc(),Ai=aa=Zr=null,Qn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Wc&&t.locale!=="ko"?null:t.data;default:return null}}var nm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!nm[e.type]:t==="textarea"}function Qc(e,t,i,u){vn(u),t=Fi(t,"onChange"),0<t.length&&(i=new la("onChange","change",null,i,u),e.push({event:i,listeners:t}))}var Ds=null,Fs=null;function sm(e){hu(e,0)}function Oi(e){var t=es(e);if(Ye(t))return e}function im(e,t){if(e==="change")return t}var Xc=!1;if(f){var pa;if(f){var ma="oninput"in document;if(!ma){var Zc=document.createElement("div");Zc.setAttribute("oninput","return;"),ma=typeof Zc.oninput=="function"}pa=ma}else pa=!1;Xc=pa&&(!document.documentMode||9<document.documentMode)}function Yc(){Ds&&(Ds.detachEvent("onpropertychange",Jc),Fs=Ds=null)}function Jc(e){if(e.propertyName==="value"&&Oi(Fs)){var t=[];Qc(t,Fs,e,bt(e)),Ss(sm,t)}}function om(e,t,i){e==="focusin"?(Yc(),Ds=t,Fs=i,Ds.attachEvent("onpropertychange",Jc)):e==="focusout"&&Yc()}function am(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Oi(Fs)}function lm(e,t){if(e==="click")return Oi(t)}function cm(e,t){if(e==="input"||e==="change")return Oi(t)}function um(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vr=typeof Object.is=="function"?Object.is:um;function Bs(e,t){if(vr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),u=Object.keys(t);if(i.length!==u.length)return!1;for(u=0;u<i.length;u++){var m=i[u];if(!p.call(t,m)||!vr(e[m],t[m]))return!1}return!0}function eu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tu(e,t){var i=eu(e);e=0;for(var u;i;){if(i.nodeType===3){if(u=e+i.textContent.length,e<=t&&u>=t)return{node:i,offset:t-e};e=u}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=eu(i)}}function ru(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ru(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function nu(){for(var e=window,t=Ve();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=Ve(e.document)}return t}function ga(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function dm(e){var t=nu(),i=e.focusedElem,u=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&ru(i.ownerDocument.documentElement,i)){if(u!==null&&ga(i)){if(t=u.start,e=u.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var m=i.textContent.length,y=Math.min(u.start,m);u=u.end===void 0?y:Math.min(u.end,m),!e.extend&&y>u&&(m=u,u=y,y=m),m=tu(i,y);var O=tu(i,u);m&&O&&(e.rangeCount!==1||e.anchorNode!==m.node||e.anchorOffset!==m.offset||e.focusNode!==O.node||e.focusOffset!==O.offset)&&(t=t.createRange(),t.setStart(m.node,m.offset),e.removeAllRanges(),y>u?(e.addRange(t),e.extend(O.node,O.offset)):(t.setEnd(O.node,O.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fm=f&&"documentMode"in document&&11>=document.documentMode,Xn=null,ya=null,Ms=null,va=!1;function su(e,t,i){var u=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;va||Xn==null||Xn!==Ve(u)||(u=Xn,"selectionStart"in u&&ga(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ms&&Bs(Ms,u)||(Ms=u,u=Fi(ya,"onSelect"),0<u.length&&(t=new la("onSelect","select",null,t,i),e.push({event:t,listeners:u}),t.target=Xn)))}function Ii(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Zn={animationend:Ii("Animation","AnimationEnd"),animationiteration:Ii("Animation","AnimationIteration"),animationstart:Ii("Animation","AnimationStart"),transitionend:Ii("Transition","TransitionEnd")},xa={},iu={};f&&(iu=document.createElement("div").style,"AnimationEvent"in window||(delete Zn.animationend.animation,delete Zn.animationiteration.animation,delete Zn.animationstart.animation),"TransitionEvent"in window||delete Zn.transitionend.transition);function Li(e){if(xa[e])return xa[e];if(!Zn[e])return e;var t=Zn[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in iu)return xa[e]=t[i];return e}var ou=Li("animationend"),au=Li("animationiteration"),lu=Li("animationstart"),cu=Li("transitionend"),uu=new Map,du="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yr(e,t){uu.set(e,t),l(t,[e])}for(var wa=0;wa<du.length;wa++){var ba=du[wa],hm=ba.toLowerCase(),pm=ba[0].toUpperCase()+ba.slice(1);Yr(hm,"on"+pm)}Yr(ou,"onAnimationEnd"),Yr(au,"onAnimationIteration"),Yr(lu,"onAnimationStart"),Yr("dblclick","onDoubleClick"),Yr("focusin","onFocus"),Yr("focusout","onBlur"),Yr(cu,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Us="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Us));function fu(e,t,i){var u=e.type||"unknown-event";e.currentTarget=i,Ns(u,t,void 0,e),e.currentTarget=null}function hu(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var u=e[i],m=u.event;u=u.listeners;e:{var y=void 0;if(t)for(var O=u.length-1;0<=O;O--){var G=u[O],Y=G.instance,ge=G.currentTarget;if(G=G.listener,Y!==y&&m.isPropagationStopped())break e;fu(m,G,ge),y=Y}else for(O=0;O<u.length;O++){if(G=u[O],Y=G.instance,ge=G.currentTarget,G=G.listener,Y!==y&&m.isPropagationStopped())break e;fu(m,G,ge),y=Y}}}if(qn)throw e=Cs,qn=!1,Cs=null,e}function ht(e,t){var i=t[Aa];i===void 0&&(i=t[Aa]=new Set);var u=e+"__bubble";i.has(u)||(pu(t,e,2,!1),i.add(u))}function ka(e,t,i){var u=0;t&&(u|=4),pu(i,e,u,t)}var Di="_reactListening"+Math.random().toString(36).slice(2);function zs(e){if(!e[Di]){e[Di]=!0,o.forEach(function(i){i!=="selectionchange"&&(mm.has(i)||ka(i,!1,e),ka(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Di]||(t[Di]=!0,ka("selectionchange",!1,t))}}function pu(e,t,i,u){switch(Fc(t)){case 1:var m=Ap;break;case 4:m=Rp;break;default:m=ia}i=m.bind(null,t,i,e),m=void 0,!Hn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(m=!0),u?m!==void 0?e.addEventListener(t,i,{capture:!0,passive:m}):e.addEventListener(t,i,!0):m!==void 0?e.addEventListener(t,i,{passive:m}):e.addEventListener(t,i,!1)}function Sa(e,t,i,u,m){var y=u;if((t&1)===0&&(t&2)===0&&u!==null)e:for(;;){if(u===null)return;var O=u.tag;if(O===3||O===4){var G=u.stateNode.containerInfo;if(G===m||G.nodeType===8&&G.parentNode===m)break;if(O===4)for(O=u.return;O!==null;){var Y=O.tag;if((Y===3||Y===4)&&(Y=O.stateNode.containerInfo,Y===m||Y.nodeType===8&&Y.parentNode===m))return;O=O.return}for(;G!==null;){if(O=kn(G),O===null)return;if(Y=O.tag,Y===5||Y===6){u=y=O;continue e}G=G.parentNode}}u=u.return}Ss(function(){var ge=y,Ce=bt(i),je=[];e:{var Se=uu.get(e);if(Se!==void 0){var Pe=la,Fe=e;switch(e){case"keypress":if(Ri(i)===0)break e;case"keydown":case"keyup":Pe=Hp;break;case"focusin":Fe="focus",Pe=da;break;case"focusout":Fe="blur",Pe=da;break;case"beforeblur":case"afterblur":Pe=da;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Pe=Uc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Pe=Op;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Pe=Kp;break;case ou:case au:case lu:Pe=Dp;break;case cu:Pe=Xp;break;case"scroll":Pe=Tp;break;case"wheel":Pe=Yp;break;case"copy":case"cut":case"paste":Pe=Bp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Pe=$c}var Ue=(t&4)!==0,Nt=!Ue&&e==="scroll",le=Ue?Se!==null?Se+"Capture":null:Se;Ue=[];for(var se=ge,de;se!==null;){de=se;var _e=de.stateNode;if(de.tag===5&&_e!==null&&(de=_e,le!==null&&(_e=Wr(se,le),_e!=null&&Ue.push($s(se,_e,de)))),Nt)break;se=se.return}0<Ue.length&&(Se=new Pe(Se,Fe,null,i,Ce),je.push({event:Se,listeners:Ue}))}}if((t&7)===0){e:{if(Se=e==="mouseover"||e==="pointerover",Pe=e==="mouseout"||e==="pointerout",Se&&i!==Je&&(Fe=i.relatedTarget||i.fromElement)&&(kn(Fe)||Fe[Pr]))break e;if((Pe||Se)&&(Se=Ce.window===Ce?Ce:(Se=Ce.ownerDocument)?Se.defaultView||Se.parentWindow:window,Pe?(Fe=i.relatedTarget||i.toElement,Pe=ge,Fe=Fe?kn(Fe):null,Fe!==null&&(Nt=Tr(Fe),Fe!==Nt||Fe.tag!==5&&Fe.tag!==6)&&(Fe=null)):(Pe=null,Fe=ge),Pe!==Fe)){if(Ue=Uc,_e="onMouseLeave",le="onMouseEnter",se="mouse",(e==="pointerout"||e==="pointerover")&&(Ue=$c,_e="onPointerLeave",le="onPointerEnter",se="pointer"),Nt=Pe==null?Se:es(Pe),de=Fe==null?Se:es(Fe),Se=new Ue(_e,se+"leave",Pe,i,Ce),Se.target=Nt,Se.relatedTarget=de,_e=null,kn(Ce)===ge&&(Ue=new Ue(le,se+"enter",Fe,i,Ce),Ue.target=de,Ue.relatedTarget=Nt,_e=Ue),Nt=_e,Pe&&Fe)t:{for(Ue=Pe,le=Fe,se=0,de=Ue;de;de=Yn(de))se++;for(de=0,_e=le;_e;_e=Yn(_e))de++;for(;0<se-de;)Ue=Yn(Ue),se--;for(;0<de-se;)le=Yn(le),de--;for(;se--;){if(Ue===le||le!==null&&Ue===le.alternate)break t;Ue=Yn(Ue),le=Yn(le)}Ue=null}else Ue=null;Pe!==null&&mu(je,Se,Pe,Ue,!1),Fe!==null&&Nt!==null&&mu(je,Nt,Fe,Ue,!0)}}e:{if(Se=ge?es(ge):window,Pe=Se.nodeName&&Se.nodeName.toLowerCase(),Pe==="select"||Pe==="input"&&Se.type==="file")var ze=im;else if(Kc(Se))if(Xc)ze=cm;else{ze=am;var He=om}else(Pe=Se.nodeName)&&Pe.toLowerCase()==="input"&&(Se.type==="checkbox"||Se.type==="radio")&&(ze=lm);if(ze&&(ze=ze(e,ge))){Qc(je,ze,i,Ce);break e}He&&He(e,Se,ge),e==="focusout"&&(He=Se._wrapperState)&&He.controlled&&Se.type==="number"&&q(Se,"number",Se.value)}switch(He=ge?es(ge):window,e){case"focusin":(Kc(He)||He.contentEditable==="true")&&(Xn=He,ya=ge,Ms=null);break;case"focusout":Ms=ya=Xn=null;break;case"mousedown":va=!0;break;case"contextmenu":case"mouseup":case"dragend":va=!1,su(je,i,Ce);break;case"selectionchange":if(fm)break;case"keydown":case"keyup":su(je,i,Ce)}var qe;if(ha)e:{switch(e){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Qn?qc(e,i)&&(Ge="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Ge="onCompositionStart");Ge&&(Wc&&i.locale!=="ko"&&(Qn||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Qn&&(qe=Bc()):(Zr=Ce,aa="value"in Zr?Zr.value:Zr.textContent,Qn=!0)),He=Fi(ge,Ge),0<He.length&&(Ge=new zc(Ge,e,null,i,Ce),je.push({event:Ge,listeners:He}),qe?Ge.data=qe:(qe=Gc(i),qe!==null&&(Ge.data=qe)))),(qe=em?tm(e,i):rm(e,i))&&(ge=Fi(ge,"onBeforeInput"),0<ge.length&&(Ce=new zc("onBeforeInput","beforeinput",null,i,Ce),je.push({event:Ce,listeners:ge}),Ce.data=qe))}hu(je,t)})}function $s(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Fi(e,t){for(var i=t+"Capture",u=[];e!==null;){var m=e,y=m.stateNode;m.tag===5&&y!==null&&(m=y,y=Wr(e,i),y!=null&&u.unshift($s(e,y,m)),y=Wr(e,t),y!=null&&u.push($s(e,y,m))),e=e.return}return u}function Yn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function mu(e,t,i,u,m){for(var y=t._reactName,O=[];i!==null&&i!==u;){var G=i,Y=G.alternate,ge=G.stateNode;if(Y!==null&&Y===u)break;G.tag===5&&ge!==null&&(G=ge,m?(Y=Wr(i,y),Y!=null&&O.unshift($s(i,Y,G))):m||(Y=Wr(i,y),Y!=null&&O.push($s(i,Y,G)))),i=i.return}O.length!==0&&e.push({event:t,listeners:O})}var gm=/\r\n?/g,ym=/\u0000|\uFFFD/g;function gu(e){return(typeof e=="string"?e:""+e).replace(gm,`
`).replace(ym,"")}function Bi(e,t,i){if(t=gu(t),gu(e)!==t&&i)throw Error(n(425))}function Mi(){}var Ca=null,Na=null;function ja(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ea=typeof setTimeout=="function"?setTimeout:void 0,vm=typeof clearTimeout=="function"?clearTimeout:void 0,yu=typeof Promise=="function"?Promise:void 0,xm=typeof queueMicrotask=="function"?queueMicrotask:typeof yu<"u"?function(e){return yu.resolve(null).then(e).catch(wm)}:Ea;function wm(e){setTimeout(function(){throw e})}function _a(e,t){var i=t,u=0;do{var m=i.nextSibling;if(e.removeChild(i),m&&m.nodeType===8)if(i=m.data,i==="/$"){if(u===0){e.removeChild(m),Ps(t);return}u--}else i!=="$"&&i!=="$?"&&i!=="$!"||u++;i=m}while(i);Ps(t)}function Jr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function vu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Jn=Math.random().toString(36).slice(2),Nr="__reactFiber$"+Jn,Ws="__reactProps$"+Jn,Pr="__reactContainer$"+Jn,Aa="__reactEvents$"+Jn,bm="__reactListeners$"+Jn,km="__reactHandles$"+Jn;function kn(e){var t=e[Nr];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Pr]||i[Nr]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=vu(e);e!==null;){if(i=e[Nr])return i;e=vu(e)}return t}e=i,i=e.parentNode}return null}function Vs(e){return e=e[Nr]||e[Pr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function es(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(n(33))}function Ui(e){return e[Ws]||null}var Ra=[],ts=-1;function en(e){return{current:e}}function pt(e){0>ts||(e.current=Ra[ts],Ra[ts]=null,ts--)}function ut(e,t){ts++,Ra[ts]=e.current,e.current=t}var tn={},zt=en(tn),Yt=en(!1),Sn=tn;function rs(e,t){var i=e.type.contextTypes;if(!i)return tn;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===t)return u.__reactInternalMemoizedMaskedChildContext;var m={},y;for(y in i)m[y]=t[y];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=m),m}function Jt(e){return e=e.childContextTypes,e!=null}function zi(){pt(Yt),pt(zt)}function xu(e,t,i){if(zt.current!==tn)throw Error(n(168));ut(zt,t),ut(Yt,i)}function wu(e,t,i){var u=e.stateNode;if(t=t.childContextTypes,typeof u.getChildContext!="function")return i;u=u.getChildContext();for(var m in u)if(!(m in t))throw Error(n(108,be(e)||"Unknown",m));return Z({},i,u)}function $i(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||tn,Sn=zt.current,ut(zt,e),ut(Yt,Yt.current),!0}function bu(e,t,i){var u=e.stateNode;if(!u)throw Error(n(169));i?(e=wu(e,t,Sn),u.__reactInternalMemoizedMergedChildContext=e,pt(Yt),pt(zt),ut(zt,e)):pt(Yt),ut(Yt,i)}var Or=null,Wi=!1,Ta=!1;function ku(e){Or===null?Or=[e]:Or.push(e)}function Sm(e){Wi=!0,ku(e)}function rn(){if(!Ta&&Or!==null){Ta=!0;var e=0,t=it;try{var i=Or;for(it=1;e<i.length;e++){var u=i[e];do u=u(!0);while(u!==null)}Or=null,Wi=!1}catch(m){throw Or!==null&&(Or=Or.slice(e+1)),Si(we,rn),m}finally{it=t,Ta=!1}}return null}var ns=[],ss=0,Vi=null,Hi=0,ur=[],dr=0,Cn=null,Ir=1,Lr="";function Nn(e,t){ns[ss++]=Hi,ns[ss++]=Vi,Vi=e,Hi=t}function Su(e,t,i){ur[dr++]=Ir,ur[dr++]=Lr,ur[dr++]=Cn,Cn=e;var u=Ir;e=Lr;var m=32-lt(u)-1;u&=~(1<<m),i+=1;var y=32-lt(t)+m;if(30<y){var O=m-m%5;y=(u&(1<<O)-1).toString(32),u>>=O,m-=O,Ir=1<<32-lt(t)+m|i<<m|u,Lr=y+e}else Ir=1<<y|i<<m|u,Lr=e}function Pa(e){e.return!==null&&(Nn(e,1),Su(e,1,0))}function Oa(e){for(;e===Vi;)Vi=ns[--ss],ns[ss]=null,Hi=ns[--ss],ns[ss]=null;for(;e===Cn;)Cn=ur[--dr],ur[dr]=null,Lr=ur[--dr],ur[dr]=null,Ir=ur[--dr],ur[dr]=null}var or=null,ar=null,gt=!1,xr=null;function Cu(e,t){var i=mr(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function Nu(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,or=e,ar=Jr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,or=e,ar=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Cn!==null?{id:Ir,overflow:Lr}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=mr(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,or=e,ar=null,!0):!1;default:return!1}}function Ia(e){return(e.mode&1)!==0&&(e.flags&128)===0}function La(e){if(gt){var t=ar;if(t){var i=t;if(!Nu(e,t)){if(Ia(e))throw Error(n(418));t=Jr(i.nextSibling);var u=or;t&&Nu(e,t)?Cu(u,i):(e.flags=e.flags&-4097|2,gt=!1,or=e)}}else{if(Ia(e))throw Error(n(418));e.flags=e.flags&-4097|2,gt=!1,or=e}}}function ju(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;or=e}function qi(e){if(e!==or)return!1;if(!gt)return ju(e),gt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ja(e.type,e.memoizedProps)),t&&(t=ar)){if(Ia(e))throw Eu(),Error(n(418));for(;t;)Cu(e,t),t=Jr(t.nextSibling)}if(ju(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(n(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){ar=Jr(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}ar=null}}else ar=or?Jr(e.stateNode.nextSibling):null;return!0}function Eu(){for(var e=ar;e;)e=Jr(e.nextSibling)}function is(){ar=or=null,gt=!1}function Da(e){xr===null?xr=[e]:xr.push(e)}var Cm=_.ReactCurrentBatchConfig;function Hs(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(n(309));var u=i.stateNode}if(!u)throw Error(n(147,e));var m=u,y=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===y?t.ref:(t=function(O){var G=m.refs;O===null?delete G[y]:G[y]=O},t._stringRef=y,t)}if(typeof e!="string")throw Error(n(284));if(!i._owner)throw Error(n(290,e))}return e}function Gi(e,t){throw e=Object.prototype.toString.call(t),Error(n(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _u(e){var t=e._init;return t(e._payload)}function Au(e){function t(le,se){if(e){var de=le.deletions;de===null?(le.deletions=[se],le.flags|=16):de.push(se)}}function i(le,se){if(!e)return null;for(;se!==null;)t(le,se),se=se.sibling;return null}function u(le,se){for(le=new Map;se!==null;)se.key!==null?le.set(se.key,se):le.set(se.index,se),se=se.sibling;return le}function m(le,se){return le=dn(le,se),le.index=0,le.sibling=null,le}function y(le,se,de){return le.index=de,e?(de=le.alternate,de!==null?(de=de.index,de<se?(le.flags|=2,se):de):(le.flags|=2,se)):(le.flags|=1048576,se)}function O(le){return e&&le.alternate===null&&(le.flags|=2),le}function G(le,se,de,_e){return se===null||se.tag!==6?(se=El(de,le.mode,_e),se.return=le,se):(se=m(se,de),se.return=le,se)}function Y(le,se,de,_e){var ze=de.type;return ze===$?Ce(le,se,de.props.children,_e,de.key):se!==null&&(se.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===me&&_u(ze)===se.type)?(_e=m(se,de.props),_e.ref=Hs(le,se,de),_e.return=le,_e):(_e=vo(de.type,de.key,de.props,null,le.mode,_e),_e.ref=Hs(le,se,de),_e.return=le,_e)}function ge(le,se,de,_e){return se===null||se.tag!==4||se.stateNode.containerInfo!==de.containerInfo||se.stateNode.implementation!==de.implementation?(se=_l(de,le.mode,_e),se.return=le,se):(se=m(se,de.children||[]),se.return=le,se)}function Ce(le,se,de,_e,ze){return se===null||se.tag!==7?(se=On(de,le.mode,_e,ze),se.return=le,se):(se=m(se,de),se.return=le,se)}function je(le,se,de){if(typeof se=="string"&&se!==""||typeof se=="number")return se=El(""+se,le.mode,de),se.return=le,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case F:return de=vo(se.type,se.key,se.props,null,le.mode,de),de.ref=Hs(le,null,se),de.return=le,de;case M:return se=_l(se,le.mode,de),se.return=le,se;case me:var _e=se._init;return je(le,_e(se._payload),de)}if(te(se)||re(se))return se=On(se,le.mode,de,null),se.return=le,se;Gi(le,se)}return null}function Se(le,se,de,_e){var ze=se!==null?se.key:null;if(typeof de=="string"&&de!==""||typeof de=="number")return ze!==null?null:G(le,se,""+de,_e);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case F:return de.key===ze?Y(le,se,de,_e):null;case M:return de.key===ze?ge(le,se,de,_e):null;case me:return ze=de._init,Se(le,se,ze(de._payload),_e)}if(te(de)||re(de))return ze!==null?null:Ce(le,se,de,_e,null);Gi(le,de)}return null}function Pe(le,se,de,_e,ze){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return le=le.get(de)||null,G(se,le,""+_e,ze);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case F:return le=le.get(_e.key===null?de:_e.key)||null,Y(se,le,_e,ze);case M:return le=le.get(_e.key===null?de:_e.key)||null,ge(se,le,_e,ze);case me:var He=_e._init;return Pe(le,se,de,He(_e._payload),ze)}if(te(_e)||re(_e))return le=le.get(de)||null,Ce(se,le,_e,ze,null);Gi(se,_e)}return null}function Fe(le,se,de,_e){for(var ze=null,He=null,qe=se,Ge=se=0,Dt=null;qe!==null&&Ge<de.length;Ge++){qe.index>Ge?(Dt=qe,qe=null):Dt=qe.sibling;var nt=Se(le,qe,de[Ge],_e);if(nt===null){qe===null&&(qe=Dt);break}e&&qe&&nt.alternate===null&&t(le,qe),se=y(nt,se,Ge),He===null?ze=nt:He.sibling=nt,He=nt,qe=Dt}if(Ge===de.length)return i(le,qe),gt&&Nn(le,Ge),ze;if(qe===null){for(;Ge<de.length;Ge++)qe=je(le,de[Ge],_e),qe!==null&&(se=y(qe,se,Ge),He===null?ze=qe:He.sibling=qe,He=qe);return gt&&Nn(le,Ge),ze}for(qe=u(le,qe);Ge<de.length;Ge++)Dt=Pe(qe,le,Ge,de[Ge],_e),Dt!==null&&(e&&Dt.alternate!==null&&qe.delete(Dt.key===null?Ge:Dt.key),se=y(Dt,se,Ge),He===null?ze=Dt:He.sibling=Dt,He=Dt);return e&&qe.forEach(function(fn){return t(le,fn)}),gt&&Nn(le,Ge),ze}function Ue(le,se,de,_e){var ze=re(de);if(typeof ze!="function")throw Error(n(150));if(de=ze.call(de),de==null)throw Error(n(151));for(var He=ze=null,qe=se,Ge=se=0,Dt=null,nt=de.next();qe!==null&&!nt.done;Ge++,nt=de.next()){qe.index>Ge?(Dt=qe,qe=null):Dt=qe.sibling;var fn=Se(le,qe,nt.value,_e);if(fn===null){qe===null&&(qe=Dt);break}e&&qe&&fn.alternate===null&&t(le,qe),se=y(fn,se,Ge),He===null?ze=fn:He.sibling=fn,He=fn,qe=Dt}if(nt.done)return i(le,qe),gt&&Nn(le,Ge),ze;if(qe===null){for(;!nt.done;Ge++,nt=de.next())nt=je(le,nt.value,_e),nt!==null&&(se=y(nt,se,Ge),He===null?ze=nt:He.sibling=nt,He=nt);return gt&&Nn(le,Ge),ze}for(qe=u(le,qe);!nt.done;Ge++,nt=de.next())nt=Pe(qe,le,Ge,nt.value,_e),nt!==null&&(e&&nt.alternate!==null&&qe.delete(nt.key===null?Ge:nt.key),se=y(nt,se,Ge),He===null?ze=nt:He.sibling=nt,He=nt);return e&&qe.forEach(function(ng){return t(le,ng)}),gt&&Nn(le,Ge),ze}function Nt(le,se,de,_e){if(typeof de=="object"&&de!==null&&de.type===$&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case F:e:{for(var ze=de.key,He=se;He!==null;){if(He.key===ze){if(ze=de.type,ze===$){if(He.tag===7){i(le,He.sibling),se=m(He,de.props.children),se.return=le,le=se;break e}}else if(He.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===me&&_u(ze)===He.type){i(le,He.sibling),se=m(He,de.props),se.ref=Hs(le,He,de),se.return=le,le=se;break e}i(le,He);break}else t(le,He);He=He.sibling}de.type===$?(se=On(de.props.children,le.mode,_e,de.key),se.return=le,le=se):(_e=vo(de.type,de.key,de.props,null,le.mode,_e),_e.ref=Hs(le,se,de),_e.return=le,le=_e)}return O(le);case M:e:{for(He=de.key;se!==null;){if(se.key===He)if(se.tag===4&&se.stateNode.containerInfo===de.containerInfo&&se.stateNode.implementation===de.implementation){i(le,se.sibling),se=m(se,de.children||[]),se.return=le,le=se;break e}else{i(le,se);break}else t(le,se);se=se.sibling}se=_l(de,le.mode,_e),se.return=le,le=se}return O(le);case me:return He=de._init,Nt(le,se,He(de._payload),_e)}if(te(de))return Fe(le,se,de,_e);if(re(de))return Ue(le,se,de,_e);Gi(le,de)}return typeof de=="string"&&de!==""||typeof de=="number"?(de=""+de,se!==null&&se.tag===6?(i(le,se.sibling),se=m(se,de),se.return=le,le=se):(i(le,se),se=El(de,le.mode,_e),se.return=le,le=se),O(le)):i(le,se)}return Nt}var os=Au(!0),Ru=Au(!1),Ki=en(null),Qi=null,as=null,Fa=null;function Ba(){Fa=as=Qi=null}function Ma(e){var t=Ki.current;pt(Ki),e._currentValue=t}function Ua(e,t,i){for(;e!==null;){var u=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,u!==null&&(u.childLanes|=t)):u!==null&&(u.childLanes&t)!==t&&(u.childLanes|=t),e===i)break;e=e.return}}function ls(e,t){Qi=e,Fa=as=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(er=!0),e.firstContext=null)}function fr(e){var t=e._currentValue;if(Fa!==e)if(e={context:e,memoizedValue:t,next:null},as===null){if(Qi===null)throw Error(n(308));as=e,Qi.dependencies={lanes:0,firstContext:e}}else as=as.next=e;return t}var jn=null;function za(e){jn===null?jn=[e]:jn.push(e)}function Tu(e,t,i,u){var m=t.interleaved;return m===null?(i.next=i,za(t)):(i.next=m.next,m.next=i),t.interleaved=i,Dr(e,u)}function Dr(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var nn=!1;function $a(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function sn(e,t,i){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,(rt&2)!==0){var m=u.pending;return m===null?t.next=t:(t.next=m.next,m.next=t),u.pending=t,Dr(e,i)}return m=u.interleaved,m===null?(t.next=t,za(u)):(t.next=m.next,m.next=t),u.interleaved=t,Dr(e,i)}function Xi(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var u=t.lanes;u&=e.pendingLanes,i|=u,t.lanes=i,ra(e,i)}}function Ou(e,t){var i=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,i===u)){var m=null,y=null;if(i=i.firstBaseUpdate,i!==null){do{var O={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};y===null?m=y=O:y=y.next=O,i=i.next}while(i!==null);y===null?m=y=t:y=y.next=t}else m=y=t;i={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:u.shared,effects:u.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Zi(e,t,i,u){var m=e.updateQueue;nn=!1;var y=m.firstBaseUpdate,O=m.lastBaseUpdate,G=m.shared.pending;if(G!==null){m.shared.pending=null;var Y=G,ge=Y.next;Y.next=null,O===null?y=ge:O.next=ge,O=Y;var Ce=e.alternate;Ce!==null&&(Ce=Ce.updateQueue,G=Ce.lastBaseUpdate,G!==O&&(G===null?Ce.firstBaseUpdate=ge:G.next=ge,Ce.lastBaseUpdate=Y))}if(y!==null){var je=m.baseState;O=0,Ce=ge=Y=null,G=y;do{var Se=G.lane,Pe=G.eventTime;if((u&Se)===Se){Ce!==null&&(Ce=Ce.next={eventTime:Pe,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});e:{var Fe=e,Ue=G;switch(Se=t,Pe=i,Ue.tag){case 1:if(Fe=Ue.payload,typeof Fe=="function"){je=Fe.call(Pe,je,Se);break e}je=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=Ue.payload,Se=typeof Fe=="function"?Fe.call(Pe,je,Se):Fe,Se==null)break e;je=Z({},je,Se);break e;case 2:nn=!0}}G.callback!==null&&G.lane!==0&&(e.flags|=64,Se=m.effects,Se===null?m.effects=[G]:Se.push(G))}else Pe={eventTime:Pe,lane:Se,tag:G.tag,payload:G.payload,callback:G.callback,next:null},Ce===null?(ge=Ce=Pe,Y=je):Ce=Ce.next=Pe,O|=Se;if(G=G.next,G===null){if(G=m.shared.pending,G===null)break;Se=G,G=Se.next,Se.next=null,m.lastBaseUpdate=Se,m.shared.pending=null}}while(!0);if(Ce===null&&(Y=je),m.baseState=Y,m.firstBaseUpdate=ge,m.lastBaseUpdate=Ce,t=m.shared.interleaved,t!==null){m=t;do O|=m.lane,m=m.next;while(m!==t)}else y===null&&(m.shared.lanes=0);An|=O,e.lanes=O,e.memoizedState=je}}function Iu(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var u=e[t],m=u.callback;if(m!==null){if(u.callback=null,u=i,typeof m!="function")throw Error(n(191,m));m.call(u)}}}var qs={},jr=en(qs),Gs=en(qs),Ks=en(qs);function En(e){if(e===qs)throw Error(n(174));return e}function Wa(e,t){switch(ut(Ks,t),ut(Gs,e),ut(jr,qs),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pe(t,e)}pt(jr),ut(jr,t)}function cs(){pt(jr),pt(Gs),pt(Ks)}function Lu(e){En(Ks.current);var t=En(jr.current),i=pe(t,e.type);t!==i&&(ut(Gs,e),ut(jr,i))}function Va(e){Gs.current===e&&(pt(jr),pt(Gs))}var xt=en(0);function Yi(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ha=[];function qa(){for(var e=0;e<Ha.length;e++)Ha[e]._workInProgressVersionPrimary=null;Ha.length=0}var Ji=_.ReactCurrentDispatcher,Ga=_.ReactCurrentBatchConfig,_n=0,wt=null,Et=null,It=null,eo=!1,Qs=!1,Xs=0,Nm=0;function $t(){throw Error(n(321))}function Ka(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!vr(e[i],t[i]))return!1;return!0}function Qa(e,t,i,u,m,y){if(_n=y,wt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ji.current=e===null||e.memoizedState===null?Am:Rm,e=i(u,m),Qs){y=0;do{if(Qs=!1,Xs=0,25<=y)throw Error(n(301));y+=1,It=Et=null,t.updateQueue=null,Ji.current=Tm,e=i(u,m)}while(Qs)}if(Ji.current=no,t=Et!==null&&Et.next!==null,_n=0,It=Et=wt=null,eo=!1,t)throw Error(n(300));return e}function Xa(){var e=Xs!==0;return Xs=0,e}function Er(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?wt.memoizedState=It=e:It=It.next=e,It}function hr(){if(Et===null){var e=wt.alternate;e=e!==null?e.memoizedState:null}else e=Et.next;var t=It===null?wt.memoizedState:It.next;if(t!==null)It=t,Et=e;else{if(e===null)throw Error(n(310));Et=e,e={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},It===null?wt.memoizedState=It=e:It=It.next=e}return It}function Zs(e,t){return typeof t=="function"?t(e):t}function Za(e){var t=hr(),i=t.queue;if(i===null)throw Error(n(311));i.lastRenderedReducer=e;var u=Et,m=u.baseQueue,y=i.pending;if(y!==null){if(m!==null){var O=m.next;m.next=y.next,y.next=O}u.baseQueue=m=y,i.pending=null}if(m!==null){y=m.next,u=u.baseState;var G=O=null,Y=null,ge=y;do{var Ce=ge.lane;if((_n&Ce)===Ce)Y!==null&&(Y=Y.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),u=ge.hasEagerState?ge.eagerState:e(u,ge.action);else{var je={lane:Ce,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};Y===null?(G=Y=je,O=u):Y=Y.next=je,wt.lanes|=Ce,An|=Ce}ge=ge.next}while(ge!==null&&ge!==y);Y===null?O=u:Y.next=G,vr(u,t.memoizedState)||(er=!0),t.memoizedState=u,t.baseState=O,t.baseQueue=Y,i.lastRenderedState=u}if(e=i.interleaved,e!==null){m=e;do y=m.lane,wt.lanes|=y,An|=y,m=m.next;while(m!==e)}else m===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Ya(e){var t=hr(),i=t.queue;if(i===null)throw Error(n(311));i.lastRenderedReducer=e;var u=i.dispatch,m=i.pending,y=t.memoizedState;if(m!==null){i.pending=null;var O=m=m.next;do y=e(y,O.action),O=O.next;while(O!==m);vr(y,t.memoizedState)||(er=!0),t.memoizedState=y,t.baseQueue===null&&(t.baseState=y),i.lastRenderedState=y}return[y,u]}function Du(){}function Fu(e,t){var i=wt,u=hr(),m=t(),y=!vr(u.memoizedState,m);if(y&&(u.memoizedState=m,er=!0),u=u.queue,Ja(Uu.bind(null,i,u,e),[e]),u.getSnapshot!==t||y||It!==null&&It.memoizedState.tag&1){if(i.flags|=2048,Ys(9,Mu.bind(null,i,u,m,t),void 0,null),Lt===null)throw Error(n(349));(_n&30)!==0||Bu(i,t,m)}return m}function Bu(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=wt.updateQueue,t===null?(t={lastEffect:null,stores:null},wt.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function Mu(e,t,i,u){t.value=i,t.getSnapshot=u,zu(t)&&$u(e)}function Uu(e,t,i){return i(function(){zu(t)&&$u(e)})}function zu(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!vr(e,i)}catch{return!0}}function $u(e){var t=Dr(e,1);t!==null&&Sr(t,e,1,-1)}function Wu(e){var t=Er();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:e},t.queue=e,e=e.dispatch=_m.bind(null,wt,e),[t.memoizedState,e]}function Ys(e,t,i,u){return e={tag:e,create:t,destroy:i,deps:u,next:null},t=wt.updateQueue,t===null?(t={lastEffect:null,stores:null},wt.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(u=i.next,i.next=e,e.next=u,t.lastEffect=e)),e}function Vu(){return hr().memoizedState}function to(e,t,i,u){var m=Er();wt.flags|=e,m.memoizedState=Ys(1|t,i,void 0,u===void 0?null:u)}function ro(e,t,i,u){var m=hr();u=u===void 0?null:u;var y=void 0;if(Et!==null){var O=Et.memoizedState;if(y=O.destroy,u!==null&&Ka(u,O.deps)){m.memoizedState=Ys(t,i,y,u);return}}wt.flags|=e,m.memoizedState=Ys(1|t,i,y,u)}function Hu(e,t){return to(8390656,8,e,t)}function Ja(e,t){return ro(2048,8,e,t)}function qu(e,t){return ro(4,2,e,t)}function Gu(e,t){return ro(4,4,e,t)}function Ku(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Qu(e,t,i){return i=i!=null?i.concat([e]):null,ro(4,4,Ku.bind(null,t,e),i)}function el(){}function Xu(e,t){var i=hr();t=t===void 0?null:t;var u=i.memoizedState;return u!==null&&t!==null&&Ka(t,u[1])?u[0]:(i.memoizedState=[e,t],e)}function Zu(e,t){var i=hr();t=t===void 0?null:t;var u=i.memoizedState;return u!==null&&t!==null&&Ka(t,u[1])?u[0]:(e=e(),i.memoizedState=[e,t],e)}function Yu(e,t,i){return(_n&21)===0?(e.baseState&&(e.baseState=!1,er=!0),e.memoizedState=i):(vr(i,t)||(i=_c(),wt.lanes|=i,An|=i,e.baseState=!0),t)}function jm(e,t){var i=it;it=i!==0&&4>i?i:4,e(!0);var u=Ga.transition;Ga.transition={};try{e(!1),t()}finally{it=i,Ga.transition=u}}function Ju(){return hr().memoizedState}function Em(e,t,i){var u=cn(e);if(i={lane:u,action:i,hasEagerState:!1,eagerState:null,next:null},ed(e))td(t,i);else if(i=Tu(e,t,i,u),i!==null){var m=Kt();Sr(i,e,u,m),rd(i,t,u)}}function _m(e,t,i){var u=cn(e),m={lane:u,action:i,hasEagerState:!1,eagerState:null,next:null};if(ed(e))td(t,m);else{var y=e.alternate;if(e.lanes===0&&(y===null||y.lanes===0)&&(y=t.lastRenderedReducer,y!==null))try{var O=t.lastRenderedState,G=y(O,i);if(m.hasEagerState=!0,m.eagerState=G,vr(G,O)){var Y=t.interleaved;Y===null?(m.next=m,za(t)):(m.next=Y.next,Y.next=m),t.interleaved=m;return}}catch{}finally{}i=Tu(e,t,m,u),i!==null&&(m=Kt(),Sr(i,e,u,m),rd(i,t,u))}}function ed(e){var t=e.alternate;return e===wt||t!==null&&t===wt}function td(e,t){Qs=eo=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function rd(e,t,i){if((i&4194240)!==0){var u=t.lanes;u&=e.pendingLanes,i|=u,t.lanes=i,ra(e,i)}}var no={readContext:fr,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},Am={readContext:fr,useCallback:function(e,t){return Er().memoizedState=[e,t===void 0?null:t],e},useContext:fr,useEffect:Hu,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,to(4194308,4,Ku.bind(null,t,e),i)},useLayoutEffect:function(e,t){return to(4194308,4,e,t)},useInsertionEffect:function(e,t){return to(4,2,e,t)},useMemo:function(e,t){var i=Er();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var u=Er();return t=i!==void 0?i(t):t,u.memoizedState=u.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},u.queue=e,e=e.dispatch=Em.bind(null,wt,e),[u.memoizedState,e]},useRef:function(e){var t=Er();return e={current:e},t.memoizedState=e},useState:Wu,useDebugValue:el,useDeferredValue:function(e){return Er().memoizedState=e},useTransition:function(){var e=Wu(!1),t=e[0];return e=jm.bind(null,e[1]),Er().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var u=wt,m=Er();if(gt){if(i===void 0)throw Error(n(407));i=i()}else{if(i=t(),Lt===null)throw Error(n(349));(_n&30)!==0||Bu(u,t,i)}m.memoizedState=i;var y={value:i,getSnapshot:t};return m.queue=y,Hu(Uu.bind(null,u,y,e),[e]),u.flags|=2048,Ys(9,Mu.bind(null,u,y,i,t),void 0,null),i},useId:function(){var e=Er(),t=Lt.identifierPrefix;if(gt){var i=Lr,u=Ir;i=(u&~(1<<32-lt(u)-1)).toString(32)+i,t=":"+t+"R"+i,i=Xs++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=Nm++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Rm={readContext:fr,useCallback:Xu,useContext:fr,useEffect:Ja,useImperativeHandle:Qu,useInsertionEffect:qu,useLayoutEffect:Gu,useMemo:Zu,useReducer:Za,useRef:Vu,useState:function(){return Za(Zs)},useDebugValue:el,useDeferredValue:function(e){var t=hr();return Yu(t,Et.memoizedState,e)},useTransition:function(){var e=Za(Zs)[0],t=hr().memoizedState;return[e,t]},useMutableSource:Du,useSyncExternalStore:Fu,useId:Ju,unstable_isNewReconciler:!1},Tm={readContext:fr,useCallback:Xu,useContext:fr,useEffect:Ja,useImperativeHandle:Qu,useInsertionEffect:qu,useLayoutEffect:Gu,useMemo:Zu,useReducer:Ya,useRef:Vu,useState:function(){return Ya(Zs)},useDebugValue:el,useDeferredValue:function(e){var t=hr();return Et===null?t.memoizedState=e:Yu(t,Et.memoizedState,e)},useTransition:function(){var e=Ya(Zs)[0],t=hr().memoizedState;return[e,t]},useMutableSource:Du,useSyncExternalStore:Fu,useId:Ju,unstable_isNewReconciler:!1};function wr(e,t){if(e&&e.defaultProps){t=Z({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function tl(e,t,i,u){t=e.memoizedState,i=i(u,t),i=i==null?t:Z({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var so={isMounted:function(e){return(e=e._reactInternals)?Tr(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var u=Kt(),m=cn(e),y=Fr(u,m);y.payload=t,i!=null&&(y.callback=i),t=sn(e,y,m),t!==null&&(Sr(t,e,m,u),Xi(t,e,m))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var u=Kt(),m=cn(e),y=Fr(u,m);y.tag=1,y.payload=t,i!=null&&(y.callback=i),t=sn(e,y,m),t!==null&&(Sr(t,e,m,u),Xi(t,e,m))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Kt(),u=cn(e),m=Fr(i,u);m.tag=2,t!=null&&(m.callback=t),t=sn(e,m,u),t!==null&&(Sr(t,e,u,i),Xi(t,e,u))}};function nd(e,t,i,u,m,y,O){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,y,O):t.prototype&&t.prototype.isPureReactComponent?!Bs(i,u)||!Bs(m,y):!0}function sd(e,t,i){var u=!1,m=tn,y=t.contextType;return typeof y=="object"&&y!==null?y=fr(y):(m=Jt(t)?Sn:zt.current,u=t.contextTypes,y=(u=u!=null)?rs(e,m):tn),t=new t(i,y),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=so,e.stateNode=t,t._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=m,e.__reactInternalMemoizedMaskedChildContext=y),t}function id(e,t,i,u){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,u),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,u),t.state!==e&&so.enqueueReplaceState(t,t.state,null)}function rl(e,t,i,u){var m=e.stateNode;m.props=i,m.state=e.memoizedState,m.refs={},$a(e);var y=t.contextType;typeof y=="object"&&y!==null?m.context=fr(y):(y=Jt(t)?Sn:zt.current,m.context=rs(e,y)),m.state=e.memoizedState,y=t.getDerivedStateFromProps,typeof y=="function"&&(tl(e,t,y,i),m.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(t=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),t!==m.state&&so.enqueueReplaceState(m,m.state,null),Zi(e,i,m,u),m.state=e.memoizedState),typeof m.componentDidMount=="function"&&(e.flags|=4194308)}function us(e,t){try{var i="",u=t;do i+=fe(u),u=u.return;while(u);var m=i}catch(y){m=`
Error generating stack: `+y.message+`
`+y.stack}return{value:e,source:t,stack:m,digest:null}}function nl(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function sl(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var Pm=typeof WeakMap=="function"?WeakMap:Map;function od(e,t,i){i=Fr(-1,i),i.tag=3,i.payload={element:null};var u=t.value;return i.callback=function(){fo||(fo=!0,xl=u),sl(e,t)},i}function ad(e,t,i){i=Fr(-1,i),i.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var m=t.value;i.payload=function(){return u(m)},i.callback=function(){sl(e,t)}}var y=e.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(i.callback=function(){sl(e,t),typeof u!="function"&&(an===null?an=new Set([this]):an.add(this));var O=t.stack;this.componentDidCatch(t.value,{componentStack:O!==null?O:""})}),i}function ld(e,t,i){var u=e.pingCache;if(u===null){u=e.pingCache=new Pm;var m=new Set;u.set(t,m)}else m=u.get(t),m===void 0&&(m=new Set,u.set(t,m));m.has(i)||(m.add(i),e=qm.bind(null,e,t,i),t.then(e,e))}function cd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ud(e,t,i,u,m){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=Fr(-1,1),t.tag=2,sn(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=m,e)}var Om=_.ReactCurrentOwner,er=!1;function Gt(e,t,i,u){t.child=e===null?Ru(t,null,i,u):os(t,e.child,i,u)}function dd(e,t,i,u,m){i=i.render;var y=t.ref;return ls(t,m),u=Qa(e,t,i,u,y,m),i=Xa(),e!==null&&!er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~m,Br(e,t,m)):(gt&&i&&Pa(t),t.flags|=1,Gt(e,t,u,m),t.child)}function fd(e,t,i,u,m){if(e===null){var y=i.type;return typeof y=="function"&&!jl(y)&&y.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=y,hd(e,t,y,u,m)):(e=vo(i.type,null,u,t,t.mode,m),e.ref=t.ref,e.return=t,t.child=e)}if(y=e.child,(e.lanes&m)===0){var O=y.memoizedProps;if(i=i.compare,i=i!==null?i:Bs,i(O,u)&&e.ref===t.ref)return Br(e,t,m)}return t.flags|=1,e=dn(y,u),e.ref=t.ref,e.return=t,t.child=e}function hd(e,t,i,u,m){if(e!==null){var y=e.memoizedProps;if(Bs(y,u)&&e.ref===t.ref)if(er=!1,t.pendingProps=u=y,(e.lanes&m)!==0)(e.flags&131072)!==0&&(er=!0);else return t.lanes=e.lanes,Br(e,t,m)}return il(e,t,i,u,m)}function pd(e,t,i){var u=t.pendingProps,m=u.children,y=e!==null?e.memoizedState:null;if(u.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(fs,lr),lr|=i;else{if((i&1073741824)===0)return e=y!==null?y.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ut(fs,lr),lr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=y!==null?y.baseLanes:i,ut(fs,lr),lr|=u}else y!==null?(u=y.baseLanes|i,t.memoizedState=null):u=i,ut(fs,lr),lr|=u;return Gt(e,t,m,i),t.child}function md(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function il(e,t,i,u,m){var y=Jt(i)?Sn:zt.current;return y=rs(t,y),ls(t,m),i=Qa(e,t,i,u,y,m),u=Xa(),e!==null&&!er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~m,Br(e,t,m)):(gt&&u&&Pa(t),t.flags|=1,Gt(e,t,i,m),t.child)}function gd(e,t,i,u,m){if(Jt(i)){var y=!0;$i(t)}else y=!1;if(ls(t,m),t.stateNode===null)oo(e,t),sd(t,i,u),rl(t,i,u,m),u=!0;else if(e===null){var O=t.stateNode,G=t.memoizedProps;O.props=G;var Y=O.context,ge=i.contextType;typeof ge=="object"&&ge!==null?ge=fr(ge):(ge=Jt(i)?Sn:zt.current,ge=rs(t,ge));var Ce=i.getDerivedStateFromProps,je=typeof Ce=="function"||typeof O.getSnapshotBeforeUpdate=="function";je||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(G!==u||Y!==ge)&&id(t,O,u,ge),nn=!1;var Se=t.memoizedState;O.state=Se,Zi(t,u,O,m),Y=t.memoizedState,G!==u||Se!==Y||Yt.current||nn?(typeof Ce=="function"&&(tl(t,i,Ce,u),Y=t.memoizedState),(G=nn||nd(t,i,G,u,Se,Y,ge))?(je||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(t.flags|=4194308)):(typeof O.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=u,t.memoizedState=Y),O.props=u,O.state=Y,O.context=ge,u=G):(typeof O.componentDidMount=="function"&&(t.flags|=4194308),u=!1)}else{O=t.stateNode,Pu(e,t),G=t.memoizedProps,ge=t.type===t.elementType?G:wr(t.type,G),O.props=ge,je=t.pendingProps,Se=O.context,Y=i.contextType,typeof Y=="object"&&Y!==null?Y=fr(Y):(Y=Jt(i)?Sn:zt.current,Y=rs(t,Y));var Pe=i.getDerivedStateFromProps;(Ce=typeof Pe=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(G!==je||Se!==Y)&&id(t,O,u,Y),nn=!1,Se=t.memoizedState,O.state=Se,Zi(t,u,O,m);var Fe=t.memoizedState;G!==je||Se!==Fe||Yt.current||nn?(typeof Pe=="function"&&(tl(t,i,Pe,u),Fe=t.memoizedState),(ge=nn||nd(t,i,ge,u,Se,Fe,Y)||!1)?(Ce||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(u,Fe,Y),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(u,Fe,Y)),typeof O.componentDidUpdate=="function"&&(t.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof O.componentDidUpdate!="function"||G===e.memoizedProps&&Se===e.memoizedState||(t.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||G===e.memoizedProps&&Se===e.memoizedState||(t.flags|=1024),t.memoizedProps=u,t.memoizedState=Fe),O.props=u,O.state=Fe,O.context=Y,u=ge):(typeof O.componentDidUpdate!="function"||G===e.memoizedProps&&Se===e.memoizedState||(t.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||G===e.memoizedProps&&Se===e.memoizedState||(t.flags|=1024),u=!1)}return ol(e,t,i,u,y,m)}function ol(e,t,i,u,m,y){md(e,t);var O=(t.flags&128)!==0;if(!u&&!O)return m&&bu(t,i,!1),Br(e,t,y);u=t.stateNode,Om.current=t;var G=O&&typeof i.getDerivedStateFromError!="function"?null:u.render();return t.flags|=1,e!==null&&O?(t.child=os(t,e.child,null,y),t.child=os(t,null,G,y)):Gt(e,t,G,y),t.memoizedState=u.state,m&&bu(t,i,!0),t.child}function yd(e){var t=e.stateNode;t.pendingContext?xu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xu(e,t.context,!1),Wa(e,t.containerInfo)}function vd(e,t,i,u,m){return is(),Da(m),t.flags|=256,Gt(e,t,i,u),t.child}var al={dehydrated:null,treeContext:null,retryLane:0};function ll(e){return{baseLanes:e,cachePool:null,transitions:null}}function xd(e,t,i){var u=t.pendingProps,m=xt.current,y=!1,O=(t.flags&128)!==0,G;if((G=O)||(G=e!==null&&e.memoizedState===null?!1:(m&2)!==0),G?(y=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(m|=1),ut(xt,m&1),e===null)return La(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(O=u.children,e=u.fallback,y?(u=t.mode,y=t.child,O={mode:"hidden",children:O},(u&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=O):y=xo(O,u,0,null),e=On(e,u,i,null),y.return=t,e.return=t,y.sibling=e,t.child=y,t.child.memoizedState=ll(i),t.memoizedState=al,e):cl(t,O));if(m=e.memoizedState,m!==null&&(G=m.dehydrated,G!==null))return Im(e,t,O,u,G,m,i);if(y){y=u.fallback,O=t.mode,m=e.child,G=m.sibling;var Y={mode:"hidden",children:u.children};return(O&1)===0&&t.child!==m?(u=t.child,u.childLanes=0,u.pendingProps=Y,t.deletions=null):(u=dn(m,Y),u.subtreeFlags=m.subtreeFlags&14680064),G!==null?y=dn(G,y):(y=On(y,O,i,null),y.flags|=2),y.return=t,u.return=t,u.sibling=y,t.child=u,u=y,y=t.child,O=e.child.memoizedState,O=O===null?ll(i):{baseLanes:O.baseLanes|i,cachePool:null,transitions:O.transitions},y.memoizedState=O,y.childLanes=e.childLanes&~i,t.memoizedState=al,u}return y=e.child,e=y.sibling,u=dn(y,{mode:"visible",children:u.children}),(t.mode&1)===0&&(u.lanes=i),u.return=t,u.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=u,t.memoizedState=null,u}function cl(e,t){return t=xo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function io(e,t,i,u){return u!==null&&Da(u),os(t,e.child,null,i),e=cl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Im(e,t,i,u,m,y,O){if(i)return t.flags&256?(t.flags&=-257,u=nl(Error(n(422))),io(e,t,O,u)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(y=u.fallback,m=t.mode,u=xo({mode:"visible",children:u.children},m,0,null),y=On(y,m,O,null),y.flags|=2,u.return=t,y.return=t,u.sibling=y,t.child=u,(t.mode&1)!==0&&os(t,e.child,null,O),t.child.memoizedState=ll(O),t.memoizedState=al,y);if((t.mode&1)===0)return io(e,t,O,null);if(m.data==="$!"){if(u=m.nextSibling&&m.nextSibling.dataset,u)var G=u.dgst;return u=G,y=Error(n(419)),u=nl(y,u,void 0),io(e,t,O,u)}if(G=(O&e.childLanes)!==0,er||G){if(u=Lt,u!==null){switch(O&-O){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(u.suspendedLanes|O))!==0?0:m,m!==0&&m!==y.retryLane&&(y.retryLane=m,Dr(e,m),Sr(u,e,m,-1))}return Nl(),u=nl(Error(n(421))),io(e,t,O,u)}return m.data==="$?"?(t.flags|=128,t.child=e.child,t=Gm.bind(null,e),m._reactRetry=t,null):(e=y.treeContext,ar=Jr(m.nextSibling),or=t,gt=!0,xr=null,e!==null&&(ur[dr++]=Ir,ur[dr++]=Lr,ur[dr++]=Cn,Ir=e.id,Lr=e.overflow,Cn=t),t=cl(t,u.children),t.flags|=4096,t)}function wd(e,t,i){e.lanes|=t;var u=e.alternate;u!==null&&(u.lanes|=t),Ua(e.return,t,i)}function ul(e,t,i,u,m){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:u,tail:i,tailMode:m}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=u,y.tail=i,y.tailMode=m)}function bd(e,t,i){var u=t.pendingProps,m=u.revealOrder,y=u.tail;if(Gt(e,t,u.children,i),u=xt.current,(u&2)!==0)u=u&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wd(e,i,t);else if(e.tag===19)wd(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(ut(xt,u),(t.mode&1)===0)t.memoizedState=null;else switch(m){case"forwards":for(i=t.child,m=null;i!==null;)e=i.alternate,e!==null&&Yi(e)===null&&(m=i),i=i.sibling;i=m,i===null?(m=t.child,t.child=null):(m=i.sibling,i.sibling=null),ul(t,!1,m,i,y);break;case"backwards":for(i=null,m=t.child,t.child=null;m!==null;){if(e=m.alternate,e!==null&&Yi(e)===null){t.child=m;break}e=m.sibling,m.sibling=i,i=m,m=e}ul(t,!0,i,null,y);break;case"together":ul(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function oo(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Br(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),An|=t.lanes,(i&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(n(153));if(t.child!==null){for(e=t.child,i=dn(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=dn(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function Lm(e,t,i){switch(t.tag){case 3:yd(t),is();break;case 5:Lu(t);break;case 1:Jt(t.type)&&$i(t);break;case 4:Wa(t,t.stateNode.containerInfo);break;case 10:var u=t.type._context,m=t.memoizedProps.value;ut(Ki,u._currentValue),u._currentValue=m;break;case 13:if(u=t.memoizedState,u!==null)return u.dehydrated!==null?(ut(xt,xt.current&1),t.flags|=128,null):(i&t.child.childLanes)!==0?xd(e,t,i):(ut(xt,xt.current&1),e=Br(e,t,i),e!==null?e.sibling:null);ut(xt,xt.current&1);break;case 19:if(u=(i&t.childLanes)!==0,(e.flags&128)!==0){if(u)return bd(e,t,i);t.flags|=128}if(m=t.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ut(xt,xt.current),u)break;return null;case 22:case 23:return t.lanes=0,pd(e,t,i)}return Br(e,t,i)}var kd,dl,Sd,Cd;kd=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},dl=function(){},Sd=function(e,t,i,u){var m=e.memoizedProps;if(m!==u){e=t.stateNode,En(jr.current);var y=null;switch(i){case"input":m=j(e,m),u=j(e,u),y=[];break;case"select":m=Z({},m,{value:void 0}),u=Z({},u,{value:void 0}),y=[];break;case"textarea":m=J(e,m),u=J(e,u),y=[];break;default:typeof m.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=Mi)}Qe(i,u);var O;i=null;for(ge in m)if(!u.hasOwnProperty(ge)&&m.hasOwnProperty(ge)&&m[ge]!=null)if(ge==="style"){var G=m[ge];for(O in G)G.hasOwnProperty(O)&&(i||(i={}),i[O]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(c.hasOwnProperty(ge)?y||(y=[]):(y=y||[]).push(ge,null));for(ge in u){var Y=u[ge];if(G=m?.[ge],u.hasOwnProperty(ge)&&Y!==G&&(Y!=null||G!=null))if(ge==="style")if(G){for(O in G)!G.hasOwnProperty(O)||Y&&Y.hasOwnProperty(O)||(i||(i={}),i[O]="");for(O in Y)Y.hasOwnProperty(O)&&G[O]!==Y[O]&&(i||(i={}),i[O]=Y[O])}else i||(y||(y=[]),y.push(ge,i)),i=Y;else ge==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,G=G?G.__html:void 0,Y!=null&&G!==Y&&(y=y||[]).push(ge,Y)):ge==="children"?typeof Y!="string"&&typeof Y!="number"||(y=y||[]).push(ge,""+Y):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(c.hasOwnProperty(ge)?(Y!=null&&ge==="onScroll"&&ht("scroll",e),y||G===Y||(y=[])):(y=y||[]).push(ge,Y))}i&&(y=y||[]).push("style",i);var ge=y;(t.updateQueue=ge)&&(t.flags|=4)}},Cd=function(e,t,i,u){i!==u&&(t.flags|=4)};function Js(e,t){if(!gt)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function Wt(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,u=0;if(t)for(var m=e.child;m!==null;)i|=m.lanes|m.childLanes,u|=m.subtreeFlags&14680064,u|=m.flags&14680064,m.return=e,m=m.sibling;else for(m=e.child;m!==null;)i|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=e,m=m.sibling;return e.subtreeFlags|=u,e.childLanes=i,t}function Dm(e,t,i){var u=t.pendingProps;switch(Oa(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(t),null;case 1:return Jt(t.type)&&zi(),Wt(t),null;case 3:return u=t.stateNode,cs(),pt(Yt),pt(zt),qa(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(qi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,xr!==null&&(kl(xr),xr=null))),dl(e,t),Wt(t),null;case 5:Va(t);var m=En(Ks.current);if(i=t.type,e!==null&&t.stateNode!=null)Sd(e,t,i,u,m),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!u){if(t.stateNode===null)throw Error(n(166));return Wt(t),null}if(e=En(jr.current),qi(t)){u=t.stateNode,i=t.type;var y=t.memoizedProps;switch(u[Nr]=t,u[Ws]=y,e=(t.mode&1)!==0,i){case"dialog":ht("cancel",u),ht("close",u);break;case"iframe":case"object":case"embed":ht("load",u);break;case"video":case"audio":for(m=0;m<Us.length;m++)ht(Us[m],u);break;case"source":ht("error",u);break;case"img":case"image":case"link":ht("error",u),ht("load",u);break;case"details":ht("toggle",u);break;case"input":ue(u,y),ht("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!y.multiple},ht("invalid",u);break;case"textarea":A(u,y),ht("invalid",u)}Qe(i,y),m=null;for(var O in y)if(y.hasOwnProperty(O)){var G=y[O];O==="children"?typeof G=="string"?u.textContent!==G&&(y.suppressHydrationWarning!==!0&&Bi(u.textContent,G,e),m=["children",G]):typeof G=="number"&&u.textContent!==""+G&&(y.suppressHydrationWarning!==!0&&Bi(u.textContent,G,e),m=["children",""+G]):c.hasOwnProperty(O)&&G!=null&&O==="onScroll"&&ht("scroll",u)}switch(i){case"input":$e(u),D(u,y,!0);break;case"textarea":$e(u),U(u);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(u.onclick=Mi)}u=m,t.updateQueue=u,u!==null&&(t.flags|=4)}else{O=m.nodeType===9?m:m.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=K(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=O.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=O.createElement(i,{is:u.is}):(e=O.createElement(i),i==="select"&&(O=e,u.multiple?O.multiple=!0:u.size&&(O.size=u.size))):e=O.createElementNS(e,i),e[Nr]=t,e[Ws]=u,kd(e,t,!1,!1),t.stateNode=e;e:{switch(O=ot(i,u),i){case"dialog":ht("cancel",e),ht("close",e),m=u;break;case"iframe":case"object":case"embed":ht("load",e),m=u;break;case"video":case"audio":for(m=0;m<Us.length;m++)ht(Us[m],e);m=u;break;case"source":ht("error",e),m=u;break;case"img":case"image":case"link":ht("error",e),ht("load",e),m=u;break;case"details":ht("toggle",e),m=u;break;case"input":ue(e,u),m=j(e,u),ht("invalid",e);break;case"option":m=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},m=Z({},u,{value:void 0}),ht("invalid",e);break;case"textarea":A(e,u),m=J(e,u),ht("invalid",e);break;default:m=u}Qe(i,m),G=m;for(y in G)if(G.hasOwnProperty(y)){var Y=G[y];y==="style"?We(e,Y):y==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,Y!=null&&ve(e,Y)):y==="children"?typeof Y=="string"?(i!=="textarea"||Y!=="")&&ke(e,Y):typeof Y=="number"&&ke(e,""+Y):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(c.hasOwnProperty(y)?Y!=null&&y==="onScroll"&&ht("scroll",e):Y!=null&&I(e,y,Y,O))}switch(i){case"input":$e(e),D(e,u,!1);break;case"textarea":$e(e),U(e);break;case"option":u.value!=null&&e.setAttribute("value",""+xe(u.value));break;case"select":e.multiple=!!u.multiple,y=u.value,y!=null?ae(e,!!u.multiple,y,!1):u.defaultValue!=null&&ae(e,!!u.multiple,u.defaultValue,!0);break;default:typeof m.onClick=="function"&&(e.onclick=Mi)}switch(i){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Wt(t),null;case 6:if(e&&t.stateNode!=null)Cd(e,t,e.memoizedProps,u);else{if(typeof u!="string"&&t.stateNode===null)throw Error(n(166));if(i=En(Ks.current),En(jr.current),qi(t)){if(u=t.stateNode,i=t.memoizedProps,u[Nr]=t,(y=u.nodeValue!==i)&&(e=or,e!==null))switch(e.tag){case 3:Bi(u.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Bi(u.nodeValue,i,(e.mode&1)!==0)}y&&(t.flags|=4)}else u=(i.nodeType===9?i:i.ownerDocument).createTextNode(u),u[Nr]=t,t.stateNode=u}return Wt(t),null;case 13:if(pt(xt),u=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(gt&&ar!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Eu(),is(),t.flags|=98560,y=!1;else if(y=qi(t),u!==null&&u.dehydrated!==null){if(e===null){if(!y)throw Error(n(318));if(y=t.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[Nr]=t}else is(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Wt(t),y=!1}else xr!==null&&(kl(xr),xr=null),y=!0;if(!y)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=i,t):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(xt.current&1)!==0?_t===0&&(_t=3):Nl())),t.updateQueue!==null&&(t.flags|=4),Wt(t),null);case 4:return cs(),dl(e,t),e===null&&zs(t.stateNode.containerInfo),Wt(t),null;case 10:return Ma(t.type._context),Wt(t),null;case 17:return Jt(t.type)&&zi(),Wt(t),null;case 19:if(pt(xt),y=t.memoizedState,y===null)return Wt(t),null;if(u=(t.flags&128)!==0,O=y.rendering,O===null)if(u)Js(y,!1);else{if(_t!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(O=Yi(e),O!==null){for(t.flags|=128,Js(y,!1),u=O.updateQueue,u!==null&&(t.updateQueue=u,t.flags|=4),t.subtreeFlags=0,u=i,i=t.child;i!==null;)y=i,e=u,y.flags&=14680066,O=y.alternate,O===null?(y.childLanes=0,y.lanes=e,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=O.childLanes,y.lanes=O.lanes,y.child=O.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=O.memoizedProps,y.memoizedState=O.memoizedState,y.updateQueue=O.updateQueue,y.type=O.type,e=O.dependencies,y.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return ut(xt,xt.current&1|2),t.child}e=e.sibling}y.tail!==null&&vt()>hs&&(t.flags|=128,u=!0,Js(y,!1),t.lanes=4194304)}else{if(!u)if(e=Yi(O),e!==null){if(t.flags|=128,u=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),Js(y,!0),y.tail===null&&y.tailMode==="hidden"&&!O.alternate&&!gt)return Wt(t),null}else 2*vt()-y.renderingStartTime>hs&&i!==1073741824&&(t.flags|=128,u=!0,Js(y,!1),t.lanes=4194304);y.isBackwards?(O.sibling=t.child,t.child=O):(i=y.last,i!==null?i.sibling=O:t.child=O,y.last=O)}return y.tail!==null?(t=y.tail,y.rendering=t,y.tail=t.sibling,y.renderingStartTime=vt(),t.sibling=null,i=xt.current,ut(xt,u?i&1|2:i&1),t):(Wt(t),null);case 22:case 23:return Cl(),u=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(t.flags|=8192),u&&(t.mode&1)!==0?(lr&1073741824)!==0&&(Wt(t),t.subtreeFlags&6&&(t.flags|=8192)):Wt(t),null;case 24:return null;case 25:return null}throw Error(n(156,t.tag))}function Fm(e,t){switch(Oa(t),t.tag){case 1:return Jt(t.type)&&zi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return cs(),pt(Yt),pt(zt),qa(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Va(t),null;case 13:if(pt(xt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(n(340));is()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pt(xt),null;case 4:return cs(),null;case 10:return Ma(t.type._context),null;case 22:case 23:return Cl(),null;case 24:return null;default:return null}}var ao=!1,Vt=!1,Bm=typeof WeakSet=="function"?WeakSet:Set,Le=null;function ds(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(u){kt(e,t,u)}else i.current=null}function fl(e,t,i){try{i()}catch(u){kt(e,t,u)}}var Nd=!1;function Mm(e,t){if(Ca=Ei,e=nu(),ga(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var u=i.getSelection&&i.getSelection();if(u&&u.rangeCount!==0){i=u.anchorNode;var m=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{i.nodeType,y.nodeType}catch{i=null;break e}var O=0,G=-1,Y=-1,ge=0,Ce=0,je=e,Se=null;t:for(;;){for(var Pe;je!==i||m!==0&&je.nodeType!==3||(G=O+m),je!==y||u!==0&&je.nodeType!==3||(Y=O+u),je.nodeType===3&&(O+=je.nodeValue.length),(Pe=je.firstChild)!==null;)Se=je,je=Pe;for(;;){if(je===e)break t;if(Se===i&&++ge===m&&(G=O),Se===y&&++Ce===u&&(Y=O),(Pe=je.nextSibling)!==null)break;je=Se,Se=je.parentNode}je=Pe}i=G===-1||Y===-1?null:{start:G,end:Y}}else i=null}i=i||{start:0,end:0}}else i=null;for(Na={focusedElem:e,selectionRange:i},Ei=!1,Le=t;Le!==null;)if(t=Le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Le=e;else for(;Le!==null;){t=Le;try{var Fe=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Fe!==null){var Ue=Fe.memoizedProps,Nt=Fe.memoizedState,le=t.stateNode,se=le.getSnapshotBeforeUpdate(t.elementType===t.type?Ue:wr(t.type,Ue),Nt);le.__reactInternalSnapshotBeforeUpdate=se}break;case 3:var de=t.stateNode.containerInfo;de.nodeType===1?de.textContent="":de.nodeType===9&&de.documentElement&&de.removeChild(de.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(_e){kt(t,t.return,_e)}if(e=t.sibling,e!==null){e.return=t.return,Le=e;break}Le=t.return}return Fe=Nd,Nd=!1,Fe}function ei(e,t,i){var u=t.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var m=u=u.next;do{if((m.tag&e)===e){var y=m.destroy;m.destroy=void 0,y!==void 0&&fl(t,i,y)}m=m.next}while(m!==u)}}function lo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var u=i.create;i.destroy=u()}i=i.next}while(i!==t)}}function hl(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function jd(e){var t=e.alternate;t!==null&&(e.alternate=null,jd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Nr],delete t[Ws],delete t[Aa],delete t[bm],delete t[km])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ed(e){return e.tag===5||e.tag===3||e.tag===4}function _d(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ed(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pl(e,t,i){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=Mi));else if(u!==4&&(e=e.child,e!==null))for(pl(e,t,i),e=e.sibling;e!==null;)pl(e,t,i),e=e.sibling}function ml(e,t,i){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(ml(e,t,i),e=e.sibling;e!==null;)ml(e,t,i),e=e.sibling}var Mt=null,br=!1;function on(e,t,i){for(i=i.child;i!==null;)Ad(e,t,i),i=i.sibling}function Ad(e,t,i){if(at&&typeof at.onCommitFiberUnmount=="function")try{at.onCommitFiberUnmount(et,i)}catch{}switch(i.tag){case 5:Vt||ds(i,t);case 6:var u=Mt,m=br;Mt=null,on(e,t,i),Mt=u,br=m,Mt!==null&&(br?(e=Mt,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Mt.removeChild(i.stateNode));break;case 18:Mt!==null&&(br?(e=Mt,i=i.stateNode,e.nodeType===8?_a(e.parentNode,i):e.nodeType===1&&_a(e,i),Ps(e)):_a(Mt,i.stateNode));break;case 4:u=Mt,m=br,Mt=i.stateNode.containerInfo,br=!0,on(e,t,i),Mt=u,br=m;break;case 0:case 11:case 14:case 15:if(!Vt&&(u=i.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){m=u=u.next;do{var y=m,O=y.destroy;y=y.tag,O!==void 0&&((y&2)!==0||(y&4)!==0)&&fl(i,t,O),m=m.next}while(m!==u)}on(e,t,i);break;case 1:if(!Vt&&(ds(i,t),u=i.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=i.memoizedProps,u.state=i.memoizedState,u.componentWillUnmount()}catch(G){kt(i,t,G)}on(e,t,i);break;case 21:on(e,t,i);break;case 22:i.mode&1?(Vt=(u=Vt)||i.memoizedState!==null,on(e,t,i),Vt=u):on(e,t,i);break;default:on(e,t,i)}}function Rd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Bm),t.forEach(function(u){var m=Km.bind(null,e,u);i.has(u)||(i.add(u),u.then(m,m))})}}function kr(e,t){var i=t.deletions;if(i!==null)for(var u=0;u<i.length;u++){var m=i[u];try{var y=e,O=t,G=O;e:for(;G!==null;){switch(G.tag){case 5:Mt=G.stateNode,br=!1;break e;case 3:Mt=G.stateNode.containerInfo,br=!0;break e;case 4:Mt=G.stateNode.containerInfo,br=!0;break e}G=G.return}if(Mt===null)throw Error(n(160));Ad(y,O,m),Mt=null,br=!1;var Y=m.alternate;Y!==null&&(Y.return=null),m.return=null}catch(ge){kt(m,t,ge)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Td(t,e),t=t.sibling}function Td(e,t){var i=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(kr(t,e),_r(e),u&4){try{ei(3,e,e.return),lo(3,e)}catch(Ue){kt(e,e.return,Ue)}try{ei(5,e,e.return)}catch(Ue){kt(e,e.return,Ue)}}break;case 1:kr(t,e),_r(e),u&512&&i!==null&&ds(i,i.return);break;case 5:if(kr(t,e),_r(e),u&512&&i!==null&&ds(i,i.return),e.flags&32){var m=e.stateNode;try{ke(m,"")}catch(Ue){kt(e,e.return,Ue)}}if(u&4&&(m=e.stateNode,m!=null)){var y=e.memoizedProps,O=i!==null?i.memoizedProps:y,G=e.type,Y=e.updateQueue;if(e.updateQueue=null,Y!==null)try{G==="input"&&y.type==="radio"&&y.name!=null&&ce(m,y),ot(G,O);var ge=ot(G,y);for(O=0;O<Y.length;O+=2){var Ce=Y[O],je=Y[O+1];Ce==="style"?We(m,je):Ce==="dangerouslySetInnerHTML"?ve(m,je):Ce==="children"?ke(m,je):I(m,Ce,je,ge)}switch(G){case"input":V(m,y);break;case"textarea":E(m,y);break;case"select":var Se=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!y.multiple;var Pe=y.value;Pe!=null?ae(m,!!y.multiple,Pe,!1):Se!==!!y.multiple&&(y.defaultValue!=null?ae(m,!!y.multiple,y.defaultValue,!0):ae(m,!!y.multiple,y.multiple?[]:"",!1))}m[Ws]=y}catch(Ue){kt(e,e.return,Ue)}}break;case 6:if(kr(t,e),_r(e),u&4){if(e.stateNode===null)throw Error(n(162));m=e.stateNode,y=e.memoizedProps;try{m.nodeValue=y}catch(Ue){kt(e,e.return,Ue)}}break;case 3:if(kr(t,e),_r(e),u&4&&i!==null&&i.memoizedState.isDehydrated)try{Ps(t.containerInfo)}catch(Ue){kt(e,e.return,Ue)}break;case 4:kr(t,e),_r(e);break;case 13:kr(t,e),_r(e),m=e.child,m.flags&8192&&(y=m.memoizedState!==null,m.stateNode.isHidden=y,!y||m.alternate!==null&&m.alternate.memoizedState!==null||(vl=vt())),u&4&&Rd(e);break;case 22:if(Ce=i!==null&&i.memoizedState!==null,e.mode&1?(Vt=(ge=Vt)||Ce,kr(t,e),Vt=ge):kr(t,e),_r(e),u&8192){if(ge=e.memoizedState!==null,(e.stateNode.isHidden=ge)&&!Ce&&(e.mode&1)!==0)for(Le=e,Ce=e.child;Ce!==null;){for(je=Le=Ce;Le!==null;){switch(Se=Le,Pe=Se.child,Se.tag){case 0:case 11:case 14:case 15:ei(4,Se,Se.return);break;case 1:ds(Se,Se.return);var Fe=Se.stateNode;if(typeof Fe.componentWillUnmount=="function"){u=Se,i=Se.return;try{t=u,Fe.props=t.memoizedProps,Fe.state=t.memoizedState,Fe.componentWillUnmount()}catch(Ue){kt(u,i,Ue)}}break;case 5:ds(Se,Se.return);break;case 22:if(Se.memoizedState!==null){Id(je);continue}}Pe!==null?(Pe.return=Se,Le=Pe):Id(je)}Ce=Ce.sibling}e:for(Ce=null,je=e;;){if(je.tag===5){if(Ce===null){Ce=je;try{m=je.stateNode,ge?(y=m.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(G=je.stateNode,Y=je.memoizedProps.style,O=Y!=null&&Y.hasOwnProperty("display")?Y.display:null,G.style.display=Re("display",O))}catch(Ue){kt(e,e.return,Ue)}}}else if(je.tag===6){if(Ce===null)try{je.stateNode.nodeValue=ge?"":je.memoizedProps}catch(Ue){kt(e,e.return,Ue)}}else if((je.tag!==22&&je.tag!==23||je.memoizedState===null||je===e)&&je.child!==null){je.child.return=je,je=je.child;continue}if(je===e)break e;for(;je.sibling===null;){if(je.return===null||je.return===e)break e;Ce===je&&(Ce=null),je=je.return}Ce===je&&(Ce=null),je.sibling.return=je.return,je=je.sibling}}break;case 19:kr(t,e),_r(e),u&4&&Rd(e);break;case 21:break;default:kr(t,e),_r(e)}}function _r(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(Ed(i)){var u=i;break e}i=i.return}throw Error(n(160))}switch(u.tag){case 5:var m=u.stateNode;u.flags&32&&(ke(m,""),u.flags&=-33);var y=_d(e);ml(e,y,m);break;case 3:case 4:var O=u.stateNode.containerInfo,G=_d(e);pl(e,G,O);break;default:throw Error(n(161))}}catch(Y){kt(e,e.return,Y)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Um(e,t,i){Le=e,Pd(e)}function Pd(e,t,i){for(var u=(e.mode&1)!==0;Le!==null;){var m=Le,y=m.child;if(m.tag===22&&u){var O=m.memoizedState!==null||ao;if(!O){var G=m.alternate,Y=G!==null&&G.memoizedState!==null||Vt;G=ao;var ge=Vt;if(ao=O,(Vt=Y)&&!ge)for(Le=m;Le!==null;)O=Le,Y=O.child,O.tag===22&&O.memoizedState!==null?Ld(m):Y!==null?(Y.return=O,Le=Y):Ld(m);for(;y!==null;)Le=y,Pd(y),y=y.sibling;Le=m,ao=G,Vt=ge}Od(e)}else(m.subtreeFlags&8772)!==0&&y!==null?(y.return=m,Le=y):Od(e)}}function Od(e){for(;Le!==null;){var t=Le;if((t.flags&8772)!==0){var i=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Vt||lo(5,t);break;case 1:var u=t.stateNode;if(t.flags&4&&!Vt)if(i===null)u.componentDidMount();else{var m=t.elementType===t.type?i.memoizedProps:wr(t.type,i.memoizedProps);u.componentDidUpdate(m,i.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var y=t.updateQueue;y!==null&&Iu(t,y,u);break;case 3:var O=t.updateQueue;if(O!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}Iu(t,O,i)}break;case 5:var G=t.stateNode;if(i===null&&t.flags&4){i=G;var Y=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":Y.autoFocus&&i.focus();break;case"img":Y.src&&(i.src=Y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var ge=t.alternate;if(ge!==null){var Ce=ge.memoizedState;if(Ce!==null){var je=Ce.dehydrated;je!==null&&Ps(je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Vt||t.flags&512&&hl(t)}catch(Se){kt(t,t.return,Se)}}if(t===e){Le=null;break}if(i=t.sibling,i!==null){i.return=t.return,Le=i;break}Le=t.return}}function Id(e){for(;Le!==null;){var t=Le;if(t===e){Le=null;break}var i=t.sibling;if(i!==null){i.return=t.return,Le=i;break}Le=t.return}}function Ld(e){for(;Le!==null;){var t=Le;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{lo(4,t)}catch(Y){kt(t,i,Y)}break;case 1:var u=t.stateNode;if(typeof u.componentDidMount=="function"){var m=t.return;try{u.componentDidMount()}catch(Y){kt(t,m,Y)}}var y=t.return;try{hl(t)}catch(Y){kt(t,y,Y)}break;case 5:var O=t.return;try{hl(t)}catch(Y){kt(t,O,Y)}}}catch(Y){kt(t,t.return,Y)}if(t===e){Le=null;break}var G=t.sibling;if(G!==null){G.return=t.return,Le=G;break}Le=t.return}}var zm=Math.ceil,co=_.ReactCurrentDispatcher,gl=_.ReactCurrentOwner,pr=_.ReactCurrentBatchConfig,rt=0,Lt=null,jt=null,Ut=0,lr=0,fs=en(0),_t=0,ti=null,An=0,uo=0,yl=0,ri=null,tr=null,vl=0,hs=1/0,Mr=null,fo=!1,xl=null,an=null,ho=!1,ln=null,po=0,ni=0,wl=null,mo=-1,go=0;function Kt(){return(rt&6)!==0?vt():mo!==-1?mo:mo=vt()}function cn(e){return(e.mode&1)===0?1:(rt&2)!==0&&Ut!==0?Ut&-Ut:Cm.transition!==null?(go===0&&(go=_c()),go):(e=it,e!==0||(e=window.event,e=e===void 0?16:Fc(e.type)),e)}function Sr(e,t,i,u){if(50<ni)throw ni=0,wl=null,Error(n(185));Es(e,i,u),((rt&2)===0||e!==Lt)&&(e===Lt&&((rt&2)===0&&(uo|=i),_t===4&&un(e,Ut)),rr(e,u),i===1&&rt===0&&(t.mode&1)===0&&(hs=vt()+500,Wi&&rn()))}function rr(e,t){var i=e.callbackNode;Cp(e,t);var u=qr(e,e===Lt?Ut:0);if(u===0)i!==null&&Ci(i),e.callbackNode=null,e.callbackPriority=0;else if(t=u&-u,e.callbackPriority!==t){if(i!=null&&Ci(i),t===1)e.tag===0?Sm(Fd.bind(null,e)):ku(Fd.bind(null,e)),xm(function(){(rt&6)===0&&rn()}),i=null;else{switch(Ac(u)){case 1:i=we;break;case 4:i=Ie;break;case 16:i=Be;break;case 536870912:i=Me;break;default:i=Be}i=Hd(i,Dd.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function Dd(e,t){if(mo=-1,go=0,(rt&6)!==0)throw Error(n(327));var i=e.callbackNode;if(ps()&&e.callbackNode!==i)return null;var u=qr(e,e===Lt?Ut:0);if(u===0)return null;if((u&30)!==0||(u&e.expiredLanes)!==0||t)t=yo(e,u);else{t=u;var m=rt;rt|=2;var y=Md();(Lt!==e||Ut!==t)&&(Mr=null,hs=vt()+500,Tn(e,t));do try{Vm();break}catch(G){Bd(e,G)}while(!0);Ba(),co.current=y,rt=m,jt!==null?t=0:(Lt=null,Ut=0,t=_t)}if(t!==0){if(t===2&&(m=ea(e),m!==0&&(u=m,t=bl(e,m))),t===1)throw i=ti,Tn(e,0),un(e,u),rr(e,vt()),i;if(t===6)un(e,u);else{if(m=e.current.alternate,(u&30)===0&&!$m(m)&&(t=yo(e,u),t===2&&(y=ea(e),y!==0&&(u=y,t=bl(e,y))),t===1))throw i=ti,Tn(e,0),un(e,u),rr(e,vt()),i;switch(e.finishedWork=m,e.finishedLanes=u,t){case 0:case 1:throw Error(n(345));case 2:Pn(e,tr,Mr);break;case 3:if(un(e,u),(u&130023424)===u&&(t=vl+500-vt(),10<t)){if(qr(e,0)!==0)break;if(m=e.suspendedLanes,(m&u)!==u){Kt(),e.pingedLanes|=e.suspendedLanes&m;break}e.timeoutHandle=Ea(Pn.bind(null,e,tr,Mr),t);break}Pn(e,tr,Mr);break;case 4:if(un(e,u),(u&4194240)===u)break;for(t=e.eventTimes,m=-1;0<u;){var O=31-lt(u);y=1<<O,O=t[O],O>m&&(m=O),u&=~y}if(u=m,u=vt()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*zm(u/1960))-u,10<u){e.timeoutHandle=Ea(Pn.bind(null,e,tr,Mr),u);break}Pn(e,tr,Mr);break;case 5:Pn(e,tr,Mr);break;default:throw Error(n(329))}}}return rr(e,vt()),e.callbackNode===i?Dd.bind(null,e):null}function bl(e,t){var i=ri;return e.current.memoizedState.isDehydrated&&(Tn(e,t).flags|=256),e=yo(e,t),e!==2&&(t=tr,tr=i,t!==null&&kl(t)),e}function kl(e){tr===null?tr=e:tr.push.apply(tr,e)}function $m(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var u=0;u<i.length;u++){var m=i[u],y=m.getSnapshot;m=m.value;try{if(!vr(y(),m))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function un(e,t){for(t&=~yl,t&=~uo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-lt(t),u=1<<i;e[i]=-1,t&=~u}}function Fd(e){if((rt&6)!==0)throw Error(n(327));ps();var t=qr(e,0);if((t&1)===0)return rr(e,vt()),null;var i=yo(e,t);if(e.tag!==0&&i===2){var u=ea(e);u!==0&&(t=u,i=bl(e,u))}if(i===1)throw i=ti,Tn(e,0),un(e,t),rr(e,vt()),i;if(i===6)throw Error(n(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Pn(e,tr,Mr),rr(e,vt()),null}function Sl(e,t){var i=rt;rt|=1;try{return e(t)}finally{rt=i,rt===0&&(hs=vt()+500,Wi&&rn())}}function Rn(e){ln!==null&&ln.tag===0&&(rt&6)===0&&ps();var t=rt;rt|=1;var i=pr.transition,u=it;try{if(pr.transition=null,it=1,e)return e()}finally{it=u,pr.transition=i,rt=t,(rt&6)===0&&rn()}}function Cl(){lr=fs.current,pt(fs)}function Tn(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,vm(i)),jt!==null)for(i=jt.return;i!==null;){var u=i;switch(Oa(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&zi();break;case 3:cs(),pt(Yt),pt(zt),qa();break;case 5:Va(u);break;case 4:cs();break;case 13:pt(xt);break;case 19:pt(xt);break;case 10:Ma(u.type._context);break;case 22:case 23:Cl()}i=i.return}if(Lt=e,jt=e=dn(e.current,null),Ut=lr=t,_t=0,ti=null,yl=uo=An=0,tr=ri=null,jn!==null){for(t=0;t<jn.length;t++)if(i=jn[t],u=i.interleaved,u!==null){i.interleaved=null;var m=u.next,y=i.pending;if(y!==null){var O=y.next;y.next=m,u.next=O}i.pending=u}jn=null}return e}function Bd(e,t){do{var i=jt;try{if(Ba(),Ji.current=no,eo){for(var u=wt.memoizedState;u!==null;){var m=u.queue;m!==null&&(m.pending=null),u=u.next}eo=!1}if(_n=0,It=Et=wt=null,Qs=!1,Xs=0,gl.current=null,i===null||i.return===null){_t=1,ti=t,jt=null;break}e:{var y=e,O=i.return,G=i,Y=t;if(t=Ut,G.flags|=32768,Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ge=Y,Ce=G,je=Ce.tag;if((Ce.mode&1)===0&&(je===0||je===11||je===15)){var Se=Ce.alternate;Se?(Ce.updateQueue=Se.updateQueue,Ce.memoizedState=Se.memoizedState,Ce.lanes=Se.lanes):(Ce.updateQueue=null,Ce.memoizedState=null)}var Pe=cd(O);if(Pe!==null){Pe.flags&=-257,ud(Pe,O,G,y,t),Pe.mode&1&&ld(y,ge,t),t=Pe,Y=ge;var Fe=t.updateQueue;if(Fe===null){var Ue=new Set;Ue.add(Y),t.updateQueue=Ue}else Fe.add(Y);break e}else{if((t&1)===0){ld(y,ge,t),Nl();break e}Y=Error(n(426))}}else if(gt&&G.mode&1){var Nt=cd(O);if(Nt!==null){(Nt.flags&65536)===0&&(Nt.flags|=256),ud(Nt,O,G,y,t),Da(us(Y,G));break e}}y=Y=us(Y,G),_t!==4&&(_t=2),ri===null?ri=[y]:ri.push(y),y=O;do{switch(y.tag){case 3:y.flags|=65536,t&=-t,y.lanes|=t;var le=od(y,Y,t);Ou(y,le);break e;case 1:G=Y;var se=y.type,de=y.stateNode;if((y.flags&128)===0&&(typeof se.getDerivedStateFromError=="function"||de!==null&&typeof de.componentDidCatch=="function"&&(an===null||!an.has(de)))){y.flags|=65536,t&=-t,y.lanes|=t;var _e=ad(y,G,t);Ou(y,_e);break e}}y=y.return}while(y!==null)}zd(i)}catch(ze){t=ze,jt===i&&i!==null&&(jt=i=i.return);continue}break}while(!0)}function Md(){var e=co.current;return co.current=no,e===null?no:e}function Nl(){(_t===0||_t===3||_t===2)&&(_t=4),Lt===null||(An&268435455)===0&&(uo&268435455)===0||un(Lt,Ut)}function yo(e,t){var i=rt;rt|=2;var u=Md();(Lt!==e||Ut!==t)&&(Mr=null,Tn(e,t));do try{Wm();break}catch(m){Bd(e,m)}while(!0);if(Ba(),rt=i,co.current=u,jt!==null)throw Error(n(261));return Lt=null,Ut=0,_t}function Wm(){for(;jt!==null;)Ud(jt)}function Vm(){for(;jt!==null&&!Zo();)Ud(jt)}function Ud(e){var t=Vd(e.alternate,e,lr);e.memoizedProps=e.pendingProps,t===null?zd(e):jt=t,gl.current=null}function zd(e){var t=e;do{var i=t.alternate;if(e=t.return,(t.flags&32768)===0){if(i=Dm(i,t,lr),i!==null){jt=i;return}}else{if(i=Fm(i,t),i!==null){i.flags&=32767,jt=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_t=6,jt=null;return}}if(t=t.sibling,t!==null){jt=t;return}jt=t=e}while(t!==null);_t===0&&(_t=5)}function Pn(e,t,i){var u=it,m=pr.transition;try{pr.transition=null,it=1,Hm(e,t,i,u)}finally{pr.transition=m,it=u}return null}function Hm(e,t,i,u){do ps();while(ln!==null);if((rt&6)!==0)throw Error(n(327));i=e.finishedWork;var m=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(n(177));e.callbackNode=null,e.callbackPriority=0;var y=i.lanes|i.childLanes;if(Np(e,y),e===Lt&&(jt=Lt=null,Ut=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||ho||(ho=!0,Hd(Be,function(){return ps(),null})),y=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||y){y=pr.transition,pr.transition=null;var O=it;it=1;var G=rt;rt|=4,gl.current=null,Mm(e,i),Td(i,e),dm(Na),Ei=!!Ca,Na=Ca=null,e.current=i,Um(i),Yo(),rt=G,it=O,pr.transition=y}else e.current=i;if(ho&&(ho=!1,ln=e,po=m),y=e.pendingLanes,y===0&&(an=null),Hr(i.stateNode),rr(e,vt()),t!==null)for(u=e.onRecoverableError,i=0;i<t.length;i++)m=t[i],u(m.value,{componentStack:m.stack,digest:m.digest});if(fo)throw fo=!1,e=xl,xl=null,e;return(po&1)!==0&&e.tag!==0&&ps(),y=e.pendingLanes,(y&1)!==0?e===wl?ni++:(ni=0,wl=e):ni=0,rn(),null}function ps(){if(ln!==null){var e=Ac(po),t=pr.transition,i=it;try{if(pr.transition=null,it=16>e?16:e,ln===null)var u=!1;else{if(e=ln,ln=null,po=0,(rt&6)!==0)throw Error(n(331));var m=rt;for(rt|=4,Le=e.current;Le!==null;){var y=Le,O=y.child;if((Le.flags&16)!==0){var G=y.deletions;if(G!==null){for(var Y=0;Y<G.length;Y++){var ge=G[Y];for(Le=ge;Le!==null;){var Ce=Le;switch(Ce.tag){case 0:case 11:case 15:ei(8,Ce,y)}var je=Ce.child;if(je!==null)je.return=Ce,Le=je;else for(;Le!==null;){Ce=Le;var Se=Ce.sibling,Pe=Ce.return;if(jd(Ce),Ce===ge){Le=null;break}if(Se!==null){Se.return=Pe,Le=Se;break}Le=Pe}}}var Fe=y.alternate;if(Fe!==null){var Ue=Fe.child;if(Ue!==null){Fe.child=null;do{var Nt=Ue.sibling;Ue.sibling=null,Ue=Nt}while(Ue!==null)}}Le=y}}if((y.subtreeFlags&2064)!==0&&O!==null)O.return=y,Le=O;else e:for(;Le!==null;){if(y=Le,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:ei(9,y,y.return)}var le=y.sibling;if(le!==null){le.return=y.return,Le=le;break e}Le=y.return}}var se=e.current;for(Le=se;Le!==null;){O=Le;var de=O.child;if((O.subtreeFlags&2064)!==0&&de!==null)de.return=O,Le=de;else e:for(O=se;Le!==null;){if(G=Le,(G.flags&2048)!==0)try{switch(G.tag){case 0:case 11:case 15:lo(9,G)}}catch(ze){kt(G,G.return,ze)}if(G===O){Le=null;break e}var _e=G.sibling;if(_e!==null){_e.return=G.return,Le=_e;break e}Le=G.return}}if(rt=m,rn(),at&&typeof at.onPostCommitFiberRoot=="function")try{at.onPostCommitFiberRoot(et,e)}catch{}u=!0}return u}finally{it=i,pr.transition=t}}return!1}function $d(e,t,i){t=us(i,t),t=od(e,t,1),e=sn(e,t,1),t=Kt(),e!==null&&(Es(e,1,t),rr(e,t))}function kt(e,t,i){if(e.tag===3)$d(e,e,i);else for(;t!==null;){if(t.tag===3){$d(t,e,i);break}else if(t.tag===1){var u=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(an===null||!an.has(u))){e=us(i,e),e=ad(t,e,1),t=sn(t,e,1),e=Kt(),t!==null&&(Es(t,1,e),rr(t,e));break}}t=t.return}}function qm(e,t,i){var u=e.pingCache;u!==null&&u.delete(t),t=Kt(),e.pingedLanes|=e.suspendedLanes&i,Lt===e&&(Ut&i)===i&&(_t===4||_t===3&&(Ut&130023424)===Ut&&500>vt()-vl?Tn(e,0):yl|=i),rr(e,t)}function Wd(e,t){t===0&&((e.mode&1)===0?t=1:(t=Ot,Ot<<=1,(Ot&130023424)===0&&(Ot=4194304)));var i=Kt();e=Dr(e,t),e!==null&&(Es(e,t,i),rr(e,i))}function Gm(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),Wd(e,i)}function Km(e,t){var i=0;switch(e.tag){case 13:var u=e.stateNode,m=e.memoizedState;m!==null&&(i=m.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(n(314))}u!==null&&u.delete(t),Wd(e,i)}var Vd;Vd=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yt.current)er=!0;else{if((e.lanes&i)===0&&(t.flags&128)===0)return er=!1,Lm(e,t,i);er=(e.flags&131072)!==0}else er=!1,gt&&(t.flags&1048576)!==0&&Su(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var u=t.type;oo(e,t),e=t.pendingProps;var m=rs(t,zt.current);ls(t,i),m=Qa(null,t,u,e,m,i);var y=Xa();return t.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Jt(u)?(y=!0,$i(t)):y=!1,t.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,$a(t),m.updater=so,t.stateNode=m,m._reactInternals=t,rl(t,u,e,i),t=ol(null,t,u,!0,y,i)):(t.tag=0,gt&&y&&Pa(t),Gt(null,t,m,i),t=t.child),t;case 16:u=t.elementType;e:{switch(oo(e,t),e=t.pendingProps,m=u._init,u=m(u._payload),t.type=u,m=t.tag=Xm(u),e=wr(u,e),m){case 0:t=il(null,t,u,e,i);break e;case 1:t=gd(null,t,u,e,i);break e;case 11:t=dd(null,t,u,e,i);break e;case 14:t=fd(null,t,u,wr(u.type,e),i);break e}throw Error(n(306,u,""))}return t;case 0:return u=t.type,m=t.pendingProps,m=t.elementType===u?m:wr(u,m),il(e,t,u,m,i);case 1:return u=t.type,m=t.pendingProps,m=t.elementType===u?m:wr(u,m),gd(e,t,u,m,i);case 3:e:{if(yd(t),e===null)throw Error(n(387));u=t.pendingProps,y=t.memoizedState,m=y.element,Pu(e,t),Zi(t,u,null,i);var O=t.memoizedState;if(u=O.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:O.cache,pendingSuspenseBoundaries:O.pendingSuspenseBoundaries,transitions:O.transitions},t.updateQueue.baseState=y,t.memoizedState=y,t.flags&256){m=us(Error(n(423)),t),t=vd(e,t,u,i,m);break e}else if(u!==m){m=us(Error(n(424)),t),t=vd(e,t,u,i,m);break e}else for(ar=Jr(t.stateNode.containerInfo.firstChild),or=t,gt=!0,xr=null,i=Ru(t,null,u,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(is(),u===m){t=Br(e,t,i);break e}Gt(e,t,u,i)}t=t.child}return t;case 5:return Lu(t),e===null&&La(t),u=t.type,m=t.pendingProps,y=e!==null?e.memoizedProps:null,O=m.children,ja(u,m)?O=null:y!==null&&ja(u,y)&&(t.flags|=32),md(e,t),Gt(e,t,O,i),t.child;case 6:return e===null&&La(t),null;case 13:return xd(e,t,i);case 4:return Wa(t,t.stateNode.containerInfo),u=t.pendingProps,e===null?t.child=os(t,null,u,i):Gt(e,t,u,i),t.child;case 11:return u=t.type,m=t.pendingProps,m=t.elementType===u?m:wr(u,m),dd(e,t,u,m,i);case 7:return Gt(e,t,t.pendingProps,i),t.child;case 8:return Gt(e,t,t.pendingProps.children,i),t.child;case 12:return Gt(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(u=t.type._context,m=t.pendingProps,y=t.memoizedProps,O=m.value,ut(Ki,u._currentValue),u._currentValue=O,y!==null)if(vr(y.value,O)){if(y.children===m.children&&!Yt.current){t=Br(e,t,i);break e}}else for(y=t.child,y!==null&&(y.return=t);y!==null;){var G=y.dependencies;if(G!==null){O=y.child;for(var Y=G.firstContext;Y!==null;){if(Y.context===u){if(y.tag===1){Y=Fr(-1,i&-i),Y.tag=2;var ge=y.updateQueue;if(ge!==null){ge=ge.shared;var Ce=ge.pending;Ce===null?Y.next=Y:(Y.next=Ce.next,Ce.next=Y),ge.pending=Y}}y.lanes|=i,Y=y.alternate,Y!==null&&(Y.lanes|=i),Ua(y.return,i,t),G.lanes|=i;break}Y=Y.next}}else if(y.tag===10)O=y.type===t.type?null:y.child;else if(y.tag===18){if(O=y.return,O===null)throw Error(n(341));O.lanes|=i,G=O.alternate,G!==null&&(G.lanes|=i),Ua(O,i,t),O=y.sibling}else O=y.child;if(O!==null)O.return=y;else for(O=y;O!==null;){if(O===t){O=null;break}if(y=O.sibling,y!==null){y.return=O.return,O=y;break}O=O.return}y=O}Gt(e,t,m.children,i),t=t.child}return t;case 9:return m=t.type,u=t.pendingProps.children,ls(t,i),m=fr(m),u=u(m),t.flags|=1,Gt(e,t,u,i),t.child;case 14:return u=t.type,m=wr(u,t.pendingProps),m=wr(u.type,m),fd(e,t,u,m,i);case 15:return hd(e,t,t.type,t.pendingProps,i);case 17:return u=t.type,m=t.pendingProps,m=t.elementType===u?m:wr(u,m),oo(e,t),t.tag=1,Jt(u)?(e=!0,$i(t)):e=!1,ls(t,i),sd(t,u,m),rl(t,u,m,i),ol(null,t,u,!0,e,i);case 19:return bd(e,t,i);case 22:return pd(e,t,i)}throw Error(n(156,t.tag))};function Hd(e,t){return Si(e,t)}function Qm(e,t,i,u){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(e,t,i,u){return new Qm(e,t,i,u)}function jl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Xm(e){if(typeof e=="function")return jl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===z)return 11;if(e===X)return 14}return 2}function dn(e,t){var i=e.alternate;return i===null?(i=mr(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function vo(e,t,i,u,m,y){var O=2;if(u=e,typeof e=="function")jl(e)&&(O=1);else if(typeof e=="string")O=5;else e:switch(e){case $:return On(i.children,m,y,t);case L:O=8,m|=8;break;case B:return e=mr(12,i,t,m|2),e.elementType=B,e.lanes=y,e;case H:return e=mr(13,i,t,m),e.elementType=H,e.lanes=y,e;case N:return e=mr(19,i,t,m),e.elementType=N,e.lanes=y,e;case ee:return xo(i,m,y,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Q:O=10;break e;case oe:O=9;break e;case z:O=11;break e;case X:O=14;break e;case me:O=16,u=null;break e}throw Error(n(130,e==null?e:typeof e,""))}return t=mr(O,i,t,m),t.elementType=e,t.type=u,t.lanes=y,t}function On(e,t,i,u){return e=mr(7,e,u,t),e.lanes=i,e}function xo(e,t,i,u){return e=mr(22,e,u,t),e.elementType=ee,e.lanes=i,e.stateNode={isHidden:!1},e}function El(e,t,i){return e=mr(6,e,null,t),e.lanes=i,e}function _l(e,t,i){return t=mr(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Zm(e,t,i,u,m){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ta(0),this.expirationTimes=ta(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ta(0),this.identifierPrefix=u,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function Al(e,t,i,u,m,y,O,G,Y){return e=new Zm(e,t,i,G,Y),t===1?(t=1,y===!0&&(t|=8)):t=0,y=mr(3,null,null,t),e.current=y,y.stateNode=e,y.memoizedState={element:u,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},$a(y),e}function Ym(e,t,i){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:u==null?null:""+u,children:e,containerInfo:t,implementation:i}}function qd(e){if(!e)return tn;e=e._reactInternals;e:{if(Tr(e)!==e||e.tag!==1)throw Error(n(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Jt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(n(171))}if(e.tag===1){var i=e.type;if(Jt(i))return wu(e,i,t)}return t}function Gd(e,t,i,u,m,y,O,G,Y){return e=Al(i,u,!0,e,m,y,O,G,Y),e.context=qd(null),i=e.current,u=Kt(),m=cn(i),y=Fr(u,m),y.callback=t??null,sn(i,y,m),e.current.lanes=m,Es(e,m,u),rr(e,u),e}function wo(e,t,i,u){var m=t.current,y=Kt(),O=cn(m);return i=qd(i),t.context===null?t.context=i:t.pendingContext=i,t=Fr(y,O),t.payload={element:e},u=u===void 0?null:u,u!==null&&(t.callback=u),e=sn(m,t,O),e!==null&&(Sr(e,m,O,y),Xi(e,m,O)),O}function bo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Kd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Rl(e,t){Kd(e,t),(e=e.alternate)&&Kd(e,t)}function Jm(){return null}var Qd=typeof reportError=="function"?reportError:function(e){console.error(e)};function Tl(e){this._internalRoot=e}ko.prototype.render=Tl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(n(409));wo(e,t,null,null)},ko.prototype.unmount=Tl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Rn(function(){wo(null,e,null,null)}),t[Pr]=null}};function ko(e){this._internalRoot=e}ko.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pc();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Xr.length&&t!==0&&t<Xr[i].priority;i++);Xr.splice(i,0,e),i===0&&Lc(e)}};function Pl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function So(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Xd(){}function eg(e,t,i,u,m){if(m){if(typeof u=="function"){var y=u;u=function(){var ge=bo(O);y.call(ge)}}var O=Gd(t,u,e,0,null,!1,!1,"",Xd);return e._reactRootContainer=O,e[Pr]=O.current,zs(e.nodeType===8?e.parentNode:e),Rn(),O}for(;m=e.lastChild;)e.removeChild(m);if(typeof u=="function"){var G=u;u=function(){var ge=bo(Y);G.call(ge)}}var Y=Al(e,0,!1,null,null,!1,!1,"",Xd);return e._reactRootContainer=Y,e[Pr]=Y.current,zs(e.nodeType===8?e.parentNode:e),Rn(function(){wo(t,Y,i,u)}),Y}function Co(e,t,i,u,m){var y=i._reactRootContainer;if(y){var O=y;if(typeof m=="function"){var G=m;m=function(){var Y=bo(O);G.call(Y)}}wo(t,O,e,m)}else O=eg(i,t,e,m,u);return bo(O)}Rc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=Bt(t.pendingLanes);i!==0&&(ra(t,i|1),rr(t,vt()),(rt&6)===0&&(hs=vt()+500,rn()))}break;case 13:Rn(function(){var u=Dr(e,1);if(u!==null){var m=Kt();Sr(u,e,1,m)}}),Rl(e,1)}},na=function(e){if(e.tag===13){var t=Dr(e,134217728);if(t!==null){var i=Kt();Sr(t,e,134217728,i)}Rl(e,134217728)}},Tc=function(e){if(e.tag===13){var t=cn(e),i=Dr(e,t);if(i!==null){var u=Kt();Sr(i,e,t,u)}Rl(e,t)}},Pc=function(){return it},Oc=function(e,t){var i=it;try{return it=e,t()}finally{it=i}},ct=function(e,t,i){switch(t){case"input":if(V(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var u=i[t];if(u!==e&&u.form===e.form){var m=Ui(u);if(!m)throw Error(n(90));Ye(u),V(u,m)}}}break;case"textarea":E(e,i);break;case"select":t=i.value,t!=null&&ae(e,!!i.multiple,t,!1)}},$r=Sl,Ft=Rn;var tg={usingClientEntryPoint:!1,Events:[Vs,es,Ui,vn,Vn,Sl]},si={findFiberByHostInstance:kn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rg={bundleType:si.bundleType,version:si.version,rendererPackageName:si.rendererPackageName,rendererConfig:si.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=js(e),e===null?null:e.stateNode},findFiberByHostInstance:si.findFiberByHostInstance||Jm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var No=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!No.isDisabled&&No.supportsFiber)try{et=No.inject(rg),at=No}catch{}}return nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tg,nr.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pl(t))throw Error(n(200));return Ym(e,t,null,i)},nr.createRoot=function(e,t){if(!Pl(e))throw Error(n(299));var i=!1,u="",m=Qd;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onRecoverableError!==void 0&&(m=t.onRecoverableError)),t=Al(e,1,!1,null,null,i,!1,u,m),e[Pr]=t.current,zs(e.nodeType===8?e.parentNode:e),new Tl(t)},nr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(n(188)):(e=Object.keys(e).join(","),Error(n(268,e)));return e=js(t),e=e===null?null:e.stateNode,e},nr.flushSync=function(e){return Rn(e)},nr.hydrate=function(e,t,i){if(!So(t))throw Error(n(200));return Co(null,e,t,!0,i)},nr.hydrateRoot=function(e,t,i){if(!Pl(e))throw Error(n(405));var u=i!=null&&i.hydratedSources||null,m=!1,y="",O=Qd;if(i!=null&&(i.unstable_strictMode===!0&&(m=!0),i.identifierPrefix!==void 0&&(y=i.identifierPrefix),i.onRecoverableError!==void 0&&(O=i.onRecoverableError)),t=Gd(t,null,e,1,i??null,m,!1,y,O),e[Pr]=t.current,zs(e),u)for(e=0;e<u.length;e++)i=u[e],m=i._getVersion,m=m(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,m]:t.mutableSourceEagerHydrationData.push(i,m);return new ko(t)},nr.render=function(e,t,i){if(!So(t))throw Error(n(200));return Co(null,e,t,!1,i)},nr.unmountComponentAtNode=function(e){if(!So(e))throw Error(n(40));return e._reactRootContainer?(Rn(function(){Co(null,null,e,!1,function(){e._reactRootContainer=null,e[Pr]=null})}),!0):!1},nr.unstable_batchedUpdates=Sl,nr.unstable_renderSubtreeIntoContainer=function(e,t,i,u){if(!So(i))throw Error(n(200));if(e==null||e._reactInternals===void 0)throw Error(n(38));return Co(e,t,i,!1,u)},nr.version="18.3.1-next-f1338f8080-20240426",nr}var sf;function fh(){if(sf)return Ll.exports;sf=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(s){console.error(s)}}return r(),Ll.exports=dg(),Ll.exports}var of;function fg(){if(of)return Eo;of=1;var r=fh();return Eo.createRoot=r.createRoot,Eo.hydrateRoot=r.hydrateRoot,Eo}var hg=fg();const pg=oc(hg);var ks=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},mg={setTimeout:(r,s)=>setTimeout(r,s),clearTimeout:r=>clearTimeout(r),setInterval:(r,s)=>setInterval(r,s),clearInterval:r=>clearInterval(r)},gg=class{#e=mg;#t=!1;setTimeoutProvider(r){this.#e=r}setTimeout(r,s){return this.#e.setTimeout(r,s)}clearTimeout(r){this.#e.clearTimeout(r)}setInterval(r,s){return this.#e.setInterval(r,s)}clearInterval(r){this.#e.clearInterval(r)}},Fn=new gg;function yg(r){setTimeout(r,0)}var Un=typeof window>"u"||"Deno"in globalThis;function Qt(){}function vg(r,s){return typeof r=="function"?r(s):r}function ql(r){return typeof r=="number"&&r>=0&&r!==1/0}function hh(r,s){return Math.max(r+(s||0)-Date.now(),0)}function gn(r,s){return typeof r=="function"?r(s):r}function gr(r,s){return typeof r=="function"?r(s):r}function af(r,s){const{type:n="all",exact:o,fetchStatus:c,predicate:l,queryKey:d,stale:f}=r;if(d){if(o){if(s.queryHash!==lc(d,s.options))return!1}else if(!pi(s.queryKey,d))return!1}if(n!=="all"){const p=s.isActive();if(n==="active"&&!p||n==="inactive"&&p)return!1}return!(typeof f=="boolean"&&s.isStale()!==f||c&&c!==s.state.fetchStatus||l&&!l(s))}function lf(r,s){const{exact:n,status:o,predicate:c,mutationKey:l}=r;if(l){if(!s.options.mutationKey)return!1;if(n){if(zn(s.options.mutationKey)!==zn(l))return!1}else if(!pi(s.options.mutationKey,l))return!1}return!(o&&s.state.status!==o||c&&!c(s))}function lc(r,s){return(s?.queryKeyHashFn||zn)(r)}function zn(r){return JSON.stringify(r,(s,n)=>Gl(n)?Object.keys(n).sort().reduce((o,c)=>(o[c]=n[c],o),{}):n)}function pi(r,s){return r===s?!0:typeof r!=typeof s?!1:r&&s&&typeof r=="object"&&typeof s=="object"?Object.keys(s).every(n=>pi(r[n],s[n])):!1}var xg=Object.prototype.hasOwnProperty;function ph(r,s){if(r===s)return r;const n=cf(r)&&cf(s);if(!n&&!(Gl(r)&&Gl(s)))return s;const c=(n?r:Object.keys(r)).length,l=n?s:Object.keys(s),d=l.length,f=n?new Array(d):{};let p=0;for(let h=0;h<d;h++){const w=n?h:l[h],b=r[w],x=s[w];if(b===x){f[w]=b,(n?h<c:xg.call(r,w))&&p++;continue}if(b===null||x===null||typeof b!="object"||typeof x!="object"){f[w]=x;continue}const v=ph(b,x);f[w]=v,v===b&&p++}return c===d&&p===c?r:f}function Oo(r,s){if(!s||Object.keys(r).length!==Object.keys(s).length)return!1;for(const n in r)if(r[n]!==s[n])return!1;return!0}function cf(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Gl(r){if(!uf(r))return!1;const s=r.constructor;if(s===void 0)return!0;const n=s.prototype;return!(!uf(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function uf(r){return Object.prototype.toString.call(r)==="[object Object]"}function wg(r){return new Promise(s=>{Fn.setTimeout(s,r)})}function Kl(r,s,n){return typeof n.structuralSharing=="function"?n.structuralSharing(r,s):n.structuralSharing!==!1?ph(r,s):s}function bg(r,s,n=0){const o=[...r,s];return n&&o.length>n?o.slice(1):o}function kg(r,s,n=0){const o=[s,...r];return n&&o.length>n?o.slice(0,-1):o}var cc=Symbol();function mh(r,s){return!r.queryFn&&s?.initialPromise?()=>s.initialPromise:!r.queryFn||r.queryFn===cc?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function gh(r,s){return typeof r=="function"?r(...s):!!r}var Sg=class extends ks{#e;#t;#r;constructor(){super(),this.#r=r=>{if(!Un&&window.addEventListener){const s=()=>r();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(r){this.#r=r,this.#t?.(),this.#t=r(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()})}setFocused(r){this.#e!==r&&(this.#e=r,this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(s=>{s(r)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},uc=new Sg;function Ql(){let r,s;const n=new Promise((c,l)=>{r=c,s=l});n.status="pending",n.catch(()=>{});function o(c){Object.assign(n,c),delete n.resolve,delete n.reject}return n.resolve=c=>{o({status:"fulfilled",value:c}),r(c)},n.reject=c=>{o({status:"rejected",reason:c}),s(c)},n}var Cg=yg;function Ng(){let r=[],s=0,n=f=>{f()},o=f=>{f()},c=Cg;const l=f=>{s?r.push(f):c(()=>{n(f)})},d=()=>{const f=r;r=[],f.length&&c(()=>{o(()=>{f.forEach(p=>{n(p)})})})};return{batch:f=>{let p;s++;try{p=f()}finally{s--,s||d()}return p},batchCalls:f=>(...p)=>{l(()=>{f(...p)})},schedule:l,setNotifyFunction:f=>{n=f},setBatchNotifyFunction:f=>{o=f},setScheduler:f=>{c=f}}}var At=Ng(),jg=class extends ks{#e=!0;#t;#r;constructor(){super(),this.#r=r=>{if(!Un&&window.addEventListener){const s=()=>r(!0),n=()=>r(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(r){this.#r=r,this.#t?.(),this.#t=r(this.setOnline.bind(this))}setOnline(r){this.#e!==r&&(this.#e=r,this.listeners.forEach(n=>{n(r)}))}isOnline(){return this.#e}},Io=new jg;function Eg(r){return Math.min(1e3*2**r,3e4)}function yh(r){return(r??"online")==="online"?Io.isOnline():!0}var Xl=class extends Error{constructor(r){super("CancelledError"),this.revert=r?.revert,this.silent=r?.silent}};function vh(r){let s=!1,n=0,o;const c=Ql(),l=()=>c.status!=="pending",d=g=>{if(!l()){const S=new Xl(g);x(S),r.onCancel?.(S)}},f=()=>{s=!0},p=()=>{s=!1},h=()=>uc.isFocused()&&(r.networkMode==="always"||Io.isOnline())&&r.canRun(),w=()=>yh(r.networkMode)&&r.canRun(),b=g=>{l()||(o?.(),c.resolve(g))},x=g=>{l()||(o?.(),c.reject(g))},v=()=>new Promise(g=>{o=S=>{(l()||h())&&g(S)},r.onPause?.()}).then(()=>{o=void 0,l()||r.onContinue?.()}),k=()=>{if(l())return;let g;const S=n===0?r.initialPromise:void 0;try{g=S??r.fn()}catch(C){g=Promise.reject(C)}Promise.resolve(g).then(b).catch(C=>{if(l())return;const R=r.retry??(Un?0:3),I=r.retryDelay??Eg,_=typeof I=="function"?I(n,C):I,F=R===!0||typeof R=="number"&&n<R||typeof R=="function"&&R(n,C);if(s||!F){x(C);return}n++,r.onFail?.(n,C),wg(_).then(()=>h()?void 0:v()).then(()=>{s?x(C):k()})})};return{promise:c,status:()=>c.status,cancel:d,continue:()=>(o?.(),c),cancelRetry:f,continueRetry:p,canStart:w,start:()=>(w()?k():v().then(k),c)}}var xh=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ql(this.gcTime)&&(this.#e=Fn.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Un?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Fn.clearTimeout(this.#e),this.#e=void 0)}},_g=class extends xh{#e;#t;#r;#s;#n;#o;#a;constructor(r){super(),this.#a=!1,this.#o=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.#s=r.client,this.#r=this.#s.getQueryCache(),this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.#e=df(this.options),this.state=r.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(r){if(this.options={...this.#o,...r},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=df(this.options);s.data!==void 0&&(this.setData(s.data,{updatedAt:s.dataUpdatedAt,manual:!0}),this.#e=s)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(r,s){const n=Kl(this.state.data,r,this.options);return this.#i({data:n,type:"success",dataUpdatedAt:s?.updatedAt,manual:s?.manual}),n}setState(r,s){this.#i({type:"setState",state:r,setStateOptions:s})}cancel(r){const s=this.#n?.promise;return this.#n?.cancel(r),s?s.then(Qt).catch(Qt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(r=>gr(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===cc||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(r=>gn(r.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(r=0){return this.state.data===void 0?!0:r==="static"?!1:this.state.isInvalidated?!0:!hh(this.state.dataUpdatedAt,r)}onFocus(){this.observers.find(s=>s.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(s=>s.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(s=>s!==r),this.observers.length||(this.#n&&(this.#a?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(r,s){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&s?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(r&&this.setOptions(r),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const n=new AbortController,o=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(this.#a=!0,n.signal)})},c=()=>{const f=mh(this.options,s),h=(()=>{const w={client:this.#s,queryKey:this.queryKey,meta:this.meta};return o(w),w})();return this.#a=!1,this.options.persister?this.options.persister(f,h,this):f(h)},d=(()=>{const f={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:c};return o(f),f})();this.options.behavior?.onFetch(d,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==d.fetchOptions?.meta)&&this.#i({type:"fetch",meta:d.fetchOptions?.meta}),this.#n=vh({initialPromise:s?.initialPromise,fn:d.fetchFn,onCancel:f=>{f instanceof Xl&&f.revert&&this.setState({...this.#t,fetchStatus:"idle"}),n.abort()},onFail:(f,p)=>{this.#i({type:"failed",failureCount:f,error:p})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0});try{const f=await this.#n.start();if(f===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(f),this.#r.config.onSuccess?.(f,this),this.#r.config.onSettled?.(f,this.state.error,this),f}catch(f){if(f instanceof Xl){if(f.silent)return this.#n.promise;if(f.revert){if(this.state.data===void 0)throw f;return this.state.data}}throw this.#i({type:"error",error:f}),this.#r.config.onError?.(f,this),this.#r.config.onSettled?.(this.state.data,f,this),f}finally{this.scheduleGc()}}#i(r){const s=n=>{switch(r.type){case"failed":return{...n,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...wh(n.data,this.options),fetchMeta:r.meta??null};case"success":const o={...n,data:r.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=r.manual?o:void 0,o;case"error":const c=r.error;return{...n,error:c,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:c,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...r.state}}};this.state=s(this.state),At.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:r})})}};function wh(r,s){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:yh(s.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function df(r){const s=typeof r.initialData=="function"?r.initialData():r.initialData,n=s!==void 0,o=n?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:s,dataUpdateCount:0,dataUpdatedAt:n?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Ag=class extends ks{constructor(r,s){super(),this.options=s,this.#e=r,this.#i=null,this.#a=Ql(),this.bindMethods(),this.setOptions(s)}#e;#t=void 0;#r=void 0;#s=void 0;#n;#o;#a;#i;#m;#f;#h;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),ff(this.#t,this.options)?this.#d():this.updateResult(),this.#x())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Zl(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Zl(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#w(),this.#b(),this.#t.removeObserver(this)}setOptions(r){const s=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof gr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#k(),this.#t.setOptions(this.options),s._defaulted&&!Oo(this.options,s)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const o=this.hasListeners();o&&hf(this.#t,n,this.options,s)&&this.#d(),this.updateResult(),o&&(this.#t!==n||gr(this.options.enabled,this.#t)!==gr(s.enabled,this.#t)||gn(this.options.staleTime,this.#t)!==gn(s.staleTime,this.#t))&&this.#g();const c=this.#y();o&&(this.#t!==n||gr(this.options.enabled,this.#t)!==gr(s.enabled,this.#t)||c!==this.#l)&&this.#v(c)}getOptimisticResult(r){const s=this.#e.getQueryCache().build(this.#e,r),n=this.createResult(s,r);return Tg(this,n)&&(this.#s=n,this.#o=this.options,this.#n=this.#t.state),n}getCurrentResult(){return this.#s}trackResult(r,s){return new Proxy(r,{get:(n,o)=>(this.trackProp(o),s?.(o),o==="promise"&&!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,o))})}trackProp(r){this.#p.add(r)}getCurrentQuery(){return this.#t}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const s=this.#e.defaultQueryOptions(r),n=this.#e.getQueryCache().build(this.#e,s);return n.fetch().then(()=>this.createResult(n,s))}fetch(r){return this.#d({...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#d(r){this.#k();let s=this.#t.fetch(this.options,r);return r?.throwOnError||(s=s.catch(Qt)),s}#g(){this.#w();const r=gn(this.options.staleTime,this.#t);if(Un||this.#s.isStale||!ql(r))return;const n=hh(this.#s.dataUpdatedAt,r)+1;this.#c=Fn.setTimeout(()=>{this.#s.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(r){this.#b(),this.#l=r,!(Un||gr(this.options.enabled,this.#t)===!1||!ql(this.#l)||this.#l===0)&&(this.#u=Fn.setInterval(()=>{(this.options.refetchIntervalInBackground||uc.isFocused())&&this.#d()},this.#l))}#x(){this.#g(),this.#v(this.#y())}#w(){this.#c&&(Fn.clearTimeout(this.#c),this.#c=void 0)}#b(){this.#u&&(Fn.clearInterval(this.#u),this.#u=void 0)}createResult(r,s){const n=this.#t,o=this.options,c=this.#s,l=this.#n,d=this.#o,p=r!==n?r.state:this.#r,{state:h}=r;let w={...h},b=!1,x;if(s._optimisticResults){const L=this.hasListeners(),B=!L&&ff(r,s),Q=L&&hf(r,n,s,o);(B||Q)&&(w={...w,...wh(h.data,r.options)}),s._optimisticResults==="isRestoring"&&(w.fetchStatus="idle")}let{error:v,errorUpdatedAt:k,status:g}=w;x=w.data;let S=!1;if(s.placeholderData!==void 0&&x===void 0&&g==="pending"){let L;c?.isPlaceholderData&&s.placeholderData===d?.placeholderData?(L=c.data,S=!0):L=typeof s.placeholderData=="function"?s.placeholderData(this.#h?.state.data,this.#h):s.placeholderData,L!==void 0&&(g="success",x=Kl(c?.data,L,s),b=!0)}if(s.select&&x!==void 0&&!S)if(c&&x===l?.data&&s.select===this.#m)x=this.#f;else try{this.#m=s.select,x=s.select(x),x=Kl(c?.data,x,s),this.#f=x,this.#i=null}catch(L){this.#i=L}this.#i&&(v=this.#i,x=this.#f,k=Date.now(),g="error");const C=w.fetchStatus==="fetching",R=g==="pending",I=g==="error",_=R&&C,F=x!==void 0,$={status:g,fetchStatus:w.fetchStatus,isPending:R,isSuccess:g==="success",isError:I,isInitialLoading:_,isLoading:_,data:x,dataUpdatedAt:w.dataUpdatedAt,error:v,errorUpdatedAt:k,failureCount:w.fetchFailureCount,failureReason:w.fetchFailureReason,errorUpdateCount:w.errorUpdateCount,isFetched:w.dataUpdateCount>0||w.errorUpdateCount>0,isFetchedAfterMount:w.dataUpdateCount>p.dataUpdateCount||w.errorUpdateCount>p.errorUpdateCount,isFetching:C,isRefetching:C&&!R,isLoadingError:I&&!F,isPaused:w.fetchStatus==="paused",isPlaceholderData:b,isRefetchError:I&&F,isStale:dc(r,s),refetch:this.refetch,promise:this.#a,isEnabled:gr(s.enabled,r)!==!1};if(this.options.experimental_prefetchInRender){const L=oe=>{$.status==="error"?oe.reject($.error):$.data!==void 0&&oe.resolve($.data)},B=()=>{const oe=this.#a=$.promise=Ql();L(oe)},Q=this.#a;switch(Q.status){case"pending":r.queryHash===n.queryHash&&L(Q);break;case"fulfilled":($.status==="error"||$.data!==Q.value)&&B();break;case"rejected":($.status!=="error"||$.error!==Q.reason)&&B();break}}return $}updateResult(){const r=this.#s,s=this.createResult(this.#t,this.options);if(this.#n=this.#t.state,this.#o=this.options,this.#n.data!==void 0&&(this.#h=this.#t),Oo(s,r))return;this.#s=s;const n=()=>{if(!r)return!0;const{notifyOnChangeProps:o}=this.options,c=typeof o=="function"?o():o;if(c==="all"||!c&&!this.#p.size)return!0;const l=new Set(c??this.#p);return this.options.throwOnError&&l.add("error"),Object.keys(this.#s).some(d=>{const f=d;return this.#s[f]!==r[f]&&l.has(f)})};this.#S({listeners:n()})}#k(){const r=this.#e.getQueryCache().build(this.#e,this.options);if(r===this.#t)return;const s=this.#t;this.#t=r,this.#r=r.state,this.hasListeners()&&(s?.removeObserver(this),r.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#x()}#S(r){At.batch(()=>{r.listeners&&this.listeners.forEach(s=>{s(this.#s)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function Rg(r,s){return gr(s.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&s.retryOnMount===!1)}function ff(r,s){return Rg(r,s)||r.state.data!==void 0&&Zl(r,s,s.refetchOnMount)}function Zl(r,s,n){if(gr(s.enabled,r)!==!1&&gn(s.staleTime,r)!=="static"){const o=typeof n=="function"?n(r):n;return o==="always"||o!==!1&&dc(r,s)}return!1}function hf(r,s,n,o){return(r!==s||gr(o.enabled,r)===!1)&&(!n.suspense||r.state.status!=="error")&&dc(r,n)}function dc(r,s){return gr(s.enabled,r)!==!1&&r.isStaleByTime(gn(s.staleTime,r))}function Tg(r,s){return!Oo(r.getCurrentResult(),s)}function pf(r){return{onFetch:(s,n)=>{const o=s.options,c=s.fetchOptions?.meta?.fetchMore?.direction,l=s.state.data?.pages||[],d=s.state.data?.pageParams||[];let f={pages:[],pageParams:[]},p=0;const h=async()=>{let w=!1;const b=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(s.signal.aborted?w=!0:s.signal.addEventListener("abort",()=>{w=!0}),s.signal)})},x=mh(s.options,s.fetchOptions),v=async(k,g,S)=>{if(w)return Promise.reject();if(g==null&&k.pages.length)return Promise.resolve(k);const R=(()=>{const M={client:s.client,queryKey:s.queryKey,pageParam:g,direction:S?"backward":"forward",meta:s.options.meta};return b(M),M})(),I=await x(R),{maxPages:_}=s.options,F=S?kg:bg;return{pages:F(k.pages,I,_),pageParams:F(k.pageParams,g,_)}};if(c&&l.length){const k=c==="backward",g=k?Pg:mf,S={pages:l,pageParams:d},C=g(o,S);f=await v(S,C,k)}else{const k=r??l.length;do{const g=p===0?d[0]??o.initialPageParam:mf(o,f);if(p>0&&g==null)break;f=await v(f,g),p++}while(p<k)}return f};s.options.persister?s.fetchFn=()=>s.options.persister?.(h,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},n):s.fetchFn=h}}}function mf(r,{pages:s,pageParams:n}){const o=s.length-1;return s.length>0?r.getNextPageParam(s[o],s,n[o],n):void 0}function Pg(r,{pages:s,pageParams:n}){return s.length>0?r.getPreviousPageParam?.(s[0],s,n[0],n):void 0}var Og=class extends xh{#e;#t;#r;#s;constructor(r){super(),this.#e=r.client,this.mutationId=r.mutationId,this.#r=r.mutationCache,this.#t=[],this.state=r.state||bh(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){this.#t.includes(r)||(this.#t.push(r),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){this.#t=this.#t.filter(s=>s!==r),this.scheduleGc(),this.#r.notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#r.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(r){const s=()=>{this.#n({type:"continue"})},n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#s=vh({fn:()=>this.options.mutationFn?this.options.mutationFn(r,n):Promise.reject(new Error("No mutationFn found")),onFail:(l,d)=>{this.#n({type:"failed",failureCount:l,error:d})},onPause:()=>{this.#n({type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#r.canRun(this)});const o=this.state.status==="pending",c=!this.#s.canStart();try{if(o)s();else{this.#n({type:"pending",variables:r,isPaused:c}),await this.#r.config.onMutate?.(r,this,n);const d=await this.options.onMutate?.(r,n);d!==this.state.context&&this.#n({type:"pending",context:d,variables:r,isPaused:c})}const l=await this.#s.start();return await this.#r.config.onSuccess?.(l,r,this.state.context,this,n),await this.options.onSuccess?.(l,r,this.state.context,n),await this.#r.config.onSettled?.(l,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(l,null,r,this.state.context,n),this.#n({type:"success",data:l}),l}catch(l){try{throw await this.#r.config.onError?.(l,r,this.state.context,this,n),await this.options.onError?.(l,r,this.state.context,n),await this.#r.config.onSettled?.(void 0,l,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(void 0,l,r,this.state.context,n),l}finally{this.#n({type:"error",error:l})}}finally{this.#r.runNext(this)}}#n(r){const s=n=>{switch(r.type){case"failed":return{...n,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...n,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:r.error,failureCount:n.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=s(this.state),At.batch(()=>{this.#t.forEach(n=>{n.onMutationUpdate(r)}),this.#r.notify({mutation:this,type:"updated",action:r})})}};function bh(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ig=class extends ks{constructor(r={}){super(),this.config=r,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(r,s,n){const o=new Og({client:r,mutationCache:this,mutationId:++this.#r,options:r.defaultMutationOptions(s),state:n});return this.add(o),o}add(r){this.#e.add(r);const s=_o(r);if(typeof s=="string"){const n=this.#t.get(s);n?n.push(r):this.#t.set(s,[r])}this.notify({type:"added",mutation:r})}remove(r){if(this.#e.delete(r)){const s=_o(r);if(typeof s=="string"){const n=this.#t.get(s);if(n)if(n.length>1){const o=n.indexOf(r);o!==-1&&n.splice(o,1)}else n[0]===r&&this.#t.delete(s)}}this.notify({type:"removed",mutation:r})}canRun(r){const s=_o(r);if(typeof s=="string"){const o=this.#t.get(s)?.find(c=>c.state.status==="pending");return!o||o===r}else return!0}runNext(r){const s=_o(r);return typeof s=="string"?this.#t.get(s)?.find(o=>o!==r&&o.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){At.batch(()=>{this.#e.forEach(r=>{this.notify({type:"removed",mutation:r})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(r){const s={exact:!0,...r};return this.getAll().find(n=>lf(s,n))}findAll(r={}){return this.getAll().filter(s=>lf(r,s))}notify(r){At.batch(()=>{this.listeners.forEach(s=>{s(r)})})}resumePausedMutations(){const r=this.getAll().filter(s=>s.state.isPaused);return At.batch(()=>Promise.all(r.map(s=>s.continue().catch(Qt))))}};function _o(r){return r.options.scope?.id}var Lg=class extends ks{#e;#t=void 0;#r;#s;constructor(s,n){super(),this.#e=s,this.setOptions(n),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){const n=this.options;this.options=this.#e.defaultMutationOptions(s),Oo(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),n?.mutationKey&&this.options.mutationKey&&zn(n.mutationKey)!==zn(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(s){this.#n(),this.#o(s)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#n(),this.#o()}mutate(s,n){return this.#s=n,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(s)}#n(){const s=this.#r?.state??bh();this.#t={...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset}}#o(s){At.batch(()=>{if(this.#s&&this.hasListeners()){const n=this.#t.variables,o=this.#t.context,c={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};s?.type==="success"?(this.#s.onSuccess?.(s.data,n,o,c),this.#s.onSettled?.(s.data,null,n,o,c)):s?.type==="error"&&(this.#s.onError?.(s.error,n,o,c),this.#s.onSettled?.(void 0,s.error,n,o,c))}this.listeners.forEach(n=>{n(this.#t)})})}},Dg=class extends ks{constructor(r={}){super(),this.config=r,this.#e=new Map}#e;build(r,s,n){const o=s.queryKey,c=s.queryHash??lc(o,s);let l=this.get(c);return l||(l=new _g({client:r,queryKey:o,queryHash:c,options:r.defaultQueryOptions(s),state:n,defaultOptions:r.getQueryDefaults(o)}),this.add(l)),l}add(r){this.#e.has(r.queryHash)||(this.#e.set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const s=this.#e.get(r.queryHash);s&&(r.destroy(),s===r&&this.#e.delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){At.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return this.#e.get(r)}getAll(){return[...this.#e.values()]}find(r){const s={exact:!0,...r};return this.getAll().find(n=>af(s,n))}findAll(r={}){const s=this.getAll();return Object.keys(r).length>0?s.filter(n=>af(r,n)):s}notify(r){At.batch(()=>{this.listeners.forEach(s=>{s(r)})})}onFocus(){At.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){At.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},Fg=class{#e;#t;#r;#s;#n;#o;#a;#i;constructor(r={}){this.#e=r.queryCache||new Dg,this.#t=r.mutationCache||new Ig,this.#r=r.defaultOptions||{},this.#s=new Map,this.#n=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=uc.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=Io.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#i?.(),this.#i=void 0)}isFetching(r){return this.#e.findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return this.#t.findAll({...r,status:"pending"}).length}getQueryData(r){const s=this.defaultQueryOptions({queryKey:r});return this.#e.get(s.queryHash)?.state.data}ensureQueryData(r){const s=this.defaultQueryOptions(r),n=this.#e.build(this,s),o=n.state.data;return o===void 0?this.fetchQuery(r):(r.revalidateIfStale&&n.isStaleByTime(gn(s.staleTime,n))&&this.prefetchQuery(s),Promise.resolve(o))}getQueriesData(r){return this.#e.findAll(r).map(({queryKey:s,state:n})=>{const o=n.data;return[s,o]})}setQueryData(r,s,n){const o=this.defaultQueryOptions({queryKey:r}),l=this.#e.get(o.queryHash)?.state.data,d=vg(s,l);if(d!==void 0)return this.#e.build(this,o).setData(d,{...n,manual:!0})}setQueriesData(r,s,n){return At.batch(()=>this.#e.findAll(r).map(({queryKey:o})=>[o,this.setQueryData(o,s,n)]))}getQueryState(r){const s=this.defaultQueryOptions({queryKey:r});return this.#e.get(s.queryHash)?.state}removeQueries(r){const s=this.#e;At.batch(()=>{s.findAll(r).forEach(n=>{s.remove(n)})})}resetQueries(r,s){const n=this.#e;return At.batch(()=>(n.findAll(r).forEach(o=>{o.reset()}),this.refetchQueries({type:"active",...r},s)))}cancelQueries(r,s={}){const n={revert:!0,...s},o=At.batch(()=>this.#e.findAll(r).map(c=>c.cancel(n)));return Promise.all(o).then(Qt).catch(Qt)}invalidateQueries(r,s={}){return At.batch(()=>(this.#e.findAll(r).forEach(n=>{n.invalidate()}),r?.refetchType==="none"?Promise.resolve():this.refetchQueries({...r,type:r?.refetchType??r?.type??"active"},s)))}refetchQueries(r,s={}){const n={...s,cancelRefetch:s.cancelRefetch??!0},o=At.batch(()=>this.#e.findAll(r).filter(c=>!c.isDisabled()&&!c.isStatic()).map(c=>{let l=c.fetch(void 0,n);return n.throwOnError||(l=l.catch(Qt)),c.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(o).then(Qt)}fetchQuery(r){const s=this.defaultQueryOptions(r);s.retry===void 0&&(s.retry=!1);const n=this.#e.build(this,s);return n.isStaleByTime(gn(s.staleTime,n))?n.fetch(s):Promise.resolve(n.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Qt).catch(Qt)}fetchInfiniteQuery(r){return r.behavior=pf(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Qt).catch(Qt)}ensureInfiniteQueryData(r){return r.behavior=pf(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Io.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(r){this.#r=r}setQueryDefaults(r,s){this.#s.set(zn(r),{queryKey:r,defaultOptions:s})}getQueryDefaults(r){const s=[...this.#s.values()],n={};return s.forEach(o=>{pi(r,o.queryKey)&&Object.assign(n,o.defaultOptions)}),n}setMutationDefaults(r,s){this.#n.set(zn(r),{mutationKey:r,defaultOptions:s})}getMutationDefaults(r){const s=[...this.#n.values()],n={};return s.forEach(o=>{pi(r,o.mutationKey)&&Object.assign(n,o.defaultOptions)}),n}defaultQueryOptions(r){if(r._defaulted)return r;const s={...this.#r.queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return s.queryHash||(s.queryHash=lc(s.queryKey,s)),s.refetchOnReconnect===void 0&&(s.refetchOnReconnect=s.networkMode!=="always"),s.throwOnError===void 0&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===cc&&(s.enabled=!1),s}defaultMutationOptions(r){return r?._defaulted?r:{...this.#r.mutations,...r?.mutationKey&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},kh=T.createContext(void 0),Bo=r=>{const s=T.useContext(kh);if(!s)throw new Error("No QueryClient set, use QueryClientProvider to set one");return s},Bg=({client:r,children:s})=>(T.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),a.jsx(kh.Provider,{value:r,children:s})),Sh=T.createContext(!1),Mg=()=>T.useContext(Sh);Sh.Provider;function Ch(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var Nh=T.createContext(Ch()),Ug=()=>T.useContext(Nh),zg=({children:r})=>{const[s]=T.useState(()=>Ch());return a.jsx(Nh.Provider,{value:s,children:typeof r=="function"?r(s):r})},$g=(r,s)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(s.isReset()||(r.retryOnMount=!1))},Wg=r=>{T.useEffect(()=>{r.clearReset()},[r])},Vg=({result:r,errorResetBoundary:s,throwOnError:n,query:o,suspense:c})=>r.isError&&!s.isReset()&&!r.isFetching&&o&&(c&&r.data===void 0||gh(n,[r.error,o])),Hg=r=>{if(r.suspense){const n=c=>c==="static"?c:Math.max(c??1e3,1e3),o=r.staleTime;r.staleTime=typeof o=="function"?(...c)=>n(o(...c)):n(o),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3))}},qg=(r,s)=>r.isLoading&&r.isFetching&&!s,Gg=(r,s)=>r?.suspense&&s.isPending,gf=(r,s,n)=>s.fetchOptimistic(r).catch(()=>{n.clearReset()});function Kg(r,s,n){const o=Mg(),c=Ug(),l=Bo(),d=l.defaultQueryOptions(r);l.getDefaultOptions().queries?._experimental_beforeQuery?.(d),d._optimisticResults=o?"isRestoring":"optimistic",Hg(d),$g(d,c),Wg(c);const f=!l.getQueryCache().get(d.queryHash),[p]=T.useState(()=>new s(l,d)),h=p.getOptimisticResult(d),w=!o&&r.subscribed!==!1;if(T.useSyncExternalStore(T.useCallback(b=>{const x=w?p.subscribe(At.batchCalls(b)):Qt;return p.updateResult(),x},[p,w]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),T.useEffect(()=>{p.setOptions(d)},[d,p]),Gg(d,h))throw gf(d,p,c);if(Vg({result:h,errorResetBoundary:c,throwOnError:d.throwOnError,query:l.getQueryCache().get(d.queryHash),suspense:d.suspense}))throw h.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(d,h),d.experimental_prefetchInRender&&!Un&&qg(h,o)&&(f?gf(d,p,c):l.getQueryCache().get(d.queryHash)?.promise)?.catch(Qt).finally(()=>{p.updateResult()}),d.notifyOnChangeProps?h:p.trackResult(h)}function fc(r,s){return Kg(r,Ag)}function Qg(r,s){const n=Bo(),[o]=T.useState(()=>new Lg(n,r));T.useEffect(()=>{o.setOptions(r)},[o,r]);const c=T.useSyncExternalStore(T.useCallback(d=>o.subscribe(At.batchCalls(d)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),l=T.useCallback((d,f)=>{o.mutate(d,f).catch(Qt)},[o]);if(c.error&&gh(o.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:l,mutateAsync:c.mutate}}const Xg="modulepreload",Zg=function(r){return"/My-Ebook-Reader/"+r},yf={},Lo=function(s,n,o){let c=Promise.resolve();if(n&&n.length>0){let p=function(h){return Promise.all(h.map(w=>Promise.resolve(w).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),f=d?.nonce||d?.getAttribute("nonce");c=p(n.map(h=>{if(h=Zg(h),h in yf)return;yf[h]=!0;const w=h.endsWith(".css"),b=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${b}`))return;const x=document.createElement("link");if(x.rel=w?"stylesheet":Xg,w||(x.as="script"),x.crossOrigin="",x.href=h,f&&x.setAttribute("nonce",f),document.head.appendChild(x),w)return new Promise((v,k)=>{x.addEventListener("load",v),x.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return c.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return s().catch(l)})};var Yg=function(){return null};fh();/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mi(){return mi=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},mi.apply(this,arguments)}var mn;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(mn||(mn={}));const vf="popstate";function Jg(r){r===void 0&&(r={});function s(c,l){let{pathname:d="/",search:f="",hash:p=""}=$n(c.location.hash.substr(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),Yl("",{pathname:d,search:f,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(c,l){let d=c.document.querySelector("base"),f="";if(d&&d.getAttribute("href")){let p=c.location.href,h=p.indexOf("#");f=h===-1?p:p.slice(0,h)}return f+"#"+(typeof l=="string"?l:jh(l))}function o(c,l){Mo(c.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(l)+")")}return t0(s,n,o,r)}function Rt(r,s){if(r===!1||r===null||typeof r>"u")throw new Error(s)}function Mo(r,s){if(!r){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function e0(){return Math.random().toString(36).substr(2,8)}function xf(r,s){return{usr:r.state,key:r.key,idx:s}}function Yl(r,s,n,o){return n===void 0&&(n=null),mi({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof s=="string"?$n(s):s,{state:n,key:s&&s.key||o||e0()})}function jh(r){let{pathname:s="/",search:n="",hash:o=""}=r;return n&&n!=="?"&&(s+=n.charAt(0)==="?"?n:"?"+n),o&&o!=="#"&&(s+=o.charAt(0)==="#"?o:"#"+o),s}function $n(r){let s={};if(r){let n=r.indexOf("#");n>=0&&(s.hash=r.substr(n),r=r.substr(0,n));let o=r.indexOf("?");o>=0&&(s.search=r.substr(o),r=r.substr(0,o)),r&&(s.pathname=r)}return s}function t0(r,s,n,o){o===void 0&&(o={});let{window:c=document.defaultView,v5Compat:l=!1}=o,d=c.history,f=mn.Pop,p=null,h=w();h==null&&(h=0,d.replaceState(mi({},d.state,{idx:h}),""));function w(){return(d.state||{idx:null}).idx}function b(){f=mn.Pop;let S=w(),C=S==null?null:S-h;h=S,p&&p({action:f,location:g.location,delta:C})}function x(S,C){f=mn.Push;let R=Yl(g.location,S,C);n&&n(R,S),h=w()+1;let I=xf(R,h),_=g.createHref(R);try{d.pushState(I,"",_)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;c.location.assign(_)}l&&p&&p({action:f,location:g.location,delta:1})}function v(S,C){f=mn.Replace;let R=Yl(g.location,S,C);n&&n(R,S),h=w();let I=xf(R,h),_=g.createHref(R);d.replaceState(I,"",_),l&&p&&p({action:f,location:g.location,delta:0})}function k(S){let C=c.location.origin!=="null"?c.location.origin:c.location.href,R=typeof S=="string"?S:jh(S);return R=R.replace(/ $/,"%20"),Rt(C,"No window.location.(origin|href) available to create URL for href: "+R),new URL(R,C)}let g={get action(){return f},get location(){return r(c,d)},listen(S){if(p)throw new Error("A history only accepts one active listener");return c.addEventListener(vf,b),p=S,()=>{c.removeEventListener(vf,b),p=null}},createHref(S){return s(c,S)},createURL:k,encodeLocation(S){let C=k(S);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:v,go(S){return d.go(S)}};return g}var wf;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(wf||(wf={}));function r0(r,s,n){return n===void 0&&(n="/"),n0(r,s,n)}function n0(r,s,n,o){let c=typeof s=="string"?$n(s):s,l=Ah(c.pathname||"/",n);if(l==null)return null;let d=Eh(r);s0(d);let f=null;for(let p=0;f==null&&p<d.length;++p){let h=g0(l);f=h0(d[p],h)}return f}function Eh(r,s,n,o){s===void 0&&(s=[]),n===void 0&&(n=[]),o===void 0&&(o="");let c=(l,d,f)=>{let p={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};p.relativePath.startsWith("/")&&(Rt(p.relativePath.startsWith(o),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(o.length));let h=Mn([o,p.relativePath]),w=n.concat(p);l.children&&l.children.length>0&&(Rt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),Eh(l.children,s,w,h)),!(l.path==null&&!l.index)&&s.push({path:h,score:d0(h,l.index),routesMeta:w})};return r.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))c(l,d);else for(let p of _h(l.path))c(l,d,p)}),s}function _h(r){let s=r.split("/");if(s.length===0)return[];let[n,...o]=s,c=n.endsWith("?"),l=n.replace(/\?$/,"");if(o.length===0)return c?[l,""]:[l];let d=_h(o.join("/")),f=[];return f.push(...d.map(p=>p===""?l:[l,p].join("/"))),c&&f.push(...d),f.map(p=>r.startsWith("/")&&p===""?"/":p)}function s0(r){r.sort((s,n)=>s.score!==n.score?n.score-s.score:f0(s.routesMeta.map(o=>o.childrenIndex),n.routesMeta.map(o=>o.childrenIndex)))}const i0=/^:[\w-]+$/,o0=3,a0=2,l0=1,c0=10,u0=-2,bf=r=>r==="*";function d0(r,s){let n=r.split("/"),o=n.length;return n.some(bf)&&(o+=u0),s&&(o+=a0),n.filter(c=>!bf(c)).reduce((c,l)=>c+(i0.test(l)?o0:l===""?l0:c0),o)}function f0(r,s){return r.length===s.length&&r.slice(0,-1).every((o,c)=>o===s[c])?r[r.length-1]-s[s.length-1]:0}function h0(r,s,n){let{routesMeta:o}=r,c={},l="/",d=[];for(let f=0;f<o.length;++f){let p=o[f],h=f===o.length-1,w=l==="/"?s:s.slice(l.length)||"/",b=p0({path:p.relativePath,caseSensitive:p.caseSensitive,end:h},w),x=p.route;if(!b)return null;Object.assign(c,b.params),d.push({params:c,pathname:Mn([l,b.pathname]),pathnameBase:S0(Mn([l,b.pathnameBase])),route:x}),b.pathnameBase!=="/"&&(l=Mn([l,b.pathnameBase]))}return d}function p0(r,s){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[n,o]=m0(r.path,r.caseSensitive,r.end),c=s.match(n);if(!c)return null;let l=c[0],d=l.replace(/(.)\/+$/,"$1"),f=c.slice(1);return{params:o.reduce((h,w,b)=>{let{paramName:x,isOptional:v}=w;if(x==="*"){let g=f[b]||"";d=l.slice(0,l.length-g.length).replace(/(.)\/+$/,"$1")}const k=f[b];return v&&!k?h[x]=void 0:h[x]=(k||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:d,pattern:r}}function m0(r,s,n){s===void 0&&(s=!1),n===void 0&&(n=!0),Mo(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let o=[],c="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,p)=>(o.push({paramName:f,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(o.push({paramName:"*"}),c+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?c+="\\/*$":r!==""&&r!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,s?void 0:"i"),o]}function g0(r){try{return r.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Mo(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),r}}function Ah(r,s){if(s==="/")return r;if(!r.toLowerCase().startsWith(s.toLowerCase()))return null;let n=s.endsWith("/")?s.length-1:s.length,o=r.charAt(n);return o&&o!=="/"?null:r.slice(n)||"/"}const y0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,v0=r=>y0.test(r);function x0(r,s){s===void 0&&(s="/");let{pathname:n,search:o="",hash:c=""}=typeof r=="string"?$n(r):r,l;if(n)if(v0(n))l=n;else{if(n.includes("//")){let d=n;n=n.replace(/\/\/+/g,"/"),Mo(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+n))}n.startsWith("/")?l=kf(n.substring(1),"/"):l=kf(n,s)}else l=s;return{pathname:l,search:C0(o),hash:N0(c)}}function kf(r,s){let n=s.replace(/\/+$/,"").split("/");return r.split("/").forEach(c=>{c===".."?n.length>1&&n.pop():c!=="."&&n.push(c)}),n.length>1?n.join("/"):"/"}function Bl(r,s,n,o){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function w0(r){return r.filter((s,n)=>n===0||s.route.path&&s.route.path.length>0)}function b0(r,s){let n=w0(r);return s?n.map((o,c)=>c===n.length-1?o.pathname:o.pathnameBase):n.map(o=>o.pathnameBase)}function k0(r,s,n,o){o===void 0&&(o=!1);let c;typeof r=="string"?c=$n(r):(c=mi({},r),Rt(!c.pathname||!c.pathname.includes("?"),Bl("?","pathname","search",c)),Rt(!c.pathname||!c.pathname.includes("#"),Bl("#","pathname","hash",c)),Rt(!c.search||!c.search.includes("#"),Bl("#","search","hash",c)));let l=r===""||c.pathname==="",d=l?"/":c.pathname,f;if(d==null)f=n;else{let b=s.length-1;if(!o&&d.startsWith("..")){let x=d.split("/");for(;x[0]==="..";)x.shift(),b-=1;c.pathname=x.join("/")}f=b>=0?s[b]:"/"}let p=x0(c,f),h=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(h||w)&&(p.pathname+="/"),p}const Mn=r=>r.join("/").replace(/\/\/+/g,"/"),S0=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),C0=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,N0=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function j0(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const Rh=["post","put","patch","delete"];new Set(Rh);const E0=["get",...Rh];new Set(E0);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gi(){return gi=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},gi.apply(this,arguments)}const hc=T.createContext(null),_0=T.createContext(null),Uo=T.createContext(null),zo=T.createContext(null),Wn=T.createContext({outlet:null,matches:[],isDataRoute:!1}),Th=T.createContext(null);function $o(){return T.useContext(zo)!=null}function pc(){return $o()||Rt(!1),T.useContext(zo).location}function Ph(r){T.useContext(Uo).static||T.useLayoutEffect(r)}function mc(){let{isDataRoute:r}=T.useContext(Wn);return r?$0():A0()}function A0(){$o()||Rt(!1);let r=T.useContext(hc),{basename:s,future:n,navigator:o}=T.useContext(Uo),{matches:c}=T.useContext(Wn),{pathname:l}=pc(),d=JSON.stringify(b0(c,n.v7_relativeSplatPath)),f=T.useRef(!1);return Ph(()=>{f.current=!0}),T.useCallback(function(h,w){if(w===void 0&&(w={}),!f.current)return;if(typeof h=="number"){o.go(h);return}let b=k0(h,JSON.parse(d),l,w.relative==="path");r==null&&s!=="/"&&(b.pathname=b.pathname==="/"?s:Mn([s,b.pathname])),(w.replace?o.replace:o.push)(b,w.state,w)},[s,o,d,l,r])}function R0(){let{matches:r}=T.useContext(Wn),s=r[r.length-1];return s?s.params:{}}function T0(r,s){return P0(r,s)}function P0(r,s,n,o){$o()||Rt(!1);let{navigator:c}=T.useContext(Uo),{matches:l}=T.useContext(Wn),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let p=d?d.pathnameBase:"/";d&&d.route;let h=pc(),w;if(s){var b;let S=typeof s=="string"?$n(s):s;p==="/"||(b=S.pathname)!=null&&b.startsWith(p)||Rt(!1),w=S}else w=h;let x=w.pathname||"/",v=x;if(p!=="/"){let S=p.replace(/^\//,"").split("/");v="/"+x.replace(/^\//,"").split("/").slice(S.length).join("/")}let k=r0(r,{pathname:v}),g=F0(k&&k.map(S=>Object.assign({},S,{params:Object.assign({},f,S.params),pathname:Mn([p,c.encodeLocation?c.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?p:Mn([p,c.encodeLocation?c.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),l,n,o);return s&&g?T.createElement(zo.Provider,{value:{location:gi({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:mn.Pop}},g):g}function O0(){let r=z0(),s=j0(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),n=r instanceof Error?r.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},s),n?T.createElement("pre",{style:c},n):null,null)}const I0=T.createElement(O0,null);class L0 extends T.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,n){return n.location!==s.location||n.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:n.error,location:n.location,revalidation:s.revalidation||n.revalidation}}componentDidCatch(s,n){console.error("React Router caught the following error during render",s,n)}render(){return this.state.error!==void 0?T.createElement(Wn.Provider,{value:this.props.routeContext},T.createElement(Th.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function D0(r){let{routeContext:s,match:n,children:o}=r,c=T.useContext(hc);return c&&c.static&&c.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=n.route.id),T.createElement(Wn.Provider,{value:s},o)}function F0(r,s,n,o){var c;if(s===void 0&&(s=[]),n===void 0&&(n=null),o===void 0&&(o=null),r==null){var l;if(!n)return null;if(n.errors)r=n.matches;else if((l=o)!=null&&l.v7_partialHydration&&s.length===0&&!n.initialized&&n.matches.length>0)r=n.matches;else return null}let d=r,f=(c=n)==null?void 0:c.errors;if(f!=null){let w=d.findIndex(b=>b.route.id&&f?.[b.route.id]!==void 0);w>=0||Rt(!1),d=d.slice(0,Math.min(d.length,w+1))}let p=!1,h=-1;if(n&&o&&o.v7_partialHydration)for(let w=0;w<d.length;w++){let b=d[w];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(h=w),b.route.id){let{loaderData:x,errors:v}=n,k=b.route.loader&&x[b.route.id]===void 0&&(!v||v[b.route.id]===void 0);if(b.route.lazy||k){p=!0,h>=0?d=d.slice(0,h+1):d=[d[0]];break}}}return d.reduceRight((w,b,x)=>{let v,k=!1,g=null,S=null;n&&(v=f&&b.route.id?f[b.route.id]:void 0,g=b.route.errorElement||I0,p&&(h<0&&x===0?(W0("route-fallback"),k=!0,S=null):h===x&&(k=!0,S=b.route.hydrateFallbackElement||null)));let C=s.concat(d.slice(0,x+1)),R=()=>{let I;return v?I=g:k?I=S:b.route.Component?I=T.createElement(b.route.Component,null):b.route.element?I=b.route.element:I=w,T.createElement(D0,{match:b,routeContext:{outlet:w,matches:C,isDataRoute:n!=null},children:I})};return n&&(b.route.ErrorBoundary||b.route.errorElement||x===0)?T.createElement(L0,{location:n.location,revalidation:n.revalidation,component:g,error:v,children:R(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):R()},null)}var Oh=(function(r){return r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r})(Oh||{}),Ih=(function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r})(Ih||{});function B0(r){let s=T.useContext(hc);return s||Rt(!1),s}function M0(r){let s=T.useContext(_0);return s||Rt(!1),s}function U0(r){let s=T.useContext(Wn);return s||Rt(!1),s}function Lh(r){let s=U0(),n=s.matches[s.matches.length-1];return n.route.id||Rt(!1),n.route.id}function z0(){var r;let s=T.useContext(Th),n=M0(),o=Lh();return s!==void 0?s:(r=n.errors)==null?void 0:r[o]}function $0(){let{router:r}=B0(Oh.UseNavigateStable),s=Lh(Ih.UseNavigateStable),n=T.useRef(!1);return Ph(()=>{n.current=!0}),T.useCallback(function(c,l){l===void 0&&(l={}),n.current&&(typeof c=="number"?r.navigate(c):r.navigate(c,gi({fromRouteId:s},l)))},[r,s])}const Sf={};function W0(r,s,n){Sf[r]||(Sf[r]=!0)}function V0(r,s){r?.v7_startTransition,r?.v7_relativeSplatPath}function Jl(r){Rt(!1)}function H0(r){let{basename:s="/",children:n=null,location:o,navigationType:c=mn.Pop,navigator:l,static:d=!1,future:f}=r;$o()&&Rt(!1);let p=s.replace(/^\/*/,"/"),h=T.useMemo(()=>({basename:p,navigator:l,static:d,future:gi({v7_relativeSplatPath:!1},f)}),[p,f,l,d]);typeof o=="string"&&(o=$n(o));let{pathname:w="/",search:b="",hash:x="",state:v=null,key:k="default"}=o,g=T.useMemo(()=>{let S=Ah(w,p);return S==null?null:{location:{pathname:S,search:b,hash:x,state:v,key:k},navigationType:c}},[p,w,b,x,v,k,c]);return g==null?null:T.createElement(Uo.Provider,{value:h},T.createElement(zo.Provider,{children:n,value:g}))}function q0(r){let{children:s,location:n}=r;return T0(ec(s),n)}new Promise(()=>{});function ec(r,s){s===void 0&&(s=[]);let n=[];return T.Children.forEach(r,(o,c)=>{if(!T.isValidElement(o))return;let l=[...s,c];if(o.type===T.Fragment){n.push.apply(n,ec(o.props.children,l));return}o.type!==Jl&&Rt(!1),!o.props.index||!o.props.children||Rt(!1);let d={id:o.props.id||l.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=ec(o.props.children,l)),n.push(d)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const G0="6";try{window.__reactRouterVersion=G0}catch{}const K0="startTransition",Cf=lg[K0];function Q0(r){let{basename:s,children:n,future:o,window:c}=r,l=T.useRef();l.current==null&&(l.current=Jg({window:c,v5Compat:!0}));let d=l.current,[f,p]=T.useState({action:d.action,location:d.location}),{v7_startTransition:h}=o||{},w=T.useCallback(b=>{h&&Cf?Cf(()=>p(b)):p(b)},[p,h]);return T.useLayoutEffect(()=>d.listen(w),[d,w]),T.useEffect(()=>V0(o),[o]),T.createElement(H0,{basename:s,children:n,location:f.location,navigationType:f.action,navigator:d,future:o})}var Nf;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher",r.useViewTransitionState="useViewTransitionState"})(Nf||(Nf={}));var jf;(function(r){r.UseFetcher="useFetcher",r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(jf||(jf={}));const Dh=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),X0=({className:r})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),xi=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),gc=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),Zt=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),yc=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),Fh=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:r,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})}),Bh=({className:r,filled:s})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:s?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.5 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"})}),yi=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Mh=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Uh=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0l-.07.07m15.482 0l.07.07m0 0l-1.018.51a51.011 51.011 0 01-4.456 2.054A51.011 51.011 0 0112 15.342a51.011 51.011 0 01-4.456-2.054l-1.018-.51m0 0l-1.018.51a51.011 51.011 0 01-4.456 2.054A51.011 51.011 0 0112 15.342a51.011 51.011 0 01-4.456-2.054l-1.018-.51"})}),Z0=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 13.5V3.75m0 9.75a1.5 1.5 0 010 3m0-3a1.5 1.5 0 000 3m0 3.75V16.5m12-3V3.75m0 9.75a1.5 1.5 0 010 3m0-3a1.5 1.5 0 000 3m0 3.75V16.5m-6-9V3.75m0 3.75a1.5 1.5 0 010 3m0-3a1.5 1.5 0 000 3m0 9.75V10.5"})}),Y0=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),zh=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z"})}),J0=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-6-13.5v13.5"})}),ey=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"})}),ty=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:r,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})}),$h=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),ry=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"})}),ny=({className:r})=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 01-.354-17.995M12 21a9 9 0 009-9M12 21a9 9 0 00-9-9M12 3c-4.418 0-8 2.015-8 4.5S7.582 12 12 12s8-2.015 8-4.5S16.418 3 12 3z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 01-9 9"})]}),sy=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})}),iy=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),oy=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536L16.732 3.732z"})}),ay=({className:r})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),ly=({onBack:r})=>a.jsxs("div",{className:"container mx-auto p-4 md:p-8 text-white min-h-screen",children:[a.jsx("header",{className:"mb-8",children:a.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 text-slate-300 hover:text-sky-400 transition-colors",children:[a.jsx(xi,{className:"w-5 h-5"}),a.jsx("span",{children:"Back to Library"})]})}),a.jsxs("main",{className:"max-w-4xl mx-auto space-y-8",children:[a.jsxs("section",{className:"bg-slate-800/80 rounded-xl shadow-lg p-6 border border-slate-700",children:[a.jsx("h1",{className:"text-3xl font-bold text-sky-300 mb-2",children:"About MeBooks"}),a.jsxs("p",{className:"text-lg text-slate-300 mb-4",children:[a.jsx("span",{className:"font-semibold text-sky-200",children:"MeBooks"})," is a modern, browser-based ebook reader inspired by the user experience of Readium's Thorium, but built entirely with web technologies. EPUB books are rendered using ",a.jsx("span",{className:"font-semibold",children:"epub.js"}),", and PDF books are rendered using an embedded distribution of ",a.jsx("span",{className:"font-semibold",children:"pdf.js"})," via ",a.jsx("span",{className:"font-semibold",children:"react-pdf"})," and ",a.jsx("span",{className:"font-semibold",children:"pdfjs-dist"}),". Import EPUB and PDF books into your local library, or browse and download from online OPDS catalogs. Built with accessibility, privacy, and customization in mind."]})]}),a.jsxs("section",{className:"grid md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-slate-800/80 rounded-xl shadow p-6 border border-slate-700 flex flex-col gap-2",children:[a.jsxs("h2",{className:"text-xl font-semibold text-sky-300 flex items-center gap-2 mb-2",children:["Accessibility & A11Y",a.jsx("span",{className:"bg-sky-900 text-sky-200 text-xs font-bold px-2 py-1 rounded ml-2",children:"WCAG 2.1 AA"})]}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-200",children:[a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Keyboard Navigation:"})," Logical tab order, visible focus, and full keyboard support."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Screen Reader Support:"})," ARIA labels, live regions, and dynamic announcements."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"High Contrast & Color Blind Friendly:"})," Tested palette and contrast ratios."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Skip Links & Landmarks:"})," Quick navigation for assistive tech users."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Accessible Modals & Dialogs:"})," Focus management, ARIA roles, and announcements."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Global Keyboard Shortcuts:"})," Discoverable, accessible shortcuts for power users."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Adjustable Font Size & Family:"})," Reader settings for easy text customization."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Responsive Design:"})," Works on all devices and screen sizes."]})]}),a.jsx("div",{className:"mt-3",children:a.jsx("a",{href:"/JamesEnglish1028-My-Ebook-Reader/VPAT.html",target:"_blank",rel:"noopener noreferrer",className:"block bg-sky-900/80 border border-sky-700 rounded px-4 py-2 text-sky-300 font-semibold text-center hover:bg-sky-800 transition",children:"Accessibility VPAT (Voluntary Product Accessibility Template)"})})]}),a.jsxs("div",{className:"bg-slate-800/80 rounded-xl shadow p-6 border border-slate-700 flex flex-col gap-2",children:[a.jsx("h2",{className:"text-xl font-semibold text-sky-300 mb-2",children:"Library Management"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-200",children:[a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Local-First Storage:"})," Your books and reading data never leave your computer. Book files are stored in IndexedDB, settings and annotations in LocalStorage."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"EPUB & PDF Import:"})," Build your personal library with ",a.jsx("code",{children:".epub"})," and ",a.jsx("code",{children:".pdf"})," files."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Book Details:"})," View publication info, subjects, and provider IDs."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Library Organization:"})," Sort by title, author, publication date, or date added."]})]})]})]}),a.jsxs("section",{className:"grid md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-slate-800/80 rounded-xl shadow p-6 border border-slate-700 flex flex-col gap-2",children:[a.jsx("h2",{className:"text-xl font-semibold text-sky-300 mb-2",children:"Online Catalogs (OPDS)"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-200",children:[a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Browse Remote Libraries:"})," Add and manage unlimited public OPDS catalogs."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"OPDS v1 & v2 Support:"})," Compatible with XML (Atom) and JSON feeds."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"One-Click Import:"})," Download books directly from catalogs to your library."]})]})]}),a.jsxs("div",{className:"bg-slate-800/80 rounded-xl shadow p-6 border border-slate-700 flex flex-col gap-2",children:[a.jsx("h2",{className:"text-xl font-semibold text-sky-300 mb-2",children:"Advanced Reader Experience"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-200",children:[a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Browser-Based:"})," No installation neededruns entirely in your browser."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Multi-Format Support:"})," Read EPUB files with ",a.jsx("span",{className:"font-semibold",children:"epub.js"})," and PDF files with an embedded ",a.jsx("span",{className:"font-semibold",children:"pdf.js"})," engine (",a.jsx("span",{className:"font-semibold",children:"react-pdf"})," + ",a.jsx("span",{className:"font-semibold",children:"pdfjs-dist"}),")."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Advanced Navigation:"})," Both readers support table of contents navigation, page jumping, and keyboard shortcuts for moving between chapters or pages."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Full-Text Search:"})," EPUB and PDF readers both support searching the entire book text, with results highlighted and easy navigation between matches."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Customizable Reader (EPUB):"})," Adjust font, theme, and reading mode (paginated or scrolled)."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Rich Tools (EPUB):"})," Bookmarks with notes, academic citation generation, and full-text search."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Citation Export (EPUB):"})," Export citations in ",a.jsx("code",{children:".ris"})," format for Zotero/EndNote."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Read Aloud (EPUB):"})," Text-to-speech with synchronized highlighting."]})]})]})]}),a.jsxs("section",{className:"bg-slate-800/80 rounded-xl shadow-lg p-6 border border-slate-700",children:[a.jsx("h2",{className:"text-xl font-semibold text-sky-300 mb-2",children:"Technology Stack"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-200",children:[a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"React:"})," Component-based UI library."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"TypeScript:"})," Static typing for maintainable code."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"TailwindCSS:"})," Utility-first CSS for rapid styling."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"epub.js:"})," EPUB parsing and rendering."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"pdf.js:"})," PDF rendering (via ",a.jsx("span",{className:"font-semibold",children:"react-pdf"})," and ",a.jsx("span",{className:"font-semibold",children:"pdfjs-dist"}),")."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"JSZip:"})," EPUB unzipping (via ",a.jsx("code",{children:"epub.js"}),")."]})]}),a.jsx("p",{className:"mt-2 text-slate-400",children:"All external dependencies are loaded from a CDN for simplicity."})]}),a.jsxs("section",{className:"bg-slate-800/80 rounded-xl shadow-lg p-6 border border-slate-700 mt-8",children:[a.jsx("h2",{className:"text-xl font-semibold text-sky-300 mb-2",children:"For Developers"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-slate-200",children:[a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Vite:"})," Lightning-fast build tool and dev server for modern web apps."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"React Router:"})," Declarative routing for SPA navigation."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"React-PDF:"})," PDF rendering in React using pdf.js."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"TanStack Query:"})," Powerful data fetching and caching (if used)."]}),a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold",children:"Other modern libraries:"})," Includes utility packages and accessibility helpers as needed."]})]}),a.jsxs("p",{className:"mt-2 text-slate-400",children:["See the ",a.jsx("code",{children:"package.json"})," for a full list of dependencies and scripts."]})]})]})]}),Ef={CATALOGS:"ebook-catalogs",REGISTRIES:"ebook-reader-registries"},pn={GLOBAL_SETTINGS:"ebook-reader-settings-global",BOOKMARKS_PREFIX:"ebook-reader-bookmarks",CITATIONS_PREFIX:"ebook-reader-citations",POSITION_PREFIX:"ebook-reader-pos",SPOKEN_POSITION_PREFIX:"ebook-reader-spoken-pos",PDF_VIEW_STATE_PREFIX:"ebook-reader-pdf-view-state",EPUB_VIEW_STATE_PREFIX:"ebook-reader-epub-view-state"},cy={ETAG_CACHE_PREFIX:"mebooks.opds.etag"},St={bookmarks:r=>`${pn.BOOKMARKS_PREFIX}-${String(r)}`,citations:r=>`${pn.CITATIONS_PREFIX}-${String(r)}`,position:r=>`${pn.POSITION_PREFIX}-${String(r)}`,spokenPosition:r=>`${pn.SPOKEN_POSITION_PREFIX}-${String(r)}`,pdfViewState:r=>`${pn.PDF_VIEW_STATE_PREFIX}-${String(r)}`,epubViewState:r=>`${pn.EPUB_VIEW_STATE_PREFIX}-${String(r)}`,etag:r=>`${cy.ETAG_CACHE_PREFIX}-${r}`},Wh="EbookReaderDB",Ze="books",Vh=3,Ht={TITLE:"title",ISBN:"isbn",PROVIDER_ID:"providerId"},uy={BASE_URL:"/My-Ebook-Reader/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_GOOGLE_CLIENT_ID:"970895595671-06di7pi5bs5hi96o9js5jr1eeo2pigm7.apps.googleusercontent.com",VITE_OWN_PROXY_URL:"https://mebooks-proxy-worker.jce1028.workers.dev/"};class dy{isDebugMode(){if(typeof window<"u"&&window.__MEBOOKS_DEBUG__)return!0;try{const s=uy;return s?.DEV||s?.VITE_DEBUG_LOGGING==="true"}catch{return!1}}shouldLog(s){return s==="error"||s==="warn"?!0:this.isDebugMode()}debug(s,...n){this.shouldLog("debug")&&console.debug(`[mebooks:debug] ${s}`,...n)}info(s,...n){this.shouldLog("info")&&console.info(`[mebooks:info] ${s}`,...n)}warn(s,...n){this.shouldLog("warn")&&console.warn(`[mebooks:warn] ${s}`,...n)}error(s,...n){this.shouldLog("error")&&console.error(`[mebooks:error] ${s}`,...n)}log(s,...n){this.isDebugMode()&&console.log(`[mebooks] ${s}`,...n)}}const ne=new dy;class fy{safeParse(s,n){if(!s)return n;try{return JSON.parse(s)}catch(o){return ne.warn("Failed to parse bookmark JSON, using fallback",o),n}}findByBookId(s){try{ne.info("Finding bookmarks for book",{bookId:s});const n=St.bookmarks(s),o=localStorage.getItem(n),c=this.safeParse(o,[]);return ne.info("Found bookmarks",{bookId:s,count:c.length}),{success:!0,data:c}}catch(n){const o=n instanceof Error?n.message:"Unknown error finding bookmarks";return ne.error("Error finding bookmarks:",o),{success:!1,error:o}}}findById(s,n){try{const o=this.findByBookId(s);return o.success?{success:!0,data:o.data.find(l=>l.id===n)||null}:{success:!1,error:"Failed to find bookmarks"}}catch(o){const c=o instanceof Error?o.message:"Unknown error finding bookmark";return ne.error("Error finding bookmark by ID:",c),{success:!1,error:c}}}add(s,n){try{ne.info("Adding bookmark",{bookId:s,cfi:n.cfi});const o=this.findByBookId(s);if(!o.success)return{success:!1,error:"Failed to retrieve bookmarks"};const c={id:new Date().toISOString(),cfi:n.cfi,label:n.label||"Bookmark",chapter:n.chapter,description:n.description,createdAt:Date.now()},l=[...o.data,c];return this.saveAll(s,l).success?(ne.info("Bookmark added",{bookId:s,bookmarkId:c.id}),{success:!0,data:c}):{success:!1,error:"Failed to save bookmark"}}catch(o){const c=o instanceof Error?o.message:"Unknown error adding bookmark";return ne.error("Error adding bookmark:",c),{success:!1,error:c}}}update(s,n,o){try{ne.info("Updating bookmark",{bookId:s,bookmarkId:n});const c=this.findByBookId(s);if(!c.success)return{success:!1,error:"Failed to retrieve bookmarks"};const l=c.data,d=l.findIndex(h=>h.id===n);if(d===-1)return{success:!1,error:"Bookmark not found"};const f={...l[d],...o};return l[d]=f,this.saveAll(s,l).success?(ne.info("Bookmark updated",{bookId:s,bookmarkId:n}),{success:!0,data:f}):{success:!1,error:"Failed to save updated bookmark"}}catch(c){const l=c instanceof Error?c.message:"Unknown error updating bookmark";return ne.error("Error updating bookmark:",l),{success:!1,error:l}}}delete(s,n){try{ne.info("Deleting bookmark",{bookId:s,bookmarkId:n});const o=this.findByBookId(s);if(!o.success)return{success:!1,error:"Failed to retrieve bookmarks"};const c=o.data.filter(d=>d.id!==n);return c.length===o.data.length?{success:!1,error:"Bookmark not found"}:this.saveAll(s,c).success?(ne.info("Bookmark deleted",{bookId:s,bookmarkId:n}),{success:!0,data:void 0}):{success:!1,error:"Failed to save after deletion"}}catch(o){const c=o instanceof Error?o.message:"Unknown error deleting bookmark";return ne.error("Error deleting bookmark:",c),{success:!1,error:c}}}deleteAll(s){try{ne.warn("Deleting all bookmarks for book",{bookId:s});const n=St.bookmarks(s);return localStorage.removeItem(n),ne.info("All bookmarks deleted",{bookId:s}),{success:!0,data:void 0}}catch(n){const o=n instanceof Error?n.message:"Unknown error deleting all bookmarks";return ne.error("Error deleting all bookmarks:",o),{success:!1,error:o}}}count(s){try{const n=this.findByBookId(s);return n.success?{success:!0,data:n.data.length}:{success:!1,error:"Failed to count bookmarks"}}catch(n){const o=n instanceof Error?n.message:"Unknown error counting bookmarks";return ne.error("Error counting bookmarks:",o),{success:!1,error:o}}}existsAtCfi(s,n){try{const o=this.findByBookId(s);return o.success?{success:!0,data:o.data.some(l=>l.cfi===n)}:{success:!1,error:"Failed to check bookmark existence"}}catch(o){const c=o instanceof Error?o.message:"Unknown error checking bookmark existence";return ne.error("Error checking bookmark existence:",c),{success:!1,error:c}}}findByChapter(s,n){try{ne.info("Finding bookmarks by chapter",{bookId:s,chapter:n});const o=this.findByBookId(s);if(!o.success)return{success:!1,error:"Failed to find bookmarks by chapter"};const c=o.data.filter(l=>l.chapter===n);return ne.info("Found bookmarks by chapter",{bookId:s,chapter:n,count:c.length}),{success:!0,data:c}}catch(o){const c=o instanceof Error?o.message:"Unknown error finding bookmarks by chapter";return ne.error("Error finding bookmarks by chapter:",c),{success:!1,error:c}}}findSortedByDate(s){try{const n=this.findByBookId(s);return n.success?{success:!0,data:[...n.data].sort((c,l)=>l.createdAt-c.createdAt)}:{success:!1,error:"Failed to sort bookmarks"}}catch(n){const o=n instanceof Error?n.message:"Unknown error sorting bookmarks";return ne.error("Error sorting bookmarks:",o),{success:!1,error:o}}}saveAll(s,n){try{const o=St.bookmarks(s);return localStorage.setItem(o,JSON.stringify(n)),{success:!0,data:void 0}}catch(o){const c=o instanceof Error?o.message:"Unknown error saving bookmarks";return ne.error("Error saving bookmarks:",c),{success:!1,error:c}}}exportBookmarks(s){try{const n=this.findByBookId(s);if(!n.success)return{success:!1,error:"Failed to export bookmarks"};const o=JSON.stringify(n.data,null,2);return ne.info("Bookmarks exported",{bookId:s,count:n.data.length}),{success:!0,data:o}}catch(n){const o=n instanceof Error?n.message:"Unknown error exporting bookmarks";return ne.error("Error exporting bookmarks:",o),{success:!1,error:o}}}importBookmarks(s,n,o=!1){try{ne.info("Importing bookmarks",{bookId:s,merge:o});const c=this.safeParse(n,[]);if(!Array.isArray(c))return{success:!1,error:"Invalid bookmark data format"};let l=c;if(o){const f=this.findByBookId(s);if(!f.success)return{success:!1,error:"Failed to merge bookmarks"};const p=new Set(f.data.map(w=>w.id)),h=c.filter(w=>!p.has(w.id));l=[...f.data,...h]}return this.saveAll(s,l).success?(ne.info("Bookmarks imported",{bookId:s,count:c.length,totalCount:l.length}),{success:!0,data:c.length}):{success:!1,error:"Failed to save imported bookmarks"}}catch(c){const l=c instanceof Error?c.message:"Unknown error importing bookmarks";return ne.error("Error importing bookmarks:",l),{success:!1,error:l}}}}const ui=new fy;class hy{safeParse(s,n){if(!s)return n;try{return JSON.parse(s)}catch(o){return ne.warn("Failed to parse citation JSON, using fallback",o),n}}findByBookId(s){try{ne.info("Finding citations for book",{bookId:s});const n=St.citations(s),o=localStorage.getItem(n),c=this.safeParse(o,[]);return ne.info("Found citations",{bookId:s,count:c.length}),{success:!0,data:c}}catch(n){const o=n instanceof Error?n.message:"Unknown error finding citations";return ne.error("Error finding citations:",o),{success:!1,error:o}}}findById(s,n){try{const o=this.findByBookId(s);return o.success?{success:!0,data:o.data.find(l=>l.id===n)||null}:{success:!1,error:"Failed to find citations"}}catch(o){const c=o instanceof Error?o.message:"Unknown error finding citation";return ne.error("Error finding citation by ID:",c),{success:!1,error:c}}}add(s,n){try{ne.info("Adding citation",{bookId:s,cfi:n.cfi});const o=this.findByBookId(s);if(!o.success)return{success:!1,error:"Failed to retrieve citations"};const c={id:new Date().toISOString(),cfi:n.cfi,note:n.note,createdAt:Date.now(),pageNumber:n.pageNumber,chapter:n.chapter,citationFormat:n.citationFormat||"apa"},l=[...o.data,c];return this.saveAll(s,l).success?(ne.info("Citation added",{bookId:s,citationId:c.id}),{success:!0,data:c}):{success:!1,error:"Failed to save citation"}}catch(o){const c=o instanceof Error?o.message:"Unknown error adding citation";return ne.error("Error adding citation:",c),{success:!1,error:c}}}update(s,n,o){try{ne.info("Updating citation",{bookId:s,citationId:n});const c=this.findByBookId(s);if(!c.success)return{success:!1,error:"Failed to retrieve citations"};const l=c.data,d=l.findIndex(h=>h.id===n);if(d===-1)return{success:!1,error:"Citation not found"};const f={...l[d],...o};return l[d]=f,this.saveAll(s,l).success?(ne.info("Citation updated",{bookId:s,citationId:n}),{success:!0,data:f}):{success:!1,error:"Failed to save updated citation"}}catch(c){const l=c instanceof Error?c.message:"Unknown error updating citation";return ne.error("Error updating citation:",l),{success:!1,error:l}}}delete(s,n){try{ne.info("Deleting citation",{bookId:s,citationId:n});const o=this.findByBookId(s);if(!o.success)return{success:!1,error:"Failed to retrieve citations"};const c=o.data.filter(d=>d.id!==n);return c.length===o.data.length?{success:!1,error:"Citation not found"}:this.saveAll(s,c).success?(ne.info("Citation deleted",{bookId:s,citationId:n}),{success:!0,data:void 0}):{success:!1,error:"Failed to save after deletion"}}catch(o){const c=o instanceof Error?o.message:"Unknown error deleting citation";return ne.error("Error deleting citation:",c),{success:!1,error:c}}}deleteAll(s){try{ne.warn("Deleting all citations for book",{bookId:s});const n=St.citations(s);return localStorage.removeItem(n),ne.info("All citations deleted",{bookId:s}),{success:!0,data:void 0}}catch(n){const o=n instanceof Error?n.message:"Unknown error deleting all citations";return ne.error("Error deleting all citations:",o),{success:!1,error:o}}}count(s){try{const n=this.findByBookId(s);return n.success?{success:!0,data:n.data.length}:{success:!1,error:"Failed to count citations"}}catch(n){const o=n instanceof Error?n.message:"Unknown error counting citations";return ne.error("Error counting citations:",o),{success:!1,error:o}}}findByChapter(s,n){try{ne.info("Finding citations by chapter",{bookId:s,chapter:n});const o=this.findByBookId(s);if(!o.success)return{success:!1,error:"Failed to find citations by chapter"};const c=o.data.filter(l=>l.chapter===n);return ne.info("Found citations by chapter",{bookId:s,chapter:n,count:c.length}),{success:!0,data:c}}catch(o){const c=o instanceof Error?o.message:"Unknown error finding citations by chapter";return ne.error("Error finding citations by chapter:",c),{success:!1,error:c}}}findSortedByDate(s){try{const n=this.findByBookId(s);return n.success?{success:!0,data:[...n.data].sort((c,l)=>l.createdAt-c.createdAt)}:{success:!1,error:"Failed to sort citations"}}catch(n){const o=n instanceof Error?n.message:"Unknown error sorting citations";return ne.error("Error sorting citations:",o),{success:!1,error:o}}}saveAll(s,n){try{const o=St.citations(s);return localStorage.setItem(o,JSON.stringify(n)),{success:!0,data:void 0}}catch(o){const c=o instanceof Error?o.message:"Unknown error saving citations";return ne.error("Error saving citations:",c),{success:!1,error:c}}}formatCitation(s,n,o="apa"){const c=o||n.citationFormat||"apa",l=s.author||"Unknown Author",d=s.title||"Untitled",f=s.publisher||"",p=this.getPublicationYear(s.publicationDate),h=n.chapter?`, ${n.chapter}`:"",w=n.pageNumber?`, p. ${n.pageNumber}`:"";let b="";switch(c.toLowerCase()){case"apa":b=`${this.formatAuthorName(l,"apa")} (${p}). ${d}. ${f}${h}${w}.`.trim();break;case"mla":b=`${l}. ${d}. ${f}, ${p}${h}${w}.`.trim();break;default:b=`${this.formatAuthorName(l,"apa")} (${p}). ${d}. ${f}${h}${w}.`.trim();break}return{text:b,format:c}}getPublicationYear(s){if(!s)return"n.d.";const n=s.match(/\d{4}/);return n?n[0]:"n.d."}formatAuthorName(s,n){const o=s.split(" ").filter(d=>d.trim());if(o.length<2)return s;const c=o.pop(),l=o;if(n==="apa"){const d=l.map(f=>f[0]?`${f[0]}.`:"").join(" ");return`${c}, ${d}`}return`${c}, ${l.join(" ")}`}exportCitations(s){try{const n=this.findByBookId(s);if(!n.success)return{success:!1,error:"Failed to export citations"};const o=JSON.stringify(n.data,null,2);return ne.info("Citations exported",{bookId:s,count:n.data.length}),{success:!0,data:o}}catch(n){const o=n instanceof Error?n.message:"Unknown error exporting citations";return ne.error("Error exporting citations:",o),{success:!1,error:o}}}importCitations(s,n,o=!1){try{ne.info("Importing citations",{bookId:s,merge:o});const c=this.safeParse(n,[]);if(!Array.isArray(c))return{success:!1,error:"Invalid citation data format"};let l=c;if(o){const f=this.findByBookId(s);if(!f.success)return{success:!1,error:"Failed to merge citations"};const p=new Set(f.data.map(w=>w.id)),h=c.filter(w=>!p.has(w.id));l=[...f.data,...h]}return this.saveAll(s,l).success?(ne.info("Citations imported",{bookId:s,count:c.length,totalCount:l.length}),{success:!0,data:c.length}):{success:!1,error:"Failed to save imported citations"}}catch(c){const l=c instanceof Error?c.message:"Unknown error importing citations";return ne.error("Error importing citations:",l),{success:!1,error:l}}}}const fi=new hy;class py{getPosition(s){try{ne.info("Getting position for book",{bookId:s});const n=St.position(s),o=localStorage.getItem(n);return o?ne.info("Found position",{bookId:s,cfi:o.substring(0,50)+"..."}):ne.info("No position found",{bookId:s}),{success:!0,data:o}}catch(n){const o=n instanceof Error?n.message:"Unknown error getting position";return ne.error("Error getting position:",o),{success:!1,error:o}}}savePosition(s,n){try{ne.info("Saving position for book",{bookId:s,cfi:n.substring(0,50)+"..."});const o=St.position(s);return localStorage.setItem(o,n),ne.info("Position saved",{bookId:s}),{success:!0,data:void 0}}catch(o){const c=o instanceof Error?o.message:"Unknown error saving position";return ne.error("Error saving position:",c),{success:!1,error:c}}}clearPosition(s){try{ne.info("Clearing position for book",{bookId:s});const n=St.position(s);return localStorage.removeItem(n),ne.info("Position cleared",{bookId:s}),{success:!0,data:void 0}}catch(n){const o=n instanceof Error?n.message:"Unknown error clearing position";return ne.error("Error clearing position:",o),{success:!1,error:o}}}hasPosition(s){try{const n=this.getPosition(s);return n.success?{success:!0,data:n.data!==null}:{success:!1,error:"Failed to check position"}}catch(n){const o=n instanceof Error?n.message:"Unknown error checking position";return ne.error("Error checking position:",o),{success:!1,error:o}}}getReadingPosition(s){try{const n=this.getPosition(s);return n.success?n.data?{success:!0,data:{bookId:s,cfi:n.data,updatedAt:Date.now()}}:{success:!0,data:null}:{success:!1,error:"Failed to get reading position"}}catch(n){const o=n instanceof Error?n.message:"Unknown error getting reading position";return ne.error("Error getting reading position:",o),{success:!1,error:o}}}getSpeechPosition(s){try{ne.info("Getting speech position for book",{bookId:s});const n=St.spokenPosition(s),o=localStorage.getItem(n);return o?ne.info("Found speech position",{bookId:s,cfi:o.substring(0,50)+"..."}):ne.info("No speech position found",{bookId:s}),{success:!0,data:o}}catch(n){const o=n instanceof Error?n.message:"Unknown error getting speech position";return ne.error("Error getting speech position:",o),{success:!1,error:o}}}saveSpeechPosition(s,n){try{ne.info("Saving speech position for book",{bookId:s,cfi:n.substring(0,50)+"..."});const o=St.spokenPosition(s);return localStorage.setItem(o,n),ne.info("Speech position saved",{bookId:s}),{success:!0,data:void 0}}catch(o){const c=o instanceof Error?o.message:"Unknown error saving speech position";return ne.error("Error saving speech position:",c),{success:!1,error:c}}}clearSpeechPosition(s){try{ne.info("Clearing speech position for book",{bookId:s});const n=St.spokenPosition(s);return localStorage.removeItem(n),ne.info("Speech position cleared",{bookId:s}),{success:!0,data:void 0}}catch(n){const o=n instanceof Error?n.message:"Unknown error clearing speech position";return ne.error("Error clearing speech position:",o),{success:!1,error:o}}}clearAllPositions(s){try{ne.info("Clearing all positions for book",{bookId:s});const n=this.clearPosition(s),o=this.clearSpeechPosition(s);return!n.success||!o.success?{success:!1,error:"Failed to clear all positions"}:(ne.info("All positions cleared",{bookId:s}),{success:!0,data:void 0})}catch(n){const o=n instanceof Error?n.message:"Unknown error clearing all positions";return ne.error("Error clearing all positions:",o),{success:!1,error:o}}}calculateProgress(s,n){if(n===0)return 0;const o=s/n*100;return Math.round(Math.max(0,Math.min(100,o)))}createLocationInfo(s,n,o){const c=o!==void 0?o:this.calculateProgress(s,n);return{currentPage:s,totalPages:n,progress:c}}formatLocationInfo(s){return`Page ${s.currentPage} of ${s.totalPages} (${s.progress}%)`}formatPageLabel(s){return`Page ${s.currentPage}`}formatPageWithProgress(s){return`Page ${s.currentPage} (${s.progress}%)`}getAllBooksWithPositions(){try{ne.info("Getting all books with positions");const s=[],n="reader_position_";for(let o=0;o<localStorage.length;o++){const c=localStorage.key(o);if(c&&c.startsWith(n)){const l=c.substring(n.length),d=parseInt(l,10);isNaN(d)||s.push(d)}}return ne.info("Found books with positions",{count:s.length}),{success:!0,data:s}}catch(s){const n=s instanceof Error?s.message:"Unknown error getting books with positions";return ne.error("Error getting books with positions:",n),{success:!1,error:n}}}exportAllPositions(){try{ne.info("Exporting all positions");const s=this.getAllBooksWithPositions();if(!s.success)return{success:!1,error:"Failed to export positions"};const n={};for(const c of s.data){const l=this.getPosition(c),d=this.getSpeechPosition(c);l.success&&d.success&&(n[c]={position:l.data,speechPosition:d.data})}const o=JSON.stringify(n,null,2);return ne.info("Positions exported",{bookCount:Object.keys(n).length}),{success:!0,data:o}}catch(s){const n=s instanceof Error?s.message:"Unknown error exporting positions";return ne.error("Error exporting positions:",n),{success:!1,error:n}}}importPositions(s,n=!1){try{ne.info("Importing positions",{merge:n});const o=JSON.parse(s);if(typeof o!="object"||o===null)return{success:!1,error:"Invalid positions data format"};if(!n){const l=this.getAllBooksWithPositions();if(l.success)for(const d of l.data)this.clearAllPositions(d)}let c=0;for(const[l,d]of Object.entries(o)){const f=parseInt(l,10);isNaN(f)||(d.position&&(this.savePosition(f,d.position),c++),d.speechPosition&&this.saveSpeechPosition(f,d.speechPosition))}return ne.info("Positions imported",{count:c}),{success:!0,data:c}}catch(o){const c=o instanceof Error?o.message:"Unknown error importing positions";return ne.error("Error importing positions:",c),{success:!1,error:c}}}clearAllBooksPositions(){try{ne.warn("Clearing all positions for all books");const s=this.getAllBooksWithPositions();if(!s.success)return{success:!1,error:"Failed to clear all positions"};let n=0;for(const o of s.data)this.clearAllPositions(o).success&&n++;return ne.info("All positions cleared",{count:n}),{success:!0,data:n}}catch(s){const n=s instanceof Error?s.message:"Unknown error clearing all positions";return ne.error("Error clearing all positions:",n),{success:!1,error:n}}}}const oi=new py,Hh=({book:r})=>{const s=c=>"downloadUrl"in c,n=c=>{const l=c.toUpperCase();return l==="PDF"?"bg-red-600":l==="AUDIOBOOK"?"bg-purple-600":"bg-sky-500"},o=s(r)&&r.alternativeFormats&&r.alternativeFormats.length>0?r.alternativeFormats.map((c,l)=>({key:`${r.title}-${c.format}-${l}`,format:c.format,mediaType:c.mediaType})):r.format?[{key:`${r.title}-${r.format}`,format:r.format,mediaType:null}]:[];return a.jsxs("div",{className:"flex gap-1 flex-wrap",children:[s(r)&&r.publicationTypeLabel&&a.jsx("span",{className:"inline-block text-xs font-bold px-2 py-0.5 rounded bg-green-700 text-white",title:`Publication Type: ${r.publicationTypeLabel}${r.schemaOrgType?" ("+r.schemaOrgType+")":""}`,children:r.publicationTypeLabel}),o.length>0&&o.map(c=>a.jsx("span",{className:`inline-block text-white text-[10px] font-bold px-2 py-0.5 rounded ${n(c.format)}`,title:c.mediaType?`Format: ${c.format}, MediaType: ${c.mediaType}`:`Format: ${c.format}`,children:c.format},c.key))]})},my=r=>{r.target.src="/default-cover.png"},_f=r=>{const s=new Date(r);return isNaN(s.getTime())?String(r):s.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})},gy=({libraryBook:r,bookmarks:s=[],citations:n=[],userCitationFormat:o})=>{function c(l,d){const f=new Blob([d],{type:"text/plain"}),p=URL.createObjectURL(f),h=document.createElement("a");h.href=p,h.download=l,document.body.appendChild(h),h.click(),setTimeout(()=>{document.body.removeChild(h),URL.revokeObjectURL(p)},0)}return a.jsxs("section",{className:"mt-8 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-slate-200 mb-2",children:"Bookmarks"}),s.length>0?a.jsx("ul",{className:"space-y-2",children:s.map((l,d)=>a.jsxs("li",{className:"bg-slate-800 rounded p-3 text-slate-300",children:[a.jsx("div",{className:"font-semibold",children:l.label||`Bookmark ${d+1}`}),l.description&&a.jsx("div",{className:"text-slate-400 text-sm mt-1",children:l.description}),l.chapter&&a.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Chapter: ",l.chapter]}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Created: ",_f(l.createdAt)]})]},l.id||d))}):a.jsx("div",{className:"text-slate-500 text-sm",children:"No bookmarks yet."})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-slate-200 mb-2 flex items-center justify-between",children:["Citations",a.jsx("button",{className:"ml-2 px-3 py-1 rounded bg-sky-700 text-white text-xs font-bold hover:bg-sky-600",onClick:()=>{const l=n.map(d=>`${d.note||""} [${d.chapter||""}${d.pageNumber?", p."+d.pageNumber:""}]`).join(`
`);c(`${r.title||"citations"}.ris`,l)},children:"Export to RIS"})]}),n.length>0?a.jsx("ul",{className:"space-y-2",children:n.map((l,d)=>{const p=(l.citationFormat||o||"apa")==="mla"?"mla":"apa",h=fi.formatCitation(r,l,p);return a.jsxs("li",{className:"bg-slate-800 rounded p-3 text-slate-300",children:[a.jsx("div",{className:"font-semibold mb-1",children:h.text}),l.note&&a.jsx("div",{className:"text-slate-400 text-sm mt-1",children:l.note}),l.chapter&&a.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Chapter: ",l.chapter]}),l.pageNumber&&a.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Page: ",l.pageNumber]}),a.jsxs("div",{className:"text-xs text-slate-500",children:["Created: ",_f(l.createdAt)]}),a.jsx("span",{className:"inline-block mt-2 px-2 py-0.5 rounded text-xs font-bold bg-sky-900 text-sky-300",children:h.format.toUpperCase()})]},l.id||d)})}):a.jsx("div",{className:"text-slate-500 text-sm",children:"No citations yet."})]})]})},yy=({book:r,onBack:s,source:n,catalogName:o,userCitationFormat:c="apa",onReadBook:l,onImportFromCatalog:d,importStatus:f,setImportStatus:p})=>{const h=r,w=typeof h.publisher=="string"?h.publisher:h.publisher?.name,b={id:h.id??0,title:r.title,author:r.author,coverImage:r.coverImage,publisher:w,publicationDate:h.publicationDate,providerId:h.providerId,providerName:h.providerName,description:h.description??h.summary??void 0,subjects:h.subjects,format:h.format,isbn:h.isbn,language:h.language,rights:h.rights,identifiers:Array.isArray(h.identifiers)?h.identifiers.map(L=>typeof L=="string"?L:L?.value).filter(Boolean):void 0,opfRaw:h.opfRaw,accessModes:h.accessModes,accessModesSufficient:h.accessModesSufficient,accessibilityFeatures:h.accessibilityFeatures,hazards:h.hazards,accessibilitySummary:h.accessibilitySummary,certificationConformsTo:h.certificationConformsTo,certification:h.certification,accessibilityFeedback:h.accessibilityFeedback},[x,v]=dt.useState([]),[k,g]=dt.useState([]);dt.useEffect(()=>{if(h.id){const L=ui.findByBookId(h.id);L.success&&v(L.data)}},[h.id]),dt.useEffect(()=>{if(h.id){const L=fi.findByBookId(h.id);L.success&&g(L.data)}},[h.id]);const S=T.useRef(null),C=()=>{l&&h.id&&l(r)},[R,I]=dt.useState(!1),[_,F]=dt.useState(!1),M=(()=>{const L=r.format?.toUpperCase(),B=h.mediaType?.toLowerCase();return L==="PDF"||L==="EPUB"||B==="application/pdf"||B==="application/epub+zip"})(),$=async()=>{if(!_){if(F(!0),d){const L=await d(r,o);L.success?I(!0):L.existingBook&&p&&p({isLoading:!1,message:"",error:`A book with the same identifier is already in your library: "${L.existingBook.title}".`})}F(!1)}};return a.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start px-4 md:px-12 md:pr-16",children:[a.jsxs("div",{className:"md:w-1/3 flex-shrink-0",children:[a.jsx(vy,{onBack:s,source:n}),a.jsx("div",{className:"mb-10"}),a.jsxs("div",{className:"mb-6 flex flex-col items-center",children:[r.coverImage?a.jsx("img",{ref:S,src:r.coverImage,alt:r.title,className:"w-full max-w-xs h-auto object-cover rounded-lg shadow-2xl aspect-[2/3] mb-4",onError:my}):a.jsx("div",{className:"w-full max-w-xs flex items-center justify-center p-4 text-center text-slate-400 bg-slate-800 rounded-lg aspect-[2/3] shadow-2xl",children:a.jsx("span",{className:"font-semibold",children:r.title})}),n==="library"?a.jsx("button",{className:"mt-2 px-4 py-2 rounded bg-sky-700 text-white font-bold hover:bg-sky-600",onClick:C,children:"Read Book"}):a.jsx("button",{className:"mt-2 px-4 py-2 rounded bg-sky-700 text-white font-bold hover:bg-sky-600 disabled:opacity-60 disabled:cursor-not-allowed",onClick:$,disabled:_||!M,children:_?"Importing...":M?"Import to My Library":"Cannot Import: Not EPUB or PDF"}),R&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-slate-900 bg-opacity-90 p-8 rounded-lg shadow-2xl flex flex-col items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-sky-400 mb-4",children:"Import Successful!"}),a.jsx("p",{className:"text-slate-200 mb-6",children:"The book has been imported to your library."}),a.jsx("button",{className:"px-4 py-2 rounded bg-sky-700 text-white font-bold hover:bg-sky-600",onClick:()=>I(!1),children:"Close"})]})})]}),a.jsx("div",{className:"w-full max-w-xs mx-auto",children:a.jsx(gy,{libraryBook:b,bookmarks:x,citations:k,userCitationFormat:c})})]}),a.jsxs("div",{className:"md:w-2/3 mt-8 md:mt-0",children:[a.jsxs("div",{className:"mb-6 mt-10 flex flex-col justify-start",children:[a.jsx("h2",{className:"text-4xl md:text-5xl font-extrabold text-slate-100 mb-6 leading-tight mt-0",children:r.title}),r.author&&a.jsxs("div",{className:"mb-2 text-lg text-slate-400",children:["By ",r.author]}),h.contributors&&h.contributors.length>0&&a.jsxs("div",{className:"mb-2 text-slate-400",children:["Contributors: ",h.contributors.join(", ")]}),w&&a.jsxs("div",{className:"mb-2 text-slate-400",children:["Publisher: ",w]}),h.publicationDate&&a.jsxs("div",{className:"mb-2 text-slate-400",children:["Published: ",h.publicationDate]}),h.isbn&&a.jsxs("div",{className:"mb-2 text-slate-400",children:["Publisher ID: ",h.isbn]}),h.language&&a.jsxs("div",{className:"mb-2 text-slate-400",children:["Language: ",h.language]}),(r.format||h.mediaType||h.acquisitionMediaType||h.publicationTypeLabel)&&a.jsx("div",{className:"mb-2 flex flex-col gap-1",children:a.jsxs("div",{className:"mb-2 flex flex-col gap-1",children:[a.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.jsx(Hh,{book:r})}),(!h.mediaType||h.mediaType==="text/html")&&a.jsxs("div",{className:"text-xs text-yellow-400 font-semibold",children:["Warning: This item may not be a valid book file (mediaType is ",h.mediaType?"text/html":"missing",")."]})]})}),(h.description||h.summary)&&a.jsx("div",{className:"mt-4 text-slate-300 text-base",children:h.description||h.summary})]}),a.jsxs("div",{className:"space-y-6 p-6 bg-slate-800 rounded-lg border border-slate-700 md:mt-4 md:mr-6 md:mb-4 md:p-8",children:[a.jsx("h3",{className:"text-xl font-bold text-sky-300 mb-4",children:"Book Details"}),a.jsxs("ul",{className:"space-y-2 text-base",children:[a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold text-slate-200",children:"Provider:"})," ",a.jsx("span",{className:"text-slate-400",children:h.providerName||(n==="catalog"?o:"Imported locally")}),h.providerId?a.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Provider ID: ",/^https?:\/\//.test(h.providerId)?a.jsx("a",{href:h.providerId,target:"_blank",rel:"noopener noreferrer",className:"text-sky-400 underline hover:text-sky-600",children:h.providerId}):h.providerId]}):a.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Imported locally"})]}),h.accessibilitySummary&&a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold text-slate-200",children:"Accessibility:"})," ",a.jsx("span",{className:"text-slate-400",children:h.accessibilitySummary})]}),h.accessibilityFeatures&&h.accessibilityFeatures.length>0&&a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold text-slate-200",children:"Features:"})," ",a.jsx("span",{className:"text-slate-400",children:h.accessibilityFeatures.join(", ")})]}),h.categories&&h.categories.length>0&&a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold text-slate-200",children:"Categories:"})," ",a.jsx("span",{className:"text-slate-400",children:h.categories.map(L=>L.label||L.term).join(", ")})]}),(!h.categories||h.categories.length===0)&&r.subjects&&r.subjects.length>0&&a.jsxs("li",{children:[a.jsx("span",{className:"font-semibold text-slate-200",children:"Subjects:"})," ",a.jsx("span",{className:"text-slate-400",children:r.subjects.map(L=>typeof L=="string"?L:L.name).join(", ")})]})]})]})]})]})},vy=({onBack:r,source:s})=>a.jsx("header",{className:"mb-8",children:a.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 text-slate-300 hover:text-sky-400 transition-colors",children:[a.jsx(xi,{className:"w-5 h-5"}),a.jsxs("span",{children:["Return to ",s==="library"?"My Library":"Catalog"]})]})}),st={dbInstance:null},zr=()=>new Promise((r,s)=>{if(st.dbInstance){r(st.dbInstance);return}if(typeof indexedDB>"u"){const o=new Error("IndexedDB is not available in this environment.");ne.error("IndexedDB unavailable:",o),s(o);return}const n=indexedDB.open(Wh,Vh);n.onerror=()=>{ne.error("IndexedDB error:",n.error),s(n.error)},n.onsuccess=()=>{st.dbInstance=n.result,r(st.dbInstance)},n.onupgradeneeded=o=>{const c=o.target.result;let l;if(!c.objectStoreNames.contains(Ze))l=c.createObjectStore(Ze,{keyPath:"id",autoIncrement:!0}),l.createIndex(Ht.TITLE,Ht.TITLE,{unique:!1});else{const d=o.target.transaction;if(d)l=d.objectStore(Ze);else return}o.oldVersion<2&&(l.indexNames.contains(Ht.ISBN)||l.createIndex(Ht.ISBN,Ht.ISBN,{unique:!1})),o.oldVersion<3&&(l.indexNames.contains(Ht.PROVIDER_ID)||l.createIndex(Ht.PROVIDER_ID,Ht.PROVIDER_ID,{unique:!1}))}}),xy=async r=>{let s;try{s=await zr()}catch(n){return Promise.reject(n)}return new Promise((n,o)=>{const d=s.transaction(Ze,"readwrite").objectStore(Ze).put(r);d.onsuccess=()=>{n(d.result)},d.onerror=()=>{ne.error("Error saving book:",d.error),o("Error saving book")}})},wy=async()=>{const r=await zr();return new Promise((s,n)=>{const l=r.transaction(Ze,"readonly").objectStore(Ze).openCursor(),d=[];l.onsuccess=f=>{const p=f.target.result;p?(d.push({...p.value}),p.continue()):(console.log("[db.getBooksMetadata] Loaded metadata:",d),s(d))},l.onerror=()=>{ne.error("Error getting books:",l.error),n("Error getting books")}})},by=async()=>{const r=await zr();return new Promise((s,n)=>{const l=r.transaction(Ze,"readonly").objectStore(Ze).getAll();l.onsuccess=()=>{console.log("[db.getAllBooks] Loaded books:",l.result),s(l.result)},l.onerror=()=>{ne.error("Error getting all books:",l.error),n("Error getting all books")}})},ky=async r=>{const s=await zr();return new Promise((n,o)=>{const d=s.transaction(Ze,"readonly").objectStore(Ze).get(r);d.onsuccess=()=>{n(d.result)},d.onerror=()=>{ne.error("Error getting book:",d.error),o("Error getting book")}})},Sy=async r=>{const s=await zr();return new Promise((n,o)=>{const d=s.transaction(Ze,"readonly").objectStore(Ze).get(r);d.onsuccess=()=>{const f=d.result;n(f?{...f,id:f.id}:null)},d.onerror=()=>{ne.error("Error getting book metadata:",d.error),o("Error getting book metadata")}})},Cy=async r=>{if(!r)return null;const s=await zr(),n=c=>new Promise((l,d)=>{try{const p=s.transaction(Ze,"readonly").objectStore(Ze);if(!p.indexNames.contains(c)){l(null);return}const w=p.index(c).get(r);w.onsuccess=()=>{l(w.result||null)},w.onerror=()=>{ne.error(`Error finding book by ${c}:`,w.error),d(`Error finding book by ${c}`)}}catch(f){ne.error(`Error initiating search on index ${c}:`,f),l(null)}}),o=await n("providerId");return o||n("isbn")},Ny=async r=>{const s=await zr();return new Promise((n,o)=>{const d=s.transaction(Ze,"readwrite").objectStore(Ze).delete(r);d.onsuccess=()=>{n()},d.onerror=()=>{ne.error("Error deleting book:",d.error),o("Error deleting book")}})},jy=async()=>{const r=await zr();return new Promise((s,n)=>{const l=r.transaction(Ze,"readwrite").objectStore(Ze).clear();l.onsuccess=()=>{s()},l.onerror=()=>{ne.error("Error clearing books:",l.error),n("Error clearing books")}})};st.init=zr;st.saveBook=xy;st.getBooksMetadata=wy;st.getAllBooks=by;st.getBook=ky;st.getBookMetadata=Sy;st.findBookByIdentifier=Cy;st.deleteBook=Ny;st.clearAllBooks=jy;const wi=(r,s)=>{if(!r)return s;try{return JSON.parse(r)}catch(n){return console.warn("Failed to parse JSON from storage, using fallback",n),s}},Af={fontSize:100,theme:"light",flow:"paginated",fontFamily:"Original",citationFormat:"apa",readAloud:{voiceURI:null,rate:.9,pitch:1,volume:1}},tc=()=>{const r=localStorage.getItem(pn.GLOBAL_SETTINGS),s=wi(r,{});return{...Af,...s,readAloud:{...Af.readAloud,...s.readAloud||{}}}},Rf=r=>{localStorage.setItem(pn.GLOBAL_SETTINGS,JSON.stringify(r))},Ey=r=>{const s=localStorage.getItem(St.bookmarks(r));return wi(s,[])},Ml=(r,s)=>{localStorage.setItem(St.bookmarks(r),JSON.stringify(s))},_y=r=>{const s=localStorage.getItem(St.citations(r));return wi(s,[])},Tf=(r,s)=>{localStorage.setItem(St.citations(r),JSON.stringify(s))},Ay=r=>localStorage.getItem(St.position(r)),Ry=(r,s)=>{localStorage.setItem(St.position(r),s)},Ty=async(r,s)=>{if(!s||!r)return[];const n=r.spine.spineItems.map(c=>c.load(r.load.bind(r)).then(()=>{const l=c.find(s.trim());return c.unload(),Promise.resolve(l)}).catch(()=>(c.unload(),Promise.resolve([])))),o=await Promise.all(n);return[].concat(...o)},Py=async r=>{try{if(r.navigation&&Array.isArray(r.navigation.landmarks)&&r.navigation.landmarks.length>0){const s=r.navigation.landmarks.find(n=>(n.type||"").toString().toLowerCase().includes("bodymatter"));if(s&&s.href)return s.href}}catch(s){console.warn("Error reading navigation landmarks when finding first chapter",s)}try{if(r.packaging&&Array.isArray(r.packaging.guide)&&r.packaging.guide.length>0){const s=r.packaging.guide.find(n=>(n.type||"").toString().toLowerCase().includes("text"));if(s&&s.href)return s.href}}catch(s){console.warn("Error reading packaging guide when finding first chapter",s)}if(r.spine&&Array.isArray(r.spine.items)){for(const s of r.spine.items)try{if(r.spine.get){const n=await r.spine.get(s.href);if(!n)continue;const c=(await n.load())?.body;let l=!1;if(c&&(c.textContent||"").trim().length>300&&(l=!0),n.unload(),l)return s.href}else return s.href}catch(n){console.warn(`Could not parse section ${s.href} when searching for first chapter. Skipping.`,n)}return r.spine.items.length>0?r.spine.items[0].href:void 0}},Pf=r=>{const s=[];try{if(r&&r.spine&&Array.isArray(r.spine.items))for(let n=0;n<r.spine.items.length;n++){const o=r.spine.items[n],c=o.href||o.idref||`item-${n}`,l=o.id||(o.href?o.href.split("#")[0].split("/").pop():`Section ${n+1}`)||`Section ${n+1}`;s.push({id:`${n}`,href:c,label:l})}}catch(n){console.warn("Failed to build fallback TOC from spine",n)}return s},Oy=r=>{try{const s=localStorage.getItem(St.pdfViewState(r));return wi(s,{zoomPercent:100,fitMode:"page"})}catch(s){return console.warn("Failed to read pdf view state",s),{zoomPercent:100,fitMode:"page"}}},Iy=(r,s)=>{try{localStorage.setItem(St.pdfViewState(r),JSON.stringify(s))}catch(n){console.warn("Failed to save pdf view state",n)}},Ly=r=>{try{const s=localStorage.getItem(St.epubViewState(r));return wi(s,{})}catch(s){return console.warn("Failed to read epub view state",s),{}}},Dy=(r,s)=>{try{localStorage.setItem(St.epubViewState(r),JSON.stringify(s))}catch(n){console.warn("Failed to save epub view state",n)}},Wo={BASE_URL:"/My-Ebook-Reader/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_GOOGLE_CLIENT_ID:"970895595671-06di7pi5bs5hi96o9js5jr1eeo2pigm7.apps.googleusercontent.com",VITE_OWN_PROXY_URL:"https://mebooks-proxy-worker.jce1028.workers.dev/"},Of=(r,s,n,o,c,l)=>{const d=s.split(" ");let f="",p=o;for(let h=0;h<d.length;h++){const w=f+d[h]+" ";r.measureText(w).width>c&&h>0?(r.fillText(f,n,p),f=d[h]+" ",p+=l):f=w}return r.fillText(f,n,p),p+l},If=(r,s)=>new Promise(n=>{const l=document.createElement("canvas");l.width=400,l.height=600;const d=l.getContext("2d");if(!d)return n("");const f=d.createLinearGradient(0,0,400,600);f.addColorStop(0,"#1e3a8a"),f.addColorStop(1,"#4c1d95"),d.fillStyle=f,d.fillRect(0,0,400,600);const p=70,h=35,w=400-p-20,b=20;d.fillStyle="#dc2626",d.fillRect(w,b,p,h),d.font="bold 20px sans-serif",d.fillStyle="white",d.textAlign="center",d.textBaseline="middle",d.fillText("PDF",w+p/2,b+h/2),d.textAlign="left",d.textBaseline="top",d.fillStyle="white",d.font="bold 42px sans-serif";const x=Of(d,r,30,100,340,50);d.strokeStyle="rgba(255, 255, 255, 0.3)",d.lineWidth=1,d.beginPath(),d.moveTo(30,x+10),d.lineTo(370,x+10),d.stroke(),d.font="24px sans-serif",d.fillStyle="rgba(255, 255, 255, 0.8)",Of(d,s,30,x+30,340,30),n(l.toDataURL("image/jpeg",.9))});const Lf=typeof import.meta<"u"&&Wo?"https://mebooks-proxy-worker.jce1028.workers.dev/":"",Fy=typeof import.meta<"u"&&Wo&&!1,By=typeof import.meta<"u"&&Wo&&!1,Df=()=>{try{return typeof window<"u"&&window.location&&window.location.origin?window.location.origin:""}catch{return""}},Xt=r=>{try{if(new URL(r),Lf){let s=Lf.trim();s=s.replace(/\/+$/,""),s.endsWith("/proxy")||(s=`${s}/proxy`);const n=s.includes("?")?"&":"?";return`${s}${n}url=${encodeURIComponent(r)}`}return r}catch{return console.error("Invalid URL passed to proxiedUrl:",r),""}},Cr=async(r,s=!1)=>{let n;try{n=new URL(r)}catch{return console.error("Invalid URL for maybeProxyForCors:",r),""}const o=Df();if(n.protocol==="http:"&&o.startsWith("https://")){const l=Xt(r);if(l&&l!==r)return console.log("[maybeProxyForCors] HTTPS app detected plain HTTP upstream, forcing proxy:",r.substring(0,80)),l;throw new Error("This resource uses plain HTTP and cannot be fetched directly from an HTTPS app. Configure an owned proxy via VITE_OWN_PROXY_URL, enable a proxy, or run the app over HTTP while debugging.")}if(s)return console.log("[maybeProxyForCors] Skipping HEAD probe for open-access content, using direct URL"),r;try{console.log("[maybeProxyForCors] Starting HEAD probe for:",r.substring(0,80));let l=await fetch(r,{method:"HEAD",mode:"cors",redirect:"manual",credentials:"include"});if(l&&l.status===405)try{console.log("[maybeProxyForCors] HEAD returned 405, trying GET probe"),l=await fetch(r,{method:"GET",mode:"cors",redirect:"manual",credentials:"include"})}catch(f){console.log("[maybeProxyForCors] GET probe failed:",String(f).substring(0,80))}if(!l)return console.log("[maybeProxyForCors] No response, using proxy"),Xt(r);if(l.status>=300&&l.status<400)return console.log("[maybeProxyForCors] HEAD probe redirect",{url:r.substring(0,80),status:l.status}),Xt(r);if(l.status>=200&&l.status<300){const f=l.headers.get("access-control-allow-origin");try{const p=Df();if(console.log("[maybeProxyForCors] HEAD probe success",{url:r.substring(0,80),status:l.status,allow:f,origin:p}),f==="*"||f&&p&&f===p)return console.log("[maybeProxyForCors] CORS allows direct URL, skipping proxy"),r;console.log("[maybeProxyForCors] CORS headers missing or mismatched, using proxy")}catch(p){console.log("[maybeProxyForCors] error determining origin, falling back to proxy",{url:r.substring(0,80),err:String(p).substring(0,80)})}}else console.log("[maybeProxyForCors] probe returned non-2xx:",{url:r.substring(0,80),status:l.status});const d=Xt(r);return console.log("[maybeProxyForCors] Returning proxied URL"),d}catch(l){return console.log("[maybeProxyForCors] Probe error (network/CORS), using proxy:",String(l).substring(0,100)),Xt(r)}},Ff=async r=>{try{const s=Xt(r),n=await fetch(s);if(!n.ok)return console.error(`Failed to fetch cover image from ${r}, status: ${n.status}`),null;const o=await n.blob();return new Promise((c,l)=>{const d=new FileReader;d.onloadend=()=>{typeof d.result=="string"&&d.result.startsWith("data:")?c(d.result):(console.error(`Failed to convert resource from ${r} to base64 DataURL.`),c(null))},d.onerror=()=>{console.error(`Error reading blob from ${r} as DataURL.`),l(null)},d.readAsDataURL(o)})}catch(s){return console.error("Error fetching or converting image to base64:",s),null}},Bf=(r,s)=>{try{const n={event:r,payload:s||{},ts:Date.now()};try{window.dispatchEvent(new CustomEvent("analytics",{detail:n}))}catch{}Ar()&&console.info("trackEvent:",r,s||{})}catch(n){Ar()&&console.warn("trackEvent failed",n)}},Ar=()=>{try{if(typeof window<"u"&&window.__MEBOOKS_DEBUG__)return!0}catch{}try{typeof import.meta<"u"}catch{}return!1},My="MeBooksCredentialsDB",Rr="credentials",Do="meta",Uy=2,Mf="credential-encryption-key";function Vo(){return new Promise((r,s)=>{const n=indexedDB.open(My,Uy);n.onupgradeneeded=()=>{const o=n.result;o.objectStoreNames.contains(Rr)||o.createObjectStore(Rr,{keyPath:"host"}),o.objectStoreNames.contains(Do)||o.createObjectStore(Do,{keyPath:"id"})},n.onsuccess=()=>r(n.result),n.onerror=()=>s(n.error)})}function Uf(r){let s="";for(let o=0;o<r.length;o+=32768){const c=r.subarray(o,o+32768);s+=String.fromCharCode(...c)}return btoa(s)}function zf(r){const s=atob(r),n=new Uint8Array(s.length);for(let o=0;o<s.length;o++)n[o]=s.charCodeAt(o);return n}async function vc(r){if(!globalThis.crypto?.subtle)return null;const s=r.transaction(Do,"readwrite"),n=s.objectStore(Do),o=await new Promise((l,d)=>{const f=n.get(Mf);f.onsuccess=()=>l(f.result?.key),f.onerror=()=>d(f.error)});if(o)return o;const c=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!1,["encrypt","decrypt"]);return await new Promise((l,d)=>{const f=n.put({id:Mf,key:c});f.onsuccess=()=>l(),f.onerror=()=>d(f.error)}),await new Promise((l,d)=>{s.oncomplete=()=>l(),s.onerror=()=>d(s.error)}),c}async function zy(r,s){const n=crypto.getRandomValues(new Uint8Array(12)),o=new TextEncoder().encode(s),c=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},r,o);return{cipher:Uf(new Uint8Array(c)),iv:Uf(n)}}async function $y(r,s,n){const o=zf(n),c=zf(s),l=new Uint8Array(o.byteLength);l.set(o);const d=new Uint8Array(c.byteLength);d.set(c);const f=await crypto.subtle.decrypt({name:"AES-GCM",iv:l},r,d);return new TextDecoder().decode(new Uint8Array(f))}async function qh(r,s){if(r.passwordCipher&&r.iv&&s)try{const n=await $y(s,r.passwordCipher,r.iv);return{host:r.host,username:r.username,password:n}}catch(n){ne.warn("Failed to decrypt stored credential",{host:r.host,error:n});return}if(r.password)return{host:r.host,username:r.username,password:r.password}}async function xc(r,s,n){try{const o=await Vo(),c=await vc(o),l=o.transaction(Rr,"readwrite"),d=l.objectStore(Rr);let f={host:r,username:s,password:n};if(c){const p=await zy(c,n);f={host:r,username:s,passwordCipher:p.cipher,iv:p.iv,v:2}}return d.put(f),new Promise((p,h)=>{l.oncomplete=()=>p(),l.onerror=()=>h(l.error)})}catch(o){ne.warn("saveCredential failed",o)}}async function Gh(){try{const r=await Vo(),s=await vc(r),c=r.transaction(Rr,"readonly").objectStore(Rr).getAll(),l=await new Promise((f,p)=>{c.onsuccess=()=>f(c.result||[]),c.onerror=()=>p(c.error)});return(await Promise.all(l.map(f=>qh(f,s)))).filter(f=>!!f)}catch(r){return ne.warn("getAllCredentials failed",r),[]}}async function Wy(r){try{const s=await Vo(),n=await vc(s),l=s.transaction(Rr,"readonly").objectStore(Rr).get(r),d=await new Promise((p,h)=>{l.onsuccess=()=>p(l.result),l.onerror=()=>h(l.error)});if(!d)return;const f=await qh(d,n);return f&&n&&d.password&&!d.passwordCipher&&await xc(f.host,f.username,f.password),f}catch(s){ne.warn("findCredential failed",s);return}}async function Vy(r){try{const n=(await Vo()).transaction(Rr,"readwrite");return n.objectStore(Rr).delete(r),new Promise((c,l)=>{n.oncomplete=()=>c(),n.onerror=()=>l(n.error)})}catch(s){ne.warn("deleteCredential failed",s)}}async function Hy(r="mebooks.opds.credentials"){try{const s=localStorage.getItem(r);if(!s)return;let n=null;try{n=JSON.parse(s)}catch{n=null}if(!Array.isArray(n))return;const o=await Gh(),c=new Set(o.map(l=>l.host));for(const l of n)!l||!l.host||c.has(l.host)||await xc(l.host,l.username,l.password);try{localStorage.removeItem(r)}catch{}}catch(s){ne.warn("migrateFromLocalStorage failed",s)}}const wc={saveCredential:xc,getAllCredentials:Gh,findCredential:Wy,deleteCredential:Vy,migrateFromLocalStorage:Hy},qy={"https://schema.org/Book":"Book","https://schema.org/Audiobook":"Audiobook","https://schema.org/Photograph":"Photograph","https://schema.org/Drawing":"Drawing","https://schema.org/Sculpture":"Sculpture","https://schema.org/Poster":"Poster","https://schema.org/Painting":"Painting","https://schema.org/image":"Image","https://schema.org/Article":"Article","https://schema.org/Periodical":"Periodical","https://schema.org/ShortStory":"Short Story","https://schema.org/Map":"Map","https://schema.org/Manuscript":"Manuscript","https://schema.org/SheetMusic":"Sheet Music","https://schema.org/audio":"Audio","https://schema.org/video":"Video","https://schema.org/Chapter":"Chapter","https://schema.org/MusicAlbum":"Music Album","https://schema.org/DigitalDocument":"Digital Document"};function Gy(r){if(!r)return{schemaOrgType:"https://schema.org/DigitalDocument",publicationTypeLabel:"Digital Document"};const s=qy[r]||"Digital Document";return{schemaOrgType:r,publicationTypeLabel:s}}function di(r){return r||""}function bc(r){return String(r??"").toLowerCase()}function Ur(r){const s=String(r??"").trim();return s.length>0?s:void 0}function ws(r){return(Array.isArray(r)?r:[r]).map(n=>di(bc(n))).filter(n=>n.length>0)}function In(r){return r?r.isCatalog?!0:typeof r.type=="string"&&r.type.includes("application/opds+json"):!1}function Ky(r,s){const n=[];return r.catalogs&&Array.isArray(r.catalogs)&&r.catalogs.forEach(o=>{if(!o)return;const c=o.metadata||{},l=c.title||c.name||o.title||"Catalog",d=Array.isArray(o.links)?o.links:[],p=(()=>{const h=x=>bc(x).includes("catalog"),w=d.find(x=>typeof x.rel=="string"&&h(x.rel));if(w)return w;const b=d.find(x=>Array.isArray(x.rel)&&x.rel.some(v=>typeof v=="string"&&h(v)));return b||d.find(x=>typeof x.type=="string"&&x.type.includes("opds"))})();p&&p.href&&n.push({title:l,url:new URL(p.href,s).href,rel:"subsection",isCatalog:!0,source:"registry"})}),r.groups&&Array.isArray(r.groups)&&r.groups.forEach(o=>{const c=o.metadata?.title||"";o.navigation&&Array.isArray(o.navigation)&&o.navigation.forEach(l=>{const d=Ur(l.title);if(l.href&&d&&In(l)){const f=new URL(l.href,s).href,p=c?`${c}: ${d}`:d;let h="";typeof l.rel=="string"?h=di(l.rel):Array.isArray(l.rel)&&l.rel.length>0?h=di(String(l.rel[0])):h=In(l)?"subsection":"";const w=In(l);n.push({title:p,url:f,rel:Array.isArray(h)?String(h[0]):h,isCatalog:w,type:l.type,source:"group"})}})}),r.navigation&&Array.isArray(r.navigation)&&r.navigation.forEach(o=>{const c=Ur(o.title);if(o.href&&c&&In(o)){const l=new URL(o.href,s).href;let d="";typeof o.rel=="string"?d=di(o.rel):Array.isArray(o.rel)&&o.rel.length>0?d=di(String(o.rel[0])):d=In(o)?"subsection":"";const f=In(o);n.push({title:c,url:l,rel:Array.isArray(d)?String(d[0]):d,isCatalog:f,type:o.type,source:"navigation"})}}),r.links&&Array.isArray(r.links)&&r.links.forEach(o=>{const c=Ur(o.title);if(o.href&&o.rel&&c){const l=ws(o.rel),d=new URL(o.href,s).href;In(o)&&l.some(f=>f.includes("collection")||f.includes("subsection")||f.includes("section"))&&n.push({title:c,url:d,rel:l[0]||"",type:o.type,isCatalog:!1,source:"navigation"})}}),n}function Qy(r,s){if(!Array.isArray(r?.facets))return[];const n=[];return r.facets.forEach((o,c)=>{const l=Ur(o?.metadata?.title)||Ur(o?.title)||`Facet Group ${c+1}`,f=(Array.isArray(o?.links)?o.links:Array.isArray(o?.navigation)?o.navigation:[]).map(p=>{const h=Ur(p?.title),w=Ur(p?.href);if(!h||!w)return null;const b=ws(p.rel),x=p?.properties?.numberOfItems??p?.properties?.number_of_items,v=Number(x);return{title:h,url:new URL(w,s).href,type:typeof p?.type=="string"?p.type:void 0,rel:b[0]||void 0,count:Number.isFinite(v)?v:void 0,isActive:b.some(k=>k.includes("self"))}}).filter(p=>p!==null);f.length>0&&n.push({title:l,links:f})}),n}function Xy(r,s){if(!Array.isArray(r?.links))return;const n=r.links.find(o=>{const c=ws(o?.rel),l=bc(o?.type);return c.some(d=>d.includes("search"))&&l.includes("application/opensearchdescription+xml")});if(n?.href)return{descriptionUrl:new URL(n.href,s).href,type:typeof n.type=="string"?n.type:void 0,title:Ur(n.title)||"Search",rel:ws(n.rel)[0]||"search"}}function Zy(r,s){const n={};return r.links&&Array.isArray(r.links)&&r.links.forEach(o=>{if(o.href&&o.rel){const c=ws(o.rel),l=new URL(o.href,s).href;c.some(d=>d.includes("next"))&&(n.next=l),c.some(d=>d.includes("prev")||d.includes("previous"))&&(n.prev=l),c.some(d=>d.includes("first"))&&(n.first=l),c.some(d=>d.includes("last"))&&(n.last=l)}}),n}function Yy(r){let n="";for(let o=0;o<r.length;o+=32768){const c=r.subarray(o,o+32768);n+=String.fromCharCode.apply(null,Array.prototype.slice.call(c))}return n}const Ln=new WeakMap;async function Jy(r){try{const s=Ln.get(r);if(s)return s}catch{}try{if(r&&typeof r.clone=="function"){const s=r.clone();try{const n=await s.arrayBuffer(),o=new Uint8Array(n);try{Ln.set(r,o)}catch{}return o}catch(n){const o=s.body&&s.body.getReader?s.body.getReader():null;if(!o)throw n;const c=[];let l=0;for(;;){const{done:p,value:h}=await o.read();if(p)break;if(h){const w=h instanceof Uint8Array?h:new Uint8Array(h);c.push(w),l+=w.length}}const d=new Uint8Array(l);let f=0;for(const p of c)d.set(p,f),f+=p.length;try{Ln.set(r,d)}catch{}return d}}if(r&&typeof r.arrayBuffer=="function"){const s=await r.arrayBuffer(),n=new Uint8Array(s);try{Ln.set(r,n)}catch{}return n}if(r&&typeof r.text=="function"){const s=await r.text();let n;typeof TextEncoder<"u"?n=new TextEncoder().encode(s):typeof Buffer<"u"?n=new Uint8Array(Buffer.from(s,"utf-8")):n=new Uint8Array;try{Ln.set(r,n)}catch{}return n}if(r&&r.body){if(r.body instanceof Uint8Array){try{Ln.set(r,r.body)}catch{}return r.body}if(typeof Buffer<"u"&&Buffer.isBuffer(r.body)){const s=new Uint8Array(r.body);try{Ln.set(r,s)}catch{}return s}}return new Uint8Array}catch(s){throw s}}async function ev(r){try{const s=await Jy(r);try{return new TextDecoder("utf-8",{fatal:!1}).decode(s)}catch{try{return new TextDecoder("iso-8859-1",{fatal:!1}).decode(s)}catch{return Yy(s)}}}catch(s){ne.warn("safeReadText: fallback decode failed",s);try{if(r&&typeof r.text=="function")return await r.text()}catch{}return""}}function tv(r){try{return new URL(r).host}catch{return r}}let $f=!1;async function rv(){if(!$f){$f=!0;try{await wc.migrateFromLocalStorage()}catch{}}}function nv(r,s,n){try{wc.saveCredential(r,s,n)}catch(o){ne.warn("saveOpdsCredential failed",o)}}async function Wf(r){try{await rv();const s=tv(r);return await wc.findCredential(s)}catch{return}}const Po=(r,s)=>{ne.debug("[OPDS2] parseOpds2Json start",{baseUrl:s,typeofJson:typeof r});try{let n=function(_,F){const M=_?String(_).toLowerCase().trim():"",$=F?String(F).toLowerCase().trim():"";if(M==="text/html"||M.includes("html")||$==="text/html"||$.includes("html"))return"Web";if(M.includes("epub")||M==="application/epub+zip"||$.includes("epub")||$==="application/epub+zip")return"EPUB";if(M.includes("pdf")||M==="application/pdf"||$.includes("pdf")||$==="application/pdf")return"PDF";if(M)return M;if($)return $},o=function(_){if(_.startsWith("urn:isbn:"))return"isbn";if(_.startsWith("urn:issn:"))return"issn";if(_.startsWith("urn:uuid:"))return"uuid";if(_.startsWith("http://")||_.startsWith("https://"))return"uri";if(/^\d{10}(\d{3})?$/.test(_))return"isbn"},c=function(_){const F=[];return _.identifier?((Array.isArray(_.identifier)?_.identifier:[_.identifier]).forEach($=>{if(typeof $=="string")F.push({value:$,scheme:o($)});else if($&&typeof $=="object"){const L=$.value||$.identifier||String($);F.push({value:L,scheme:$.scheme||$.schemeURI||o(L)})}}),F.length>0?F:void 0):void 0},l=function(_){if(!Array.isArray(_.subject)||_.subject.length===0)return;const F=[];return _.subject.forEach(M=>{if(typeof M=="string")F.push({name:M});else if(M&&typeof M=="object"){const $=M.name||M.label;$&&F.push({name:String($).trim(),scheme:M.scheme||M.schemeURI,code:M.term||M.code})}}),F.length>0?F:void 0},d=function(_){const F=[],M=_.contributor||_.contributors;return M?((Array.isArray(M)?M:[M]).forEach(L=>{if(typeof L=="string")F.push({name:L});else if(L&&typeof L=="object"){const B=L.name||L.label;B&&F.push({name:String(B).trim(),role:L.role||L.type,uri:L.uri||L.identifier})}}),F.length>0?F:void 0):void 0},f=function(_){if(!(!_.accessMode&&!_.accessibilityFeature&&!_.accessibilityHazard&&!_.conformsTo))return{modes:_.accessMode?Array.isArray(_.accessMode)?_.accessMode:[_.accessMode]:void 0,modesSufficient:_.accessModesSufficient?Array.isArray(_.accessModesSufficient)?_.accessModesSufficient:[_.accessModesSufficient]:void 0,features:_.accessibilityFeature?Array.isArray(_.accessibilityFeature)?_.accessibilityFeature:[_.accessibilityFeature]:void 0,hazards:_.accessibilityHazard?Array.isArray(_.accessibilityHazard)?_.accessibilityHazard:[_.accessibilityHazard]:void 0,summary:_.accessibilitySummary,certification:_.conformsTo?{standard:String(_.conformsTo)}:void 0}},p=function(_){const F=_.join(" ").toLowerCase();return F.includes("/open-access")?"open-access":F.includes("/borrow")||F.includes("/loan")?"borrow":F.includes("/buy")?"buy":F.includes("/sample")?"sample":"generic"},h=function(_,F){const M=_.metadata||{};let $="Unknown Author";if(M.author)if(Array.isArray(M.author)&&M.author.length>0){const E=M.author[0];$=typeof E=="string"?E:typeof E=="object"&&"name"in E&&E.name||"Unknown Author"}else typeof M.author=="string"?$=M.author:typeof M.author=="object"&&"name"in M.author&&($=M.author.name||"Unknown Author");const L=M.title&&String(M.title).trim()||"Untitled",B=M.description||M.subtitle||null;let Q;M.publisher&&(typeof M.publisher=="string"?Q=M.publisher:typeof M.publisher=="object"&&"name"in M.publisher&&(Q=M.publisher.name));const oe=M.published||M.issued||void 0;let z;if(typeof M.identifier=="string")z=M.identifier;else if(Array.isArray(M.identifier)&&M.identifier.length>0){const E=M.identifier.find(U=>typeof U=="string");E&&(z=E)}let H;try{const E=M.series||M.belongsTo?.series,U=Array.isArray(E)?E[0]:E,K=typeof U=="string"?U:U?.name,pe=typeof U=="object"&&U?U.position??U.ordinal??U.index:void 0;K&&(H={name:K,position:typeof pe=="number"?pe:void 0})}catch{}let N;if(Array.isArray(M.subject)){const E=[];M.subject.forEach(U=>{if(U&&typeof U=="object"){const K=(U.name||U.label||"").trim(),pe=(U.term||U.code||K||"").trim(),Ee=(U.scheme||U.schemeURI||"http://opds-spec.org/subject").trim();(K||pe)&&E.push({scheme:Ee,term:pe||K,label:K||pe})}}),E.length>0&&(N=E)}const X=_.images&&_.images[0]||M.image&&M.image[0],me=X?.href?new URL(X.href,F).href:X?.url?new URL(X.url,F).href:null;let ee=[];Array.isArray(_.links)?ee=_.links:typeof _.links=="object"&&_.links&&(ee=[_.links]);const ie=[],re=[];ee.forEach(E=>{if(!E||!E.href)return;const U=Array.isArray(E.rel)?E.rel.map(pe=>String(pe)):E.rel?[String(E.rel)]:[];if(U.some(pe=>pe.includes("acquisition")||pe==="http://opds-spec.org/acquisition/borrow"||pe==="http://opds-spec.org/acquisition/loan"||pe==="http://opds-spec.org/acquisition/open-access"||pe.includes("/open-access"))){const pe=b(E.indirectAcquisition||E.properties?.indirectAcquisition);ie.push({href:new URL(E.href,F).href,rels:U,type:E.type,indirectType:pe})}E.title&&U.includes("collection")&&re.push({title:E.title,href:new URL(E.href,F).href})});const Z=ie.map(E=>{const U=n(E.type,E.indirectType)||"UNKNOWN",K=p(E.rels),pe=E.rels.some(Ee=>Ee.includes("/open-access")||Ee==="http://opds-spec.org/acquisition/open-access");return{format:U,downloadUrl:E.href,mediaType:E.type,isOpenAccess:pe,acquisitionType:K}});let P,W=!1;if(ie.length>0){const E=(K,pe)=>{if(!K.type)return!1;const Ee=String(K.type).toLowerCase().trim();return pe==="epub"?Ee==="application/epub+zip"||Ee.includes("epub"):pe==="pdf"?Ee==="application/pdf"||Ee.includes("pdf"):pe==="html"?Ee==="text/html"||Ee.includes("html"):!1},U=K=>K.rels.some(pe=>pe.includes("/open-access")||pe==="http://opds-spec.org/acquisition/open-access");P=ie.find(K=>U(K)&&E(K,"epub")),P||(P=ie.find(K=>U(K)&&E(K,"pdf"))),P||(P=ie.find(K=>E(K,"epub"))),P||(P=ie.find(K=>E(K,"pdf"))),P||(P=ie.find(K=>!E(K,"html"))),P||(P=ie[0]),P&&U(P)&&(W=!0)}let ye,he;if(P&&(ye=P.href,he=n(P.type,P.indirectType)),!ye&&_.content&&Array.isArray(_.content)&&_.content.length>0){const E=_.content[0];E.href&&(ye=new URL(E.href,F).href),!he&&E.type&&(he=n(E.type))}const fe=M["@type"]||M.type,{schemaOrgType:Ae,publicationTypeLabel:be}=Gy(fe);let xe;P&&P.type&&(xe=w(fe,P.type));const Ne=M.language?Array.isArray(M.language)?M.language[0]:M.language:void 0,De=M.duration||M.durationInSeconds?parseInt(String(M.duration||M.durationInSeconds),10):void 0,$e=M.extent?parseInt(String(M.extent),10):void 0,Ye=M.source||M.sourceIdentifier,Ve=c(M),j=l(M),ue=d(M),ce=f(M),V=j?.map(E=>typeof E=="string"?E:String(E?.name??"")).map(E=>E.trim()).filter(E=>E.length>0),D=ue?.map(E=>typeof E=="string"?E:String(E?.name??"")).map(E=>E.trim()).filter(E=>E.length>0),q=P?p(P.rels):void 0,te=_.properties?.["opds:borrowPeriod"]?parseInt(String(_.properties["opds:borrowPeriod"]),10):void 0,ae=_.properties?.["opds:copies"]?parseInt(String(_.properties["opds:copies"]),10):void 0,J=_.properties?.["opds:holds"]?parseInt(String(_.properties["opds:holds"]),10):void 0;let A;try{const E=M.series||M.belongsTo?.series;E&&(A=(Array.isArray(E)?E:[E]).map(K=>{const pe=typeof K=="string"?K:K?.name;if(pe)return{name:String(pe).trim(),position:typeof K=="object"&&K?K.position??K.ordinal??K.index:void 0,volume:K?.volume,url:K?.uri||K?.url}}).filter(K=>K!==void 0),A.length===0&&(A=void 0))}catch{}if(L&&(ye||me))return{title:L,author:$,coverImage:me||null,downloadUrl:ye||"",summary:B||null,publisher:Q||void 0,publicationDate:oe||void 0,providerId:z||void 0,subjects:V&&V.length>0?V:void 0,contributors:D&&D.length>0?D:void 0,categories:N||void 0,collections:re.length>0?re:void 0,format:he||void 0,acquisitionType:q,mediaType:P&&P.type?String(P.type).toLowerCase().trim():void 0,isOpenAccess:W?!0:void 0,alternativeFormats:Z.length>0?Z:void 0,borrowPeriodDays:te,copiesAvailable:ae,holdsCount:J,schemaOrgType:Ae,publicationTypeLabel:be,mediumFormatCode:xe,series:A,language:Ne,duration:De,extent:$e,source:Ye,identifiers:Ve,accessibility:ce}},w=function(_,F){if(!F)return;const M=String(F).toLowerCase().trim();return M==="text/html"?"Web":M},b=function(_){if(!_)return;const M=(Array.isArray(_)?_:[_])[0];if(M){if(M.type)return M.type;if(M.indirectAcquisition)return b(M.indirectAcquisition)}},x=function(_){if(!_)return;const F=String(_).split(";")[0].trim().toLowerCase();if(F.includes("epub")||F==="application/epub+zip")return"EPUB";if(F.includes("pdf")||F==="application/pdf")return"PDF"};if(typeof r!="object"||r===null)throw new Error("Invalid OPDS2 catalog format: input is not an object");try{ne.debug("[OPDS2] keys",{baseUrl:s,keys:Object.keys(r)})}catch(_){ne.warn("[OPDS2] Object.keys failed",{baseUrl:s,type:typeof r,constructor:r&&r.constructor?r.constructor.name:void 0,err:_})}const v=[],k=Ky(r,s),g=Qy(r,s),S=Zy(r,s),C=Xy(r,s);if(r.links&&Array.isArray(r.links)&&r.links.forEach(_=>{if(_.href&&_.rel){const F=ws(_.rel),M=new URL(_.href,s).href;F.some(L=>L.includes("next"))&&(S.next=M),F.some(L=>L.includes("prev")||L.includes("previous"))&&(S.prev=M),F.some(L=>L.includes("first"))&&(S.first=M),F.some(L=>L.includes("last"))&&(S.last=M);const $=Ur(_.title);$&&(F.some(L=>L.includes("collection"))||F.some(L=>L.includes("subsection"))||F.some(L=>L.includes("section")))&&k.push({title:$,url:M,rel:F[0]||"",type:_.type,source:"navigation"})}}),r.publications&&Array.isArray(r.publications)&&(ne.debug("[OPDS2] Parsing publications",{count:r.publications.length,baseUrl:s}),r.publications&&Array.isArray(r.publications)))for(const _ of r.publications){if(typeof _.links=="string"&&_.links.trim().startsWith("<"))try{const $=new DOMParser().parseFromString(_.links,"application/xml"),L=[];Array.from($.querySelectorAll("link")).forEach(B=>{const Q=B.getAttribute("href"),oe=B.getAttribute("rel"),z=B.getAttribute("type"),H={};Q&&(H.href=Q),oe&&(H.rel=oe),z&&(H.type=z),L.push(H)}),L.length>0&&(_.links=L)}catch{}if(!_.links&&_.properties&&typeof _.properties=="object"){const M=_.properties.links||_.properties.link||_.properties.acquisitions;if(typeof M=="string"&&M.trim().startsWith("<"))try{const L=new DOMParser().parseFromString(M,"application/xml"),B=[];Array.from(L.querySelectorAll("link")).forEach(Q=>{const oe=Q.getAttribute("href"),z=Q.getAttribute("rel"),H=Q.getAttribute("type"),N={};oe&&(N.href=oe),z&&(N.rel=z),H&&(N.type=H),B.push(N)}),B.length>0&&(_.links=B)}catch{}}const F=h(_,s);F&&v.push(F)}const R=r.metadata&&typeof r.metadata=="object",I=Array.isArray(r.publications)&&r.publications.length>0;return!R&&!I&&console.warn("[OPDS2] Warning: feed is missing required metadata and publications."),ne.debug("[OPDS2] parseOpds2Json complete",{navLinks:k.length,facetGroups:g.length,books:v.length,paginationKeys:Object.keys(S)}),{books:v,navLinks:k,facetGroups:g,pagination:S,search:C}}catch(n){const o=n instanceof Error?n.message:"Unknown OPDS2 parse error";return ne.error("[OPDS2] parseOpds2Json error",n),{books:[],navLinks:[],facetGroups:[],pagination:{},error:o}}},sv=async(r,s,n=5)=>{let o=0;const c=r,l=await Cr(r);if(typeof l=="string"&&l.includes("corsproxy.io")&&s){const h=new Error("Acquisition would use a public CORS proxy which may strip Authorization or block POST requests. Configure an owned proxy (VITE_OWN_PROXY_URL) to perform authenticated borrows.");throw h.proxyUsed=!0,h}const f=(h=!1)=>{const w={Accept:"application/json, text/json, */*"};return h&&s&&(w.Authorization=`Basic ${btoa(`${s.username}:${s.password}`)}`),w},p=!!s;for(;o<n&&l;){o++;let h=null;try{p?(h=await fetch(l,{method:"GET",headers:f(!0)}),h.status===405&&(h=await fetch(l,{method:"POST",headers:f(!0)}))):(h=await fetch(l,{method:"POST",headers:f(!1)}),h.status===405&&(h=await fetch(l,{method:"GET",headers:f(!1)})))}catch(x){throw x}if(!h)return null;if(h.status>=300&&h.status<400){const x=h.headers&&typeof h.headers.get=="function"?h.headers.get("Location")||h.headers.get("location"):null;if(x)return new URL(x,c).href}const w=typeof h.ok=="boolean"?h.ok:h.status>=200&&h.status<300,b=h.headers&&typeof h.headers.get=="function"&&h.headers.get("Content-Type")||"";if(w){if(b.includes("application/json")||b.includes("text/json")||b.includes("application/opds+json")){const v=await h.json().catch(()=>null),k=v?.url||v?.location||v?.href||v?.contentLocation;if(typeof k=="string"&&k.length>0)return new URL(k,c).href;if(Array.isArray(v?.links)){const g=v.links.find(S=>S?.href&&(S.rel==="content"||S.rel==="self"||String(S.rel).includes("acquisition")));if(g?.href)return new URL(g.href,l).href}}const x=h.headers.get("Location")||h.headers.get("location");if(x)return new URL(x,c).href;if(b.includes("application/epub")||b.includes("application/pdf")||b.includes("application/octet-stream"))return c}if(h.status===401||h.status===403){const x=await ev(h).catch(()=>"");let v=null;try{(h.headers.get&&(h.headers.get("Content-Type")||"").includes("application/vnd.opds.authentication.v1.0+json")||x.trim().startsWith("{"))&&(v=JSON.parse(x))}catch{v=null}const k=new Error(`Acquisition requires authentication: ${h.status} ${h.statusText}`);k.status=h.status,v&&(k.authDocument=v);try{typeof l=="string"&&(l.includes("corsproxy.io")||l.includes("/proxy?url="))&&(k.proxyUsed=!0)}catch{}throw k}break}return null};function iv(r){let n="";for(let o=0;o<r.length;o+=32768){const c=r.subarray(o,o+32768);n+=String.fromCharCode.apply(null,Array.prototype.slice.call(c))}return n}const Dn=new WeakMap;async function ov(r){try{const s=Dn.get(r);if(s)return s}catch{}try{if(r&&typeof r.arrayBuffer=="function")try{const s=await r.arrayBuffer(),n=new Uint8Array(s);try{Dn.set(r,n)}catch{}return n}catch{}if(r&&typeof r.clone=="function"){const s=r.clone();try{const n=await s.arrayBuffer(),o=new Uint8Array(n);try{Dn.set(r,o)}catch{}return o}catch(n){const o=s.body&&s.body.getReader?s.body.getReader():null;if(!o)throw n;const c=[];let l=0;for(;;){const{done:p,value:h}=await o.read();if(p)break;if(h){const w=h instanceof Uint8Array?h:new Uint8Array(h);c.push(w),l+=w.length}}const d=new Uint8Array(l);let f=0;for(const p of c)d.set(p,f),f+=p.length;try{Dn.set(r,d)}catch{}return d}}if(r&&typeof r.text=="function"){const s=await r.text();let n;typeof TextEncoder<"u"?n=new TextEncoder().encode(s):typeof Buffer<"u"?n=new Uint8Array(Buffer.from(s,"utf-8")):n=new Uint8Array;try{Dn.set(r,n)}catch{}return n}if(r&&r.body){if(r.body instanceof Uint8Array){try{Dn.set(r,r.body)}catch{}return r.body}if(typeof Buffer<"u"&&Buffer.isBuffer(r.body)){const s=new Uint8Array(r.body);try{Dn.set(r,s)}catch{}return s}}return new Uint8Array}catch(s){throw s}}async function Bn(r){try{const s=await ov(r);try{return new TextDecoder("utf-8",{fatal:!1}).decode(s)}catch{try{return new TextDecoder("iso-8859-1",{fatal:!1}).decode(s)}catch{return iv(s)}}}catch(s){console.warn("safeReadText: fallback decode failed",s);try{if(r&&typeof r.text=="function")return await r.text()}catch{}return""}}const rc=r=>{if(!r)return;const s=r.split(";")[0].trim().toLowerCase();if(s.includes("epub")||s==="application/epub+zip")return"EPUB";if(s.includes("pdf")||s==="application/pdf")return"PDF";if(s.includes("audiobook")||s==="http://bib.schema.org/audiobook")return"AUDIOBOOK"},nc=r=>{if(!r)return;const s=Array.from(r.children);for(const n of s){if((n.localName||n.nodeName||"").toLowerCase()!=="indirectacquisition")continue;const c=nc(n);if(c)return c;const l=n.getAttribute("type")||void 0;if(rc(l))return l}for(const n of s){const o=nc(n);if(o)return o}},ai=(r,s)=>Array.from(r.children).find(c=>(c.localName||c.nodeName||"").toLowerCase()===s.toLowerCase())?.textContent?.trim()||void 0,av=(r,s)=>{const n=new Map;return(r||[]).forEach(o=>{n.set(o.href,o)}),(s||[]).forEach(o=>{n.set(o.href,o)}),n.size>0?Array.from(n.values()):void 0},lv=(r,s)=>{const n=new Map;return(r||[]).forEach(o=>{n.set(`${o.scheme}|${o.term}|${o.label}`,o)}),(s||[]).forEach(o=>{n.set(`${o.scheme}|${o.term}|${o.label}`,o)}),n.size>0?Array.from(n.values()):void 0},cv=(r,s)=>{const n=Array.from(new Set([...r||[],...s||[]].filter(Boolean)));return n.length>0?n:void 0},uv=(r,s)=>({...r,author:r.author||s.author,coverImage:r.coverImage||s.coverImage,downloadUrl:r.downloadUrl||s.downloadUrl,summary:r.summary||s.summary,publisher:r.publisher||s.publisher,publicationDate:r.publicationDate||s.publicationDate,providerId:r.providerId||s.providerId,distributor:r.distributor||s.distributor,subjects:cv(r.subjects,s.subjects),categories:lv(r.categories,s.categories),format:r.format||s.format,acquisitionMediaType:r.acquisitionMediaType||s.acquisitionMediaType,collections:av(r.collections,s.collections),isOpenAccess:r.isOpenAccess||s.isOpenAccess||void 0,availabilityStatus:r.availabilityStatus||s.availabilityStatus,schemaOrgType:r.schemaOrgType||s.schemaOrgType,publicationTypeLabel:r.publicationTypeLabel||s.publicationTypeLabel,mediumFormatCode:r.mediumFormatCode||s.mediumFormatCode}),Kh=r=>{if(r)for(const s of Array.from(r.children)){if((s.localName||s.nodeName||"").toLowerCase()==="availability")return s.getAttribute("status")||void 0;const o=Kh(s);if(o)return o}},dv=r=>{try{const s=new URL(r).hostname.toLowerCase();return s.endsWith("palace.io")||s.endsWith("palaceproject.io")||s.endsWith("thepalaceproject.org")||s==="palace.io"||s.endsWith(".palace.io")||s.endsWith(".thepalaceproject.org")}catch{return!1}},hn=(r,s)=>{const o=new DOMParser().parseFromString(r,"application/xml"),c=o.querySelector("parsererror");if(c)throw console.error("XML Parsing Error:",c.textContent),new Error("Failed to parse catalog feed. The URL may not point to a valid OPDS feed, or the response was not valid XML.");const l=o.documentElement?.nodeName;if(!l||l.toLowerCase()!=="feed"&&!l.endsWith(":feed"))throw new Error("Invalid Atom/OPDS feed. The XML document is missing the root <feed> element.");const d=Array.from(o.querySelectorAll("entry")),f=[],p=[],h=[],w={};let b;const x=new Set,v=new Map,k=dv(s),g=B=>{const Q=`${B.rel}|${B.url}`;x.has(Q)||(x.add(Q),p.push(B))},S=B=>{const Q=B.providerId||B.downloadUrl;if(!Q){f.push(B);return}const oe=v.get(Q);if(typeof oe=="number"){f[oe]=uv(f[oe],B);return}v.set(Q,f.length),f.push(B)},C=o.documentElement,R=ai(C,"totalResults"),I=ai(C,"itemsPerPage"),_=ai(C,"startIndex"),F=Number(R),M=Number(I),$=Number(_);if(Number.isFinite(F)&&(w.totalResults=F),Number.isFinite(M)&&(w.itemsPerPage=M),Number.isFinite($)&&(w.startIndex=$),Array.from(o.querySelectorAll("feed > link")).forEach(B=>{const Q=B.getAttribute("rel")||"",oe=String(Q).toLowerCase(),z=B.getAttribute("href");if(z){const H=new URL(z,s).href,N=B.getAttribute("type")||void 0;if(oe.includes("next")&&(w.next=H),(oe.includes("prev")||oe.includes("previous"))&&(w.prev=H),oe.includes("first")&&(w.first=H),oe.includes("last")&&(w.last=H),oe.includes("facet")){const X=B.getAttribute("title")?.trim();if(!X)return;const me=B.getAttribute("opds:facetGroup")||B.getAttribute("facetGroup")||"Facets",ee=B.getAttribute("opds:activeFacet")||B.getAttribute("activeFacet")||"",ie=B.getAttribute("thr:count")||B.getAttribute("count")||"",re=Number(ie),Z={title:X,url:H,type:N,rel:Q||void 0,count:Number.isFinite(re)?re:void 0,isActive:ee==="true"||ee==="active"},P=h.find(W=>W.title===me);P?P.links.push(Z):h.push({title:me,links:[Z]});return}if(oe==="search"){if(N?.toLowerCase().includes("application/opensearchdescription+xml")){b||={descriptionUrl:H,type:N,title:B.getAttribute("title")?.trim()||"Search",rel:Q||"search"};return}g({title:B.getAttribute("title")?.trim()||"Search",url:H,rel:Q||"search",type:N,source:"navigation"});return}(oe==="collection"||oe.includes("subsection"))&&g({title:B.getAttribute("title")?.trim()||H,url:H,rel:Q||"collection",type:N,source:"navigation"})}}),d.forEach(B=>{const Q=B.querySelector("title")?.textContent?.trim()||"Untitled",oe=Array.from(B.querySelectorAll("link")),z=B.getAttribute("schema:additionalType"),H=z==="http://bib.schema.org/Audiobook"||z==="http://schema.org/Audiobook",N=oe.find(be=>{const xe=be.getAttribute("rel")||"";return xe.includes("/open-access")||xe==="http://opds-spec.org/acquisition/open-access"}),X=N||oe.find(be=>{const xe=be.getAttribute("rel")||"",Ne=be.getAttribute("type")||"";return xe.includes("opds-spec.org/acquisition")&&(Ne.includes("epub+zip")||Ne.includes("pdf"))})||oe.find(be=>(be.getAttribute("rel")||"").includes("opds-spec.org/acquisition")),me=!!N;let ee;try{const be=B.getElementsByTagName("bibframe:distribution");if(be.length>0){const xe=be[0].getAttribute("bibframe:ProviderName")?.trim();ee=xe&&xe.length>0?xe:void 0}}catch{try{const xe=B.getElementsByTagName("distribution");if(xe.length>0){const Ne=xe[0].getAttribute("ProviderName")?.trim();ee=Ne&&Ne.length>0?Ne:void 0}}catch(xe){console.warn("Could not parse distributor information:",xe)}}const ie=Array.from(B.querySelectorAll('link[rel="collection"]')),re=ie.map(be=>{const xe=be.getAttribute("href"),Ne=be.getAttribute("title");if(xe&&Ne){const De=new URL(xe,s).href,$e=Ne.trim();return k&&ee&&$e.toLowerCase()===ee.toLowerCase()||g({title:$e,url:De,rel:"collection",type:be.getAttribute("type")||void 0,source:"navigation"}),{title:$e,href:De}}return null}).filter(be=>be!==null),Z=B.querySelector('link[rel="subsection"], link[rel="http://opds-spec.org/subsection"]'),P=ie.find(be=>{const xe=be.getAttribute("title")?.trim();return xe?!(k&&ee&&xe.toLowerCase()===ee.toLowerCase()):!1})||null,W=oe.find(be=>{const xe=(be.getAttribute("rel")||"").toLowerCase(),Ne=(be.getAttribute("type")||"").toLowerCase();return xe.includes("opds-spec.org/acquisition")?!1:Ne.includes("profile=opds-catalog")&&Ne.includes("kind=navigation")})||null,ye=oe.find(be=>{const xe=(be.getAttribute("rel")||"").toLowerCase(),Ne=(be.getAttribute("type")||"").toLowerCase();return xe.includes("opds-spec.org/acquisition")?!1:Ne.includes("profile=opds-catalog")&&Ne.includes("kind=acquisition")})||null,fe=(B.querySelector('link[rel="http://opds-spec.org/image"]')||B.querySelector('link[rel="http://opds-spec.org/image/thumbnail"]'))?.getAttribute("href"),Ae=fe?new URL(fe,s).href:null;if(X){const be=Array.from(B.querySelectorAll("author > name")).map(ae=>ae.textContent?.trim()).filter(ae=>!!ae),xe=be[0]||"Unknown Author",Ne=B.querySelector("summary")?.textContent?.trim()||B.querySelector("content")?.textContent?.trim()||null,De=X?.getAttribute("href"),$e=X?.getAttribute("type")||"",Ye=nc(X),Ve=rc($e)?$e:Ye;let j=rc(Ve||$e);H&&(j="AUDIOBOOK");const ue=Kh(X),ce=(B.querySelector("publisher")?.textContent||B.querySelector("dc\\:publisher")?.textContent)?.trim(),V=(B.querySelector("issued")?.textContent||B.querySelector("dc\\:issued")?.textContent||B.querySelector("published")?.textContent)?.trim(),D=ai(B,"identifier")||ai(B,"id"),q=Array.from(B.querySelectorAll("category")).map(ae=>{const J=ae.getAttribute("scheme")||"http://palace.io/subjects",A=ae.getAttribute("term")?.trim(),E=ae.getAttribute("label")?.trim();return A?{scheme:J,term:A,label:E||A}:null}).filter(ae=>ae!==null),te=q.map(ae=>ae.label);if(De){const ae=new URL(De,s).href;let J=Ve||$e;!J&&H&&(J="http://bib.schema.org/Audiobook"),S({title:Q,author:xe,coverImage:Ae,downloadUrl:ae,summary:Ne,publisher:ce||void 0,publicationDate:V||void 0,providerId:D,distributor:ee,subjects:te.length>0?te:void 0,contributors:be.length>1?be.slice(1):void 0,categories:q.length>0?q:void 0,format:j,acquisitionMediaType:J||void 0,collections:re.length>0?re:void 0,isOpenAccess:me||void 0,availabilityStatus:ue||void 0})}}else if(Z||P||W||ye){const be=Z||P||W||ye,xe=be?.getAttribute("href");xe&&g({title:Q,url:new URL(xe,s).href,rel:Z?"subsection":P?"collection":ye&&be===ye?"acquisition":"navigation",type:be?.getAttribute("type")||void 0,thumbnail:Ae||void 0,source:"navigation"})}}),l&&(l.toLowerCase()==="feed"||l.endsWith(":feed"))&&d.length===0){const B=o.documentElement,Q=!!(B&&B.getElementsByTagName("title")&&B.getElementsByTagName("title").length>0),oe=!!(B&&B.getElementsByTagName("link")&&B.getElementsByTagName("link").length>0);if(!Q&&!oe)throw new Error("The feed contains no entries.");return{books:[],navLinks:[],facetGroups:h,pagination:w}}if(l&&(l.toLowerCase()==="feed"||l.endsWith(":feed"))&&d.length>0&&f.length===0&&p.length===0)throw new Error("This appears to be a valid Atom feed, but it contains no recognizable OPDS book entries or navigation links. Please ensure the URL points to an OPDS catalog.");return{books:f,navLinks:p,facetGroups:h,pagination:w,search:b}},Vf=(r,s,n,o)=>{const c=s.get("x-mebooks-proxy-error-source");if(c==="upstream")return`The proxy reached the upstream server, but the upstream server denied the request (${s.get("x-mebooks-upstream-status")||"403"}) for ${r}. This is not a proxy allowlist rejection.`;if(n.includes("application/json"))try{const l=JSON.parse(o);if(l&&l.error&&typeof l.error=="string"){const d=typeof l.host=="string"?l.host:"",f=typeof l.protocol=="string"?l.protocol:"";if(l.error.toLowerCase().includes("host"))return`Proxy denied access to host for ${d||r}. The proxy's HOST_ALLOWLIST may need to include the upstream host.${f==="http:"?" This upstream is plain HTTP, so the proxy must explicitly allow that host and serve the browser over HTTPS.":""}`;if(c==="proxy")return`Proxy error: ${l.error}`}}catch{}return c==="proxy"?`The proxy itself denied the request for ${r}. Check proxy configuration and allowlist rules.`:`Proxy returned 403 for ${r}. The proxy may be blocking this host.`},fv=async(r,s,n="auto")=>{try{let o=r;const c=(()=>{try{return new URL(r).hostname.toLowerCase()}catch{return""}})(),l=c.endsWith("palace.io")||c.endsWith("palaceproject.io")||c.endsWith("thepalaceproject.org")||c==="palace.io"||c.endsWith(".palace.io")||c.endsWith(".thepalaceproject.org");ne.debug("fetchCatalogContent host classification",{hostname:c,isPalaceHost:l,forcedVersion:n});let d;l?d=Xt(r):d=await Cr(r);const f=l||n==="1"?"application/atom+xml;profile=opds-catalog, application/xml, text/xml, */*":"application/opds+json, application/atom+xml;profile=opds-catalog;q=0.9, application/json;q=0.8, application/xml;q=0.7, */*;q=0.5";ne.debug("fetchCatalogContent fetch details",{fetchUrl:d,acceptHeader:f});const p=d===r,h=await fetch(d,{method:"GET",mode:"cors",credentials:p?"include":"omit",headers:{Accept:f}});try{console.debug("[mebooks] initial response - status:",h.status,"content-type:",h.headers.get("Content-Type"))}catch{}const w=h.status>=300&&h.status<400,b=!!h.headers.get("Access-Control-Allow-Origin");if((w||p&&!b)&&Xt){const k=Xt(r),g=await fetch(k,{method:"GET",headers:{Accept:f}});if(g){const S=g.headers.get("Content-Type")||"",C=await Bn(g);if(g.status===403)throw new Error(Vf(r,g.headers,S,C));if(S.includes("text/html")&&C.trim().toLowerCase().startsWith("<!doctype html>"))throw new Error("The CORS proxy returned an HTML page instead of the catalog feed. This might indicate the proxy service is down or blocking the request. Please try another catalog or check back later.");if(console.debug("[mebooks] proxied response - forcedVersion:",n,"contentType:",S,"url:",r),n==="1"&&C.trim().startsWith("<"))return console.debug("[mebooks] Forcing OPDS1 (XML) parse for proxied response"),hn(C,o);if(S.includes("application/opds+json")||S.includes("application/json"))try{console.warn("[mebooks] Attempting to parse OPDS2 JSON (proxied), response length:",C.length);const R=JSON.parse(C);return console.warn("[mebooks] Successfully parsed OPDS2 JSON (proxied), keys:",Object.keys(R).slice(0,5)),Po(R,o)}catch(R){if(C&&C.trim().startsWith("<"))try{return console.warn("[mebooks] Response body appears to be XML despite JSON Content-Type; attempting XML parse"),hn(C,o)}catch(I){throw console.error("[mebooks] Failed to parse as XML after JSON Content-Type:",I),new Error("Failed to parse catalog content as both JSON and XML.")}else throw console.error("[mebooks] Failed to parse as JSON (proxied) and does not appear to be XML:",R),new Error("Failed to parse catalog content as JSON.")}else if(S.includes("application/atom+xml")||S.includes("application/xml")||S.includes("text/xml")||C.trim().startsWith("<"))try{return hn(C,o)}catch(R){throw console.error("[mebooks] Failed to parse as XML:",R),new Error("Failed to parse catalog content as XML.")}else throw console.error("[mebooks] Unsupported Content-Type or ambiguous response:",S),new Error(`Unsupported or ambiguous catalog format. Content-Type: "${S}"`)}}if(!h.ok){const k=`${h.status}${h.statusText?` ${h.statusText}`:""}`;let g=`The catalog server responded with an error (${k}). Please check the catalog URL.`;if((h.status===401||h.status===403&&p)&&(g=`Could not access catalog (${k}). This catalog requires authentication (a login or password), which is not supported by this application.`),h.status===403&&!p){const S=h.headers.get("Content-Type")||"",C=await Bn(h).catch(()=>"");g=Vf(r,h.headers,S,C)}throw h.status===429&&(g=`Could not access catalog (${k}). The request was rate-limited by the server or the proxy. Please wait a moment and try again.`),new Error(g)}const x=h.headers.get("Content-Type")||"",v=await Bn(h);if(p&&h.url&&(o=h.url),x.includes("text/html")&&v.trim().toLowerCase().startsWith("<!doctype html>"))throw new Error("The CORS proxy returned an HTML page instead of the catalog feed. This might indicate the proxy service is down or blocking the request. Please try another catalog or check back later.");if(console.debug("[mebooks] direct response - forcedVersion:",n,"contentType:",x,"url:",r),n==="1"&&v.trim().startsWith("<"))return console.debug("[mebooks] Forcing OPDS1 (XML) parse for direct response"),hn(v,o);if(console.warn("[mebooks] About to check JSON condition - forcedVersion:",n,"contentType includes opds+json:",x.includes("application/opds+json")),x.includes("application/opds+json")||x.includes("application/json"))try{console.warn("[mebooks] Attempting to parse OPDS2 JSON (direct), response length:",v.length);const k=JSON.parse(v);return console.warn("[mebooks] Successfully parsed OPDS2 JSON (direct), keys:",Object.keys(k).slice(0,5)),Po(k,o)}catch{if(v&&v.trim().startsWith("<"))try{return console.warn("[mebooks] Direct response body appears to be XML despite JSON Content-Type; attempting XML parse"),hn(v,o)}catch(g){throw console.error("[mebooks] Failed to parse as XML after JSON Content-Type:",g),new Error("Failed to parse catalog content as both JSON and XML.")}throw console.warn("[mebooks] Failed to JSON.parse response (direct)"),new Error(`Failed to parse JSON response for ${r}.`)}else{if(x.includes("application/atom+xml")||x.includes("application/xml")||x.includes("text/xml"))return hn(v,o);if(console.warn("[mebooks] Fell through to else block - forcedVersion:",n,"contentType:",x,"response starts with {:",v.trim().startsWith("{"),"response starts with <:",v.trim().startsWith("<")),n!=="1"&&v.trim().startsWith("{"))try{const k=JSON.parse(v);return Po(k,o)}catch{}if(v.trim().startsWith("<"))return hn(v,o);throw new Error(`Unsupported or ambiguous catalog format. Content-Type: "${x}".`)}}catch(o){console.error("Error fetching or parsing catalog content:",o);let c;return o instanceof TypeError?o.message.includes("exceeds response Body")?c="A network error occurred while downloading the catalog. The response was incomplete, which can be caused by an unstable connection or a proxy issue. Please try again.":o.message==="Failed to fetch"?c="Network Error: Failed to fetch the content. This could be due to your internet connection, the remote catalog being offline, or the public CORS proxy being temporarily unavailable.":c=`A network error occurred: ${o.message}`:o instanceof SyntaxError?c="Failed to parse the catalog feed. The response was not valid JSON or XML.":o instanceof Error?c=o.message:c="An unknown error occurred while loading the catalog.",{books:[],navLinks:[],facetGroups:[],pagination:{},error:c}}},hv=async(r,s,n=5)=>{let o=0;const c=["application/adobe+epub","application/pdf+lcp","application/vnd.readium.license.status.v1.0+json"],l=r;let d;try{const h=(()=>{try{return new URL(r).hostname.toLowerCase()}catch{return""}})();h.endsWith("palace.io")||h.endsWith("palaceproject.io")||h.endsWith("thepalaceproject.org")||h==="palace.io"||h.endsWith(".palace.io")||h.endsWith(".thepalaceproject.org")?d=Xt(r):d=await Cr(r)}catch{d=await Cr(r)}try{if(typeof d=="string"&&d.includes("corsproxy.io")&&s){const w=new Error("Acquisition would use a public CORS proxy which may strip Authorization or block POST requests. Configure an owned proxy (VITE_OWN_PROXY_URL) to perform authenticated borrows.");throw w.proxyUsed=!0,w}}catch(h){throw h}const f=(h=!1)=>{const w={Accept:"application/atom+xml, application/xml, text/xml, */*"};return h&&s&&(w.Authorization=`Basic ${btoa(`${s.username}:${s.password}`)}`),w},p=!!s;for(;o<n&&d;){o++;let h=null;try{const b=typeof d=="string"&&d===l;p?(h=await fetch(d,{method:"GET",headers:f(!0),credentials:b?"include":"omit"}),h.status===405&&(h=await fetch(d,{method:"POST",headers:f(!0),credentials:b?"include":"omit"}))):(h=await fetch(d,{method:"POST",headers:f(!1),credentials:b?"include":"omit"}),h.status===405&&(h=await fetch(d,{method:"GET",headers:f(!1),credentials:b?"include":"omit"})))}catch(b){throw b}if(!h)return null;if(h.status>=300&&h.status<400){const b=h.headers&&typeof h.headers.get=="function"?h.headers.get("Location")||h.headers.get("location"):null;if(b)return new URL(b,l).href}if(typeof h.ok=="boolean"?h.ok:h.status>=200&&h.status<300){const b=await Bn(h).catch(()=>"");try{if(b.trim().startsWith("<")){const k=new DOMParser().parseFromString(b,"application/xml"),g=Array.from(k.querySelectorAll("link")),S=["application/adobe+epub","application/pdf+lcp","application/vnd.readium.license.status.v1.0+json"],C=g.find(R=>{const I=(R.getAttribute("rel")||"").toLowerCase(),_=(R.getAttribute("type")||"").toLowerCase();return R.getAttribute("href")&&(I.includes("acquisition")||I.includes("borrow")||I.includes("loan")||I.includes("http://opds-spec.org/acquisition"))?(_&&(_.includes("epub")||_.includes("pdf")||S.some(M=>_.includes(M))),!0):!1});if(C){const R=C.getAttribute("href");return new URL(R,l).href}}}catch{}const x=h.headers&&typeof h.headers.get=="function"&&h.headers.get("Content-Type")||"";if(x.includes("application/epub")||x.includes("application/pdf")||x.includes("application/octet-stream"))return l;try{const v=b||await Bn(h).catch(()=>"");if(typeof d=="string"&&(d.includes("corsproxy.io")||d.includes("/proxy?url="))&&(x.includes("text/html")||v&&v.trim().startsWith("<"))){const g=new Error("Acquisition failed via public CORS proxy. The proxy may block POST requests or strip Authorization headers. Configure an owned proxy (VITE_OWN_PROXY_URL) to preserve credentials and HTTP methods.");throw g.status=h.status,g.proxyUsed=!0,g}}catch{}}try{const b=typeof d=="string"&&d===l,x=h.status===401||h.status===403,v=h.headers&&typeof h.headers.get=="function"&&!!h.headers.get("Access-Control-Allow-Origin");if(b&&x&&!v){const k=Xt(l),g=k&&k.includes("corsproxy.io");if(!k){const _=new Error("Acquisition failed and no proxy is available. Configure an owned proxy via VITE_OWN_PROXY_URL to allow authenticated downloads from the browser.");throw _.proxyUsed=!0,_}if(g){const _=new Error("Acquisition would require using a public CORS proxy which may strip Authorization or block POSTs. Configure an owned proxy (VITE_OWN_PROXY_URL).");throw _.proxyUsed=!0,_}const S=(_=!1)=>{const F={Accept:"application/atom+xml, application/xml, text/xml, */*"};return _&&s&&(F.Authorization=`Basic ${btoa(`${s.username}:${s.password}`)}`),F};let C=null;try{p?(C=await fetch(k,{method:"GET",headers:S(!0)}),C&&C.status===405&&(C=await fetch(k,{method:"POST",headers:S(!0)}))):(C=await fetch(k,{method:"POST",headers:S(!1)}),C&&C.status===405&&(C=await fetch(k,{method:"GET",headers:S(!1)})))}catch{const F=new Error("Failed to contact owned proxy for authenticated acquisition. Check your proxy configuration.");throw F.proxyUsed=!0,F}if(!C){const _=new Error("Proxy retry failed.");throw _.proxyUsed=!0,_}if(C.status>=300&&C.status<400){const _=C.headers&&typeof C.headers.get=="function"?C.headers.get("Location")||C.headers.get("location"):null;if(_)return new URL(_,l).href}if(typeof C.ok=="boolean"?C.ok:C.status>=200&&C.status<300){const _=await Bn(C).catch(()=>"");try{if(_.trim().startsWith("<")){const $=new DOMParser().parseFromString(_,"application/xml"),B=Array.from($.querySelectorAll("link")).find(Q=>{const oe=(Q.getAttribute("rel")||"").toLowerCase(),z=(Q.getAttribute("type")||"").toLowerCase();return Q.getAttribute("href")&&(oe.includes("acquisition")||oe.includes("borrow")||oe.includes("loan")||oe.includes("http://opds-spec.org/acquisition"))?(z&&(z.includes("epub")||z.includes("pdf")||c.some(N=>z.includes(N))),!0):!1});if(B){const Q=B.getAttribute("href");return new URL(Q,l).href}}}catch{}const F=C.headers&&typeof C.headers.get=="function"&&C.headers.get("Content-Type")||"";if(F.includes("application/epub")||F.includes("application/pdf")||F.includes("application/octet-stream"))return l}const I=new Error("Authenticated acquisition failed even after retrying via owned proxy.");throw I.proxyUsed=!0,I}}catch(b){throw b}if(h.status===401||h.status===403){const b=await Bn(h).catch(()=>"");let x=null;try{((h.headers.get("Content-Type")||"").includes("application/vnd.opds.authentication.v1.0+json")||b.trim().startsWith("{"))&&(x=JSON.parse(b))}catch{x=null}const v=new Error(`Acquisition requires authentication: ${h.status} ${h.statusText}`);v.status=h.status,x&&(v.authDocument=x);try{typeof d=="string"&&(d.includes("corsproxy.io")||d.includes("/proxy?url="))&&(v.proxyUsed=!0)}catch{}throw v}break}return null},pv=(r,s)=>s==="all"?r:r.filter(n=>{if(n.categories&&n.categories.length>0){const o=n.categories.filter(c=>c.scheme.includes("audience")||c.scheme.includes("target-age"));if(o.length>0)return o.some(l=>{const d=l.label.toLowerCase(),f=l.term.toLowerCase();switch(s){case"adult":return d.includes("adult")&&!d.includes("young")||f.includes("adult")&&!f.includes("young")||d.includes("18+")||f.includes("18+");case"young-adult":return d.includes("young adult")||d.includes("teen")||f.includes("young-adult")||f.includes("teen")||d.includes("ya")||f.includes("ya");case"children":return d.includes("children")||d.includes("child")||d.includes("juvenile")||d.includes("kids")||f.includes("children")||f.includes("child")||f.includes("juvenile")||f.includes("kids");default:return!1}})}return n.subjects&&n.subjects.length>0&&n.subjects.some(c=>{const l=c.toLowerCase();switch(s){case"adult":return l.includes("adult")&&!l.includes("young");case"young-adult":return l.includes("young adult")||l.includes("teen")||l.includes("ya");case"children":return l.includes("children")||l.includes("child")||l.includes("juvenile")||l.includes("kids");default:return!1}})?!0:s==="adult"}),mv=r=>{const s=new Set(["all"]);return r.forEach(n=>{n.categories&&n.categories.length>0&&n.categories.forEach(o=>{if(o.scheme.includes("audience")||o.scheme.includes("target-age")){const c=o.label.toLowerCase(),l=o.term.toLowerCase();(c.includes("adult")&&!c.includes("young")||l.includes("adult")&&!l.includes("young")||c.includes("18+")||l.includes("18+"))&&s.add("adult"),(c.includes("young adult")||c.includes("teen")||l.includes("young-adult")||l.includes("teen")||c.includes("ya")||l.includes("ya"))&&s.add("young-adult"),(c.includes("children")||c.includes("child")||c.includes("juvenile")||c.includes("kids")||l.includes("children")||l.includes("child")||l.includes("juvenile")||l.includes("kids"))&&s.add("children")}}),n.subjects&&n.subjects.length>0&&n.subjects.forEach(o=>{const c=o.toLowerCase();c.includes("adult")&&!c.includes("young")&&s.add("adult"),(c.includes("young adult")||c.includes("teen")||c.includes("ya"))&&s.add("young-adult"),(c.includes("children")||c.includes("child")||c.includes("juvenile")||c.includes("kids"))&&s.add("children")})}),Array.from(s)},gv=(r,s)=>s==="all"?r:r.filter(n=>{if(n.categories&&n.categories.length>0){const o=n.categories.filter(c=>c.scheme.includes("fiction")||c.scheme.includes("genre")||c.scheme.includes("bisac"));if(o.length>0){const c=o.some(l=>{const d=l.label.toLowerCase(),f=l.term.toLowerCase();if(d.includes("fiction")||f.includes("fiction"))return!d.includes("non-fiction")&&!f.includes("non-fiction");if(d.includes("non-fiction")||f.includes("non-fiction")||d.includes("nonfiction")||f.includes("nonfiction"))return!1;const p=["romance","mystery","thriller","fantasy","science fiction","horror","adventure","literary","drama","suspense"],h=["biography","history","science","philosophy","religion","self-help","health","business","politics","economics"],w=p.some(x=>d.includes(x)||f.includes(x));return h.some(x=>d.includes(x)||f.includes(x))?!1:w?!0:null});if(c!==null)return s==="fiction"?c:!c}}if(n.subjects&&n.subjects.length>0){const o=n.subjects.some(c=>{const l=c.toLowerCase();if(l.includes("fiction")&&!l.includes("non-fiction"))return!0;if(l.includes("non-fiction")||l.includes("nonfiction"))return!1;const d=["romance","mystery","thriller","fantasy","science fiction","horror","adventure","literary","drama","suspense"];return["biography","history","science","philosophy","religion","self-help","health","business","politics","economics"].some(w=>l.includes(w))?!1:d.some(w=>l.includes(w))?!0:null});if(o!==null)return s==="fiction"?o:!o}return!0}),yv=r=>{const s=new Set(["all"]);let n=!1,o=!1;return r.forEach(c=>{c.categories&&c.categories.length>0&&c.categories.forEach(l=>{if(l.scheme.includes("fiction")||l.scheme.includes("genre")||l.scheme.includes("bisac")){const d=String(l.label||"").toLowerCase(),f=String(l.term||"").toLowerCase();(d.includes("fiction")&&!d.includes("non-fiction")||f.includes("fiction")&&!f.includes("non-fiction"))&&(n=!0),(d.includes("non-fiction")||f.includes("non-fiction")||d.includes("nonfiction")||f.includes("nonfiction"))&&(o=!0);const p=["romance","mystery","thriller","fantasy","science fiction","horror","adventure","literary","drama","suspense"],h=["biography","history","science","philosophy","religion","self-help","health","business","politics","economics"],w=p.some(x=>d.includes(x)||f.includes(x)),b=h.some(x=>d.includes(x)||f.includes(x));w&&(n=!0),b&&(o=!0)}}),c.subjects&&c.subjects.length>0&&c.subjects.forEach(l=>{const d=String(l||"").toLowerCase();d.includes("fiction")&&!d.includes("non-fiction")&&(n=!0),(d.includes("non-fiction")||d.includes("nonfiction"))&&(o=!0);const f=["romance","mystery","thriller","fantasy","science fiction","horror","adventure","literary","drama","suspense"],p=["biography","history","science","philosophy","religion","self-help","health","business","politics","economics"],h=f.some(b=>d.includes(b)),w=p.some(b=>d.includes(b));h&&(n=!0),w&&(o=!0)})}),n&&s.add("fiction"),o&&s.add("non-fiction"),Array.from(s)},vv=(r,s)=>s==="all"?r:r.filter(n=>{const o=(n.acquisitionMediaType||n.mediaType)?.toLowerCase(),c=n.format?.toUpperCase();return s==="epub"?o==="application/epub+zip"||o?.includes("epub")||c==="EPUB":s==="pdf"?o==="application/pdf"||o?.includes("pdf")||c==="PDF":s==="audiobook"?o?.includes("bib.schema.org/audiobook")||o?.includes("audiobook")||c==="AUDIOBOOK":!1}),xv=r=>{const s=new Set(["all"]);return r.forEach(o=>{const c=o.acquisitionMediaType||o.mediaType,l=c?.toLowerCase(),d=o.format?.toUpperCase();(l?.includes("bib.schema.org/audiobook")||l?.includes("audiobook")||c==="http://bib.schema.org/Audiobook"||d==="AUDIOBOOK")&&s.add("audiobook"),(l==="application/epub+zip"||l?.includes("epub")||d==="EPUB")&&s.add("epub"),(l==="application/pdf"||l?.includes("pdf")||d==="PDF")&&s.add("pdf")}),Array.from(s)},Hf=r=>r&&(r.trim().split("/").filter(Boolean).pop()||r.trim()).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/[^a-zA-Z0-9]+/g,"-").replace(/^-+|-+$/g,"").toLowerCase()||void 0,wv=r=>{if(r.publicationTypeLabel?.trim())return r.publicationTypeLabel.trim();if(r.schemaOrgType?.trim()){const s=r.schemaOrgType.trim().split("/").filter(Boolean).pop();return s?s.replace(/([a-z0-9])([A-Z])/g,"$1 $2"):void 0}if(r.format?.toUpperCase()==="AUDIOBOOK")return"Audiobook"},Qh=r=>Hf(r.schemaOrgType)||Hf(r.publicationTypeLabel)||(r.format?.toUpperCase()==="AUDIOBOOK"?"audiobook":void 0),bv=(r,s)=>s==="all"?r:r.filter(n=>Qh(n)===s),kv=r=>{const s=new Map;return r.forEach(n=>{const o=Qh(n),c=wv(n);o&&c&&!s.has(o)&&s.set(o,c)}),Array.from(s.entries()).map(([n,o])=>({key:n,label:o}))},Sv=(r,s)=>s==="all"?r:r.filter(n=>(n.availabilityStatus||"available")===s),Cv=r=>{const s={available:"Available",unavailable:"Unavailable",reserved:"Reserved",ready:"Ready"},n=new Set;return r.forEach(o=>{n.add(o.availabilityStatus||"available")}),Array.from(n).sort().map(o=>({key:o,label:s[o]||o.replace(/-/g," ")}))},Nv=(r,s)=>s==="all"?r:r.filter(n=>(n.distributor||"").trim()===s),jv=r=>{const s=new Set;return r.forEach(n=>{const o=n.distributor?.trim();o&&s.add(o)}),Array.from(s).sort()},Ev="application/atom+xml;profile=opds-catalog",_v="application/opds+json",qf="__OPENSEARCH_OPEN__",Gf="__OPENSEARCH_CLOSE__";function Ul(r,s){return Array.from(r.children).find(c=>(c.localName||c.nodeName||"").toLowerCase()===s.toLowerCase())?.textContent?.trim()||void 0}function Av(r){const s=r.matchAll(/\{([^}]+)\}/g),n=[];for(const o of s){const c=String(o[1]||"").trim();if(!c)continue;(("?&/#.;+".includes(c[0]||"")?c[0]:"")?c.slice(1):c).split(",").map(p=>p.trim()).filter(Boolean).forEach(p=>{const h=!p.endsWith("?"),w=h?p:p.slice(0,-1),[b,x]=w.includes(":")?w.split(/:(.+)/,2):[void 0,w],v=(x||w).trim();v&&n.push({name:v,required:h,namespace:b?.trim()||void 0})})}return n}function Rv(r,s){const n=r.replaceAll("{",qf).replaceAll("}",Gf);return new URL(n,s).href.replaceAll(qf,"{").replaceAll(Gf,"}")}function Kf(r){const s=String(r.type||"").toLowerCase();return s.includes(Ev)?300:s.includes(_v)?200:s.includes("application/atom+xml")?150:s.includes("application/json")?100:0}function Tv(r){if(r.length!==0)return[...r].sort((s,n)=>{const o=Kf(n)-Kf(s);return o!==0?o:s.method.localeCompare(n.method)})[0]}function Pv(r){return r.replace(/([?&])[^=&?#]+=(?=&|$)/g,"$1").replace(/[?&]{2,}/g,"?").replace(/\?&/g,"?").replace(/[?&]+$/g,"")}function Xh(r){if(r.includes(":")){const[s,n]=r.split(/:(.+)/,2);return{lookupKey:n,queryKey:`${s}:${n}`}}return{lookupKey:r,queryKey:r}}function Ov(r,s){const n=!r.endsWith("?"),o=n?r:r.slice(0,-1),{lookupKey:c}=Xh(o),l=s[c]??s[o];if(l==null||String(l).length===0){if(n)throw new Error(`Missing required OpenSearch parameter: ${c}`);return""}return encodeURIComponent(String(l))}function Iv(r,s){const n="?&".includes(r[0]||"")?r[0]:"",c=(n?r.slice(1):r).split(",").map(d=>d.trim()).filter(Boolean);if(!n)return c.map(d=>Ov(d,s)).join(",");const l=c.map(d=>{const f=!d.endsWith("?"),p=f?d:d.slice(0,-1),{lookupKey:h,queryKey:w}=Xh(p),b=s[h]??s[p];if(b==null||String(b).length===0){if(f)throw new Error(`Missing required OpenSearch parameter: ${h}`);return null}return`${w}=${encodeURIComponent(String(b))}`}).filter(d=>d!==null);return l.length===0?"":`${n}${l.join("&")}`}function Lv(r,s){const o=new DOMParser().parseFromString(r,"application/xml");if(o.querySelector("parsererror"))throw new Error("Failed to parse OpenSearch description document.");if(!(o.documentElement?.nodeName?.toLowerCase()||"").includes("opensearchdescription"))throw new Error("Invalid OpenSearch description document.");const d=o.documentElement,p=Array.from(d.children).filter(h=>(h.localName||h.nodeName||"").toLowerCase()==="url").map(h=>{const w=h.getAttribute("template")?.trim();if(!w)return null;const b=Rv(w,s),x=h.getAttribute("method")?.trim()||"GET",v=h.getAttribute("rel")?.trim()||void 0,k=Number(h.getAttribute("indexOffset")),g=Number(h.getAttribute("pageOffset"));return{template:b,type:h.getAttribute("type")?.trim()||void 0,method:x,rel:v,indexOffset:Number.isFinite(k)?k:void 0,pageOffset:Number.isFinite(g)?g:void 0,params:Av(b)}}).filter(h=>h!==null);return{shortName:Ul(d,"ShortName"),description:Ul(d,"Description"),tags:Ul(d,"Tags")?.split(/\s+/).filter(Boolean),urls:p,activeTemplate:Tv(p)}}function Dv(r,s){const o=(typeof r=="string"?r:r.template).replace(/\{([^}]+)\}/g,(c,l)=>Iv(String(l||"").trim(),s));return Pv(o)}async function Fv(r){try{const s=await Cr(r,!0),n=await fetch(s,{method:"GET",headers:{Accept:"application/opensearchdescription+xml, application/xml, text/xml;q=0.9, */*;q=0.5"}});if(!n.ok)throw new Error(`Catalog search is unavailable because the OpenSearch description could not be loaded (${n.status}).`);const o=await n.text();return Lv(o,r)}catch(s){throw s instanceof Error&&(s.message.includes("Catalog search is unavailable")||s.message.includes("Invalid OpenSearch description document.")||s.message.includes("Failed to parse OpenSearch description document."))?s:new Error("Catalog search is unavailable because the OpenSearch description could not be reached.")}}const Bv={},Zh="970895595671-06di7pi5bs5hi96o9js5jr1eeo2pigm7.apps.googleusercontent.com".trim(),sc=Number(Bv?.VITE_GOOGLE_INIT_TIMEOUT_MS||12e3),Mv=["https://www.googleapis.com/auth/drive.file","openid","profile","email"].join(" "),kc="Custom Ebook Reader Library",Yh="books",Fo="library.json",Sc="latest.json",Jh="library-snapshot-",Qf="g_access_token_expires_at",Xf=3,Uv=400;let Zf=!1,Yf=!1,Jf=null;const zv=r=>new Promise(s=>setTimeout(s,r)),$v=r=>r===429||typeof r=="number"&&r>=500&&r<600,ep=r=>{if(!r||typeof r!="object")return;const s=r;if(typeof s.status=="number")return s.status;if(typeof s.code=="number")return s.code;if(typeof s.result?.error?.code=="number")return s.result.error.code},Ho=(r,s)=>{const n=ep(r);if(n===401)return new Error("Google session expired or permission was revoked. Please sign in again.");if(r&&typeof r=="object"){const o=r,c=o.result?.error,l=Array.isArray(c?.errors)?c.errors.map(f=>f?.reason||f?.message).filter(f=>!!(f&&f.trim().length>0)):[];if(n===403){const f=[c?.status,...l,c?.message,o.details,o.message].filter(p=>!!(p&&p.trim().length>0)).join(" | ").toLowerCase();if(f.includes("insufficient")||f.includes("scope"))return new Error("Google sign-in succeeded, but Drive access was not granted. Sign out, then sign in again and approve Google Drive access.")}const d=[o.error,o.details,o.message,c?.message,...l].filter(f=>!!(f&&f.trim().length>0));if(d.length>0)return new Error(d.join(" - "))}return r instanceof Error?r:new Error(s)};async function qo(r,s){let n=0;for(;n<Xf;)try{return await s()}catch(o){n+=1;const c=ep(o);if(!($v(c)||o instanceof TypeError&&o.message==="Failed to fetch")||n>=Xf)throw o;const d=Uv*Math.pow(2,n-1);ne.warn(`[google] ${r} failed, retrying`,{attempt:n,delay:d,status:c,error:o}),await zv(d)}throw new Error(`[google] ${r} failed after retries`)}function Wv(){if(!Zh)throw new Error("Google sync is not configured. Set VITE_GOOGLE_CLIENT_ID in your environment.")}const eh=(r,s,n=sc)=>new Promise((o,c)=>{const l=Date.now(),d=setInterval(()=>{const f=window[r];if(!!(f&&(!s||f[s]))){clearInterval(d),o(f);return}Date.now()-l>=n&&(clearInterval(d),c(new Error(`Timed out waiting for Google SDK (${r}${s?`.${s}`:""}) after ${n}ms.`)))},100)}),Vv=async()=>{Zf||await new Promise((r,s)=>{const n=setTimeout(()=>{s(new Error(`Timed out loading gapi client after ${sc}ms.`))},sc);window.gapi.load("client",()=>{window.gapi.client.init({discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}).then(()=>{Zf=!0,clearTimeout(n),r()}).catch(o=>{clearTimeout(n),s(o)})})})},bs=()=>{const r=window.gapi?.client?.getToken?.(),s=r?.access_token;if(!s)throw new Error("Google session not available. Please sign in before syncing.");let n=null;if(typeof r?.expires_at=="number"&&Number.isFinite(r.expires_at)&&(n=r.expires_at>1e12?r.expires_at:r.expires_at*1e3),n!==null&&n<=Date.now()+6e4)throw new Error("Google session expired. Please sign in again.");const o=localStorage.getItem(Qf),c=o?Number(o):NaN;return n===null&&Number.isFinite(c)&&c<=Date.now()+6e4&&localStorage.removeItem(Qf),s};async function Go(r){return qo("drive.files.list",()=>window.gapi.client.drive.files.list(r))}async function Hv(r){return qo("drive.files.create",()=>window.gapi.client.drive.files.create(r))}async function ic(r){return qo("drive.files.get",()=>window.gapi.client.drive.files.get(r))}const qv=r=>{const s=r.toISOString().replace(/[:.]/g,"-");return`${Jh}${s}.json`};async function Cc(r,s,n){return qo(n,async()=>{const o=await fetch(r,s);if(!o.ok){const c=new Error(`${n} failed: ${o.status} ${o.statusText}`);throw c.status=o.status,c}return o})}const Gv=r=>new Promise((s,n)=>{(async()=>{try{Wv(),await Promise.all([eh("gapi"),eh("google","accounts")]),Yf||(Jf=window.google.accounts.oauth2.initTokenClient({client_id:Zh,scope:Mv,include_granted_scopes:!0,callback:r}),Yf=!0),await Vv(),s(Jf)}catch(o){ne.error("Error during Google Client initialization:",o),n(Ho(o,"Failed to initialize Google Client."))}})()}),Kv=r=>{window.google?.accounts?.oauth2&&window.google.accounts.oauth2.revoke(r,()=>{ne.info("Access token revoked.")})},vi=async(r,s)=>{const n=`mimeType='application/vnd.google-apps.folder' and name='${r}' and trashed=false`+(s?` and '${s}' in parents`:""),o=await Go({q:n});if(o.result.files&&o.result.files.length>0)return o.result.files[0].id;const c={name:r,mimeType:"application/vnd.google-apps.folder",...s&&{parents:[s]}};return(await Hv({resource:c,fields:"id"})).result.id},xs=async(r,s)=>{const n=`'${r}' in parents and name='${s}' and trashed=false`,o=await Go({q:n,fields:"files(id,name)"});return o.result.files&&o.result.files.length>0?o.result.files[0]:null},zl=async(r,s,n)=>{const o=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),c=await xs(r,s);return c?.id?(await Qv(c.id,o,"application/json"),c.id):tp(r,s,o,"application/json")},tp=async(r,s,n,o)=>{const c={name:s,parents:[r]},l=new FormData;l.append("metadata",new Blob([JSON.stringify(c)],{type:"application/json"})),l.append("file",new Blob([n],{type:o}));const d=bs(),p=await(await Cc("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:new Headers({Authorization:`Bearer ${d}`}),body:l},"drive.uploadFile")).json();if(p.error)throw new Error(p.error.message);return p.id},Qv=async(r,s,n)=>{const o=bs(),l=await(await Cc(`https://www.googleapis.com/upload/drive/v3/files/${r}?uploadType=media`,{method:"PATCH",headers:new Headers({Authorization:`Bearer ${o}`,"Content-Type":n}),body:s},"drive.updateFile")).json();if(l.error)throw new Error(l.error.message);return l},Xv=async(r,s,n)=>{try{bs();const o=await vi(kc);localStorage.setItem("ebook-reader-drive-folder-id",o),n(`Uploading ${s.length} book files...`);const c=await vi(Yh,o),l=s.map(async(h,w)=>{n(`Uploading book ${w+1}/${s.length}: ${h.title}`);const b=(h.format||"epub").toLowerCase(),x=b==="pdf"?"application/pdf":"application/epub+zip",v=`${h.id}.${b}`;await tp(c,v,h.epubData,x)});await Promise.all(l),n("Uploading library metadata...");const d=new Date,f=qv(d),p=await zl(o,f,r);await zl(o,Fo,r),await zl(o,Sc,{latestSnapshotFileId:p,latestSnapshotFileName:f,updatedAt:d.toISOString(),version:1}),n("Upload complete!")}catch(o){throw Ho(o,"Upload failed.")}},Zv=async()=>{try{bs();const r=await vi(kc);let s,n;const o=await xs(r,Sc);if(o?.id)try{const p=await ic({fileId:o.id,alt:"media"}),h=JSON.parse(p.body||"{}");s=typeof h.latestSnapshotFileId=="string"?h.latestSnapshotFileId:void 0,n=typeof h.latestSnapshotFileName=="string"?h.latestSnapshotFileName:void 0}catch(p){ne.warn("Failed to parse latest.json pointer",p)}const c=`'${r}' in parents and name contains '${Jh}' and trashed=false`,l=await Go({q:c,fields:"files(id,name,createdTime,modifiedTime)",orderBy:"modifiedTime desc",pageSize:50}),f=(Array.isArray(l?.result?.files)?l.result.files:[]).filter(p=>typeof p?.id=="string"&&typeof p?.name=="string").map(p=>({id:p.id,name:p.name,createdAt:p.createdTime||p.modifiedTime||new Date(0).toISOString(),isLatest:s&&s===p.id||n&&n===p.name||!1}));if(f.length===0){const p=await xs(r,Fo);if(p?.id)return[{id:p.id,name:Fo,createdAt:new Date(0).toISOString(),isLatest:!0}]}return f}catch(r){throw Ho(r,"Failed to list Drive snapshots.")}},Yv=async(r,s)=>{try{bs(),r("Finding app folder in Drive...");const n=await vi(kc);r("Resolving metadata snapshot...");let o=s;if(!o){const p=await xs(n,Sc);if(p?.id)try{const h=await ic({fileId:p.id,alt:"media"}),w=JSON.parse(h.body||"{}");typeof w.latestSnapshotFileId=="string"?o=w.latestSnapshotFileId:typeof w.latestSnapshotFileName=="string"&&(o=(await xs(n,w.latestSnapshotFileName))?.id)}catch(h){ne.warn("Failed to resolve latest snapshot pointer; falling back to library.json",h)}}if(o||(o=(await xs(n,Fo))?.id),!o)return null;r("Downloading library metadata...");const c=await ic({fileId:o,alt:"media"}),l=JSON.parse(c.body);r("Finding books subfolder...");const d=await vi(Yh,n),f=[];for(let p=0;p<l.library.length;p++){const h=l.library[p];if(!h.id){ne.warn(`Book metadata for "${h.title}" is missing an ID, skipping download.`);continue}r(`Downloading book ${p+1}/${l.library.length}: ${h.title}`);const w=(h.format||"epub").toLowerCase(),b=`${h.id}.${w}`,x=`'${d}' in parents and name='${b}' and trashed=false`,v=await Go({q:x});if(!(v.result.files&&v.result.files.length>0)){ne.warn(`Book file for "${h.title}" (ID: ${h.id}, filename: ${b}) not found in Drive.`);continue}const k=v.result.files[0].id;try{const g=bs(),C=await(await Cc(`https://www.googleapis.com/drive/v3/files/${k}?alt=media`,{headers:{Authorization:`Bearer ${g}`}},"drive.downloadBookFile")).arrayBuffer(),R={...h,epubData:C};f.push(R)}catch(g){ne.warn(`Failed to download book file for "${h.title}" (ID: ${h.id}).`,g)}}return r("Download complete!"),{payload:l,booksWithData:f}}catch(n){throw Ho(n,"Download failed.")}};function th(r,s){const[n,o]=T.useState(()=>{try{const l=localStorage.getItem(r);return l?JSON.parse(l):s}catch(l){return ne.error(`Error reading localStorage key "${r}":`,l),s}});T.useEffect(()=>{try{localStorage.setItem(r,JSON.stringify(n))}catch(l){ne.error(`Error writing to localStorage key "${r}":`,l)}},[r,n]);const c=T.useCallback(()=>{try{localStorage.removeItem(r),o(s)}catch(l){ne.error(`Error removing localStorage key "${r}":`,l)}},[r,s]);return[n,o,c]}function rp(){const[r,s]=th(Ef.CATALOGS,[]),[n,o]=th(Ef.REGISTRIES,[]),c=T.useMemo(()=>n.map(({id:b,name:x,url:v})=>({id:b,name:x,url:v})),[n]);T.useEffect(()=>{if(r.some(x=>!x.opdsVersion)){const x=r.map(v=>v.opdsVersion?v:{...v,opdsVersion:"auto"});s(x)}},[r,s]),T.useEffect(()=>{n.some(x=>"opdsVersion"in x)&&o(c)},[n,c,o]);const l=T.useCallback((b,x,v="auto")=>{const k={id:new Date().toISOString(),name:b,url:x,opdsVersion:v};return s(g=>[...g,k]),k},[s]),d=T.useCallback(b=>{s(x=>x.filter(v=>v.id!==b))},[s]),f=T.useCallback((b,x)=>{s(v=>v.map(k=>k.id===b?{...k,...x}:k))},[s]),p=T.useCallback((b,x)=>{console.warn("[useCatalogs] addRegistry called:",{name:b,url:x});const v={id:new Date().toISOString(),name:b,url:x};return console.warn("[useCatalogs] Created registry object:",v),console.warn("[useCatalogs] Has opdsVersion?","opdsVersion"in v),o(k=>{const g=[...k,v];return console.warn("[useCatalogs] Updated registries:",g),g}),v},[o]),h=T.useCallback(b=>{o(x=>x.filter(v=>v.id!==b))},[o]),w=T.useCallback((b,x)=>{o(v=>v.map(k=>k.id===b?{...k,...x}:k))},[o]);return{catalogs:r,registries:c,addCatalog:l,deleteCatalog:d,updateCatalog:f,addRegistry:p,deleteRegistry:h,updateRegistry:w}}class Jv{constructor(){this.dbInstance=null}async init(){return this.dbInstance?this.dbInstance:new Promise((s,n)=>{const o=indexedDB.open(Wh,Vh);o.onerror=()=>{ne.error("IndexedDB error:",o.error),n(new Error("Failed to open IndexedDB"))},o.onsuccess=()=>{this.dbInstance=o.result,s(this.dbInstance)},o.onupgradeneeded=c=>{const l=c.target.result;let d;if(!l.objectStoreNames.contains(Ze))d=l.createObjectStore(Ze,{keyPath:"id",autoIncrement:!0}),d.createIndex(Ht.TITLE,Ht.TITLE,{unique:!1});else{const f=c.target.transaction;if(f)d=f.objectStore(Ze);else return}c.oldVersion<2&&(d.indexNames.contains(Ht.ISBN)||d.createIndex(Ht.ISBN,Ht.ISBN,{unique:!1})),c.oldVersion<3&&(d.indexNames.contains(Ht.PROVIDER_ID)||d.createIndex(Ht.PROVIDER_ID,Ht.PROVIDER_ID,{unique:!1}))}})}async save(s){try{const n=await this.init(),o=await new Promise((c,l)=>{const p=n.transaction(Ze,"readwrite").objectStore(Ze).put(s);p.onsuccess=()=>{c(p.result)},p.onerror=()=>{ne.error("Error saving book:",p.error),l(new Error("Failed to save book"))}});return ne.info(`Book saved successfully with ID: ${o}`),{success:!0,data:o}}catch(n){const o=n instanceof Error?n.message:"Unknown error saving book";return ne.error("BookRepository.save error:",o),{success:!1,error:o}}}async findById(s){try{const n=await this.init();return{success:!0,data:await new Promise((c,l)=>{const p=n.transaction(Ze,"readonly").objectStore(Ze).get(s);p.onsuccess=()=>{c(p.result)},p.onerror=()=>{ne.error("Error getting book:",p.error),l(new Error("Failed to get book"))}})||null}}catch(n){const o=n instanceof Error?n.message:"Unknown error finding book";return ne.error("BookRepository.findById error:",o),{success:!1,error:o}}}async findMetadataById(s){try{const n=await this.findById(s);if(!n.success)return{success:!1,error:"Failed to find book metadata"};if(!n.data)return{success:!0,data:null};const o=n.data;return{success:!0,data:{id:o.id,title:o.title,author:o.author,coverImage:o.coverImage,publisher:o.publisher,publicationDate:o.publicationDate,isbn:o.isbn,providerId:o.providerId,providerName:o.providerName,distributor:o.distributor,description:o.description,subjects:o.subjects,format:o.format,language:o.language,rights:o.rights,identifiers:o.identifiers,opfRaw:o.opfRaw,accessModes:o.accessModes,accessModesSufficient:o.accessModesSufficient,accessibilityFeatures:o.accessibilityFeatures,hazards:o.hazards,accessibilitySummary:o.accessibilitySummary,certificationConformsTo:o.certificationConformsTo,certification:o.certification,accessibilityFeedback:o.accessibilityFeedback}}}catch(n){const o=n instanceof Error?n.message:"Unknown error finding metadata";return ne.error("BookRepository.findMetadataById error:",o),{success:!1,error:o}}}async findAll(){try{const s=await this.init();return{success:!0,data:await new Promise((o,c)=>{const f=s.transaction(Ze,"readonly").objectStore(Ze).getAll();f.onsuccess=()=>{o(f.result)},f.onerror=()=>{ne.error("Error getting all books:",f.error),c(new Error("Failed to get all books"))}})}}catch(s){const n=s instanceof Error?s.message:"Unknown error finding all books";return ne.error("BookRepository.findAll error:",n),{success:!1,error:n}}}async findAllMetadata(){try{const s=await this.init(),n=await new Promise((o,c)=>{const f=s.transaction(Ze,"readonly").objectStore(Ze).openCursor(),p=[];f.onsuccess=h=>{const w=h.target.result;w?(p.push({...w.value}),w.continue()):(console.log("[BookRepository.findAllMetadata] Loaded metadata:",p),o(p))},f.onerror=()=>{ne.error("Error getting books metadata:",f.error),c(new Error("Failed to get books metadata"))}});return console.log("[BookRepository.findAllMetadata] Returning books:",n),{success:!0,data:n}}catch(s){const n=s instanceof Error?s.message:"Unknown error finding all metadata";return ne.error("BookRepository.findAllMetadata error:",n),{success:!1,error:n}}}async findByIdentifier(s){if(!s)return{success:!0,data:null};try{const n=await this.init(),o=async d=>new Promise((f,p)=>{try{const w=n.transaction(Ze,"readonly").objectStore(Ze);if(!w.indexNames.contains(d)){f(null);return}const x=w.index(d).get(s);x.onsuccess=()=>{f(x.result||null)},x.onerror=()=>{ne.error(`Error finding book by ${d}:`,x.error),p(new Error(`Failed to find book by ${d}`))}}catch(h){ne.error(`Error initiating search on index ${d}:`,h),f(null)}}),c=await o("providerId");return c?{success:!0,data:c}:{success:!0,data:await o("isbn")}}catch(n){const o=n instanceof Error?n.message:"Unknown error finding by identifier";return ne.error("BookRepository.findByIdentifier error:",o),{success:!1,error:o}}}async delete(s){try{const n=await this.init();return await new Promise((o,c)=>{const f=n.transaction(Ze,"readwrite").objectStore(Ze).delete(s);f.onsuccess=()=>{o()},f.onerror=()=>{ne.error("Error deleting book:",f.error),c(new Error("Failed to delete book"))}}),ne.info(`Book deleted successfully: ${s}`),{success:!0,data:void 0}}catch(n){const o=n instanceof Error?n.message:"Unknown error deleting book";return ne.error("BookRepository.delete error:",o),{success:!1,error:o}}}async deleteAll(){try{const s=await this.init();return await new Promise((n,o)=>{const d=s.transaction(Ze,"readwrite").objectStore(Ze).clear();d.onsuccess=()=>{n()},d.onerror=()=>{ne.error("Error clearing all books:",d.error),o(new Error("Failed to clear all books"))}}),ne.warn("All books cleared from library"),{success:!0,data:void 0}}catch(s){const n=s instanceof Error?s.message:"Unknown error clearing all books";return ne.error("BookRepository.deleteAll error:",n),{success:!1,error:n}}}async update(s,n){try{const o=await this.findById(s);if(!o.success)return{success:!1,error:"Failed to find book for update"};if(!o.data)return{success:!1,error:"Book not found"};const c={...o.data,...n,id:s};return(await this.save(c)).success?{success:!0,data:void 0}:{success:!1,error:"Failed to save updated book"}}catch(o){const c=o instanceof Error?o.message:"Unknown error updating book";return ne.error("BookRepository.update error:",c),{success:!1,error:c}}}async exists(s){const n=await this.findByIdentifier(s);return n.success?{success:!0,data:n.data!==null}:{success:!1,error:"Failed to check if book exists"}}async count(){try{const s=await this.init();return{success:!0,data:await new Promise((o,c)=>{const f=s.transaction(Ze,"readonly").objectStore(Ze).count();f.onsuccess=()=>{o(f.result)},f.onerror=()=>{ne.error("Error counting books:",f.error),c(new Error("Failed to count books"))}})}}catch(s){const n=s instanceof Error?s.message:"Unknown error counting books";return ne.error("BookRepository.count error:",n),{success:!1,error:n}}}}const np=new Jv,hi={all:["books"],detail:r=>["books",r],metadata:r=>["books",r,"metadata"]};function ex(){return fc({queryKey:hi.all,queryFn:async()=>{const r=await np.findAllMetadata();if(r.success)return r.data;{const s=r.error;throw ne.error("Failed to fetch books from repository:",s),new Error(s)}}})}function tx(){const r=Bo();return Qg({mutationFn:async s=>{const n=await np.delete(s);if(!n.success){const o=n.error;throw ne.error(`Failed to delete book ${s}:`,o),new Error(o)}},onSuccess:()=>{r.invalidateQueries({queryKey:hi.all})}})}class rx{async fetchCatalog(s,n,o="auto"){try{const c=(()=>{try{return new URL(s).hostname.toLowerCase()}catch{return""}})(),d=c.endsWith("palace.io")||c.endsWith("palaceproject.io")||c.endsWith("thepalaceproject.org")||c==="palace.io"||c.endsWith(".palace.io")||c.endsWith(".thepalaceproject.org")?"1":o,f=await fv(s,n,d);return f.error?{success:!1,error:f.error}:{success:!0,data:{books:f.books,navigationLinks:f.navLinks,facetGroups:f.facetGroups||[],pagination:f.pagination,search:f.search}}}catch(c){const l=c instanceof Error?c.message:"Unknown error fetching OPDS catalog";return ne.error("OPDS fetch error:",l),{success:!1,error:l}}}async parseOPDS1(s,n){try{ne.info("Parsing OPDS 1 feed",{baseUrl:n});const o=hn(s,n);return ne.info("OPDS 1 parse successful",{bookCount:o.books.length,navLinkCount:o.navLinks.length}),{success:!0,data:{books:o.books,navigationLinks:o.navLinks,facetGroups:o.facetGroups||[],pagination:o.pagination,search:o.search}}}catch(o){const c=o instanceof Error?o.message:"Unknown error parsing OPDS 1";return ne.error("OPDS 1 parse error:",c),{success:!1,error:c}}}async parseOPDS2(s,n){try{ne.info("Parsing OPDS 2 feed",{baseUrl:n});const o=Po(s,n);if(o.error){const c=o.error;return ne.error("OPDS 2 parse reported error",{baseUrl:n,error:c}),{success:!1,error:c}}return ne.info("OPDS 2 parse successful",{bookCount:o.books.length,navLinkCount:o.navLinks.length}),{success:!0,data:{books:o.books,navigationLinks:o.navLinks,facetGroups:o.facetGroups||[],pagination:o.pagination,search:o.search}}}catch(o){const c=o instanceof Error?o.message:"Unknown error parsing OPDS 2";return ne.error("OPDS 2 parse error:",c),{success:!1,error:c}}}async parseOPDS(s,n){try{if(typeof s=="object"&&s!==null)return this.parseOPDS2(s,n);const o=s.trim();if(o.startsWith("<"))return this.parseOPDS1(o,n);if(o.startsWith("{")||o.startsWith("["))try{const c=JSON.parse(o);return this.parseOPDS2(c,n)}catch{return{success:!1,error:"Invalid JSON content"}}return{success:!1,error:"Unable to detect OPDS version"}}catch(o){const c=o instanceof Error?o.message:"Unknown error parsing OPDS";return ne.error("OPDS auto-parse error:",c),{success:!1,error:c}}}detectVersion(s){if(typeof s=="object"&&s!==null)return"2";if(typeof s=="string"){const n=s.trim();if(n.startsWith("<"))return"1";if(n.startsWith("{")||n.startsWith("["))return"2"}return null}}class nx{async resolveOPDS2(s,n,o=5){try{ne.info("Resolving OPDS 2 acquisition chain",{href:s});const c=await sv(s,n,o);return c?(ne.info("OPDS 2 acquisition resolved",{finalUrl:c}),{success:!0,data:c}):{success:!1,error:"Failed to resolve acquisition chain"}}catch(c){const l=c instanceof Error?c.message:"Unknown error resolving acquisition";return ne.error("OPDS 2 acquisition error:",l),{success:!1,error:l,status:c?.status,proxyUsed:c?.proxyUsed}}}async resolveOPDS1(s,n,o=5){try{ne.info("Resolving OPDS 1 acquisition chain",{href:s});const c=await hv(s,n,o);return c?(ne.info("OPDS 1 acquisition resolved",{finalUrl:c}),{success:!0,data:c}):{success:!1,error:"Failed to resolve acquisition chain"}}catch(c){const l=c instanceof Error?c.message:"Unknown error resolving acquisition";return ne.error("OPDS 1 acquisition error:",l),{success:!1,error:l,status:c?.status,proxyUsed:c?.proxyUsed}}}async resolve(s,n="auto",o,c=5){if(n==="2")return this.resolveOPDS2(s,o,c);if(n==="1")return this.resolveOPDS1(s,o,c);ne.info("Auto-detecting OPDS version for acquisition",{href:s});const l=await this.resolveOPDS2(s,o,c);return l.success?l:(ne.info("OPDS 2 resolution failed, trying OPDS 1",{href:s}),this.resolveOPDS1(s,o,c))}}const sx=new rx,$l=new nx,ix={all:["catalogs"],content:(r,s,n)=>["catalogs","content",r,s,n]};function ox(r,s,n="auto",o=!0){return fc({queryKey:ix.content(r||"",s,n),queryFn:async()=>{if(!r)return{books:[],navigationLinks:[],facetGroups:[],pagination:{},search:null,error:"No URL provided"};ne.debug(`[useCatalogContent] Fetching: ${r}`);const c=await sx.fetchCatalog(r,s,n);if(!c.success)return{books:[],navigationLinks:[],facetGroups:[],pagination:{},search:null,error:"error"in c?c.error:"Failed to fetch catalog content"};const l=c.data.navigationLinks.length>0&&c.data.books.length===0;let d=c.data.navigationLinks;if(l&&c.data.pagination){const f=Object.values(c.data.pagination).filter(p=>!!p);d=c.data.navigationLinks.filter(p=>!f.includes(p.url))}return{books:c.data.books,navigationLinks:d,facetGroups:c.data.facetGroups,pagination:c.data.pagination,search:c.data.search||null,error:null}},enabled:o&&!!r,staleTime:120*1e3})}const ax={all:["catalog-search"],description:r=>["catalog-search","description",r]};function lx(r,s=!0){return fc({queryKey:ax.description(r?.descriptionUrl||""),queryFn:async()=>{if(!r?.descriptionUrl)throw new Error("No OpenSearch description URL provided");return Fv(r.descriptionUrl)},enabled:s&&!!r?.descriptionUrl,staleTime:600*1e3,retry:!1})}function cx(r={}){const{enableArrowKeys:s=!1,enableActivation:n=!1,enableEscape:o=!1,onArrowKey:c,onActivate:l,onEscape:d,preventDefault:f=!0,stopPropagation:p=!1}=r,h=T.useRef(c),w=T.useRef(l),b=T.useRef(d);T.useEffect(()=>{h.current=c,w.current=l,b.current=d},[c,l,d]);const x=T.useCallback(v=>{if(s&&h.current){let k=null;switch(v.key){case"ArrowUp":k="up";break;case"ArrowDown":k="down";break;case"ArrowLeft":k="left";break;case"ArrowRight":k="right";break}if(k){f&&v.preventDefault(),p&&v.stopPropagation(),h.current(k,v);return}}if(n&&w.current&&(v.key==="Enter"||v.key===" ")){f&&v.preventDefault(),p&&v.stopPropagation(),w.current(v);return}if(o&&b.current&&v.key==="Escape"){f&&v.preventDefault(),p&&v.stopPropagation(),b.current(v);return}},[s,n,o,f,p]);T.useEffect(()=>(window.addEventListener("keydown",x),()=>{window.removeEventListener("keydown",x)}),[x])}function yr(r){const{isActive:s,initialFocusRef:n,returnFocusRef:o,onEscape:c}=r,l=T.useRef(null),d=T.useRef(null),f=T.useCallback(h=>{const w=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])',"[contenteditable]"].join(",");return Array.from(h.querySelectorAll(w)).filter(x=>x.offsetParent!==null&&getComputedStyle(x).visibility!=="hidden")},[]),p=T.useCallback(h=>{if(l.current){if(h.key==="Escape"&&c){h.preventDefault(),c();return}if(h.key==="Tab"){const w=f(l.current);if(w.length===0){h.preventDefault();return}const b=w[0],x=w[w.length-1];if(h.shiftKey&&document.activeElement===b){h.preventDefault(),x.focus();return}if(!h.shiftKey&&document.activeElement===x){h.preventDefault(),b.focus();return}}}},[f,c]);return T.useEffect(()=>{if(!s||!l.current)return;d.current=document.activeElement;const h=f(l.current);n?.current?n.current.focus():h.length>0&&h[0].focus();const w=l.current;return w&&w.addEventListener("keydown",p),()=>{w&&w.removeEventListener("keydown",p),o?.current?o.current.focus():d.current&&d.current.focus()}},[s,n,o,f,p]),l}function ux(r){const{shortcuts:s,enabled:n=!0,preventInInputs:o=!0}=r,c=T.useRef(s);T.useEffect(()=>{c.current=s},[s]);const l=T.useCallback(d=>{if(!n)return;if(o){const p=d.target,h=p.tagName.toLowerCase();if(h==="input"||h==="textarea"||p.isContentEditable)return}const f=c.current.find(p=>{if(p.enabled===!1||!(d.key===p.key))return!1;const w=p.ctrl?d.ctrlKey||d.metaKey:!d.ctrlKey&&!d.metaKey,b=p.shift?d.shiftKey:!d.shiftKey,x=p.alt?d.altKey:!d.altKey;return w&&b&&x});f&&(f.preventDefault&&d.preventDefault(),f.action(d))},[n,o]);T.useEffect(()=>{if(n)return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}},[n,l])}function dx(r){const s=typeof navigator<"u"&&navigator.platform.toUpperCase().includes("MAC"),n=[];r.ctrl&&n.push(s?"":"Ctrl"),r.shift&&n.push(s?"":"Shift"),r.alt&&n.push(s?"":"Alt");let o=r.key;return o===" "?o="Space":o==="ArrowLeft"?o="":o==="ArrowRight"?o="":o==="ArrowUp"?o="":o==="ArrowDown"?o="":o==="Escape"&&(o="Esc"),n.push(o),n.join(s?"":"+")}const sp=({isOpen:r,onClose:s,onSave:n})=>{const[o,c]=T.useState(""),l=200,d=T.useRef(null),f=yr({isActive:r,initialFocusRef:d,onEscape:s});if(T.useEffect(()=>{r&&c("")},[r]),!r)return null;const p=()=>{n(o)},h=l-o.length;return a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{ref:f,className:"bg-slate-800 rounded-lg shadow-xl w-full max-w-md p-6 text-white",onClick:w=>w.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-bold text-sky-300",children:"Add Bookmark"}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-slate-300 mb-4 text-sm",children:"A bookmark for the current location will be created. You can add an optional note below."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"bookmark-note",className:"block text-sm font-medium text-slate-400 mb-2",children:"Note (optional)"}),a.jsx("textarea",{ref:d,id:"bookmark-note",rows:4,value:o,onChange:w=>{w.target.value.length<=l&&c(w.target.value)},className:"w-full bg-slate-700 rounded-md p-2 text-sm focus:outline-none focus:ring-2 focus:ring-sky-500",placeholder:"Add a brief note..."}),a.jsxs("p",{className:`text-xs mt-1 text-right ${h<20?"text-red-400":"text-slate-500"}`,children:[h," characters remaining"]})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx("button",{onClick:s,className:"py-2 px-4 rounded-md bg-slate-600 hover:bg-slate-500 transition-colors font-semibold",children:"Cancel"}),a.jsx("button",{onClick:p,className:"py-2 px-6 rounded-md bg-sky-500 hover:bg-sky-600 transition-colors font-bold",children:"Save Bookmark"})]})]})})},ip=({isOpen:r,onClose:s,onSave:n})=>{const[o,c]=T.useState(""),l=50,d=T.useRef(null),f=yr({isActive:r,initialFocusRef:d,onEscape:s});if(T.useEffect(()=>{r&&c("")},[r]),!r)return null;const p=()=>{n(o)},h=l-o.length;return a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{ref:f,className:"bg-slate-800 rounded-lg shadow-xl w-full max-w-md p-6 text-white",onClick:w=>w.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-bold text-sky-300",children:"Create Citation"}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-slate-300 mb-4 text-sm",children:"A citation for the current location will be created. You can add an optional note below."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"citation-note",className:"block text-sm font-medium text-slate-400 mb-2",children:"Note (optional)"}),a.jsx("textarea",{ref:d,id:"citation-note",rows:3,value:o,onChange:w=>{w.target.value.length<=l&&c(w.target.value)},className:"w-full bg-slate-700 rounded-md p-2 text-sm focus:outline-none focus:ring-2 focus:ring-sky-500",placeholder:"Add a brief note..."}),a.jsxs("p",{className:`text-xs mt-1 text-right ${h<10?"text-red-400":"text-slate-500"}`,children:[h," characters remaining"]})]}),a.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[a.jsx("button",{onClick:s,className:"py-2 px-4 rounded-md bg-slate-600 hover:bg-slate-500 transition-colors font-semibold",children:"Discard"}),a.jsx("button",{onClick:p,className:"py-2 px-6 rounded-md bg-sky-500 hover:bg-sky-600 transition-colors font-bold",children:"Save Citation"})]})]})})},yn=({text:r,size:s="medium"})=>{const n=s==="small"?"h-5 w-5 border-2":"h-12 w-12 border-b-2",o=s==="small"?"text-sm":"text-base";return a.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",role:"status","aria-live":"polite","aria-busy":"true",children:[a.jsx("div",{className:`animate-spin rounded-full border-sky-400 ${n}`,"aria-hidden":"true"}),r&&a.jsx("p",{className:`text-sky-300 ${o}`,children:r}),!r&&a.jsx("span",{className:"sr-only",children:"Loading..."})]})},fx=({excerpt:r,query:s})=>{if(!s)return a.jsx("span",{children:r});const n=s.toLowerCase(),o=r.replace(/\s+/g," ").trim(),l=o.toLowerCase().indexOf(n);if(l===-1){const v=r.split(new RegExp(`(${s})`,"gi"));return a.jsx("span",{className:"text-sm text-slate-300 group-hover:text-slate-100 transition-colors",children:v.map((k,g)=>k.toLowerCase()===n?a.jsx("strong",{className:"text-sky-300 bg-sky-800/50 font-normal rounded",children:k},g):a.jsx("span",{children:k},g))})}let d=o.lastIndexOf(".",l);d=Math.max(d,o.lastIndexOf("!",l)),d=Math.max(d,o.lastIndexOf("?",l));let f=o.indexOf(".",l+s.length);f===-1&&(f=1/0);let p=o.indexOf("!",l+s.length);p!==-1&&(f=Math.min(f,p)),p=o.indexOf("?",l+s.length),p!==-1&&(f=Math.min(f,p)),f===1/0?f=o.length:f++,d===-1?d=0:d++;const h=o.substring(d,f).trim(),w=d>0,b=f<o.length,x=h.split(new RegExp(`(${s})`,"gi"));return a.jsxs("span",{className:"text-sm text-slate-300 group-hover:text-slate-100 transition-colors",children:[w&&"...",x.map((v,k)=>v.toLowerCase()===n?a.jsx("strong",{className:"text-sky-300 bg-sky-800/50 font-normal rounded",children:v},k):a.jsx("span",{children:v},k)),b&&"..."]})},hx=({isOpen:r,onClose:s,onQueryChange:n,onNavigate:o,results:c,isLoading:l,searchQuery:d})=>r?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black/60 z-30",onClick:s,"aria-hidden":"true"}),a.jsxs("div",{className:`fixed top-0 left-0 h-full w-80 bg-slate-800 shadow-2xl z-40 transform transition-transform duration-300 ease-in-out flex flex-col ${r?"translate-x-0":"-translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"search-heading",children:[a.jsxs("div",{className:"p-4 border-b border-slate-700 flex justify-between items-center flex-shrink-0",children:[a.jsx("h3",{id:"search-heading",className:"text-xl font-semibold text-white",children:"Search"}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700","aria-label":"Close search",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"p-4 border-b border-slate-700 flex-shrink-0",children:a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:a.jsx(Mh,{className:"w-5 h-5 text-slate-400"})}),a.jsx("input",{type:"search",placeholder:"Search in book...",value:d,onChange:f=>n(f.target.value),className:"w-full bg-slate-700 text-white rounded-md pl-10 pr-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Search input",autoFocus:!0})]})}),a.jsx("div",{className:"overflow-y-auto flex-grow",children:l?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(yn,{text:"Searching..."})}):d&&c.length>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-xs text-slate-400 px-4 pt-4 pb-2",children:[c.length," result",c.length!==1&&"s",' found for "',d,'"']}),a.jsx("ul",{className:"divide-y divide-slate-700",children:c.map((f,p)=>a.jsx("li",{className:"group",children:a.jsx("button",{onClick:()=>o(f.cfi),className:"w-full text-left p-4 hover:bg-sky-500/10 transition-colors",children:a.jsx(fx,{excerpt:f.excerpt.trim(),query:d})})},p))})]}):d&&c.length===0?a.jsxs("p",{className:"p-8 text-slate-400 text-center",children:['No results found for "',d,'".']}):a.jsx("p",{className:"p-8 text-slate-400 text-center",children:"Enter a term above to search the book."})})]})]}):null,px=({isOpen:r,onClose:s,settings:n,onSettingsChange:o})=>{const[c,l]=T.useState("display"),[d,f]=T.useState([]);if(T.useEffect(()=>{if(r){const b=()=>{const x=window.speechSynthesis.getVoices();x.length>0&&f(x)};return b(),window.speechSynthesis.onvoiceschanged=b,()=>{window.speechSynthesis.onvoiceschanged=null}}},[r]),!r)return null;const p=b=>{o({readAloud:{...n.readAloud,...b}})},h=b=>{window.speechSynthesis.cancel();const x=new SpeechSynthesisUtterance("Hello, this is a preview of my voice.");x.voice=b,x.rate=n.readAloud.rate,x.pitch=n.readAloud.pitch,window.speechSynthesis.speak(x)},w=()=>{const b=d.find(x=>x.voiceURI===n.readAloud.voiceURI);return a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Voice"}),a.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-md mb-4",children:[a.jsx("p",{className:"text-xs text-slate-400 text-center",children:"Current Voice"}),a.jsx("p",{className:"font-semibold text-sky-300 truncate text-center",title:b?b.name:"System Default",children:b?b.name:"System Default"})]}),a.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Select a new voice from the list below:"}),a.jsx("div",{className:"max-h-48 overflow-y-auto rounded-md border border-slate-600 bg-slate-700/50",children:a.jsx("ul",{className:"divide-y divide-slate-600",children:d.length>0?d.map(x=>a.jsxs("li",{className:`flex items-center justify-between p-2 text-sm transition-colors ${n.readAloud.voiceURI===x.voiceURI?"bg-sky-500/20 text-sky-300":"hover:bg-slate-700"}`,children:[a.jsxs("button",{onClick:()=>p({voiceURI:x.voiceURI}),className:"flex-grow text-left pr-2",children:[a.jsx("span",{className:"font-medium",children:x.name}),a.jsx("span",{className:"text-xs text-slate-400 block",children:x.lang})]}),a.jsx("button",{onClick:()=>h(x),className:"p-2 rounded-full hover:bg-slate-600 flex-shrink-0","aria-label":`Preview voice ${x.name}`,children:a.jsx(zh,{className:"w-4 h-4"})})]},x.voiceURI)):a.jsx("li",{className:"p-4 text-center text-slate-400",children:"Loading voices..."})})})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"read-speed",className:"block text-sm font-medium text-slate-300 mb-2",children:"Speed"}),a.jsx("input",{id:"read-speed",type:"range",min:"0.5",max:"2",step:"0.1",value:n.readAloud.rate,onChange:x=>p({rate:parseFloat(x.target.value)}),className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"}),a.jsxs("div",{className:"text-center text-slate-400 text-sm mt-1",children:[n.readAloud.rate.toFixed(1),"x"]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"read-pitch",className:"block text-sm font-medium text-slate-300 mb-2",children:"Pitch"}),a.jsx("input",{id:"read-pitch",type:"range",min:"0",max:"2",step:"0.1",value:n.readAloud.pitch,onChange:x=>p({pitch:parseFloat(x.target.value)}),className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"}),a.jsx("div",{className:"text-center text-slate-400 text-sm mt-1",children:n.readAloud.pitch.toFixed(1)})]})]})};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black/60 z-30",onClick:s}),a.jsxs("div",{className:`fixed top-0 right-0 h-full w-80 bg-slate-800 shadow-2xl z-40 transform transition-transform duration-300 ease-in-out flex flex-col ${r?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"settings-panel-title",children:[a.jsxs("div",{className:"p-4 border-b border-slate-700 flex justify-between items-center flex-shrink-0",children:[a.jsx("h3",{id:"settings-panel-title",className:"text-xl font-semibold text-white",children:"Settings"}),a.jsx("button",{onClick:s,"aria-label":"Close settings",className:"p-2 rounded-full hover:bg-slate-700",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"border-b border-slate-700 px-2 flex-shrink-0",children:a.jsxs("nav",{className:"flex -mb-px",children:[a.jsxs("button",{onClick:()=>l("display"),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 ${c==="display"?"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white hover:border-slate-500"}`,children:[a.jsx(ty,{className:"w-5 h-5"}),"Display"]}),a.jsxs("button",{onClick:()=>l("readAloud"),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 ${c==="readAloud"?"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white hover:border-slate-500"}`,children:[a.jsx(ey,{className:"w-5 h-5"}),"Read Aloud"]})]})}),a.jsxs("div",{className:"p-6 text-white overflow-y-auto flex-grow",children:[c==="display"&&a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"font-size",className:"block text-sm font-medium text-slate-300 mb-2",children:"Font Size"}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("span",{className:"text-lg",children:"A"}),a.jsx("input",{id:"font-size",type:"range",min:"80",max:"200",step:"1",value:n.fontSize,onChange:b=>o({fontSize:parseInt(b.target.value,10)}),className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"}),a.jsx("span",{className:"text-3xl",children:"A"})]}),a.jsxs("div",{className:"text-center text-slate-400 text-sm mt-1",children:[n.fontSize,"%"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Theme"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("button",{onClick:()=>o({theme:"light"}),className:`p-4 rounded-lg border-2 transition-colors ${n.theme==="light"?"border-sky-500 bg-sky-500/20":"border-slate-600 hover:border-slate-500"}`,children:[a.jsx("div",{className:"w-full h-12 bg-white rounded"}),a.jsx("p",{className:"mt-2 text-center text-sm font-medium",children:"Light"})]}),a.jsxs("button",{onClick:()=>o({theme:"dark"}),className:`p-4 rounded-lg border-2 transition-colors ${n.theme==="dark"?"border-sky-500 bg-sky-500/20":"border-slate-600 hover:border-slate-500"}`,children:[a.jsx("div",{className:"w-full h-12 bg-gray-900 rounded"}),a.jsx("p",{className:"mt-2 text-center text-sm font-medium",children:"Dark"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Font Family"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:["Original","Serif","Sans-Serif"].map(b=>a.jsx("button",{onClick:()=>o({fontFamily:b}),className:`py-2 px-1 rounded-lg border-2 transition-colors text-center text-sm truncate ${n.fontFamily===b?"border-sky-500 bg-sky-500/20":"border-slate-600 hover:border-slate-500"}`,children:a.jsx("span",{className:b==="Serif"?"font-serif-custom":b==="Sans-Serif"?"font-sans-custom":"font-original",children:b})},b))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Reading Mode"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("button",{onClick:()=>o({flow:"paginated"}),className:`p-4 rounded-lg border-2 transition-colors text-center ${n.flow==="paginated"?"border-sky-500 bg-sky-500/20":"border-slate-600 hover:border-slate-500"}`,children:[a.jsx("span",{className:"block text-sm font-medium",children:"Paginated"}),a.jsx("span",{className:"block text-xs text-slate-400 mt-1",children:"Turn pages like a real book."})]}),a.jsxs("button",{onClick:()=>o({flow:"scrolled"}),className:`p-4 rounded-lg border-2 transition-colors text-center ${n.flow==="scrolled"?"border-sky-500 bg-sky-500/20":"border-slate-600 hover:border-slate-500"}`,children:[a.jsx("span",{className:"block text-sm font-medium",children:"Scrolled"}),a.jsx("span",{className:"block text-xs text-slate-400 mt-1",children:"Scroll like a webpage."})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Citation Format"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:["APA","MLA"].map(b=>a.jsx("button",{onClick:()=>o({citationFormat:b.toLowerCase()}),className:`py-2 px-1 rounded-lg border-2 transition-colors text-center text-sm truncate ${n.citationFormat===b.toLowerCase()?"border-sky-500 bg-sky-500/20":"border-slate-600 hover:border-slate-500"}`,children:b},b))})]})]}),c==="readAloud"&&a.jsx(w,{})]})]})]})},Wl=({children:r,label:s,placement:n="top"})=>{const[o,c]=T.useState(!1),l=T.useRef(null);return a.jsxs("div",{ref:l,className:"relative inline-flex",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),onFocus:()=>c(!0),onBlur:()=>c(!1),children:[r,a.jsx("div",{role:"tooltip","aria-hidden":!o,className:`pointer-events-none z-50 absolute whitespace-nowrap bg-slate-800 text-white text-xs rounded px-2 py-1 transition-all duration-200 transform ${o?"opacity-100 scale-100":"opacity-0 scale-95"}`+(n==="top"?" -bottom-9 left-1/2 -translate-x-1/2":""),children:s})]})},Nc=({isOpen:r,onClose:s,onZoomIn:n,onZoomOut:o,onToggleFit:c,activeReader:l=null})=>{const d=T.useRef(null),f=yr({isActive:r,initialFocusRef:d,onEscape:s});if(!r)return null;const p=[{key:"?",description:"Show/hide keyboard shortcuts",category:"global",action:()=>{}},{key:"Escape",description:"Close active modal or return to library",category:"global",action:()=>{}}],h=l?[{key:"ArrowLeft",description:"Previous page",category:"reader",action:()=>{}},{key:"ArrowRight",description:"Next page",category:"reader",action:()=>{}},{key:" ",description:"Next page",category:"reader",action:()=>{}},{key:"+",description:`Zoom in ${l==="epub"?"(increase font size)":""}`,category:"reader",action:()=>{}},{key:"-",description:`Zoom out ${l==="epub"?"(decrease font size)":""}`,category:"reader",action:()=>{}},{key:"f",description:"Toggle fit width / fit page",category:"reader",action:()=>{}},{key:"c",description:"Open/close contents & bookmarks",category:"reader",action:()=>{}},{key:"b",description:"Add a quick bookmark for current page",category:"reader",action:()=>{}}]:[],w=b=>a.jsxs("li",{className:"flex items-start gap-2",children:[a.jsx("kbd",{className:"px-2 py-1 bg-slate-700 rounded text-xs font-mono min-w-[3rem] text-center",children:dx(b)}),a.jsx("span",{className:"flex-1",children:b.description})]},`${b.key}-${b.description}`);return a.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center",role:"presentation",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:s}),a.jsxs("div",{ref:f,role:"dialog","aria-modal":"true","aria-labelledby":"shortcut-help-title",className:"relative bg-slate-800 text-white rounded-lg shadow-lg max-w-2xl w-full mx-4 p-6 max-h-[90vh] overflow-y-auto",onClick:b=>b.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{id:"shortcut-help-title",className:"text-xl font-bold",children:"Keyboard Shortcuts"}),a.jsx("button",{ref:d,onClick:s,className:"p-2 rounded hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Close help",children:""})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wide mb-3",children:"Global"}),a.jsx("ul",{className:"space-y-2 text-sm",children:p.map(w)})]}),l&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("h4",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wide mb-3",children:["Reader (",l==="epub"?"EPUB":"PDF",")"]}),a.jsx("ul",{className:"space-y-2 text-sm",children:h.map(w)})]}),l&&n&&o&&c&&a.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-700",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wide mb-3",children:"Quick Actions"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Wl,{label:"Zoom out (-)",children:a.jsx("button",{onClick:o,className:"p-3 rounded-full bg-slate-700 hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Zoom out",children:a.jsx(ry,{className:"w-5 h-5 text-slate-50"})})}),a.jsx(Wl,{label:"Zoom in (+)",children:a.jsx("button",{onClick:n,className:"p-3 rounded-full bg-slate-700 hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Zoom in",children:a.jsx($h,{className:"w-5 h-5 text-slate-50"})})}),a.jsx(Wl,{label:"Toggle fit (F)",children:a.jsx("button",{onClick:c,className:"p-3 rounded-full bg-slate-700 hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Toggle fit mode",children:a.jsx(Z0,{className:"w-5 h-5 text-slate-50"})})})]})]}),a.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-700 text-xs text-slate-400",children:[a.jsx("p",{children:" Tip: Keyboard shortcuts are disabled when typing in text fields."}),a.jsxs("p",{className:"mt-1",children:["Press ",a.jsx("kbd",{className:"px-1 py-0.5 bg-slate-700 rounded text-xs",children:"?"})," anytime to view this help."]})]})]})]})},op=r=>{if(!r)return"n.d.";const s=new Date(r).getFullYear();if(!isNaN(s))return s.toString();const n=r.match(/^\d{4}/);return n?n[0]:"n.d."},ap=(r,s)=>{const n=r.split(" ").filter(l=>l.trim());if(n.length<2)return r;const o=n.pop(),c=n;if(s==="apa"){const l=c.map(d=>d[0]?`${d[0]}.`:"").join(" ");return`${o}, ${l}`}return`${o}, ${c.join(" ")}`},mx=(r,s)=>{const n=r.author||"Unknown Author",o=r.title||"Untitled Book",c=r.publisher||"[Publisher not available]",l=op(r.publicationDate),d=ap(n,s);switch(s){case"apa":return{pre:`${d} (${l}). `,title:o,post:`. ${c}.`,isItalic:!0};case"mla":return{pre:`${d}. `,title:o,post:`. ${c}, ${l==="n.d."?"[Date not available]":l}.`,isItalic:!0};case"chicago":return{pre:`${d}. `,title:o,post:`. ${c}, ${l==="n.d."?"[Date not available]":l}.`,isItalic:!1};default:return{pre:`${n}. `,title:o,post:".",isItalic:!1}}},gx=(r,s)=>{const n=[],o=op(r.publicationDate);return s.forEach(c=>{const l=[];l.push("TY  - CHAP"),r.author&&l.push(`AU  - ${ap(r.author,"ris")}`),r.title&&l.push(`T2  - ${r.title}`),r.publisher&&l.push(`PB  - ${r.publisher}`),o!=="n.d."&&l.push(`PY  - ${o}`),r.isbn&&l.push(`SN  - ${r.isbn}`),c.chapter&&l.push(`TI  - ${c.chapter}`),c.pageNumber&&l.push(`SP  - ${c.pageNumber}`);const d=(c.note||"").replace(/(\r\n|\n|\r)/gm," ");d&&l.push(`N1  - ${d}`),l.push("ER  - "),n.push(l.join(`\r
`))}),n.join(`\r
\r
`)+`\r
`},lp=({item:r,onNavigate:s,level:n})=>{const[o,c]=T.useState(!1),l=!!(r.subitems&&r.subitems.length>0),f=n===0?"font-semibold text-slate-200":"font-normal text-slate-300";return a.jsxs("li",{children:[a.jsxs("div",{className:"flex items-center justify-between w-full py-2 pr-3 hover:bg-sky-500/10","data-level":n,children:[a.jsx("button",{onClick:()=>{r.href&&s(r.href)},className:`flex-1 text-left ${f} group-hover:text-sky-300 transition-colors focus:outline-none`,"aria-label":`Go to ${r.label}`,children:r.label.trim()}),l&&a.jsx("button",{onClick:()=>c(!o),"aria-label":o?`Collapse ${r.label}`:`Expand ${r.label}`,className:"p-1 ml-2 rounded hover:bg-slate-700",children:a.jsx(Fh,{className:`w-4 h-4 text-slate-500 transition-transform duration-200 flex-shrink-0 ${o?"rotate-90":""}`})})]}),l&&a.jsx("div",{className:`transition-all duration-300 ease-in-out overflow-hidden ${o?"max-h-[1000px]":"max-h-0"}`,children:a.jsx("ul",{className:"pt-1",children:r.subitems.map(h=>a.jsx(lp,{item:h,onNavigate:s,level:n+1},h.id))})})]})},cp=({isOpen:r,onClose:s,toc:n,onTocNavigate:o,bookmarks:c,onBookmarkNavigate:l,onDeleteBookmark:d,citations:f,onCitationNavigate:p,onDeleteCitation:h,settings:w,bookData:b})=>{const[x,v]=T.useState("toc"),k=()=>{if(!b||f.length===0)return;const g=gx(b,f),S=new Blob([g],{type:"application/x-research-info-systems;charset=utf-8"}),R=`${(b.title||"book").replace(/[^a-z0-9]/gi,"_").toLowerCase()}_citations.ris`,I=document.createElement("a");I.href=URL.createObjectURL(S),I.download=R,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(I.href)};return r?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black/60 z-30",onClick:s,"aria-hidden":"true"}),a.jsxs("div",{className:`fixed top-0 left-0 h-full w-80 bg-slate-800 shadow-2xl z-40 transform transition-transform duration-300 ease-in-out flex flex-col ${r?"translate-x-0":"-translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"nav-heading",children:[a.jsxs("div",{className:"p-4 border-b border-slate-700 flex justify-between items-center flex-shrink-0",children:[a.jsx("h3",{id:"nav-heading",className:"text-xl font-semibold text-white",children:"Navigation"}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700","aria-label":"Close navigation panel",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"border-b border-slate-700 px-2 flex-shrink-0",children:a.jsxs("nav",{className:"flex -mb-px",children:[a.jsx("button",{onClick:()=>v("toc"),className:`py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 ${x==="toc"?"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white hover:border-slate-500"}`,"aria-current":x==="toc"?"page":void 0,children:"Contents"}),a.jsx("button",{onClick:()=>v("bookmarks"),className:`py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 ${x==="bookmarks"?"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white hover:border-slate-500"}`,"aria-current":x==="bookmarks"?"page":void 0,children:"Bookmarks"}),a.jsx("button",{onClick:()=>v("citations"),className:`py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 ${x==="citations"?"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white hover:border-slate-500"}`,"aria-current":x==="citations"?"page":void 0,children:"Citations"})]})}),a.jsxs("div",{className:"overflow-y-auto flex-grow",children:[x==="toc"&&a.jsx("div",{className:"p-4",children:n.length>0?a.jsx("ul",{className:"space-y-1",children:n.map(g=>a.jsx(lp,{item:g,onNavigate:o,level:0},g.id))}):a.jsx("p",{className:"p-4 text-slate-400 text-center",children:"No table of contents available."})}),x==="bookmarks"&&a.jsx("div",{children:c.length>0?a.jsx("ul",{className:"divide-y divide-slate-700",children:c.sort((g,S)=>g.createdAt-S.createdAt).map(g=>a.jsxs("li",{className:"p-4 flex items-center justify-between group",children:[a.jsxs("button",{onClick:()=>l(g.cfi),className:"flex-grow text-left pr-4",children:[g.chapter&&a.jsx("span",{className:"block text-xs font-semibold text-sky-400 uppercase tracking-wider mb-1",children:g.chapter}),a.jsx("span",{className:"block text-sm font-semibold text-slate-200 group-hover:text-sky-300 transition-colors",children:g.label}),g.description&&a.jsx("blockquote",{className:"mt-2 pl-3 border-l-2 border-slate-600",children:a.jsx("p",{className:"text-sm text-slate-300 italic",children:g.description})}),a.jsx("span",{className:"block text-xs text-slate-400 mt-2",children:new Date(g.createdAt).toLocaleString()})]}),a.jsx("button",{onClick:()=>d(g.id),className:"p-2 rounded-full hover:bg-red-500/20 text-slate-500 hover:text-red-400 transition-colors flex-shrink-0","aria-label":`Delete bookmark: ${g.label}`,children:a.jsx(yi,{className:"w-5 h-5"})})]},g.id))}):a.jsx("p",{className:"p-8 text-slate-400 text-center",children:"You haven't added any bookmarks yet."})}),x==="citations"&&a.jsxs("div",{children:[b&&f.length>0&&a.jsx("div",{className:"p-4 border-b border-slate-700",children:a.jsxs("button",{onClick:k,className:"w-full flex items-center justify-center gap-2 py-2 px-4 rounded-md bg-sky-500 hover:bg-sky-600 transition-colors font-semibold text-white text-sm",children:[a.jsx(Y0,{className:"w-5 h-5"}),a.jsx("span",{children:"Export Citations (.ris)"})]})}),f.length>0&&b?a.jsx("ul",{className:"divide-y divide-slate-700",children:f.sort((g,S)=>g.createdAt-S.createdAt).map(g=>{const S=mx(b,w.citationFormat);return a.jsxs("li",{className:"p-4 flex items-center justify-between group",children:[a.jsxs("button",{onClick:()=>p(g.cfi),className:"flex-grow text-left pr-4",children:[g.chapter&&a.jsx("span",{className:"block text-xs font-semibold text-sky-400 uppercase tracking-wider mb-1",children:g.chapter}),a.jsxs("p",{className:"text-sm text-slate-200 group-hover:text-sky-300 transition-colors",children:[S.pre,a.jsx("span",{className:`${S.isItalic?"italic":"not-italic"} text-slate-300 group-hover:text-sky-400`,children:S.title}),S.post]}),g.note&&a.jsx("blockquote",{className:"mt-2 pl-3 border-l-2 border-slate-600",children:a.jsxs("p",{className:"text-sm text-slate-300 italic",children:['"',g.note,'"']})}),a.jsxs("div",{className:"flex justify-between items-center text-xs text-slate-400 mt-2",children:[a.jsx("span",{children:new Date(g.createdAt).toLocaleString()}),g.pageNumber&&a.jsxs("span",{className:"font-semibold bg-slate-700 px-1.5 py-0.5 rounded",children:["p. ",g.pageNumber]})]})]}),a.jsx("button",{onClick:()=>h(g.id),className:"p-2 rounded-full hover:bg-red-500/20 text-slate-500 hover:text-red-400 transition-colors flex-shrink-0","aria-label":"Delete citation",children:a.jsx(yi,{className:"w-5 h-5"})})]},g.id)})}):a.jsx("p",{className:"p-8 text-slate-400 text-center",children:"You haven't created any citations yet."})]})]})]})]}):null},up=({value:r,isOpen:s})=>a.jsx("div",{className:"fixed left-1/2 transform -translate-x-1/2 top-6 z-50 pointer-events-none",children:a.jsx("div",{"aria-hidden":!s,"aria-live":"polite",className:`mx-auto transition-all ${s?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-2"} duration-300`,children:a.jsx("div",{className:"bg-sky-600 text-white px-5 py-2 rounded-full shadow-2xl text-sm sm:text-base font-semibold ring-1 ring-sky-700",children:r})})}),yx=({bookId:r,onClose:s,animationData:n})=>{const[o,c]=T.useState(null),[l,d]=T.useState(null),[f,p]=T.useState(!0),[h,w]=T.useState(!1),[b,x]=T.useState(!1),[v,k]=T.useState(!1),[g,S]=T.useState(!1),[C,R]=T.useState(!1),[I,_]=T.useState([]),[F,M]=T.useState([]),[$,L]=T.useState([]),[B,Q]=T.useState([]),[oe,z]=T.useState(!1),[H,N]=T.useState(""),[X,me]=T.useState({currentPage:0,totalPages:0,progress:0}),[ee,ie]=T.useState(!0),[re,Z]=T.useState(null),[P,W]=T.useState(""),[ye,he]=T.useState(null),[fe,Ae]=T.useState(n?"start":"finished"),[be,xe]=T.useState(!1),[Ne,De]=T.useState(!1);T.useEffect(()=>{if(!Ne)return;const we=window.setTimeout(()=>De(!1),8e3);return()=>clearTimeout(we)},[Ne]);const[$e,Ye]=T.useState("stopped"),[Ve,j]=T.useState(!1),[ue,ce]=T.useState(!1),V=T.useRef(null);T.useEffect(()=>{if(ue)return V.current&&clearTimeout(V.current),V.current=window.setTimeout(()=>ce(!1),1200),()=>{V.current&&(clearTimeout(V.current),V.current=null)}},[ue]);const[D,q]=T.useState(tc),te=T.useRef(null),ae=T.useRef(null),J=T.useRef(null),A=T.useRef(null),E=T.useRef(D);E.current=D;const U=T.useRef($e);U.current=$e;const K=T.useRef(null),pe=T.useRef(null),Ee=T.useRef(null),ve=T.useRef(null),ke=T.useRef(null),Te=T.useRef(null),Oe=T.useRef(null),Re=T.useRef(null),We=T.useRef(!1),yt=T.useRef(null),Qe=T.useRef(null),ot=T.useRef(null),Je=T.useRef(null),bt=T.useRef(""),ct=T.useRef(null),Ct=T.useRef(!1),Tt=T.useMemo(()=>h||b||v,[h,b,v]),qt=T.useCallback(()=>{Oe.current&&clearTimeout(Oe.current)},[]),vn=T.useCallback(()=>{qt(),Tt||(Oe.current=window.setTimeout(()=>{ie(!1)},3e3))},[Tt,qt]);T.useEffect(()=>{if(fe!=="start")return;const we=setTimeout(()=>Ae("expanding"),50);return()=>clearTimeout(we)},[fe]),T.useEffect(()=>{const we=ae.current;!we||!n||(fe==="start"?(we.style.position="absolute",we.style.top=`${n.rect.top}px`,we.style.left=`${n.rect.left}px`,we.style.width=`${n.rect.width}px`,we.style.height=`${n.rect.height}px`,we.style.transition="all 0.6s cubic-bezier(0.4, 0, 0.2, 1)"):fe==="expanding"&&(we.style.position="absolute",we.style.top="50%",we.style.left="50%",we.style.transform="translate(-50%, -50%)",we.style.width="auto",we.style.height="80vh",we.style.transition="all 0.6s cubic-bezier(0.4, 0, 0.2, 1)"))},[fe,n]),T.useEffect(()=>{(async()=>{const Ie=await st.getBook(r);Ie?c(Ie):(console.error("Book not found"),s())})()},[r,s]),T.useEffect(()=>{const we=()=>{if(tc().readAloud.voiceURI)return;const Be=window.speechSynthesis.getVoices();if(Be.length===0)return;const Ke=Be.find(Me=>Me.default)||Be.find(Me=>Me.lang==="en-US"&&/google/i.test(Me.name))||Be.find(Me=>Me.lang==="en-US"&&/microsoft/i.test(Me.name))||Be.find(Me=>Me.lang==="en-US"&&Me.localService)||Be.find(Me=>Me.lang==="en-US")||null;Ke&&q(Me=>{const et={...Me.readAloud,voiceURI:Ke.voiceURI},at={...Me,readAloud:et};return Rf(at),at})};return window.speechSynthesis.getVoices().length>0?we():window.speechSynthesis.onvoiceschanged=we,()=>{window.speechSynthesis.onvoiceschanged=null}},[]);const Vn=T.useCallback(()=>{ot.current&&oi.saveSpeechPosition(r,ot.current)},[r]),$r=T.useCallback(()=>{yt.current&&A.current&&(A.current.annotations.remove(yt.current,"highlight"),yt.current=null)},[]),Ft=T.useCallback(()=>{U.current!=="stopped"&&Vn(),Ye("stopped"),window.speechSynthesis.cancel(),Ct.current=!1,$r(),Qe.current=null,ot.current=null,bt.current=""},[$r,Vn]),xn=T.useCallback(()=>{const we=A.current;if(!we)return;U.current!=="stopped"&&(window.speechSynthesis.cancel(),$r());const Ie=we.getContents();if(!Ie||Ie.length===0)return;const Be=Ie[0].document?.body;if(!Be)return;const Ke=Be.textContent||"",Me=Ke.replace(/\s+/g," ").trim();if(!Me){E.current.flow==="paginated"&&U.current==="playing"&&(Ct.current=!0,we.next());return}let et=Me,at=0;const Hr=Je.current;if(Hr)try{const tt=Ie[0].range(Hr);if(tt){const Ot=tt.toString().replace(/\s+/g," ").trim(),Bt=Me.indexOf(Ot);Bt!==-1&&(at=Bt,et=Me.substring(at))}}catch(tt){console.error("Could not find start CFI for speech, starting from beginning.",tt)}finally{Je.current=null}ct.current={rawText:Ke,normalizedText:Me,startIndexInNormalized:at};const lt=new SpeechSynthesisUtterance(et);Qe.current=lt;const ft=window.speechSynthesis.getVoices(),Pt=E.current,mt=ft.find(tt=>tt.voiceURI===Pt.readAloud.voiceURI);lt.voice=mt||null,lt.rate=Pt.readAloud.rate,lt.pitch=Pt.readAloud.pitch,lt.volume=Pt.readAloud.volume,lt.onboundary=tt=>{if(tt.name!=="word"||!A.current||!Be||!ct.current)return;const{rawText:Ot,normalizedText:Bt,startIndexInNormalized:qr}=ct.current;tt.charIndex+qr},lt.onend=()=>{if($r(),U.current!=="playing"){if(U.current==="paused")return;Ye("stopped");return}E.current.flow==="paginated"?(Ct.current=!0,A.current?.next()):Ye("stopped")},lt.onerror=tt=>{console.error("SpeechSynthesisUtterance error",tt),Ft()},window.speechSynthesis.speak(lt),Ye("playing")},[Ft,$r]);T.useEffect(()=>{if(fe!=="finished"||!o||!te.current)return;let we=!0;return(async()=>{try{p(!0);const Be=window.ePub,Ke=Be(o.epubData);J.current=Ke,te.current&&(te.current.innerHTML="",te.current.style.opacity="0");const Me=Ke.renderTo(te.current,{width:"100%",height:"100%",flow:D.flow==="scrolled"?"scrolled-doc":"paginated",manager:"default",spread:"auto"});if(!we)return;d(Me),A.current=Me;const et=await Ke.loaded.navigation;if(!we)return;try{if(et&&et.toc&&Array.isArray(et.toc)&&et.toc.length>0)Ar()&&console.debug("ReaderView: using navigation.toc with",et.toc.length,"entries"),_(et.toc),De(!1);else{Ar()&&console.debug("ReaderView: navigation.toc missing or empty, building fallback TOC from spine");const mt=Pf(Ke),tt=mt.map(Ot=>({id:Ot.id,href:Ot.href,label:Ot.label,subitems:[]}));_(tt),De(!0);try{Bf("toc_fallback",{bookId:r,fallbackCount:mt&&mt.length||0})}catch{}}}catch(mt){Ar()&&console.warn("Error processing navigation TOC, using fallback",mt);const tt=Pf(Ke),Ot=tt.map(Bt=>({id:Bt.id,href:Bt.href,label:Bt.label,subitems:[]}));_(Ot),De(!0);try{Bf("toc_fallback",{bookId:r,fallbackCount:tt&&tt.length||0,error:String(mt)})}catch{}}if(K.current=et||null,xe(!0),Me.on("relocated",mt=>{if(!we)return;const tt=mt.start.cfi;if(Z(tt),tt&&(Ee.current=tt,ve.current&&clearTimeout(ve.current),ve.current=window.setTimeout(()=>{oi.savePosition(r,tt)},1e3)),We.current&&J.current?.locations){const Ot=J.current.locations,Bt=Ot.locationFromCfi(mt.start.cfi);if(Bt>-1){const qr=Ot.percentageFromCfi(mt.start.cfi);me({currentPage:Bt+1,totalPages:Ot.length(),progress:Math.round((qr||0)*100)})}}Ct.current&&(Ct.current=!1,xn())}),await Ke.ready,!we||(We.current=!1,await Ke.locations.generate(1600),!we))return;We.current=!0,Ke.locations&&me(mt=>({...mt,totalPages:Ke.locations.length(),currentPage:1}));const at=ui.findByBookId(r);at.success&&M(at.data);const Hr=fi.findByBookId(r);Hr.success&&L(Hr.data);const lt=oi.getSpeechPosition(r);Je.current=lt.success?lt.data:null;const ft=oi.getPosition(r),Pt=(ft.success?ft.data:null)||await Py(Ke);if(!we)return;if(Me)try{await Me.display(Pt||void 0)}catch(mt){console.warn(`rendition.display failed for ${Pt}. Attempting spine fallback.`,mt);try{const tt=Ke?.spine?.items&&Ke.spine.items.length>0?Ke.spine.items[0].href:void 0;tt?await Me.display(tt):await Me.display()}catch(tt){console.error("Failed to display book using spine fallback or default",tt)}}if(!we)return;p(!1),te.current&&(te.current.style.transition="opacity 0.3s ease-in",te.current.style.opacity="1");try{if(r){const mt=Ly(r);mt&&mt.fontSize&&typeof mt.fontSize=="number"&&q(tt=>({...tt,fontSize:mt.fontSize}))}}catch{}}catch(Be){we&&console.error("Error initializing EPUB:",Be)}})(),()=>{we=!1,Ft(),ve.current&&clearTimeout(ve.current),Ee.current&&oi.savePosition(r,Ee.current),We.current=!1,xe(!1),K.current=null,J.current&&(J.current.destroy(),J.current=null),A.current=null,d(null)}},[r,o,D.flow,fe,xn,Ft]),T.useEffect(()=>{if(l){if(!l.themesRegistered){const we={body:{color:"#000",background:"#fff"}},Ie={body:{color:"#fff",background:"#1f2937"}};l.themes.register("light",we),l.themes.register("dark",Ie),l.themesRegistered=!0}l.themes.select(D.theme),l.themes.fontSize(`${D.fontSize}%`),D.fontFamily==="Original"?l.themes.font("inherit"):D.fontFamily==="Serif"?l.themes.font('Georgia, "Times New Roman", serif'):D.fontFamily==="Sans-Serif"&&l.themes.font('"Helvetica Neue", Helvetica, Arial, sans-serif')}Rf(D)},[l,D]),T.useEffect(()=>{if(r)try{Dy(r,{fontSize:D.fontSize})}catch(we){console.warn("Failed to save epub view state",we)}},[D.fontSize,r]);const Ss=()=>{q(we=>{const Ie=Math.min(300,Math.round(we.fontSize*1.15));return{...we,fontSize:Ie}}),ce(!0)},Wr=()=>{q(we=>{const Ie=Math.max(50,Math.round(we.fontSize/1.15));return{...we,fontSize:Ie}}),ce(!0)},Hn=()=>{q(we=>({...we,flow:we.flow==="paginated"?"scrolled":"paginated"}))};T.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]),T.useEffect(()=>{if(l)return Re.current&&(clearTimeout(Re.current),Re.current=null),Re.current=window.setTimeout(()=>{try{A.current&&typeof A.current.resize=="function"&&A.current.resize()}catch(we){console.warn("Safe resize failed, rendition may no longer be available.",we)}},50),()=>{Re.current&&(clearTimeout(Re.current),Re.current=null)}},[ee,l]),T.useEffect(()=>(ee&&!Tt?vn():qt(),Tt&&!ee&&ie(!0),qt),[ee,Tt,vn,qt]),T.useEffect(()=>{if(re&&be&&K.current){const Ie=K.current.get(re);Ie&&typeof Ie.then=="function"&&Ie.then(Be=>{Be&&Be.label&&W(Be.label.trim())})}},[re,be]);const sr=T.useCallback(()=>{l?.next(),ie(!0),Ft()},[l,Ft]),Vr=T.useCallback(()=>{l?.prev(),ie(!0),Ft()},[l,Ft]);T.useEffect(()=>{const we=Ie=>{const Be=document.activeElement&&document.activeElement.tagName;if(!(Be==="INPUT"||Be==="TEXTAREA")){if(Ie.key==="ArrowLeft")Vr();else if(Ie.key==="ArrowRight")sr();else if(Ie.key===" ")Ie.preventDefault(),sr();else if(Ie.key.toLowerCase()==="c")x(Ke=>!Ke);else if(Ie.key==="?")j(Ke=>!Ke);else if(Ie.key==="+"||Ie.key==="="&&Ie.shiftKey)Ss();else if(Ie.key==="-"||Ie.key==="_")Wr();else if(Ie.key.toLowerCase()==="f")Hn();else if(Ie.key.toLowerCase()==="b"){if(!Ee.current)return;new Date().toISOString(),Ee.current,`${X.currentPage}`;const Ke=ui.add(r,{cfi:Ee.current,label:`Page ${X.currentPage}`,chapter:P});if(Ke.success){const Me=[...F,Ke.data];M(Me)}}}};return window.addEventListener("keydown",we),()=>window.removeEventListener("keydown",we)},[Vr,sr,F,r,X.currentPage,P]),T.useEffect(()=>{if(!l)return;const we=Ie=>{if(h||b||v||!te.current)return;const Be=te.current.getBoundingClientRect(),Ke=Ie.clientX-Be.left,Me=Be.width,et=Me*.3;D.flow==="paginated"?Ke<et?Vr():Ke>Me-et?sr():ie(at=>!at):ie(at=>!at)};return l.on("click",we),()=>{l.off("click",we)}},[l,D.flow,h,b,v,Vr,sr]);const wn=we=>{q(Ie=>{const Be={...Ie,...we};return we.readAloud&&(Be.readAloud={...Ie.readAloud,...we.readAloud}),Be})},cr=T.useCallback(async we=>{if(!A.current){Ar()&&console.warn("safeDisplay: rendition not ready");return}try{await A.current.display(we||void 0)}catch(Ie){Ar()&&console.warn("safeDisplay: rendition.display failed for",we,Ie);try{const Be=J.current,Ke=new Set,Me=async ft=>{if(!ft||Ke.has(ft))return!1;Ke.add(ft);try{return Ar()&&console.debug("safeDisplay: trying candidate",ft),await A.current.display(ft),!0}catch(Pt){return Ar()&&console.debug("safeDisplay: candidate failed",ft,Pt),!1}};if(!we){const ft=Be?.spine?.items&&Be.spine.items.length>0?Be.spine.items[0].href:void 0;if(ft&&await Me(ft))return;await Me(void 0);return}const et=we;if(await Me(et))return;const at=et.split("#")[0];if(at!==et&&await Me(at))return;if(!/[/.]/.test(et)&&Be?.spine?.items){for(const ft of Be.spine.items)if(ft.id===et||ft.idref===et||ft.href&&ft.href.split("#")[0].endsWith(et)){const Pt=ft.href;if(Pt&&await Me(Pt))return}}if(Be?.spine?.items){const ft=at.split("/").pop();if(ft){for(const Pt of Be.spine.items)if(Pt.href&&Pt.href.split("#")[0].endsWith(ft)&&await Me(Pt.href))return}}const lt=Be?.spine?.items&&Be.spine.items.length>0?Be.spine.items[0].href:void 0;if(lt&&await Me(lt))return;await Me(void 0)}catch(Be){console.error("safeDisplay: rendition.display fallback failed",Be)}}},[]),qn=we=>{Ft(),cr(we),x(!1)},Cs=we=>{Ft(),cr(we),x(!1)},Ko=we=>{Ft(),cr(we),x(!1)},Qo=T.useCallback(async we=>{if(!Ee.current)return;const Ie=Ee.current;let Be=P;if(K.current)try{const Me=K.current.get(Ie);if(Me&&typeof Me.then=="function"){const et=await Me;et?.label&&(Be=et.label.trim())}}catch(Me){console.warn("Could not fetch chapter for bookmark, using last known chapter.",Me)}new Date().toISOString(),`${X.currentPage}${X.progress}`;const Ke=ui.add(r,{cfi:Ee.current,label:`Page ${X.currentPage} (${X.progress}%)`,chapter:Be,description:we||void 0});if(Ke.success){const Me=[...F,Ke.data];M(Me)}R(!1)},[r,F,X.currentPage,X.progress,P]),Ns=T.useCallback(we=>{if(ui.delete(r,we).success){const Be=F.filter(Ke=>Ke.id!==we);M(Be)}},[r,F]),Tr=T.useCallback(async we=>{if(!Ee.current)return;const Ie=Ee.current;let Be=P;if(K.current)try{const Me=K.current.get(Ie);if(Me&&typeof Me.then=="function"){const et=await Me;et?.label&&(Be=et.label.trim())}}catch(Me){console.warn("Could not fetch chapter for citation, using last known chapter.",Me)}const Ke=fi.add(r,{cfi:Ie,note:we,pageNumber:X.currentPage>0?X.currentPage:void 0,chapter:Be,citationFormat:"apa"});if(Ke.success){const Me=[...$,Ke.data];L(Me)}S(!1)},[r,$,X.currentPage,P]),bi=T.useCallback(we=>{if(fi.delete(r,we).success){const Be=$.filter(Ke=>Ke.id!==we);L(Be)}},[r,$]),bn=T.useMemo(()=>F.some(we=>we.cfi===re),[F,re]),Xo=T.useCallback(()=>{if(bn){const we=F.find(Ie=>Ie.cfi===re);we&&Ns(we.id)}else R(!0)},[bn,Ns,F,re]),js=T.useCallback(async we=>{if(!we||!J.current){Q([]),z(!1);return}ye&&l&&(l.annotations.remove(ye,"highlight"),he(null));try{z(!0);const Ie=await Ty(J.current,we);Q(Ie)}catch(Ie){console.error("Search failed:",Ie),Q([])}finally{z(!1)}},[l,ye]),ki=T.useCallback(we=>{if(N(we),Te.current&&clearTimeout(Te.current),!we.trim()){Q([]),z(!1);return}Te.current=window.setTimeout(()=>{js(we)},500)},[js]),Si=T.useCallback(we=>{l&&(ye&&l.annotations.remove(ye,"highlight"),Ft(),k(!1),cr(we).then(()=>{try{l.annotations.add("highlight",we,{},void 0,"hl",{fill:"yellow","fill-opacity":"0.3"}),he(we)}catch(Ie){console.warn("Failed to add highlight after navigation",Ie)}}))},[l,ye,Ft]),Ci=()=>{k(!1),ye&&l&&(l.annotations.remove(ye,"highlight"),he(null))},Zo=we=>{if(l&&J.current?.locations&&We.current){ie(!0),Ft();const Ie=parseInt(we.target.value,10);me(Be=>({...Be,progress:Ie})),pe.current&&clearTimeout(pe.current),pe.current=window.setTimeout(()=>{const Be=J.current.locations.cfiFromPercentage(Ie/100);cr(Be)},150)}},Yo=we=>{D.flow==="paginated"&&(ke.current=we.touches[0].clientX)},vt=we=>{if(D.flow!=="paginated"||ke.current===null)return;const Ie=we.changedTouches[0].clientX-ke.current;Ie>50?Vr():Ie<-50&&sr(),ke.current=null},Jo=()=>{U.current==="playing"?(Ye("paused"),window.speechSynthesis.pause(),Vn(),Ct.current=!1):U.current==="paused"?(Ye("playing"),window.speechSynthesis.resume()):xn()};return a.jsxs(a.Fragment,{children:[n&&fe!=="finished"&&a.jsx("div",{className:`fixed inset-0 bg-slate-900 z-50 flex justify-center items-center transition-opacity duration-300 ${fe==="fading"?"opacity-0":"opacity-100"}`,onTransitionEnd:()=>{fe==="fading"&&Ae("finished")},children:n.coverImage&&a.jsx("img",{ref:ae,src:n.coverImage,alt:"Expanding book cover",className:"object-contain rounded-lg shadow-2xl transition-all duration-700 ease-[cubic-bezier(0.4,0,0.2,1)]",onTransitionEnd:()=>{fe==="expanding"&&setTimeout(()=>Ae("fading"),200)}})}),a.jsxs("div",{className:`fixed inset-0 bg-slate-900 flex flex-col select-none transition-opacity duration-500 ${fe==="fading"||fe==="finished"?"opacity-100":"opacity-0"}`,children:[a.jsxs("header",{className:`flex flex-wrap sm:flex-nowrap items-center justify-between sm:justify-start sm:gap-4 p-2 bg-slate-800 shadow-md z-20 text-white flex-shrink-0 transition-transform duration-300 ease-in-out ${ee?"translate-y-0":"-translate-y-full"}`,onMouseEnter:qt,onMouseLeave:vn,children:[Ne&&a.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-full mt-2 z-40",children:a.jsxs("div",{className:"bg-amber-600 text-black px-4 py-2 rounded shadow-md flex items-center gap-4",children:[a.jsx("span",{className:"text-sm",children:"This book's navigation was incomplete; a fallback contents list was used."}),a.jsx("button",{onClick:()=>{const we=J.current?.spine?.items&&J.current.spine.items.length>0?J.current.spine.items[0].href:void 0;we&&cr(we),De(!1)},className:"bg-black/10 hover:bg-black/20 px-3 py-1 rounded text-sm font-semibold",children:"Open first content"}),a.jsx("button",{onClick:()=>De(!1),className:"px-2 py-1 text-sm underline",children:"Dismiss"})]})}),a.jsxs("div",{className:"flex items-center gap-2 sm:order-1",children:[a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close Reader",children:a.jsx(Zt,{className:"w-6 h-6"})}),a.jsxs("button",{onClick:()=>x(!0),className:"p-2 rounded-full hover:bg-slate-700 transition-colors relative","aria-label":"Contents and Bookmarks",children:[a.jsx(yc,{className:"w-6 h-6"}),(F.length>0||$.length>0)&&a.jsx("span",{className:"absolute top-1 right-1 block h-2 w-2 rounded-full bg-sky-400 ring-2 ring-slate-800"})]})]}),a.jsxs("div",{className:"flex justify-end items-center gap-2 sm:order-3",children:[a.jsx("button",{onClick:Jo,className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":$e==="playing"?"Pause Read Aloud":"Start Read Aloud",children:$e==="playing"?a.jsx(J0,{className:"w-6 h-6 text-sky-400"}):a.jsx(zh,{className:"w-6 h-6"})}),a.jsx("button",{onClick:()=>k(!0),className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Search in book",children:a.jsx(Mh,{className:"w-6 h-6"})}),a.jsx("button",{onClick:()=>S(!0),className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Create citation for this page",children:a.jsx(Uh,{className:"w-6 h-6"})}),a.jsx("button",{onClick:Xo,className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":bn?"Remove bookmark from this page":"Add bookmark to this page",children:a.jsx(Bh,{className:"w-6 h-6",filled:bn})}),a.jsx("button",{onClick:()=>j(!0),className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Keyboard help",children:"?"}),a.jsx("button",{onClick:()=>w(!0),className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Settings",children:a.jsx(X0,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"text-center truncate px-2 w-full pt-2 sm:order-2 sm:w-auto sm:flex-grow sm:min-w-0 sm:pt-0",children:[a.jsx("h2",{className:"text-lg font-bold",children:o?.title||"Loading..."}),a.jsx("p",{className:"text-sm text-slate-400",children:o?.author})]})]}),a.jsxs("div",{className:"flex-grow relative min-h-0",onTouchStart:Yo,onTouchEnd:vt,children:[f&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900 z-30",children:a.jsx(yn,{text:"Loading Book..."})}),a.jsx("div",{ref:te,id:"viewer",className:"w-full h-full p-4 md:p-8 bg-slate-900/20"})]}),a.jsxs("footer",{className:`flex items-center gap-4 p-4 bg-slate-800 z-20 text-white flex-shrink-0 transition-transform duration-300 ease-in-out ${ee?"translate-y-0":"translate-y-full"}`,onMouseEnter:qt,onMouseLeave:vn,children:[D.flow==="paginated"?a.jsx("button",{onClick:Vr,className:"p-2 rounded-full hover:bg-slate-700 transition-colors flex-shrink-0","aria-label":"Previous Page",children:a.jsx(xi,{className:"w-6 h-6"})}):a.jsx("div",{className:"w-10 h-10 flex-shrink-0"}),a.jsxs("div",{className:"flex-grow flex flex-col justify-center",children:[a.jsx("input",{type:"range",min:"0",max:"100",value:X.progress||0,onChange:Zo,className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Book progress",disabled:!We.current||X.totalPages===0}),a.jsx("div",{className:"text-center text-sm text-slate-300 mt-2","aria-live":"polite",children:X.totalPages>0&&We.current?a.jsxs("span",{children:["Page ",X.currentPage," of ",X.totalPages,"  ",X.progress,"%"]}):a.jsx("span",{className:"text-slate-400",children:"Calculating progress..."})})]}),a.jsxs("div",{className:"w-28 flex flex-col items-center text-sm",children:[a.jsx("label",{className:"text-slate-300 text-xs",children:"Go to"}),a.jsx("input",{type:"number",min:1,max:X.totalPages||9999,value:X.currentPage||"",onChange:we=>{const Ie=parseInt(we.target.value||"1",10);if(isNaN(Ie)||!J.current?.locations)return;const Be=J.current.locations.cfiFromLocation(Ie-1);Be&&cr(Be)},className:"w-full text-center rounded-md bg-slate-700 px-2 py-1 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Jump to page"})]}),D.flow==="paginated"?a.jsx("button",{onClick:sr,className:"p-2 rounded-full hover:bg-slate-700 transition-colors flex-shrink-0","aria-label":"Next Page",children:a.jsx(gc,{className:"w-6 h-6"})}):a.jsx("div",{className:"w-10 h-10 flex-shrink-0"})]}),a.jsx(cp,{isOpen:b,onClose:()=>x(!1),toc:I,onTocNavigate:qn,bookmarks:F,onBookmarkNavigate:Cs,onDeleteBookmark:Ns,citations:$,onCitationNavigate:Ko,onDeleteCitation:bi,settings:D,bookData:o}),a.jsx(hx,{isOpen:v,onClose:Ci,onQueryChange:ki,onNavigate:Si,results:B,isLoading:oe,searchQuery:H}),a.jsx(px,{isOpen:h,onClose:()=>w(!1),settings:D,onSettingsChange:wn}),a.jsx(ip,{isOpen:g,onClose:()=>S(!1),onSave:Tr}),a.jsx(sp,{isOpen:C,onClose:()=>R(!1),onSave:Qo}),a.jsx(Nc,{isOpen:Ve,onClose:()=>j(!1),onZoomIn:Ss,onZoomOut:Wr,onToggleFit:Hn,activeReader:"epub"}),a.jsx(up,{value:`${D.fontSize}%`,isOpen:ue})]})]})},vx=({isOpen:r,title:s="Confirm",message:n,confirmLabel:o="Confirm",cancelLabel:c="Cancel",onClose:l,onConfirm:d,variant:f="default"})=>{const p=T.useRef(null),h=yr({isActive:r,onEscape:l,initialFocusRef:p});return r?a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:l,role:"dialog","aria-modal":"true",children:a.jsxs("div",{ref:h,className:"bg-slate-800 rounded-lg shadow-xl w-full max-w-md p-6 text-white",onClick:w=>w.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:`text-xl font-bold ${f==="danger"?"text-red-300":"text-sky-300"}`,children:s}),a.jsx("button",{onClick:l,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsx("p",{className:"text-slate-300 mb-6 text-sm",children:n}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{ref:p,onClick:l,className:"py-2 px-4 rounded-md bg-slate-600 hover:bg-slate-500 transition-colors font-semibold",tabIndex:0,children:c}),a.jsx("button",{onClick:d,className:`py-2 px-6 rounded-md transition-colors font-bold ${f==="danger"?"bg-red-600 hover:bg-red-700":"bg-sky-500 hover:bg-sky-600"}`,tabIndex:0,children:o})]})]})}):null},xx=({isOpen:r,onClose:s,onConfirm:n,bookTitle:o})=>{const c=yr({isActive:r,onEscape:s});return r?a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{ref:c,className:"bg-slate-800 rounded-lg shadow-xl w-full max-w-md p-6 text-white",onClick:l=>l.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{className:"text-xl font-bold text-red-400 flex items-center gap-2",children:[a.jsx(yi,{className:"w-6 h-6"}),"Confirm Deletion"]}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsxs("p",{className:"text-slate-300 mb-6 text-sm",children:['Are you sure you want to permanently delete "',a.jsx("strong",{className:"font-semibold text-slate-100",children:o}),'"? This action cannot be undone.']}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:s,className:"py-2 px-4 rounded-md bg-slate-600 hover:bg-slate-500 transition-colors font-semibold",children:"Cancel"}),a.jsx("button",{onClick:n,className:"py-2 px-6 rounded-md bg-red-600 hover:bg-red-700 transition-colors font-bold",children:"Delete"})]})]})}):null},wx=({isOpen:r,onClose:s,onReplace:n,onAddAnyway:o,bookTitle:c})=>{const l=yr({isActive:r,onEscape:s});return r?a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{ref:l,className:"bg-slate-800 rounded-lg shadow-xl w-full max-w-md p-6 text-white",onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-bold text-yellow-300",children:"Duplicate Book Found"}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsxs("p",{className:"text-slate-300 mb-6 text-sm",children:['The book "',a.jsx("strong",{className:"font-semibold text-slate-100",children:c}),'" is already in your library. What would you like to do?']}),a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsx("button",{onClick:n,className:"w-full py-2.5 px-4 rounded-md bg-sky-500 hover:bg-sky-600 transition-colors font-bold",children:"Replace Existing"}),a.jsx("button",{onClick:o,className:"w-full py-2.5 px-4 rounded-md bg-slate-600 hover:bg-slate-500 transition-colors font-semibold",children:"Add as New Copy"}),a.jsx("button",{onClick:s,className:"w-full py-2 px-4 text-sm text-slate-400 hover:text-white transition-colors",children:"Cancel Import"})]})]})}):null},dp=T.createContext(void 0),bx=({children:r})=>{const[s,n]=T.useState([]),o=T.useRef({}),c=T.useCallback(d=>{if(n(f=>f.filter(p=>p.id!==d)),o.current[d]){try{window.clearTimeout(o.current[d])}catch{}delete o.current[d]}},[]),l=T.useCallback((d,f=4e3,p,h)=>{const w=`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`;n(x=>[...x,{id:w,message:d,actionLabel:p,action:h}]);const b=window.setTimeout(()=>c(w),f);return o.current[w]=b,w},[c]);return T.useEffect(()=>()=>{Object.values(o.current).forEach(d=>{try{window.clearTimeout(d)}catch{}}),o.current={}},[]),a.jsx(dp.Provider,{value:{toasts:s,pushToast:l,removeToast:c},children:r})},fp=()=>{const r=T.useContext(dp);return r||{toasts:[],pushToast:(s,n,o,c)=>{try{return`${Date.now().toString(36)}-noop`}catch{return"noop"}},removeToast:s=>{}}},hp=T.createContext(null),kx=({children:r})=>{const[s,n]=T.useState(!1),[o,c]=T.useState({message:""}),l=T.useRef(()=>{});T.useRef(null);const d=fp(),f=w=>(c({...typeof w=="string"?{message:w}:w}),n(!0),new Promise(x=>{l.current=x})),p=()=>{n(!1),l.current(!1)},h=()=>{if(n(!1),l.current(!0),o&&typeof o.undoCallback=="function")try{const w=o.undoCallback(),b=o.undoDurationMs??6e3;d.pushToast("Action performed",b,"Undo",async()=>{try{w&&typeof w.then=="function"?await w:await o.undoCallback()}catch(x){console.error("Undo action failed",x)}}),w&&typeof w.then=="function"&&w.catch(()=>{})}catch(w){console.warn("undoCallback failed",w)}};return a.jsxs(hp.Provider,{value:f,children:[r,a.jsx(vx,{isOpen:s,title:o.title||"Confirm",message:o.message,confirmLabel:o.confirmLabel||"Confirm",cancelLabel:o.cancelLabel||"Cancel",variant:o.variant||"default",onClose:p,onConfirm:h})]})},jc=()=>{const r=T.useContext(hp);if(!r)throw new Error("useConfirm must be used within a ConfirmProvider");return r},Sx=({isOpen:r,onClose:s})=>{const[n,o]=T.useState(null),c=jc(),l=yr({isActive:r,onEscape:s});T.useEffect(()=>{r&&st.getBooksMetadata().then(f=>{o(f.length)}).catch(()=>{o(0)})},[r]);const d=()=>{(async()=>{const f={books:[],localStorageEntries:{}};try{f.books=await st.getAllBooks(),Object.keys(localStorage).filter(h=>h.startsWith("ebook-reader-")).forEach(h=>{f.localStorageEntries[h]=localStorage.getItem(h)})}catch(h){console.warn("Failed to snapshot library before clear",h)}await c({message:`DANGER: This will permanently delete your entire local library, including all books, bookmarks, and citations.

You will have a short window to undo this action.`,title:"Dangerous Operation",confirmLabel:"Yes, delete",variant:"danger",undoCallback:async()=>{try{if(f.books&&f.books.length>0)for(const h of f.books)await st.saveBook(h);Object.entries(f.localStorageEntries||{}).forEach(([h,w])=>{w===null?localStorage.removeItem(h):localStorage.setItem(h,w)}),setTimeout(()=>window.location.reload(),200)}catch(h){console.error("Failed to restore library on undo",h)}},undoDurationMs:8e3})&&(Object.keys(localStorage).filter(h=>h.startsWith("ebook-reader-")).forEach(h=>localStorage.removeItem(h)),st.clearAllBooks().then(()=>{window.location.reload()}))})()};return r?a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{ref:l,className:"bg-slate-800 rounded-lg shadow-xl w-full max-w-lg p-6 text-white",onClick:f=>f.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-sky-300",children:"Local Storage Management"}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2 text-slate-200",children:"Library Statistics"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Your library is stored locally in your browser's IndexedDB."}),a.jsxs("div",{className:"mt-4",children:[a.jsx("span",{className:"font-semibold text-slate-300",children:"Books in Library: "}),a.jsx("span",{className:"font-bold text-sky-300 text-lg",children:n===null?"Loading...":n})]})]}),a.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-red-500/30",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2 text-red-400",children:"Danger Zone"}),a.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"This will permanently delete all books and associated data (bookmarks, citations, reading progress) from your browser. This action cannot be undone."}),a.jsxs("button",{onClick:d,className:"w-full flex items-center justify-center gap-2 py-2 px-4 rounded-md bg-red-600 hover:bg-red-700 transition-colors font-semibold text-white text-sm",children:[a.jsx(yi,{className:"w-5 h-5"}),a.jsx("span",{children:"Clear Entire Local Library"})]})]})]})]})}):null},Cx=({isOpen:r,onClose:s,catalogs:n,onAddCatalog:o,onDeleteCatalog:c,onUpdateCatalog:l,registries:d,onAddRegistry:f,onDeleteRegistry:p,onUpdateRegistry:h})=>{const[w,b]=T.useState(""),[x,v]=T.useState(""),[k,g]=T.useState("auto"),[S,C]=T.useState(""),[R,I]=T.useState(null),[_,F]=T.useState(""),[M,$]=T.useState("catalogs"),L=yr({isActive:r,onEscape:s});if(!r)return null;const B=X=>{if(X.preventDefault(),!w.trim()||!x.trim()){C("Name and URL cannot be empty.");return}try{new URL(x)}catch{C("Please enter a valid URL.");return}C(""),M==="catalogs"?o(w,x,k):f(w,x),b(""),v("")},Q=X=>{I(X.id),F(X.name)},oe=()=>{I(null),F("")},z=()=>{!R||!_.trim()||(M==="catalogs"?l(R,_.trim()):h(R,_.trim()),oe())},H=M==="catalogs"?n:d,N=M==="catalogs"?c:p;return a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:s,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{ref:L,className:"bg-slate-800 rounded-lg shadow-xl w-full max-w-lg p-6 text-white",onClick:X=>X.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-bold text-sky-300",children:"Manage Sources"}),a.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close",children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"border-b border-slate-700 mb-6",children:a.jsxs("nav",{className:"flex -mb-px gap-4",children:[a.jsx("button",{onClick:()=>$("catalogs"),className:`py-3 px-2 text-sm font-medium border-b-2 transition-colors duration-200 ${M==="catalogs"?"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white hover:border-slate-500"}`,children:"Catalogs"}),a.jsx("button",{onClick:()=>$("registries"),className:`py-3 px-2 text-sm font-medium border-b-2 transition-colors duration-200 ${M==="registries"?"border-sky-400 text-sky-300":"border-transparent text-slate-400 hover:text-white hover:border-slate-500"}`,children:"Registries"})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx($h,{className:"w-5 h-5"}),"Add New ",M==="catalogs"?"Catalog":"Registry"]}),a.jsxs("form",{onSubmit:B,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"item-name",className:"block text-sm font-medium text-slate-400 mb-1",children:"Name"}),a.jsx("input",{id:"item-name",type:"text",value:w,onChange:X=>b(X.target.value),placeholder:M==="catalogs"?"e.g., Project Gutenberg":"e.g., OPDS Registry",className:"w-full bg-slate-700 rounded-md p-2 text-sm focus:outline-none focus:ring-2 focus:ring-sky-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"item-url",className:"block text-sm font-medium text-slate-400 mb-1",children:"URL"}),a.jsx("input",{id:"item-url",type:"url",value:x,onChange:X=>v(X.target.value),placeholder:"https://.../catalog.xml",className:"w-full bg-slate-700 rounded-md p-2 text-sm focus:outline-none focus:ring-2 focus:ring-sky-500"})]}),M==="catalogs"&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"opds-version",className:"block text-sm font-medium text-slate-400 mb-1",children:"OPDS Version"}),a.jsxs("select",{id:"opds-version",value:k,onChange:X=>g(X.target.value),className:"w-full bg-slate-700 rounded-md p-2 text-sm focus:outline-none focus:ring-2 focus:ring-sky-500",children:[a.jsx("option",{value:"auto",children:"Auto-detect (recommended)"}),a.jsx("option",{value:"1",children:"OPDS 1 (Atom/XML)"}),a.jsx("option",{value:"2",children:"OPDS 2 (JSON)"})]})]}),M==="registries"&&a.jsx("p",{className:"text-sm text-slate-400",children:"Registries are always OPDS 2.0 (JSON) format."}),S&&a.jsx("p",{className:"text-sm text-red-400",children:S}),a.jsxs("button",{type:"submit",className:"w-full py-2 px-4 rounded-md bg-sky-500 hover:bg-sky-600 transition-colors font-bold text-sm",children:["Add ",M==="catalogs"?"Catalog":"Registry"]})]})]}),a.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(ny,{className:"w-5 h-5"})," Saved ",M==="catalogs"?"Catalogs":"Registries"]}),H.length>0?a.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:H.map(X=>a.jsx("li",{className:"bg-slate-700/50 p-2 rounded-md flex items-center justify-between gap-2",children:R===X.id?a.jsxs(a.Fragment,{children:[a.jsx("label",{htmlFor:`edit-name-${X.id}`,className:"sr-only",children:"Edit name"}),a.jsx("input",{id:`edit-name-${X.id}`,type:"text",value:_,onChange:me=>F(me.target.value),className:"w-full bg-slate-600 rounded-md p-1 text-sm focus:outline-none focus:ring-1 focus:ring-sky-500",autoFocus:!0,onKeyDown:me=>{me.key==="Enter"&&z(),me.key==="Escape"&&oe()}}),a.jsxs("div",{className:"flex items-center flex-shrink-0",children:[a.jsx("button",{onClick:z,className:"p-2 rounded-full hover:bg-green-500/20 text-green-400 transition-colors","aria-label":`Save changes for ${X.name}`,children:a.jsx(ay,{className:"w-4 h-4"})}),a.jsx("button",{onClick:oe,className:"p-2 rounded-full hover:bg-red-500/20 text-slate-500 hover:text-red-400 transition-colors","aria-label":"Cancel editing",children:a.jsx(Zt,{className:"w-4 h-4"})})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"truncate",children:[a.jsx("p",{className:"font-semibold text-slate-200 truncate",children:X.name}),a.jsx("p",{className:"text-xs text-slate-400 truncate",children:X.url})]}),a.jsxs("div",{className:"flex items-center flex-shrink-0",children:[a.jsx("button",{onClick:()=>Q(X),className:"p-2 rounded-full hover:bg-sky-500/20 text-slate-500 hover:text-sky-400 transition-colors","aria-label":`Edit ${X.name}`,children:a.jsx(oy,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>N(X.id),className:"p-2 rounded-full hover:bg-red-500/20 text-slate-500 hover:text-red-400 transition-colors","aria-label":`Delete ${X.name}`,children:a.jsx(yi,{className:"w-4 h-4"})})]})]})},X.id))}):a.jsxs("p",{className:"text-sm text-slate-400 text-center py-8",children:["No ",M==="catalogs"?"catalogs":"registries"," added yet."]})]})]})]})})},Nx=({isOpen:r,onClose:s})=>{const[n,o]=T.useState(""),[c,l]=T.useState(""),[d,f]=T.useState(!0),[p,h]=T.useState(null),[w,b]=T.useState(!1),x=yr({isActive:r,onEscape:s});if(!Ar())return null;const v=async(k=!1)=>{b(!0),h(null);try{let g=n;k?g=Xt(n):g=await Cr(n);const S={};c&&(S.Authorization=c);let C=null;try{C=await fetch(g,{method:"HEAD",mode:"cors",redirect:"manual",credentials:d?"include":"omit",headers:S}),C&&C.status===405&&(C=await fetch(g,{method:"GET",mode:"cors",redirect:"manual",credentials:d?"include":"omit",headers:S}))}catch(M){h({error:String(M),target:g,requestHeaders:S,documentCookie:typeof document<"u"?document.cookie:""}),b(!1);return}const R=C.headers.get("access-control-allow-origin"),I=C.headers.get("access-control-allow-credentials"),_=C.headers.get("access-control-allow-headers"),F=C.headers.get("access-control-expose-headers");h({ok:C.ok,status:C.status,statusText:C.statusText,url:C.url||g,accessControlAllowOrigin:R,accessControlAllowCredentials:I,accessControlAllowHeaders:_,accessControlExposeHeaders:F,requestHeaders:S,proxied:g!==n,proxiedUrl:g!==n?g:null,documentCookie:typeof document<"u"?document.cookie:""})}catch(g){h({error:String(g)})}b(!1)};return r?a.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center p-6",children:a.jsxs("div",{ref:x,className:"w-full max-w-2xl bg-white rounded shadow-lg overflow-auto",style:{maxHeight:"80vh"},children:[a.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[a.jsx("strong",{children:"Network Debug"}),a.jsxs("div",{children:[a.jsx("button",{className:"mr-2 px-3 py-1 bg-gray-200 rounded",onClick:()=>{o(""),h(null)},children:"Clear"}),a.jsx("button",{className:"px-3 py-1 bg-red-500 text-white rounded",onClick:s,children:"Close"})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Target URL"}),a.jsx("input",{className:"w-full p-2 border rounded",value:n,onChange:k=>o(k.target.value),placeholder:"https://example.org/opds/borrow/123"})]}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Authorization header (optional)"}),a.jsx("input",{className:"w-full p-2 border rounded",value:c,onChange:k=>l(k.target.value),placeholder:"Basic base64(...)"}),a.jsx("div",{className:"text-xs text-gray-600",children:"You can paste an Authorization header value to simulate client-sent auth. Note: browsers may preflight requests when custom headers are present."})]}),a.jsx("div",{className:"mb-4 flex items-center gap-3",children:a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:k=>f(k.target.checked)})," Include credentials (cookies)"]})}),a.jsxs("div",{className:"mb-4 flex gap-2",children:[a.jsx("button",{className:"px-3 py-2 bg-blue-600 text-white rounded",onClick:()=>v(!1),disabled:w||!n,children:"Probe (auto)"}),a.jsx("button",{className:"px-3 py-2 bg-indigo-600 text-white rounded",onClick:()=>v(!0),disabled:w||!n,children:"Force Proxy"})]}),a.jsxs("div",{className:"text-sm",children:[w&&a.jsx("div",{children:"Running probe..."}),p&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Target used:"})," ",p.url||p.target]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Proxied:"})," ",String(p.proxied)]}),p.proxiedUrl&&a.jsxs("div",{children:[a.jsx("strong",{children:"Proxied URL:"})," ",p.proxiedUrl]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Response:"})," ",p.status," ",p.statusText]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Access-Control-Allow-Origin:"})," ",String(p.accessControlAllowOrigin)]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Access-Control-Allow-Credentials:"})," ",String(p.accessControlAllowCredentials)]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Access-Control-Allow-Headers:"})," ",String(p.accessControlAllowHeaders)]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Access-Control-Expose-Headers:"})," ",String(p.accessControlExposeHeaders)]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("strong",{children:"Request headers sent (client-side):"}),a.jsx("pre",{className:"p-2 bg-gray-100 rounded text-xs overflow-auto",children:JSON.stringify(p.requestHeaders,null,2)})]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("strong",{children:"document.cookie (current origin):"}),a.jsx("pre",{className:"p-2 bg-gray-100 rounded text-xs overflow-auto",children:p.documentCookie||"<none>"})]}),a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Limitations: The browser will not expose cross-origin cookies or Set-Cookie headers to JavaScript. A missing Access-Control-Allow-Origin or Access-Control-Allow-Credentials header will still prevent the browser from exposing the response body to the app."})]})]})]})]})}):null},jx=({isOpen:r,host:s,authDocument:n,onClose:o,onSubmit:c,onOpenAuthLink:l,onRetry:d,probeUrl:f})=>{const[p,h]=T.useState(""),[w,b]=T.useState(""),[x,v]=T.useState(!1);T.useEffect(()=>{if(!r){h(""),b(""),v(!1);return}const L=n?.username_hint||n?.username||n?.suggested_username||"",B=n?.password_hint||"";L&&h(String(L)),B&&b("")},[r]);const[k,g]=T.useState(!1),[S,C]=T.useState(!1),R=T.useRef(null);T.useEffect(()=>()=>{if(R.current){try{window.clearInterval(R.current)}catch{}R.current=null}},[]);const I=yr({isActive:r,onEscape:o});if(!r)return null;const _=n?.realm||n?.title||null,F=n?.description||n?.instructions||null,M=n?.logo||n?.image||null,$=Array.isArray(n?.links)?n.links:[];return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900 bg-opacity-75 p-4",children:a.jsxs("div",{ref:I,className:"bg-slate-800 p-6 rounded-lg max-w-md w-full text-white",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-2",children:[M&&a.jsx("img",{src:M,alt:"provider logo",className:"w-12 h-12 object-contain"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:_?`Login to ${_}`:"Authentication required"}),a.jsxs("p",{className:"text-sm text-slate-300",children:["This catalog at ",a.jsx("span",{className:"font-mono",children:s})," requires credentials to access the requested content."]})]}),k&&a.jsx("div",{className:"mb-3 text-sm text-slate-300",children:"Waiting for provider sign-in to complete... This may take a minute."}),S&&a.jsxs("div",{className:"mb-3 text-sm text-emerald-300 flex items-center justify-between",children:[a.jsx("span",{children:"Direct access appears to be available. You can retry the acquisition now."}),a.jsx("div",{className:"ml-4",children:a.jsx("button",{onClick:()=>{if(R.current){try{window.clearInterval(R.current)}catch{}R.current=null}g(!1),typeof d=="function"&&d()},className:"px-3 py-1 rounded bg-emerald-600 hover:bg-emerald-500 text-white",children:"Retry now"})})]})]}),F&&a.jsx("p",{className:"text-sm text-slate-300 mb-4",children:F}),$.length>0&&a.jsxs("div",{className:"mb-4 text-sm text-slate-300",children:[a.jsx("div",{className:"font-semibold mb-1",children:"Authentication Links"}),a.jsx("ul",{className:"list-disc list-inside",children:$.map((L,B)=>a.jsxs("li",{children:[a.jsx("a",{className:"text-sky-400",href:L.href,target:"_blank",rel:"noreferrer",children:L.title||L.href})," ",L.rel?a.jsxs("span",{className:"text-xs text-slate-400",children:["(",L.rel,")"]}):null]},B))})]}),$.length>0&&a.jsx("div",{className:"mb-4 flex gap-2",children:$.map((L,B)=>(L.rel||"").toString().includes("authenticate")?a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",onClick:async()=>{let oe=null;try{oe=window.open(L.href,"_blank","noopener")}catch{oe=null}typeof l=="function"&&l(L.href);try{if(!oe||typeof window>"u"||typeof Cr!="function")return;g(!0),C(!1);let z=0;const H=30,N=f||L.href;R.current=window.setInterval(async()=>{z+=1;try{await Cr(N)===N&&(C(!0),g(!1),R.current&&(window.clearInterval(R.current),R.current=null))}catch{}z>=H&&(g(!1),R.current&&(window.clearInterval(R.current),R.current=null))},2e3)}catch{}},className:"px-3 py-2 rounded bg-emerald-600 hover:bg-emerald-500 text-white",children:"Open sign-in page"})},B):null)}),a.jsx("label",{htmlFor:"opds-username",className:"block text-sm text-slate-300 mb-1",children:"Username"}),a.jsx("input",{id:"opds-username","aria-label":"username",placeholder:n?.username_placeholder||"Username",value:p,onChange:L=>h(L.target.value),className:"w-full mb-3 p-2 rounded bg-slate-900 border border-slate-700 text-white"}),a.jsx("label",{htmlFor:"opds-password",className:"block text-sm text-slate-300 mb-1",children:"Password"}),a.jsx("input",{id:"opds-password","aria-label":"password",placeholder:n?.password_placeholder||"Password",type:"password",value:w,onChange:L=>b(L.target.value),className:"w-full mb-3 p-2 rounded bg-slate-900 border border-slate-700 text-white"}),n?.username_hint&&a.jsxs("div",{className:"text-xs text-slate-400 mb-2",children:["Hint: ",n.username_hint]}),n?.password_hint&&a.jsxs("div",{className:"text-xs text-slate-400 mb-2",children:["Password: ",n.password_hint]}),a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx("input",{id:"saveCred",type:"checkbox",checked:x,onChange:L=>v(L.target.checked)}),a.jsx("label",{htmlFor:"saveCred",className:"text-sm text-slate-300",children:"Save credential for this host"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{onClick:o,className:"px-4 py-2 rounded bg-slate-700 hover:bg-slate-600",children:"Cancel"}),typeof d=="function"&&a.jsx("button",{onClick:()=>d(),className:"px-4 py-2 rounded bg-yellow-600 hover:bg-yellow-500",children:"Retry"}),a.jsx("button",{onClick:()=>c(p,w,x),className:"px-4 py-2 rounded bg-sky-500 hover:bg-sky-600",children:"Continue"})]})]})})},rh="https://www.googleapis.com/auth/drive.file",li="g_access_token",Ao="g_access_token_expires_at",Ex=r=>{if(typeof r!="number"&&typeof r!="string")return null;const s=typeof r=="number"?r:Number(r);return Number.isFinite(s)?s>1e12?s:s*1e3:null},pp=T.createContext(null),_x=({children:r})=>{const[s,n]=T.useState(null),[o,c]=T.useState(null),[l,d]=T.useState(!1),[f,p]=T.useState("initializing"),[h,w]=T.useState(null),b=T.useRef("none"),x=T.useRef(null),v=!!s,k=T.useCallback(()=>{localStorage.removeItem(li),localStorage.removeItem(Ao)},[]),g=T.useCallback(()=>{const $=localStorage.getItem(li);$&&Kv($),n(null),w(null),k(),localStorage.removeItem("ebook-reader-drive-folder-id"),localStorage.removeItem("ebook-reader-drive-file-id"),localStorage.removeItem("ebook-reader-last-sync"),window.gapi?.client&&window.gapi.client.setToken(null)},[k]),S=T.useCallback($=>{if(!$?.access_token)return null;localStorage.setItem(li,$.access_token);let L=null;const B=Number($.expires_in);return Number.isFinite(B)&&B>0?L=Date.now()+B*1e3:L=Ex($.expires_at),L!==null?localStorage.setItem(Ao,String(L)):localStorage.removeItem(Ao),L},[]),C=T.useCallback(()=>{const $=localStorage.getItem(li),L=localStorage.getItem(Ao),B=L?Number(L):NaN;return $?!Number.isFinite(B)||B<=Date.now()+6e4?(k(),null):$:null},[k]),R=T.useCallback(async($,L)=>{try{const B=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${$}`}});if(!B.ok)throw new Error(`Failed to fetch user profile, status: ${B.status}`);const Q=await B.json();if(window.gapi?.client){const oe={access_token:$};typeof L=="number"&&Number.isFinite(L)&&(oe.expires_at=L),window.gapi.client.setToken(oe)}n({name:Q.name,email:Q.email,picture:Q.picture}),w(null),p("ready")}catch(B){console.error("Token validation/profile fetch failed:",B),g(),p("ready"),w("Google session is invalid or expired. Please sign in again.")}},[g]),I=T.useCallback($=>{if(!x.current)return;b.current=$;const L=$==="interactive_consent"?"consent":"";try{x.current.requestAccessToken({prompt:L})}catch(B){console.error("Google token request failed to start:",B),b.current="none";const Q=B instanceof Error?B.message:"Google sign-in request failed.";w(Q)}},[]),_=T.useCallback(async $=>{const L=b.current;if(b.current="none",$?.error){if(L==="interactive_silent"){I("interactive_consent");return}const Q=$.error_description||$.error||"Google sign-in failed.";w(Q);return}if(!(()=>{const Q=window.google?.accounts?.oauth2;if(Q?.hasGrantedAllScopes&&$?.access_token)try{return Q.hasGrantedAllScopes($,rh)}catch{}return(typeof $?.scope=="string"?$.scope.split(/\s+/).filter(Boolean):[]).includes(rh)})()){if(L!=="interactive_consent"){I("interactive_consent");return}w("Google Drive access was not granted. Please approve Drive access to use cloud sync.");return}if($?.access_token){const Q=S($);await R($.access_token,Q)}},[R,I,S]);T.useEffect(()=>{(async()=>{p("initializing"),w(null);try{const L=await Gv(_);x.current=L,c(L),p("ready")}catch(L){const B=L instanceof Error?L.message:"Google initialization failed.";B.includes("VITE_GOOGLE_CLIENT_ID")?p("not_configured"):p("error"),w(B)}finally{d(!0)}})()},[_]),T.useEffect(()=>{if(!l||f!=="ready")return;const $=!!localStorage.getItem(li),L=C();if(L){R(L);return}o&&$&&I("restore_silent")},[f,R,C,l,I,o]);const F=T.useCallback(()=>{x.current&&(w(null),I("interactive_consent"))},[I]),M=T.useCallback(()=>{x.current&&(w(null),I("interactive_consent"))},[I]);return a.jsx(pp.Provider,{value:{user:s,isLoggedIn:v,tokenClient:o,signIn:F,reauthorizeDrive:M,signOut:g,isInitialized:l,authStatus:f,authError:h},children:r})},Ec=()=>{const r=T.useContext(pp);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r},Ax=({className:r})=>a.jsxs("svg",{className:r,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),a.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),a.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),a.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),Rx=({isOpen:r,onClose:s,onUploadToDrive:n,onDownloadFromDrive:o,driveSnapshots:c,selectedSnapshotId:l,onSelectSnapshotId:d,onRefreshSnapshots:f,isLoadingSnapshots:p,syncStatus:h,setSyncStatus:w})=>{const{user:b,isLoggedIn:x,signIn:v,reauthorizeDrive:k,signOut:g,isInitialized:S,authStatus:C,authError:R}=Ec(),I=()=>{h.state!=="syncing"&&(w({state:"idle",message:""}),s())},_=yr({isActive:r,onEscape:I});if(!r)return null;const F=localStorage.getItem("ebook-reader-last-sync"),M=F?new Date(F).toLocaleString():"Never",$=h.state==="syncing",L=!S||C==="initializing"?"Initializing...":C==="not_configured"?"Google Sync Not Configured":C==="error"?"Retry Google Setup":"Sign in with Google",B=!S||C==="initializing"||C==="not_configured",Q=h.state==="error"?"text-red-300 border-red-500/30 bg-red-500/10":h.state==="success"?"text-emerald-300 border-emerald-500/30 bg-emerald-500/10":h.state==="syncing"?"text-sky-300 border-sky-500/30 bg-sky-500/10":"text-slate-300 border-slate-600 bg-slate-800/70",oe=h.state==="idle"?`Last synced: ${M}`:h.message;return a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:I,"aria-modal":"true",role:"dialog",children:a.jsxs("div",{ref:_,className:"bg-slate-800 rounded-lg shadow-xl w-full max-w-lg p-6 text-white",onClick:z=>z.stopPropagation(),children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-sky-300",children:"Cloud Sync"}),a.jsx("button",{onClick:I,className:"p-2 rounded-full hover:bg-slate-700 transition-colors","aria-label":"Close",disabled:$,children:a.jsx(Zt,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-200",children:"Account & Sync"}),x&&b?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("img",{src:b.picture,alt:"User",className:"w-12 h-12 rounded-full"}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("p",{className:"font-semibold",children:b.name}),a.jsx("p",{className:"text-sm text-slate-400",children:b.email})]}),a.jsx("button",{onClick:k,className:"py-2 px-3 rounded-md bg-sky-700 hover:bg-sky-600 transition-colors font-semibold text-xs",children:"Refresh Drive Access"}),a.jsx("button",{onClick:g,className:"py-2 px-4 rounded-md bg-slate-600 hover:bg-slate-500 transition-colors font-semibold text-sm",children:"Sign Out"})]}),a.jsx("div",{className:`rounded-md border px-3 py-2 text-xs ${Q}`,children:oe}),R&&a.jsx("p",{className:"text-xs text-amber-300",role:"status",children:R})]}):a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Sign in with your Google account to back up and sync your library across devices using Google Drive."}),C==="not_configured"&&a.jsx("p",{className:"text-xs text-amber-300 mb-3",role:"status",children:"Google sync is not configured for this deployment. Set `VITE_GOOGLE_CLIENT_ID` and redeploy."}),C==="error"&&R&&a.jsx("p",{className:"text-xs text-amber-300 mb-3",role:"status",children:R}),a.jsxs("button",{onClick:v,disabled:B,className:"w-full flex items-center justify-center gap-3 py-2.5 px-4 rounded-md bg-white text-slate-700 hover:bg-slate-200 transition-colors font-semibold disabled:opacity-70 disabled:cursor-not-allowed",children:[a.jsx(Ax,{className:"w-5 h-5"}),L]})]})]}),x&&a.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2 text-slate-200",children:"Google Drive Sync"}),a.jsxs("p",{className:"text-xs text-slate-500 mb-4",children:["Last synced: ",M]}),a.jsxs("div",{className:"mb-4 p-3 rounded-md bg-slate-800/60 border border-slate-700",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3 mb-2",children:[a.jsx("p",{className:"text-xs font-semibold text-slate-300 uppercase",children:"Restore Point"}),a.jsx("button",{onClick:f,disabled:$||p,className:"text-xs px-2 py-1 rounded bg-slate-700 hover:bg-slate-600 disabled:opacity-60",children:p?"Refreshing...":"Refresh"})]}),a.jsx("select",{value:l,onChange:z=>d(z.target.value),disabled:$||p||c.length===0,className:"w-full p-2 rounded bg-slate-900 border border-slate-700 text-sm text-white",children:c.length===0?a.jsx("option",{value:"",children:"No snapshots found yet"}):c.map(z=>a.jsxs("option",{value:z.id,children:[z.isLatest?"[Latest] ":"",z.name]},z.id))}),a.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"Select which cloud snapshot to use when downloading. Upload creates a new timestamped snapshot automatically."})]}),h.state!=="idle"?a.jsxs("div",{className:"p-4 rounded-md bg-slate-700/50 text-center",children:[$&&a.jsx(yn,{text:h.message}),h.state==="success"&&a.jsx("p",{className:"text-green-400",children:h.message}),h.state==="error"&&a.jsx("p",{className:"text-red-400",children:h.message})]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("button",{onClick:n,className:"flex flex-col items-center justify-center gap-2 p-4 rounded-md bg-slate-700 hover:bg-slate-600 transition-colors disabled:opacity-50",disabled:$,children:[a.jsx(Dh,{className:"w-6 h-6 text-sky-400"}),a.jsx("span",{className:"font-semibold",children:"Upload to Drive"}),a.jsx("span",{className:"text-xs text-slate-400 text-center",children:"Save your local library to the cloud. This will overwrite any existing data in Drive."})]}),a.jsxs("button",{onClick:o,className:"flex flex-col items-center justify-center gap-2 p-4 rounded-md bg-slate-700 hover:bg-slate-600 transition-colors disabled:opacity-50",disabled:$,children:[a.jsx(iy,{className:"w-6 h-6 text-sky-400"}),a.jsx("span",{className:"font-semibold",children:"Download from Drive"}),a.jsx("span",{className:"text-xs text-slate-400 text-center",children:"Replace your local library with the one from Drive. Local changes will be lost."})]})]})]})]})]})})},Tx=({message:r,isOpen:s})=>a.jsx("div",{className:`fixed right-6 top-6 z-50 pointer-events-none transition-all duration-300 ${s?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:a.jsx("div",{className:"bg-green-600 text-white px-4 py-2 rounded-full shadow-lg text-sm font-medium ring-1 ring-green-700",children:r})});class vs extends T.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.handleReset=()=>{this.props.onReset(),this.setState({hasError:!1,error:null})}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,n){console.error("ErrorBoundary caught an error:",s,n)}render(){return this.state.hasError?a.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 text-center text-white bg-slate-900",role:"alert",children:a.jsxs("div",{className:"bg-slate-800 p-8 rounded-lg shadow-xl max-w-lg w-full",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto text-red-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsx("h1",{className:"text-2xl font-bold text-red-300",children:"Something went wrong."}),a.jsx("p",{className:"mt-2 text-slate-300",children:this.props.fallbackMessage||"An unexpected error occurred. Please try again."}),this.state.error&&a.jsxs("details",{className:"mt-4 text-left bg-slate-900/50 p-3 rounded-md text-sm",children:[a.jsx("summary",{className:"cursor-pointer text-slate-400 hover:text-white",children:"Error Details"}),a.jsx("pre",{className:"mt-2 text-slate-400 whitespace-pre-wrap break-all",children:a.jsx("code",{children:this.state.error.message})})]}),a.jsx("button",{onClick:this.handleReset,className:"mt-6 py-2 px-6 rounded-md bg-sky-500 hover:bg-sky-600 transition-colors font-bold",children:"Try Again"})]})}):this.props.children}}const nh=({message:r,politeness:s="polite",clearAfter:n=5e3,onClear:o})=>{const[c,l]=T.useState(null);return T.useEffect(()=>{if(r){if(l(r),n>0){const d=setTimeout(()=>{l(null),o&&o()},n);return()=>clearTimeout(d)}}else l(null)},[r,n,o]),c?a.jsx("div",{role:"status","aria-live":s,"aria-atomic":"true",className:"sr-only",children:c}):null},Px="/My-Ebook-Reader/assets/MeBooks_lockup_stacked_dark-Bjs16_ps.svg",Ox="/My-Ebook-Reader/assets/MeBooks_transparent_white_removed-8vWVlR8U.png",Ix=({isVisible:r})=>a.jsx("div",{className:`fixed inset-0 bg-slate-900 flex flex-col items-center justify-center z-50 transition-opacity duration-700 ease-in-out ${r?"opacity-100":"opacity-0 pointer-events-none"}`,children:a.jsx("div",{className:"animate-pulse",children:a.jsx("img",{src:Px,alt:"MeBooks",className:"w-64"})})}),Lx=({isCloudSyncModalOpen:r,onCloseCloudSyncModal:s,onUploadToDrive:n,onDownloadFromDrive:o,driveSnapshots:c,selectedSnapshotId:l,onSelectSnapshotId:d,onRefreshSnapshots:f,isLoadingSnapshots:p,syncStatus:h,setSyncStatus:w,isLocalStorageModalOpen:b,onCloseLocalStorageModal:x,credentialPrompt:v,onCloseCredentialPrompt:k,onCredentialSubmit:g,onOpenAuthLink:S,onRetryAfterProviderLogin:C,showNetworkDebug:R,onCloseNetworkDebug:I,onOpenNetworkDebug:_,isShortcutHelpOpen:F,onCloseShortcutHelp:M})=>a.jsxs(a.Fragment,{children:[a.jsx(Rx,{isOpen:r,onClose:s,onUploadToDrive:n,onDownloadFromDrive:o,driveSnapshots:c,selectedSnapshotId:l,onSelectSnapshotId:d,onRefreshSnapshots:f,isLoadingSnapshots:p,syncStatus:h,setSyncStatus:w}),a.jsx(Sx,{isOpen:b,onClose:x}),a.jsx(jx,{isOpen:v.isOpen,host:v.host,authDocument:v.authDocument,onClose:k,onSubmit:g,onOpenAuthLink:S,onRetry:C,probeUrl:v.pendingHref}),a.jsx(Nx,{isOpen:R,onClose:I}),a.jsx(Nc,{isOpen:F,onClose:M,activeReader:null}),typeof window<"u"&&window.__MEBOOKS_DEBUG__&&a.jsx("div",{className:"fixed right-3 bottom-3 z-[60]",children:a.jsx("button",{onClick:_,className:"px-3 py-2 bg-yellow-400 rounded shadow",children:"Network Debug"})})]}),Dx=({availableAudiences:r,availableFictionModes:s,availableMediaModes:n,availablePublicationTypes:o,availableAvailabilityModes:c,availableDistributors:l,audienceMode:d,fictionMode:f,mediaMode:p,publicationMode:h,availabilityMode:w,distributorMode:b,onAudienceChange:x,onFictionChange:v,onMediaChange:k,onPublicationChange:g,onAvailabilityChange:S,onDistributorChange:C})=>{const R=[{key:"all",label:"All Ages",available:!0},{key:"adult",label:"Adult",available:r.includes("adult")},{key:"young-adult",label:"Young Adult",available:r.includes("young-adult")},{key:"children",label:"Children",available:r.includes("children")}],I=[{key:"all",label:"All Types",available:!0},{key:"fiction",label:"Fiction",available:s.includes("fiction")},{key:"non-fiction",label:"Non-Fiction",available:s.includes("non-fiction")}],_=[{key:"all",label:"All Media",available:!0},{key:"epub",label:"EPUB",available:n.includes("epub")},{key:"pdf",label:"PDF",available:n.includes("pdf")},{key:"audiobook",label:"Audiobooks",available:n.includes("audiobook")}],F=r.length>1,M=s.length>1,$=n.length>1,L=o.length>1,B=c.length>1,Q=l.length>1;if(!(F||M||$||L||B||Q))return null;const z=+(d!=="all")+ +(f!=="all")+ +(p!=="all")+ +(h!=="all")+ +(w!=="all")+ +(b!=="all");return a.jsxs("div",{className:"mb-5 rounded-xl border border-slate-700/60 bg-slate-900/35 p-3",children:[a.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-slate-400",children:"Filters"}),a.jsx("span",{className:"text-[11px] text-slate-500",children:z>0?`${z} active`:"Local only"})]}),(F||M||$||L||B||Q)&&a.jsxs("div",{className:"flex flex-wrap items-start gap-3",children:[F&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-500",children:"Audience"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:R.filter(H=>H.available).map(H=>a.jsx("button",{onClick:()=>x(H.key),className:`rounded-full px-2.5 py-1 text-xs font-medium transition-colors ${d===H.key?"bg-sky-500/20 text-sky-100 ring-1 ring-sky-500/40":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:H.label.replace("All Ages","All")},H.key))})]}),M&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-500",children:"Type"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:I.filter(H=>H.available).map(H=>a.jsx("button",{onClick:()=>v(H.key),className:`rounded-full px-2.5 py-1 text-xs font-medium transition-colors ${f===H.key?"bg-amber-500/20 text-amber-100 ring-1 ring-amber-500/40":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:H.label.replace("All Types","All")},H.key))})]}),$&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-500",children:"Format"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:_.filter(H=>H.available).map(H=>a.jsx("button",{onClick:()=>k(H.key),className:`rounded-full px-2.5 py-1 text-xs font-medium transition-colors ${p===H.key?"bg-cyan-500/20 text-cyan-100 ring-1 ring-cyan-500/40":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:H.label.replace("All Media","All")},H.key))})]}),L&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-500",children:"Publication"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"all",label:"All"},...o].map(H=>a.jsx("button",{onClick:()=>g(H.key),className:`rounded-full px-2.5 py-1 text-xs font-medium transition-colors ${h===H.key?"bg-emerald-500/20 text-emerald-100 ring-1 ring-emerald-500/40":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:H.label},H.key))})]}),B&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-500",children:"Availability"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:[{key:"all",label:"All"},...c].map(H=>a.jsx("button",{onClick:()=>S(H.key),className:`rounded-full px-2.5 py-1 text-xs font-medium transition-colors ${w===H.key?"bg-lime-500/20 text-lime-100 ring-1 ring-lime-500/40":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:H.label},H.key))})]}),Q&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.12em] text-slate-500",children:"Distributor"}),a.jsx("div",{className:"flex flex-wrap gap-1.5",children:["all",...l].map(H=>a.jsx("button",{onClick:()=>C(H),className:`rounded-full px-2.5 py-1 text-xs font-medium transition-colors ${b===H?"bg-fuchsia-500/20 text-fuchsia-100 ring-1 ring-fuchsia-500/40":"bg-slate-800 text-slate-300 hover:bg-slate-700"}`,children:H==="all"?"All":H},H))})]})]})]})},Fx=({navPath:r,pagination:s,onBreadcrumbClick:n,onPaginationClick:o,isLoading:c=!1})=>{const l=r.length>0,d=s&&(s.prev||s.next)&&!c;return a.jsxs(a.Fragment,{children:[l&&a.jsx("nav",{"aria-label":"breadcrumb",className:"mb-4 flex flex-wrap items-center gap-y-1 rounded-lg border border-slate-700/60 bg-slate-900/30 px-3 py-2 text-sm text-slate-400",children:r.map((f,p)=>a.jsxs(dt.Fragment,{children:[a.jsx("button",{onClick:()=>n(p),className:`truncate transition-colors hover:text-sky-300 ${p===r.length-1?"font-medium text-white":""}`,"aria-current":p===r.length-1?"page":void 0,children:f.name}),p<r.length-1&&a.jsx(Fh,{className:"w-4 h-4 mx-1 flex-shrink-0"})]},p))}),d&&a.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[a.jsxs("button",{onClick:()=>s.prev&&o(s.prev),disabled:!s.prev,className:"inline-flex items-center gap-2 rounded-md border border-slate-700 bg-slate-800 px-3 py-2 text-sm font-medium text-slate-200 transition-colors duration-200 hover:bg-slate-700 disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Previous page",children:[a.jsx(xi,{className:"h-4 w-4"}),a.jsx("span",{children:"Previous"})]}),a.jsxs("button",{onClick:()=>s.next&&o(s.next),disabled:!s.next,className:"inline-flex items-center gap-2 rounded-md border border-slate-700 bg-slate-800 px-3 py-2 text-sm font-medium text-slate-200 transition-colors duration-200 hover:bg-slate-700 disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Next page",children:[a.jsx("span",{children:"Next"}),a.jsx(gc,{className:"h-4 w-4"})]})]})]})},Bx=({value:r,onChange:s,onSubmit:n,onClear:o,disabled:c=!1,isLoading:l=!1,errorMessage:d=null,hasActiveSearch:f=!1})=>{const p=r.trim();return a.jsxs("section",{className:"mb-5 rounded-xl border border-slate-700/60 bg-slate-950/40 p-3",children:[a.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-slate-400",children:"Catalog Search"}),a.jsx("span",{className:"text-[11px] text-slate-500",children:l?"Loading search":"Remote query"})]}),a.jsxs("form",{className:"flex flex-col gap-2 sm:flex-row",onSubmit:h=>{h.preventDefault(),!(c||p.length===0)&&n()},children:[a.jsx("input",{type:"search",value:r,onChange:h=>s(h.target.value),placeholder:"Search this catalog",disabled:c,className:"min-w-0 flex-1 rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500 disabled:cursor-not-allowed disabled:opacity-60","aria-label":"Search this catalog"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"submit",disabled:c||p.length===0,className:"rounded-lg bg-sky-600 px-3 py-2 text-sm font-medium text-white transition-colors hover:bg-sky-500 disabled:cursor-not-allowed disabled:bg-slate-700 disabled:text-slate-400",children:"Search"}),f&&a.jsx("button",{type:"button",onClick:o,className:"rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm font-medium text-slate-200 transition-colors hover:bg-slate-800",children:"Clear"})]})]}),d&&a.jsx("p",{className:"mt-2 text-xs text-rose-300",children:d})]})},Mx=({navigationLinks:r,currentNavigationUrl:s=null,facetGroups:n,onNavigationSelect:o,onFacetSelect:c,isLoading:l=!1})=>{const[d,f]=T.useState(!0),[p,h]=T.useState(!0),[w,b]=T.useState(""),[x,v]=T.useState(!1),[k,g]=T.useState(!1),[S,C]=T.useState(""),R=T.useRef(null),I=T.useRef(null),_=yr({isActive:k,onEscape:()=>g(!1),initialFocusRef:I,returnFocusRef:R}),F=10,M=24,$=12,L=24,B=r.length>0,Q=n.some(Z=>Z.links.length>0),oe=r.length>$,z=r.length>L,H=T.useMemo(()=>{const Z=w.trim().toLowerCase();return Z?r.filter(P=>P.title.toLowerCase().includes(Z)):r},[r,w]),N=T.useMemo(()=>{if(r.length<=$)return H;const Z=x?M:F;return H.slice(0,Z)},[H,r.length,x]),X=Math.max(H.length-N.length,0),me=T.useMemo(()=>{const Z=S.trim().toLowerCase();return Z?r.filter(P=>P.title.toLowerCase().includes(Z)):r},[S,r]);if(T.useEffect(()=>{v(!1),g(!1),C("")},[s,r]),!B&&!Q&&!l)return null;const ee=()=>{C(w),g(!0)},ie=Z=>{g(!1),o(Z)},re=(Z,P,W)=>{const ye=!!s&&Z.url===s;return a.jsx("button",{onClick:()=>W(Z),className:`w-full rounded-md border px-2.5 py-2 text-left text-sm transition-colors ${ye?"border-sky-400/40 bg-sky-500/20 text-sky-100":"border-transparent bg-sky-500/10 text-sky-200 hover:border-sky-500/30 hover:bg-sky-500/20"}`,"aria-current":ye?"page":void 0,children:a.jsxs("span",{className:"flex items-center gap-2.5",children:[Z.thumbnail&&a.jsx("img",{src:Z.thumbnail,alt:`${Z.title} thumbnail`,className:"h-10 w-8 flex-shrink-0 rounded object-cover",loading:"lazy",onError:he=>{const fe=he.currentTarget;fe.onerror=null,fe.src=Xt(Z.thumbnail)}}),a.jsx("span",{className:"min-w-0 truncate",children:Z.title})]})},`${Z.url}-${P}`)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"rounded-xl border border-slate-700/60 bg-slate-900/40 p-3 lg:sticky lg:top-4",children:[a.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[a.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-slate-400",children:"Browse"}),a.jsxs("span",{className:"text-[11px] text-slate-500",children:[r.length+n.reduce((Z,P)=>Z+P.links.length,0)," options"]})]}),a.jsxs("div",{className:"space-y-2.5",children:[B&&a.jsxs("div",{className:"overflow-hidden rounded-lg border border-slate-700/70",children:[a.jsxs("button",{onClick:()=>f(!d),className:"flex w-full items-center justify-between bg-slate-800/70 px-3 py-2 text-left transition-colors hover:bg-slate-800",children:[a.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.14em] text-slate-300",children:"Navigation"}),a.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform ${d?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&a.jsxs("div",{className:"space-y-2 bg-slate-900/30 p-2",children:[oe&&a.jsx("input",{type:"search",value:w,onChange:Z=>b(Z.target.value),placeholder:`Filter ${r.length} links`,className:"w-full rounded-md border border-slate-700 bg-slate-900 px-2.5 py-2 text-sm text-slate-200 placeholder:text-slate-500 focus:border-sky-500/50 focus:outline-none","aria-label":"Filter navigation links"}),H.length>0?a.jsxs(a.Fragment,{children:[a.jsx("nav",{className:"space-y-1.5",children:N.map((Z,P)=>re(Z,P,o))}),r.length>$&&a.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[X>0&&a.jsxs("button",{onClick:()=>v(!0),className:"rounded-md border border-slate-700 bg-slate-800 px-2.5 py-1.5 text-xs font-medium text-slate-300 transition-colors hover:bg-slate-700",children:["Show ",Math.min(X,M-F)," more"]}),x&&H.length>F&&a.jsx("button",{onClick:()=>v(!1),className:"rounded-md border border-slate-700 bg-slate-800 px-2.5 py-1.5 text-xs font-medium text-slate-300 transition-colors hover:bg-slate-700",children:"Show less"}),z&&a.jsxs("button",{ref:R,onClick:ee,className:"rounded-md border border-sky-500/30 bg-sky-500/10 px-2.5 py-1.5 text-xs font-medium text-sky-200 transition-colors hover:bg-sky-500/20",children:["View all (",H.length,")"]})]})]}):a.jsx("p",{className:"rounded-md bg-slate-900 px-2.5 py-3 text-sm text-slate-400",children:"No navigation links match that filter."})]})]}),Q&&a.jsxs("div",{className:"overflow-hidden rounded-lg border border-slate-700/70",children:[a.jsxs("button",{onClick:()=>h(!p),className:"flex w-full items-center justify-between bg-slate-800/70 px-3 py-2 text-left transition-colors hover:bg-slate-800",children:[a.jsx("span",{className:"text-xs font-medium uppercase tracking-[0.14em] text-slate-300",children:"Facets"}),a.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform ${p?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&a.jsx("div",{className:"space-y-3 bg-slate-900/30 p-2",children:n.filter(Z=>Z.links.length>0).map((Z,P)=>a.jsxs("div",{children:[a.jsx("p",{className:"px-1.5 pb-1 text-[11px] font-medium uppercase tracking-[0.14em] text-slate-500",children:Z.title}),a.jsx("nav",{className:"space-y-1.5",children:Z.links.map((W,ye)=>a.jsxs("button",{onClick:()=>c(W),className:`flex w-full items-center justify-between gap-3 rounded-md border px-2.5 py-2 text-left text-sm transition-colors ${W.isActive?"border-emerald-500/40 bg-emerald-500/12 text-emerald-100":"border-transparent bg-slate-800/40 text-slate-300 hover:bg-slate-800/70"}`,children:[a.jsx("span",{className:"truncate",children:W.title}),typeof W.count=="number"&&a.jsx("span",{className:"rounded-full bg-slate-800 px-2 py-0.5 text-[11px] text-slate-400",children:W.count})]},`${W.url}-${ye}`))})]},`${Z.title}-${P}`))})]})]})]}),k&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",onClick:()=>g(!1),role:"dialog","aria-modal":"true","aria-label":"All navigation links",children:a.jsxs("div",{ref:_,className:"flex max-h-[85vh] w-full max-w-2xl flex-col overflow-hidden rounded-xl border border-slate-700 bg-slate-900 text-white shadow-xl",onClick:Z=>Z.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 px-4 py-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-white",children:"All Navigation Links"}),a.jsxs("p",{className:"text-xs text-slate-400",children:[r.length," total links"]})]}),a.jsx("button",{onClick:()=>g(!1),className:"rounded-full p-2 text-slate-400 transition-colors hover:bg-slate-800 hover:text-white","aria-label":"Close navigation browser",children:a.jsx(Zt,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"border-b border-slate-700 px-4 py-3",children:a.jsx("input",{ref:I,type:"search",value:S,onChange:Z=>C(Z.target.value),placeholder:`Search ${r.length} links`,className:"w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-sky-500/50 focus:outline-none","aria-label":"Search all navigation links"})}),a.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3",children:me.length>0?a.jsx("nav",{className:"space-y-1.5",children:me.map((Z,P)=>re(Z,P,ie))}):a.jsx("p",{className:"rounded-md bg-slate-950 px-3 py-4 text-sm text-slate-400",children:"No navigation links match that search."})})]})})]})},mp=({message:r,title:s,variant:n="page",severity:o="error",onRetry:c,onDismiss:l,className:d=""})=>{const p=(()=>{switch(o){case"error":return{bg:"bg-red-900/20",border:"border-red-500/50",text:"text-red-400",icon:"text-red-500",button:"bg-red-600 hover:bg-red-700"};case"warning":return{bg:"bg-yellow-900/20",border:"border-yellow-500/50",text:"text-yellow-400",icon:"text-yellow-500",button:"bg-yellow-600 hover:bg-yellow-700"};case"info":return{bg:"bg-blue-900/20",border:"border-blue-500/50",text:"text-blue-400",icon:"text-blue-500",button:"bg-blue-600 hover:bg-blue-700"}}})(),h=()=>{switch(o){case"error":return a.jsx("svg",{className:`w-6 h-6 ${p.icon}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return a.jsx("svg",{className:`w-6 h-6 ${p.icon}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"info":return a.jsx("svg",{className:`w-6 h-6 ${p.icon}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}};return n==="inline"?a.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${p.bg} ${p.border} border ${d}`,children:[h(),a.jsx("span",{className:`text-sm ${p.text}`,children:r}),l&&a.jsx("button",{onClick:l,className:"ml-auto text-slate-400 hover:text-white","aria-label":"Dismiss",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):n==="card"?a.jsx("div",{className:`rounded-lg p-6 ${p.bg} ${p.border} border ${d}`,children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0",children:h()}),a.jsxs("div",{className:"flex-1 min-w-0",children:[s&&a.jsx("h3",{className:`text-lg font-semibold mb-2 ${p.text}`,children:s}),a.jsx("p",{className:"text-slate-300 text-sm",children:r}),(c||l)&&a.jsxs("div",{className:"flex gap-3 mt-4",children:[c&&a.jsx("button",{onClick:c,className:`px-4 py-2 rounded-lg text-white font-medium transition-colors ${p.button}`,children:"Try Again"}),l&&a.jsx("button",{onClick:l,className:"px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-white font-medium transition-colors",children:"Dismiss"})]})]}),l&&a.jsx("button",{onClick:l,className:"flex-shrink-0 text-slate-400 hover:text-white","aria-label":"Close",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}):a.jsx("div",{className:`text-center py-20 ${p.bg} rounded-lg ${d}`,children:a.jsxs("div",{className:"flex flex-col items-center max-w-md mx-auto",children:[a.jsx("div",{className:"mb-4",children:h()}),a.jsx("h2",{className:`text-2xl font-semibold mb-2 ${p.text}`,children:s||"Something Went Wrong"}),a.jsx("p",{className:"text-slate-300 mb-6",children:r}),(c||l)&&a.jsxs("div",{className:"flex gap-3",children:[c&&a.jsx("button",{onClick:c,className:`px-6 py-3 rounded-lg text-white font-bold transition-colors ${p.button}`,children:"Try Again"}),l&&a.jsx("button",{onClick:l,className:"px-6 py-3 rounded-lg bg-slate-700 hover:bg-slate-600 text-white font-bold transition-colors",children:"Dismiss"})]})]})})},gp=({variant:r="spinner",size:s="medium",message:n,className:o=""})=>{if(r==="spinner"){const c=s==="large"?"medium":s;return a.jsx("div",{className:`flex justify-center items-center ${o}`,children:a.jsx(yn,{text:n,size:c})})}if(r==="inline"){const c={small:"w-4 h-4",medium:"w-5 h-5",large:"w-6 h-6"};return a.jsxs("div",{className:`inline-flex items-center gap-2 ${o}`,children:[a.jsxs("svg",{className:`animate-spin ${c[s]} text-sky-400`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n&&a.jsx("span",{className:"text-sm text-slate-300",children:n})]})}if(r==="skeleton")return a.jsx("div",{className:`animate-pulse ${o}`,children:a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6",children:Array.from({length:12}).map((c,l)=>a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"aspect-[2/3] bg-slate-700 rounded-lg"}),a.jsx("div",{className:"h-4 bg-slate-700 rounded w-3/4"}),a.jsx("div",{className:"h-3 bg-slate-700 rounded w-1/2"})]},l))})});if(r==="page"){const c=s==="large"?"medium":s;return a.jsx("div",{className:`fixed inset-0 bg-slate-900 bg-opacity-75 flex items-center justify-center z-50 ${o}`,children:a.jsx("div",{className:"bg-slate-800 p-8 rounded-lg shadow-xl text-center max-w-sm w-full",children:a.jsx(yn,{text:n,size:c})})})}return null},yp=dt.forwardRef(({book:r,onClick:s,onContextMenu:n,className:o="",isFocused:c=!1},l)=>{const d=()=>s(r),f=k=>{n&&(k.preventDefault(),n(r,k))},p=k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),s(r))},h=k=>"downloadUrl"in k,b="coverImage"in r&&r.coverImage?r.coverImage:"cover"in r&&r.cover?r.cover:null,x=h(r)?r.contributors??[]:[],v=h(r)?(r.categories??[]).map(k=>k.label||k.term).filter(Boolean):[];return a.jsxs("div",{ref:l,onClick:d,onContextMenu:f,onKeyDown:p,tabIndex:0,"aria-label":`${r.title} by ${r.author}`,className:`cursor-pointer group relative focus:outline-none ${c?"ring-2 ring-sky-500 ring-offset-2 ring-offset-slate-900":""} ${o}`,children:[a.jsx("div",{className:"aspect-[2/3] bg-slate-800 rounded-lg overflow-hidden shadow-lg transform group-hover:scale-105 transition-transform duration-300 book-cover-container",children:b?a.jsx("img",{src:b,alt:r.title,className:"w-full h-full object-cover",loading:"lazy",onError:k=>{const g=k.currentTarget;g.onerror=null,h(r)&&r.coverImage&&(g.src=Xt(r.coverImage))}}):a.jsx("div",{className:"w-full h-full flex items-center justify-center p-4 text-center text-slate-400",children:a.jsx("span",{className:"font-semibold",children:r.title})})}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx("h3",{className:"text-sm font-semibold text-white truncate group-hover:text-sky-400",children:r.title}),a.jsx("p",{className:"text-xs text-slate-400 truncate",children:r.author}),x.length>0&&a.jsxs("p",{className:"text-[11px] text-slate-400 truncate",title:x.join(", "),children:["Contributors: ",x.slice(0,2).join(", ")]}),v.length>0&&a.jsxs("p",{className:"text-[11px] text-slate-500 truncate",title:v.join(", "),children:["Categories: ",v.slice(0,2).join(", ")]}),a.jsx(Hh,{book:r})]})]})});yp.displayName="BookCard";const vp=({books:r,isLoading:s=!1,onBookClick:n,onBookContextMenu:o,className:c=""})=>{const[l,d]=T.useState(-1),f=T.useRef(null),p=T.useRef(new Map),h=T.useCallback(()=>{if(typeof window>"u")return 4;const R=window.innerWidth;return R>=1280?6:R>=1024?5:R>=768?4:R>=640?3:2},[]),[w,b]=T.useState(h);T.useEffect(()=>{const R=()=>b(h());return window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[h]);const x=T.useCallback(R=>{r.length!==0&&d(I=>{let _=I;if(I===-1)_=0;else switch(R){case"left":_=I>0?I-1:I;break;case"right":_=I<r.length-1?I+1:I;break;case"up":_=I-w,_<0&&(_=I);break;case"down":_=I+w,_>=r.length&&(_=I);break}const F=p.current.get(_);return F&&(F.focus(),F.scrollIntoView({behavior:"smooth",block:"nearest"})),_})},[r.length,w]),v=T.useCallback(()=>{l>=0&&l<r.length&&n(r[l])},[l,r,n]),[k,g]=T.useState(!1);cx({enableArrowKeys:k&&r.length>0,enableActivation:k&&r.length>0,onArrowKey:x,onActivate:v,preventDefault:!0});const S=T.useCallback(()=>{if(g(!0),l===-1&&r.length>0){d(0);const R=p.current.get(0);R&&R.focus()}},[l,r.length]),C=T.useCallback(R=>{f.current?.contains(R.relatedTarget)||g(!1)},[]);return s?a.jsx("div",{className:"flex justify-center mt-20",children:a.jsx(yn,{})}):a.jsx("div",{ref:f,className:`grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6 ${c}`,onFocus:S,onBlur:C,"aria-label":"Book collection",children:r.map((R,I)=>{const _="id"in R&&R.id?`book-${R.id}`:`catalog-${"downloadUrl"in R?R.downloadUrl:R.title}-${I}`;return a.jsx(yp,{book:R,onClick:n,onContextMenu:o,isFocused:I===l,ref:F=>{F?p.current.set(I,F):p.current.delete(I)}},_)})})},xp=({variant:r,title:s,message:n,error:o})=>{const l=(()=>{switch(r){case"library":return{title:"Your library is empty.",message:"Import your first book or add a catalog to get started!",textColor:"text-slate-50"};case"catalog":return{title:"Empty Section",message:"No categories or books were found here.",textColor:"text-slate-50"};case"error":return{title:"Error Loading Source",message:o||"An unexpected error occurred.",textColor:"text-red-500"};default:return{title:"No Content",message:"Nothing to display here.",textColor:"text-white"}}})(),d=s||l.title,f=n||l.message,p=l.textColor;return a.jsxs("div",{className:"text-center py-20 bg-slate-700 rounded-lg",children:[a.jsx("h2",{className:`text-2xl font-semibold ${p}`,children:d}),a.jsx("p",{className:"text-slate-100 mt-2 max-w-xl mx-auto",children:f})]})},Ux=({activeOpdsSource:r,catalogNavPath:s,setCatalogNavPath:n,onShowBookDetail:o})=>{const[c,l]=T.useState("all"),[d,f]=T.useState("all"),[p,h]=T.useState("all"),[w,b]=T.useState("all"),[x,v]=T.useState("all"),[k,g]=T.useState("all"),[S,C]=T.useState([]),[R,I]=T.useState([]),[_,F]=T.useState(""),[M,$]=T.useState(null),[L,B]=T.useState(null),[Q,oe]=T.useState(null),[z,H]=T.useState(null),N=s.length>0?s[s.length-1].url:r?.url||null,X=r&&"opdsVersion"in r&&r.opdsVersion||"auto";T.useEffect(()=>{C([])},[N,r?.id]),T.useEffect(()=>{I([])},[r?.id]);const{data:me,isLoading:ee,error:ie,refetch:re}=ox(N,r?.url||"",X,!!r),Z=me?.books||[],P=me?.navigationLinks||[],W=me?.facetGroups||[],ye=me?.pagination||null,he=me?.search||null;T.useEffect(()=>{oe(null),F(""),$(null),B(null),H(null)},[r?.id]),T.useEffect(()=>{he&&oe(he)},[he]);const{data:fe,isLoading:Ae,error:be}=lx(Q,!!Q?.descriptionUrl),xe=T.useMemo(()=>{if(!ye)return null;const ve=ye.prev||(R.length>0?R[R.length-1]:void 0);return{...ye,prev:ve}},[ye,R]),{availableAudiences:Ne,availableFictionModes:De,availableMediaModes:$e,availablePublicationTypes:Ye,availableAvailabilityModes:Ve,availableDistributors:j}=T.useMemo(()=>({availableAudiences:mv(Z),availableFictionModes:yv(Z),availableMediaModes:xv(Z),availablePublicationTypes:kv(Z),availableAvailabilityModes:Cv(Z),availableDistributors:jv(Z)}),[Z]);T.useEffect(()=>{if(Z.length===0)return;const ve=pv(Z,c),ke=gv(ve,d),Te=vv(ke,p),Oe=bv(Te,w),Re=Sv(Oe,x),We=Nv(Re,k);C(We)},[c,d,p,w,x,k,Z]);const ue=()=>{l("all"),f("all"),h("all"),b("all"),v("all"),g("all")},ce=ve=>{n(s.slice(0,ve+1)),ue(),I([])},V=ve=>{n(ke=>{if(ke.length===0)return ke;const Te=[...ke];return Te[Te.length-1]={...Te[Te.length-1],url:ve},Te}),I(ke=>{try{if(!N)return ke;const Te=ke[ke.length-1];return Te&&Te===ve?ke.slice(0,-1):[...ke,N]}catch{return ke}})},D=ve=>{o(ve,"catalog",r.name)},q=()=>{const ve=_.trim(),ke=fe?.activeTemplate;if(!ve||!ke)return;let Te;try{Te=Dv(ke,{searchTerms:ve})}catch(We){H(We instanceof Error?We.message:"Unable to build search URL.");return}const Oe=M&&L?L:s.length>0?s:[{name:r.name,url:r.url}],Re=[...Oe,{name:`Search: ${ve}`,url:Te}];B(Oe),$(ve),H(null),n(Re),I([])},te=()=>{n(L||s.slice(0,Math.max(s.length-1,0))),$(null),B(null),F(""),H(null),I([])},ae=ve=>{n(ke=>[...ke,{name:ve.title,url:ve.url}]),ue(),I([])},J=ve=>{n(ke=>{if(ke.length===0)return[{name:ve.title,url:ve.url}];const Te=[...ke];return Te[Te.length-1]={...Te[Te.length-1],name:ve.title,url:ve.url},Te}),ue(),I([])},A=T.useMemo(()=>W.map(ve=>({...ve,links:ve.links.map(ke=>({...ke,isActive:ke.isActive??ke.url===N}))})),[N,W]),E=T.useMemo(()=>{if(!N)return P;const ve=P.filter(ke=>ke.url!==N);return ve.length>0?ve:P},[N,P]),U=E.length>0||A.some(ve=>ve.links.length>0);if(ee)return a.jsx(gp,{variant:"spinner",message:"Loading catalog..."});if(ie)return a.jsx(mp,{variant:"page",title:"Failed to Load Catalog",message:ie?.message||"Could not load catalog content.",onRetry:()=>re()});const K=S.length>0,pe=Z.length>0,Ee=!pe&&!U;return a.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[U&&a.jsx("aside",{className:"order-2 w-full lg:order-1 lg:w-56 lg:flex-shrink-0",children:a.jsx(Mx,{navigationLinks:E,currentNavigationUrl:N,facetGroups:A,onNavigationSelect:ae,onFacetSelect:J,isLoading:ee})}),a.jsxs("main",{className:"flex-1 min-w-0 order-1 lg:order-2",children:[a.jsx(Fx,{navPath:s,pagination:xe??ye,onBreadcrumbClick:ce,onPaginationClick:V,isLoading:ee}),Q&&a.jsx(Bx,{value:_,onChange:F,onSubmit:q,onClear:te,disabled:Ae||!fe?.activeTemplate,isLoading:Ae,errorMessage:z||(be instanceof Error?be.message:null),hasActiveSearch:!!M}),a.jsx(Dx,{availableAudiences:Ne,availableFictionModes:De,availableMediaModes:$e,availablePublicationTypes:Ye,availableAvailabilityModes:Ve,availableDistributors:j,audienceMode:c,fictionMode:d,mediaMode:p,publicationMode:w,availabilityMode:x,distributorMode:k,onAudienceChange:l,onFictionChange:f,onMediaChange:h,onPublicationChange:b,onAvailabilityChange:v,onDistributorChange:g}),Ee?a.jsx(xp,{variant:"catalog"}):K?a.jsx(vp,{books:S,onBookClick:D,isLoading:ee}):pe?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("p",{className:"text-slate-400 text-lg mb-2",children:"No books match your current filters"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Try adjusting the local filters to see more books"})]}):null]})]})},zx=({isLoading:r,onFileChange:s,onActivate:n,alwaysShowLabel:o=!1,className:c=""})=>{const l=T.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsxs("label",{htmlFor:"epub-upload",onClick:n,className:`cursor-pointer bg-sky-500 hover:bg-sky-600 text-white font-bold p-2 sm:py-2 sm:px-4 rounded-lg inline-flex items-center transition-colors duration-200 ${r?"opacity-50 cursor-not-allowed":""} ${c}`,children:[a.jsx(Dh,{className:"w-5 h-5 sm:mr-2"}),a.jsx("span",{className:o?"inline":"hidden sm:inline",children:"Import Book"})]}),a.jsx("input",{ref:l,id:"epub-upload",type:"file",accept:".epub,.pdf",className:"hidden",onChange:s,disabled:r,"aria-label":"Upload EPUB or PDF file"})]})},$x=({onOpenBook:r,onShowBookDetail:s,onFileChange:n,importStatus:o,libraryRefreshFlag:c})=>{console.log("[LocalLibraryView] mounted. libraryRefreshFlag:",c);const[l,d]=T.useState(null),{data:f=[],isLoading:p,error:h,refetch:w}=ex();dt.useEffect(()=>{console.log("[LocalLibraryView] useEffect triggered by libraryRefreshFlag:",c),w()},[c,w]);const{mutate:b}=tx(),x=g=>{s(g,"library")},v=(g,S)=>{S.preventDefault(),d(g)},k=T.useCallback(()=>{l?.id&&b(l.id,{onSuccess:()=>{d(null)}})},[l,b]);return p?a.jsx(gp,{variant:"skeleton",message:"Loading library..."}):h?a.jsx(mp,{variant:"page",title:"Failed to Load Library",message:h instanceof Error?h.message:"Could not load books from the library.",onRetry:()=>w()}):a.jsxs(a.Fragment,{children:[f.length>0?a.jsx(vp,{books:f,onBookClick:x,onBookContextMenu:v}):a.jsx(xp,{variant:"library"}),a.jsx(xx,{isOpen:!!l,onClose:()=>d(null),onConfirm:k,bookTitle:l?.title||""})]})},Wx=({onOpenBook:r,onShowBookDetail:s,processAndSaveBook:n,importStatus:o,setImportStatus:c,activeOpdsSource:l,setActiveOpdsSource:d,catalogNavPath:f,setCatalogNavPath:p,onOpenCloudSyncModal:h,onOpenLocalStorageModal:w,onShowAbout:b,libraryRefreshFlag:x,syncStatus:v})=>{const k=Bo(),{user:g,isLoggedIn:S}=Ec(),{catalogs:C,registries:R,addCatalog:I,deleteCatalog:_,updateCatalog:F,addRegistry:M,deleteRegistry:$,updateRegistry:L}=rp(),[B,Q]=T.useState(!1),[oe,z]=T.useState(!1),[H,N]=T.useState(!1),[X,me]=T.useState(null),[ee,ie]=T.useState(null),re=T.useRef(null),Z=T.useRef(null);T.useEffect(()=>{const D=q=>{re.current&&!re.current.contains(q.target)&&Q(!1),Z.current&&!Z.current.contains(q.target)&&N(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]);const P=T.useCallback(D=>{D==="library"?(d(null),p([])):(d(D),p([{name:D.name,url:D.url}])),Q(!1)},[d,p]),W=T.useCallback((D,q,te="auto")=>{I(D,q,te)},[I]),ye=T.useCallback(D=>{_(D),l?.id===D&&P("library")},[_,l,P]),he=T.useCallback((D,q)=>{F(D,{name:q}),l?.id===D&&(d(te=>te?{...te,name:q}:null),p(te=>{if(te.length>0){const ae=[...te];return ae[0]={...ae[0],name:q},ae}return te}))},[F,l,d,p]),fe=T.useCallback((D,q)=>{M(D,q)},[M]),Ae=T.useCallback(D=>{$(D),l?.id===D&&P("library")},[$,l,P]),be=T.useCallback((D,q)=>{L(D,{name:q}),l?.id===D&&d(te=>te?{...te,name:q}:null)},[L,l,d]),xe=D=>{console.log("[LibraryView] handleFileChange called",D.target.files);const q=D.target.files;if(!q||q.length===0){console.log("[LibraryView] No file selected");return}const te=q[0];if(console.log("[LibraryView] File selected:",te.name,te.type,te.size),te.size===0){console.error("[LibraryView] File size is 0 - file object is invalid!");const K=/\.(epub|pdf)$/i.test(te.name)?'Unable to access file. If this file is stored in iCloud, right-click it in Finder and select "Download Now" to make it available locally, then try again.':"Unable to access file. Please try again.";c({isLoading:!1,message:"",error:K}),D.target.value="";return}const ae=te.name;te.type;const J=ae.toLowerCase().endsWith(".pdf")?"PDF":"EPUB";console.log("[LibraryView] Creating blob from file...");const A=te.slice(0,te.size,te.type),E=new FileReader;console.log("[LibraryView] Starting FileReader.readAsArrayBuffer from blob..."),E.readAsArrayBuffer(A),c({isLoading:!0,message:"Reading file...",error:null}),E.onload=async U=>{const K=U.target?.result;if(!K){c({isLoading:!1,message:"",error:"Could not read file data."});return}console.log("[LibraryView] File read successfully, calling processAndSaveBook...",{fileName:ae,size:K.byteLength});try{const pe=await n(K,ae,void 0,"file",void 0,void 0,J);console.log("[LibraryView] processAndSaveBook result:",pe),pe.success?(console.log("[LibraryView] Invalidating books query cache..."),await k.invalidateQueries({queryKey:hi.all}),console.log("[LibraryView] Books query cache invalidated"),c({isLoading:!1,message:"Import successful!",error:null}),setTimeout(()=>c({isLoading:!1,message:"",error:null}),2e3)):!pe.success&&pe.bookRecord&&pe.existingBook&&(console.log("[LibraryView] Duplicate book detected"),me(pe.bookRecord),ie(pe.existingBook),c({isLoading:!1,message:"",error:null}))}catch(pe){console.error("[LibraryView] Error during processAndSaveBook:",pe),c({isLoading:!1,message:"",error:pe.message||"Failed to import book"})}D.target.value=""},E.onerror=U=>{console.error("[LibraryView] FileReader error:",{error:E.error,errorName:E.error?.name,errorMessage:E.error?.message,event:U}),c({isLoading:!1,message:"",error:`File read error: ${E.error?.message||"Unknown error"}`}),D.target.value=""}},Ne=T.useCallback(async()=>{if(!X||!ee)return;c({isLoading:!0,message:"Replacing book...",error:null});const D={...X,id:ee.id};me(null),ie(null);try{await st.saveBook(D),l||await k.invalidateQueries({queryKey:hi.all}),c({isLoading:!1,message:"Import successful!",error:null}),setTimeout(()=>c({isLoading:!1,message:"",error:null}),2e3)}catch(q){ne.error("Error replacing book:",q),c({isLoading:!1,message:"",error:"Failed to replace the book in the library."})}},[l,X,ee,k,c]),De=T.useCallback(async()=>{if(!X)return;c({isLoading:!0,message:"Saving new copy...",error:null});const D={...X};me(null),ie(null);try{await st.saveBook(D),l||await k.invalidateQueries({queryKey:hi.all}),c({isLoading:!1,message:"Import successful!",error:null}),setTimeout(()=>c({isLoading:!1,message:"",error:null}),2e3)}catch(q){ne.error("Error adding duplicate book:",q),c({isLoading:!1,message:"",error:"Failed to add the new copy to the library."})}},[l,X,k,c]),$e=T.useCallback(()=>{me(null),ie(null),c({isLoading:!1,message:"",error:null})},[c]),Ye=l?l.name:"My Library",Ve=!!l,j=localStorage.getItem("ebook-reader-last-sync"),ue=j?new Date(j).toLocaleString():"Never",ce=v.state==="idle"?`Last synced ${ue}`:v.message,V=v.state==="error"?"text-red-300":v.state==="success"?"text-emerald-300":v.state==="syncing"?"text-sky-300":"text-slate-400";return a.jsxs("div",{className:"container mx-auto p-4 md:p-8",children:[a.jsxs("header",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("img",{src:Ox,alt:"MeBooks Logo",className:"w-10 h-10 flex-shrink-0"}),a.jsxs("div",{ref:re,className:"relative",children:[a.jsxs("button",{onClick:()=>Q(D=>!D),className:"flex items-center gap-2 text-white text-left","aria-label":"Select book source","aria-expanded":B?"true":"false","aria-haspopup":"true",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:Ye}),a.jsx(sy,{className:`w-6 h-6 transition-transform flex-shrink-0 mt-1 md:mt-2 ${B?"rotate-180":""}`})]}),B&&a.jsx("div",{className:"absolute top-full mt-2 w-72 bg-slate-800 border border-slate-700 rounded-lg shadow-xl z-20",children:a.jsxs("ul",{className:"p-1 text-white max-h-96 overflow-y-auto",children:[a.jsx("li",{children:a.jsx("button",{onClick:()=>P("library"),className:`w-full text-left px-3 py-2 text-sm rounded-md ${Ve?"hover:bg-slate-700":"bg-sky-600"}`,children:"My Library"})}),(C.length>0||R.length>0)&&a.jsx("li",{className:"my-1 border-t border-slate-700"}),C.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("li",{className:"px-3 pt-2 pb-1 text-xs font-semibold text-slate-400 uppercase",children:"Catalogs"}),C.map(D=>a.jsx("li",{children:a.jsx("button",{onClick:()=>P(D),className:`w-full text-left px-3 py-2 text-sm rounded-md truncate ${Ve&&l?.id===D.id?"bg-sky-600":"hover:bg-slate-700"}`,children:D.name})},D.id))]}),R.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("li",{className:"px-3 pt-2 pb-1 text-xs font-semibold text-slate-400 uppercase",children:"Registries"}),R.map(D=>a.jsx("li",{children:a.jsx("button",{onClick:()=>P(D),className:`w-full text-left px-3 py-2 text-sm rounded-md truncate ${Ve&&l?.id===D.id?"bg-sky-600":"hover:bg-slate-700"}`,children:D.name})},D.id))]})]})})]})]}),a.jsx("div",{className:"flex items-center gap-2 flex-shrink-0 self-end md:self-auto",children:a.jsxs("div",{ref:Z,className:"relative",children:[a.jsx("button",{onClick:()=>N(D=>!D),className:"cursor-pointer bg-slate-900/80 hover:bg-slate-800 text-slate-200 p-2 rounded-md inline-flex items-center transition-colors duration-200 h-[36px] w-[36px] justify-center border border-slate-700/80","aria-label":"Open main menu",children:a.jsx(yc,{className:"w-4 h-4"})}),H&&a.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-slate-900/95 border border-slate-700/80 rounded-md shadow-xl z-20 overflow-hidden backdrop-blur-sm",children:[a.jsxs("div",{className:"px-3 py-2.5 border-b border-slate-700/60 bg-slate-800/50",children:[S&&g?a.jsxs("div",{className:"flex items-center gap-2.5",children:[a.jsx("img",{src:g.picture,alt:`${g.name} profile`,className:"w-8 h-8 rounded-full object-cover",referrerPolicy:"no-referrer"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-[13px] font-medium text-slate-100 truncate leading-tight",children:g.name}),a.jsx("p",{className:"text-[11px] text-slate-500 truncate leading-tight",children:g.email})]})]}):a.jsx("p",{className:"text-[12px] font-medium text-slate-300",children:"Browsing locally"}),a.jsx("p",{className:`mt-2 text-[11px] leading-tight ${V}`,children:ce})]}),a.jsxs("ul",{className:"p-1.5 text-white",children:[!Ve&&a.jsx("li",{children:a.jsx(zx,{isLoading:o.isLoading,onFileChange:xe,onActivate:()=>N(!1),alwaysShowLabel:!0,className:"w-full justify-start rounded-sm bg-transparent hover:bg-slate-800/80 text-slate-100 font-medium px-2.5 py-2 border-0 text-[13px]"})}),!Ve&&a.jsx("li",{className:"my-1 border-t border-slate-700/40"}),a.jsx("li",{children:a.jsx("button",{onClick:()=>{z(!0),N(!1)},className:"w-full text-left px-2.5 py-2 text-[13px] rounded-sm hover:bg-slate-800/80 text-slate-200 block",children:"Manage Sources"})}),a.jsx("li",{className:"my-1 border-t border-slate-700/40"}),a.jsx("li",{children:a.jsx("button",{onClick:()=>{w(),N(!1)},className:"w-full text-left px-2.5 py-2 text-[13px] rounded-sm hover:bg-slate-800/80 text-slate-200 block",children:"Local Storage"})}),a.jsx("li",{children:a.jsx("button",{onClick:()=>{h(),N(!1)},className:"w-full text-left px-2.5 py-2 text-[13px] rounded-sm hover:bg-slate-800/80 text-slate-200 block",children:"Cloud Sync"})}),a.jsx("li",{className:"my-1 border-t border-slate-700/40"}),a.jsx("li",{children:a.jsx("button",{onClick:()=>{b(),N(!1)},className:"w-full text-left px-2.5 py-2 text-[13px] rounded-sm hover:bg-slate-800/80 text-slate-200 block",children:"About"})})]})]})]})})]}),a.jsx("section",{"aria-label":"Library content",children:Ve&&l?a.jsx(Ux,{activeOpdsSource:l,catalogNavPath:f,setCatalogNavPath:p,onShowBookDetail:s}):a.jsx($x,{libraryRefreshFlag:x,onOpenBook:r,onShowBookDetail:s,onFileChange:xe,importStatus:o})}),a.jsx(Cx,{isOpen:oe,onClose:()=>z(!1),catalogs:C,onAddCatalog:W,onDeleteCatalog:ye,onUpdateCatalog:he,registries:R,onAddRegistry:fe,onDeleteRegistry:Ae,onUpdateRegistry:be}),a.jsx(wx,{isOpen:!!X,onClose:$e,onReplace:Ne,onAddAnyway:De,bookTitle:X?.title||""})]})},sh="/My-Ebook-Reader/assets/pdf.worker.min-qwK7q_zL.mjs",Vx=dt.lazy(()=>Lo(()=>import("./index-7Mi_DyoV.js"),__vite__mapDeps([0,1])).then(r=>({default:r.Document}))),ih=dt.lazy(()=>Lo(()=>import("./index-7Mi_DyoV.js"),__vite__mapDeps([0,1])).then(r=>({default:r.Page}))),wp=({bookId:r,onClose:s})=>{const n=R0(),o=mc(),c=r??(n.id?Number(n.id):null),l=s??(()=>o("/")),[d,f]=T.useState(null),[p,h]=T.useState(null),[w,b]=T.useState(!0),[x,v]=T.useState(null),[k,g]=T.useState(null),[S,C]=T.useState(1),[R,I]=T.useState(100),[_,F]=T.useState("page"),[M,$]=T.useState(!1),L=dt.useRef(null),[B,Q]=T.useState(!1),[oe,z]=T.useState([]),[H,N]=T.useState({}),[X,me]=T.useState(null),ee=dt.useRef(null),[ie,re]=T.useState(!1),[Z,P]=T.useState(!1),[W,ye]=T.useState(!1),he=jc(),[fe,Ae]=T.useState(!1),[be,xe]=T.useState([]),[Ne,De]=T.useState([]),[$e,Ye]=T.useState(tc),[Ve,j]=T.useState(!1),[ue,ce]=T.useState(null),V=dt.useRef(null),D=T.useRef(null),q=T.useRef(null),te=T.useRef(!1);T.useEffect(()=>{let ve=!1;(async()=>{try{const Oe=await Lo(()=>import("./index-7Mi_DyoV.js"),__vite__mapDeps([0,1]));try{Oe.pdfjs.GlobalWorkerOptions.workerSrc=sh,ve=!0}catch(Re){console.warn("Could not set worker via static pdfWorkerUrl",Re)}if(!ve){const Re=await Lo(()=>import("./pdf-D-gusrb1.js").then(We=>We.p),[]);Re.GlobalWorkerOptions.workerSrc=sh,ve=!0}}catch(Oe){console.warn("Could not configure pdfjs worker dynamically",Oe),j(!0)}})();let ke=null;return(async()=>{b(!0),v(null),h(null);try{console.debug("[PdfReaderView] fetching book id=",c);const Oe=await st.getBook(c);if(!Oe)try{const yt=(await st.getAllBooks()).map(Qe=>Qe.id).filter(Boolean);throw new Error(`Could not find this book in your library (requested id: ${c}). Available book ids: ${yt.join(", ")||"none"}`)}catch{throw new Error(`Could not find this book in your library (requested id: ${c}).`)}if(Oe.format!=="PDF")throw new Error("The selected book is not in PDF format.");f(Oe);const Re=new Blob([Oe.epubData],{type:"application/pdf"});ke=URL.createObjectURL(Re),console.debug("[PdfReaderView] created objectUrl",ke,"blob size",Re.size),ce(Re.size),h(ke)}catch(Oe){console.error("[PdfReaderView] fetchBookData error",Oe),v(Oe instanceof Error?Oe.message:"An unknown error occurred.")}finally{b(!1)}})(),()=>{ke&&URL.revokeObjectURL(ke)}},[c]);const ae=ve=>{g(ve.numPages||null),C(1),(async()=>{try{Ae(!0);const ke=await ve.getOutline();if(!ke||ke.length===0){z([]);return}let Te=0;const Oe=async(We,yt=0)=>{if(!We)return null;const Qe=We.title||"Untitled";let ot=null;try{let ct=We.dest;if(typeof ct=="string"&&(ct=await ve.getDestination(ct)),Array.isArray(ct)&&ct.length>0)try{ot=await ve.getPageIndex(ct[0])+1}catch{}}catch{}const Je=[];if(We.items&&We.items.length>0)for(const ct of We.items){const Ct=await Oe(ct,yt+1);Ct&&Je.push(Ct)}return{id:`pdf-toc-${Te++}`,label:Qe,href:ot?`page:${ot}`:"",subitems:Je}},Re=[];for(const We of ke){const yt=await Oe(We,0);yt&&Re.push(yt)}z(Re);try{const We=[],yt=async ot=>{for(const Je of ot){if(Je.href)if(Je.href.startsWith("page:")){const bt=Number(Je.href.split(":")[1]);!isNaN(bt)&&bt>=1&&We.push({page:bt,label:Je.label})}else try{const bt=await ve.getDestination(Je.href);if(Array.isArray(bt)&&bt.length>0)try{const ct=await ve.getPageIndex(bt[0]);We.push({page:ct+1,label:Je.label})}catch{}}catch{}Je.subitems&&Je.subitems.length>0&&await yt(Je.subitems)}};await yt(Re),We.sort((ot,Je)=>ot.page-Je.page);const Qe={};for(let ot=0;ot<We.length;ot++){const Je=We[ot].page,bt=ot+1<We.length?We[ot+1].page-1:ve.numPages||Je;for(let ct=Je;ct<=bt;ct++)Qe[ct]=We[ot].label}N(Qe)}catch(We){console.warn("Failed to build pdf chapter map",We)}}catch(ke){console.warn("Failed to map PDF outline",ke),z([])}finally{Ae(!1)}})();try{const ke=Ay(d?.id??c);if(ke&&typeof ke=="string"&&ke.startsWith("page:")){const Te=Number(ke.split(":")[1]);!isNaN(Te)&&Te>=1&&C(Te)}}catch{}try{if(d?.id&&!te.current){const ke=Oy(d.id);ke&&typeof ke.zoomPercent=="number"&&I(ke.zoomPercent),ke&&ke.fitMode==="width"&&F("width"),te.current=!0}}catch{}},J=()=>{k&&C(ve=>Math.min(k,ve+1))},A=()=>{C(ve=>Math.max(1,ve-1))},E=ve=>{if(ve){if(ve.startsWith("page:")){const ke=Number(ve.split(":")[1]);!isNaN(ke)&&ke>=1&&C(ke)}else isNaN(Number(ve))||C(Number(ve));re(!1)}};dt.useEffect(()=>{if(!d?.id)return;V.current&&clearTimeout(V.current);const ve=d.id;return V.current=window.setTimeout(()=>{try{Ry(ve,`page:${S}`)}catch(ke){console.warn("Failed to save last PDF position",ke)}},800),()=>{V.current&&(clearTimeout(V.current),V.current=null)}},[S,d]),T.useEffect(()=>{if(d?.id){try{Iy(d.id,{zoomPercent:R,fitMode:_})}catch(ve){console.warn("Failed to persist pdf view state",ve)}$(!0),L.current&&clearTimeout(L.current),L.current=window.setTimeout(()=>$(!1),1200)}},[R,_,d]);const U=T.useCallback(()=>{if(!D.current)return;const ve=D.current.getBoundingClientRect().width;q.current=ve},[]);T.useEffect(()=>{U();const ve=new ResizeObserver(()=>U());return D.current&&ve.observe(D.current),()=>ve.disconnect()},[U]),dt.useEffect(()=>{const ve=ke=>{const Te=document.activeElement&&document.activeElement.tagName;if(!(Te==="INPUT"||Te==="TEXTAREA")){if(ke.key==="ArrowLeft")A();else if(ke.key==="ArrowRight")J();else if(ke.key===" ")ke.preventDefault(),J();else if(ke.key==="+"||ke.key==="="&&ke.shiftKey)I(Oe=>Math.min(400,Math.round(Oe*1.15)));else if(ke.key==="-"||ke.key==="_")I(Oe=>Math.max(20,Math.round(Oe/1.15)));else if(ke.key.toLowerCase()==="f")F(Oe=>Oe==="page"?"width":"page");else if(ke.key==="?")Q(Oe=>!Oe);else if(ke.key.toLowerCase()==="c")re(Oe=>!Oe);else if(ke.key.toLowerCase()==="b"){if(!d?.id)return;const Oe={id:new Date().toISOString(),cfi:`page:${S}`,label:`Page ${S}`,chapter:void 0,description:void 0,createdAt:Date.now()},Re=[...be,Oe];xe(Re);try{Ml(d.id,Re)}catch(We){console.warn(We)}}}};return window.addEventListener("keydown",ve),()=>window.removeEventListener("keydown",ve)},[A,J,d,S,be]),T.useEffect(()=>{if(!(!d||!d.id))try{const ve=Ey(d.id),ke=_y(d.id);xe(ve||[]),De(ke||[])}catch(ve){console.warn("Failed to load bookmarks/citations for PDF",ve)}},[d]);const K=async ve=>{if(!d?.id)return;if(be.some(Re=>Re.cfi===`page:${S}`))try{if(!await he({message:"A bookmark already exists for this page. Add another?"}))return}catch{return}const Te={id:new Date().toISOString(),cfi:`page:${S}`,label:`Page ${S}`,chapter:H[S]||void 0,description:ve||void 0,createdAt:Date.now()},Oe=[...be,Te];xe(Oe);try{Ml(d.id,Oe)}catch(Re){console.warn(Re)}P(!1),me("Bookmark added"),ee.current&&clearTimeout(ee.current),ee.current=window.setTimeout(()=>me(null),1400)},pe=async ve=>{if(!d?.id)return;if(Ne.some(Re=>Re.pageNumber===S&&(Re.note||"")===(ve||"")))try{if(!await he({message:"An identical citation already exists for this page. Add another?"}))return}catch{return}const Te={id:new Date().toISOString(),cfi:`page:${S}`,note:ve||void 0,createdAt:Date.now(),pageNumber:S,chapter:H[S]||void 0},Oe=[...Ne,Te];De(Oe);try{Tf(d.id,Oe)}catch(Re){console.warn(Re)}ye(!1),me("Citation added"),ee.current&&clearTimeout(ee.current),ee.current=window.setTimeout(()=>me(null),1400)},Ee=()=>w?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx(yn,{text:"Loading PDF..."})}):x?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:a.jsxs("div",{className:"text-center bg-slate-800 p-8 rounded-lg shadow-lg max-w-lg mx-auto",children:[a.jsx("h3",{className:"text-xl font-bold text-red-300 mb-2",children:"Could Not Open PDF"}),a.jsx("p",{className:"text-slate-300",children:x})]})}):p?a.jsxs("div",{className:"w-full h-full flex flex-col",children:[a.jsxs("div",{ref:D,className:"flex-grow relative overflow-auto bg-slate-900/10 p-4 md:p-8",children:[a.jsx(T.Suspense,{fallback:a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx(yn,{text:"Loading viewer..."})}),children:a.jsxs("div",{className:"w-full max-w-[1100px] mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-300 mb-2",children:[a.jsxs("div",{children:["Size: ",ue?`${(ue/1024).toFixed(1)} KB`:"unknown"]}),p&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("a",{href:p,target:"_blank",rel:"noreferrer",className:"underline",children:"Open raw PDF"}),a.jsx("a",{href:p,download:d?.title?`${d.title}.pdf`:"book.pdf",className:"underline",children:"Download"})]})]}),a.jsx(Vx,{file:p,onLoadSuccess:ae,onLoadError:ve=>{console.error("PDF load error",ve),v("Failed to load PDF file (viewer). The file may be corrupted or unsupported."),j(!0)},children:(()=>{const ve=q.current||900;if(_==="width"){const Re=Math.max(200,Math.floor(ve-32));return a.jsx(ih,{pageNumber:S,width:Re,onLoadError:We=>{console.error("PDF page load error",We),v("Failed to render PDF page. Showing fallback."),j(!0)}})}const Te=Math.max(200,Math.floor(R/100*900));return a.jsx(ih,{pageNumber:S,width:Te,onLoadError:Oe=>{console.error("PDF page load error",Oe),v("Failed to render PDF page. Showing fallback."),j(!0)}})})()})]})}),Ve?a.jsx("iframe",{src:p,title:d?.title||"PDF Viewer",className:"w-full h-full border-0","aria-hidden":"false"}):a.jsx("iframe",{src:p,title:d?.title||"PDF Viewer",className:"w-full h-full border-0 hidden","aria-hidden":"true"})]}),a.jsxs("footer",{className:"flex items-center gap-4 p-4 bg-slate-800 z-20 text-white flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:A,className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Previous page",disabled:S<=1,children:a.jsx(xi,{className:"w-5 h-5"})}),a.jsx("button",{onClick:J,className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Next page",disabled:k!==null&&S>=k,children:a.jsx(gc,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"flex-grow flex flex-col justify-center",children:[a.jsx("input",{type:"range",min:"1",max:k||1,value:S,onChange:ve=>C(Number(ve.target.value)),className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer","aria-label":"PDF progress",disabled:!k}),a.jsx("div",{className:"text-center text-sm text-slate-300 mt-2","aria-live":"polite",children:k?a.jsxs("span",{children:["Page ",S," of ",k]}):a.jsx("span",{className:"text-slate-400",children:"Loading pages..."})})]}),a.jsxs("div",{className:"w-28 flex flex-col items-center text-sm",children:[a.jsx("label",{className:"text-slate-300 text-xs",children:"Go to"}),a.jsx("input",{type:"number",min:1,max:k||9999,value:S||"",onChange:ve=>{const ke=parseInt(ve.target.value||"1",10);isNaN(ke)||ke<1||C(Math.min(k||ke,Math.max(1,ke)))},className:"w-full text-center rounded-md bg-slate-700 px-2 py-1 focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Jump to page"})]})]})]}):null;return a.jsxs("div",{className:"fixed inset-0 bg-slate-900 flex flex-col select-none",children:[a.jsx(up,{value:_==="page"?`${R}%`:`Fit: ${_}`,isOpen:M}),a.jsx(Tx,{message:X||"",isOpen:!!X}),a.jsxs("header",{className:"flex items-center justify-between p-2 bg-slate-800 shadow-md z-20 text-white flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:l,className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Close Reader",children:a.jsx(Zt,{className:"w-6 h-6"})}),a.jsxs("button",{onClick:()=>re(!0),className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Contents and Bookmarks",children:[a.jsx(yc,{className:"w-6 h-6"}),(be.length>0||Ne.length>0)&&a.jsx("span",{className:"absolute top-1 right-1 block h-2 w-2 rounded-full bg-sky-400 ring-2 ring-slate-800"})]})]}),a.jsxs("div",{className:"text-center truncate px-2",children:[a.jsx("h2",{className:"text-lg font-bold",children:d?.title||"PDF Reader"}),a.jsx("p",{className:"text-sm text-slate-400",children:d?.author})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[a.jsx("button",{onClick:()=>I(ve=>Math.max(20,Math.round(ve/1.15))),className:"p-2 rounded hover:bg-slate-700","aria-label":"Zoom out",children:"-"}),a.jsxs("div",{className:"text-sm text-slate-300 px-2",children:[R,"%"]}),a.jsx("button",{onClick:()=>I(ve=>Math.min(400,Math.round(ve*1.15))),className:"p-2 rounded hover:bg-slate-700","aria-label":"Zoom in",children:"+"}),a.jsx("button",{onClick:()=>F(ve=>ve==="page"?"width":"page"),className:"p-2 rounded hover:bg-slate-700","aria-label":"Toggle fit mode",children:_==="page"?"Fit Page":"Fit Width"}),a.jsx("button",{onClick:()=>ye(!0),className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Create citation for this page",children:a.jsx(Uh,{className:"w-6 h-6"})}),a.jsx("button",{onClick:()=>P(!0),className:"p-2 rounded-full hover:bg-slate-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500","aria-label":"Add bookmark to this page",children:a.jsx(Bh,{className:"w-6 h-6"})}),a.jsx("button",{onClick:()=>Q(ve=>!ve),className:"p-2 rounded hover:bg-slate-700","aria-label":"Keyboard help",children:"?"})]})})]}),a.jsx("main",{className:"flex-grow relative min-h-0 bg-slate-800/50",children:Ee()}),a.jsx(cp,{isOpen:ie,onClose:()=>re(!1),toc:oe,onTocNavigate:E,bookmarks:be,onBookmarkNavigate:ve=>{E(ve)},onDeleteBookmark:ve=>{const ke=be.filter(Te=>Te.id!==ve);xe(ke),d?.id&&Ml(d.id,ke)},citations:Ne,onCitationNavigate:ve=>{E(ve)},onDeleteCitation:ve=>{const ke=Ne.filter(Te=>Te.id!==ve);De(ke),d?.id&&Tf(d.id,ke)},settings:$e,bookData:d}),a.jsx(Nc,{isOpen:B,onClose:()=>Q(!1),onZoomIn:()=>I(ve=>Math.min(400,Math.round(ve*1.15))),onZoomOut:()=>I(ve=>Math.max(20,Math.round(ve/1.15))),onToggleFit:()=>F(ve=>ve==="page"?"width":"page"),activeReader:"pdf"}),a.jsx(sp,{isOpen:Z,onClose:()=>P(!1),onSave:K}),a.jsx(ip,{isOpen:W,onClose:()=>ye(!1),onSave:pe})]})},Hx=r=>{const{currentView:s,selectedBookId:n,coverAnimationData:o,onCloseReader:c,detailViewData:l,onReturnToLibrary:d,onImportFromCatalog:f,onOpenBook:p,onShowBookDetail:h,syncStatus:w,processAndSaveBook:b,activeOpdsSource:x,setActiveOpdsSource:v,catalogNavPath:k,setCatalogNavPath:g,onOpenCloudSyncModal:S,onOpenLocalStorageModal:C,onShowAbout:R,importStatus:I,setImportStatus:_,libraryRefreshFlag:F,userCitationFormat:M}=r,[$,L]=dt.useState(s),[B,Q]=dt.useState(n),[oe,z]=dt.useState(o),[H,N]=dt.useState("reader"),X=dt.useCallback((me,ee)=>{const ie=me.mediaType||me.acquisitionMediaType||"",re=(me.format||"").toUpperCase();let Z="reader";ie.includes("pdf")||re==="PDF"?Z="pdfReader":(ie.includes("epub")||re==="EPUB")&&(Z="reader"),Q(me.id),z(ee||null),N(Z),L(Z)},[]);switch(dt.useEffect(()=>{L(s)},[s]),dt.useEffect(()=>{Q(n)},[n]),dt.useEffect(()=>{z(o)},[o]),$){case"reader":return B!==null?a.jsx(vs,{onReset:c,fallbackMessage:"There was an error while trying to display this book. Returning to the library.",children:a.jsx(yx,{bookId:B,onClose:c,animationData:oe})}):null;case"pdfReader":return B!==null?a.jsx(vs,{onReset:c,fallbackMessage:"There was an error while trying to display this PDF. Returning to the library.",children:a.jsx(wp,{bookId:B,onClose:c})}):null;case"bookDetail":return l?a.jsx(vs,{onReset:d,fallbackMessage:"There was an error showing the book details. Returning to the library.",children:a.jsx(yy,{book:l.book,source:l.source,catalogName:l.catalogName,onBack:d,onReadBook:X,onImportFromCatalog:f,importStatus:I,setImportStatus:_,userCitationFormat:M})}):null;case"about":return a.jsx(ly,{onBack:d});case"library":default:return a.jsx(vs,{onReset:()=>window.location.reload(),fallbackMessage:"There was a critical error in the library. Please try reloading the application.",children:a.jsx(Wx,{onOpenBook:p,onShowBookDetail:h,processAndSaveBook:b,importStatus:I,setImportStatus:_,activeOpdsSource:x,setActiveOpdsSource:v,catalogNavPath:k,setCatalogNavPath:g,onOpenCloudSyncModal:S,onOpenLocalStorageModal:C,onShowAbout:R,libraryRefreshFlag:F,syncStatus:w})})}},ms={isOpen:!1,host:null,pendingHref:null,pendingBook:null,pendingCatalogName:void 0,authDocument:null},qx=({processAndSaveBook:r,setImportStatus:s,setActiveOpdsSource:n,setCurrentView:o,pushToast:c})=>{const[l,d]=T.useState(ms),[f,p]=T.useState(!1),h=T.useCallback(async(v,k)=>{if(v.format&&v.format.toUpperCase()!=="EPUB"&&v.format.toUpperCase()!=="PDF"){const g=`Cannot import this book. The application currently only supports EPUB and PDF formats, but this book is a ${v.format}.`;return s({isLoading:!1,message:"",error:g}),{success:!1}}s({isLoading:!0,message:`Downloading ${v.title}...`,error:null});try{let g=v.downloadUrl;if(!v.isOpenAccess){const $=await Wf(v.downloadUrl),L=await $l.resolve(v.downloadUrl,"auto",$?{username:$.username,password:$.password}:null);if(L.success)g=L.data;else{const B=L;if(B.status===401||B.status===403)return s({isLoading:!1,message:"",error:null}),d({isOpen:!0,host:new URL(v.downloadUrl).host,pendingHref:v.downloadUrl,pendingBook:v,pendingCatalogName:k,authDocument:null}),{success:!1};ne.warn("Failed to resolve acquisition chain, using original URL",B.error)}}let S=await Cr(g,v.isOpenAccess===!0);const C=await Wf(v.downloadUrl),R={};C&&(R.Authorization=`Basic ${btoa(`${C.username}:${C.password}`)}`);let I;if(v.isOpenAccess)try{I=await fetch(g,{headers:R,credentials:"include",redirect:"follow"})}catch{S=Xt(g),I=await fetch(S,{headers:{},credentials:"omit",redirect:"follow"})}else I=await fetch(S,{headers:R,credentials:S===g?"include":"omit"});if(!I.ok){const $=`${I.status}${I.statusText?` ${I.statusText}`:""}`;let L=`Download failed. The server responded with an error (${$}). The book might not be available at this address.`;throw(I.status===401||I.status===403)&&(L=`Download failed (${$}). This catalog or book requires authentication (a login or password), which is not supported by this application.`),I.status===429&&(L=`Download failed (${$}). The request was rate-limited by the server or the proxy. Please wait a moment and try again.`),new Error(L)}const _=await I.arrayBuffer(),F=v.format&&v.format.toUpperCase()==="PDF"?{summary:v.summary,publisher:v.publisher,publicationDate:v.publicationDate,subjects:v.subjects,coverImage:v.coverImage}:void 0,M=await r(_,v.title,v.author,"catalog",k,v.providerId,v.format,v.coverImage,F);return M.success&&(n(null),o("library")),M}catch(g){ne.error("Error importing from catalog:",g);let S="Download failed. The file may no longer be available or there was a network issue.";return g instanceof TypeError&&g.message==="Failed to fetch"?S="Download failed due to a network error. This could be due to your internet connection or the public CORS proxy being temporarily down.":g instanceof Error&&(S=g.message),s({isLoading:!1,message:"",error:S}),{success:!1}}},[r,n,o,s]),w=T.useCallback(async(v,k,g)=>{if(!l.pendingHref){d(ms);return}const S=l.pendingHref;try{const C=await $l.resolve(S,"auto",{username:v,password:k});if(C.success&&l.pendingBook){g&&l.host&&nv(l.host,v,k),d(ms),s({isLoading:!0,message:`Downloading ${l.pendingBook.title}...`,error:null});const R=await Cr(C.data),I={};v&&k&&(I.Authorization=`Basic ${btoa(`${v}:${k}`)}`);const _=await fetch(R,{headers:I,credentials:R===C.data?"include":"omit"});if(!_.ok)throw new Error(`Download failed: ${_.status}`);const F=await _.arrayBuffer(),M=await r(F,l.pendingBook.title,l.pendingBook.author,"catalog",l.pendingCatalogName,l.pendingBook.providerId,l.pendingBook.format,l.pendingBook.coverImage);!M.success&&M.existingBook&&s({isLoading:!1,message:"",error:`A book with the same identifier is already in your library: "${M.existingBook.title}".`})}else s({isLoading:!1,message:"",error:"Failed to resolve acquisition URL."}),d(ms)}catch(C){ne.error("Credential resolve/import failed",C),s({isLoading:!1,message:"",error:C instanceof Error?C.message:"Failed to authenticate and download the book."}),d(ms)}},[l,r,s]),b=T.useCallback(v=>{},[]),x=T.useCallback(async()=>{if(!(!l.pendingHref||!l.pendingBook)){s({isLoading:!0,message:"Retrying download after provider login...",error:null});try{const v=await $l.resolve(l.pendingHref,"auto",null);if(!v.success)throw new Error("Failed to resolve after login");const k=await Cr(v.data);if(typeof k=="string"&&k.includes("corsproxy.io"))throw c("The retry would use a public CORS proxy which commonly strips authentication. Configure an owned proxy via VITE_OWN_PROXY_URL and retry.",12e3),new Error("Retry aborted: public CORS proxy would be used and may block authenticated downloads.");const g=await fetch(k,{credentials:k===v.data?"include":"omit"});if(!g.ok)throw new Error(`Download failed: ${g.status}`);const S=await g.arrayBuffer(),C=await r(S,l.pendingBook.title,l.pendingBook.author,"catalog",l.pendingCatalogName,l.pendingBook.providerId,l.pendingBook.format,l.pendingBook.coverImage);!C.success&&C.existingBook&&s({isLoading:!1,message:"",error:`A book with the same identifier is already in your library: "${C.existingBook.title}".`}),d(ms)}catch(v){ne.error("Retry after provider login failed",v),s({isLoading:!1,message:"",error:v instanceof Error?v.message:"Retry failed"})}}},[l,r,c,s]);return{credentialPrompt:l,setCredentialPrompt:d,handleImportFromCatalog:h,handleCredentialSubmit:w,handleOpenAuthLink:b,handleRetryAfterProviderLogin:x,showNetworkDebug:f,setShowNetworkDebug:p}};var gs={},Vl={},oh;function Gx(){return oh||(oh=1,Vl.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",times:"",divide:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",euro:"",trade:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lceil:"",rceil:"",lfloor:"",rfloor:"",loz:"",spades:"",clubs:"",hearts:"",diams:""}),Vl}var Ro={},ah;function Kx(){if(ah)return Ro;ah=1;var r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,s=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),n=new RegExp("^"+r.source+s.source+"*(?::"+r.source+s.source+"*)?$"),o=0,c=1,l=2,d=3,f=4,p=5,h=6,w=7;function b(L,B){this.message=L,this.locator=B,Error.captureStackTrace&&Error.captureStackTrace(this,b)}b.prototype=new Error,b.prototype.name=b.name;function x(){}x.prototype={parse:function(L,B,Q){var oe=this.domBuilder;oe.startDocument(),I(B,B={}),v(L,B,Q,oe,this.errorHandler),oe.endDocument()}};function v(L,B,Q,oe,z){function H(te){if(te>65535){te-=65536;var ae=55296+(te>>10),J=56320+(te&1023);return String.fromCharCode(ae,J)}else return String.fromCharCode(te)}function N(te){var ae=te.slice(1,-1);return ae in Q?Q[ae]:ae.charAt(0)==="#"?H(parseInt(ae.substr(1).replace("x","0x"))):(z.error("entity not found:"+te),te)}function X(te){if(te>ye){var ae=L.substring(ye,te).replace(/&#?\w+;/g,N);Z&&me(ye),oe.characters(ae,0,te-ye),ye=te}}function me(te,ae){for(;te>=ie&&(ae=re.exec(L));)ee=ae.index,ie=ee+ae[0].length,Z.lineNumber++;Z.columnNumber=te-ee+1}for(var ee=0,ie=0,re=/.*(?:\r\n?|\n)|.*$/g,Z=oe.locator,P=[{currentNSMap:B}],W={},ye=0;;){try{var he=L.indexOf("<",ye);if(he<0){if(!L.substr(ye).match(/^\s*$/)){var fe=oe.doc,Ae=fe.createTextNode(L.substr(ye));fe.appendChild(Ae),oe.currentElement=Ae}return}switch(he>ye&&X(he),L.charAt(he+1)){case"/":var ue=L.indexOf(">",he+3),be=L.substring(he+2,ue),xe=P.pop();ue<0?(be=L.substring(he+2).replace(/[\s<].*/,""),z.error("end tag name: "+be+" is not complete:"+xe.tagName),ue=he+1+be.length):be.match(/\s</)&&(be=be.replace(/[\s<].*/,""),z.error("end tag name: "+be+" maybe not complete"),ue=he+1+be.length);var Ne=xe.localNSMap,De=xe.tagName==be,$e=De||xe.tagName&&xe.tagName.toLowerCase()==be.toLowerCase();if($e){if(oe.endElement(xe.uri,xe.localName,be),Ne)for(var Ye in Ne)oe.endPrefixMapping(Ye);De||z.fatalError("end tag name: "+be+" is not match the current start tagName:"+xe.tagName)}else P.push(xe);ue++;break;case"?":Z&&me(he),ue=F(L,he,oe);break;case"!":Z&&me(he),ue=_(L,he,oe,z);break;default:Z&&me(he);var Ve=new M,j=P[P.length-1].currentNSMap,ue=g(L,he,Ve,j,N,z),ce=Ve.length;if(!Ve.closed&&R(L,ue,Ve.tagName,W)&&(Ve.closed=!0,Q.nbsp||z.warning("unclosed xml attribute")),Z&&ce){for(var V=k(Z,{}),D=0;D<ce;D++){var q=Ve[D];me(q.offset),q.locator=k(Z,{})}oe.locator=V,S(Ve,oe,j)&&P.push(Ve),oe.locator=Z}else S(Ve,oe,j)&&P.push(Ve);Ve.uri==="http://www.w3.org/1999/xhtml"&&!Ve.closed?ue=C(L,ue,Ve.tagName,N,oe):ue++}}catch(te){if(te instanceof b)throw te;z.error("element parse error: "+te),ue=-1}ue>ye?ye=ue:X(Math.max(he,ye)+1)}}function k(L,B){return B.lineNumber=L.lineNumber,B.columnNumber=L.columnNumber,B}function g(L,B,Q,oe,z,H){function N(Z,P,W){Z in Q.attributeNames&&H.fatalError("Attribute "+Z+" redefined"),Q.addValue(Z,P,W)}for(var X,me,ee=++B,ie=o;;){var re=L.charAt(ee);switch(re){case"=":if(ie===c)X=L.slice(B,ee),ie=d;else if(ie===l)ie=d;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(ie===d||ie===c)if(ie===c&&(H.warning('attribute value must after "="'),X=L.slice(B,ee)),B=ee+1,ee=L.indexOf(re,B),ee>0)me=L.slice(B,ee).replace(/&#?\w+;/g,z),N(X,me,B-1),ie=p;else throw new Error("attribute value no end '"+re+"' match");else if(ie==f)me=L.slice(B,ee).replace(/&#?\w+;/g,z),N(X,me,B),H.warning('attribute "'+X+'" missed start quot('+re+")!!"),B=ee+1,ie=p;else throw new Error('attribute value must after "="');break;case"/":switch(ie){case o:Q.setTagName(L.slice(B,ee));case p:case h:case w:ie=w,Q.closed=!0;case f:case c:case l:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return H.error("unexpected end of input"),ie==o&&Q.setTagName(L.slice(B,ee)),ee;case">":switch(ie){case o:Q.setTagName(L.slice(B,ee));case p:case h:case w:break;case f:case c:me=L.slice(B,ee),me.slice(-1)==="/"&&(Q.closed=!0,me=me.slice(0,-1));case l:ie===l&&(me=X),ie==f?(H.warning('attribute "'+me+'" missed quot(")!'),N(X,me.replace(/&#?\w+;/g,z),B)):((oe[""]!=="http://www.w3.org/1999/xhtml"||!me.match(/^(?:disabled|checked|selected)$/i))&&H.warning('attribute "'+me+'" missed value!! "'+me+'" instead!!'),N(me,me,B));break;case d:throw new Error("attribute value missed!!")}return ee;case"":re=" ";default:if(re<=" ")switch(ie){case o:Q.setTagName(L.slice(B,ee)),ie=h;break;case c:X=L.slice(B,ee),ie=l;break;case f:var me=L.slice(B,ee).replace(/&#?\w+;/g,z);H.warning('attribute "'+me+'" missed quot(")!!'),N(X,me,B);case p:ie=h;break}else switch(ie){case l:Q.tagName,(oe[""]!=="http://www.w3.org/1999/xhtml"||!X.match(/^(?:disabled|checked|selected)$/i))&&H.warning('attribute "'+X+'" missed value!! "'+X+'" instead2!!'),N(X,X,B),B=ee,ie=c;break;case p:H.warning('attribute space is required"'+X+'"!!');case h:ie=c,B=ee;break;case d:ie=f,B=ee;break;case w:throw new Error("elements closed character '/' and '>' must be connected to")}}ee++}}function S(L,B,Q){for(var oe=L.tagName,z=null,re=L.length;re--;){var H=L[re],N=H.qName,X=H.value,Z=N.indexOf(":");if(Z>0)var me=H.prefix=N.slice(0,Z),ee=N.slice(Z+1),ie=me==="xmlns"&&ee;else ee=N,me=null,ie=N==="xmlns"&&"";H.localName=ee,ie!==!1&&(z==null&&(z={},I(Q,Q={})),Q[ie]=z[ie]=X,H.uri="http://www.w3.org/2000/xmlns/",B.startPrefixMapping(ie,X))}for(var re=L.length;re--;){H=L[re];var me=H.prefix;me&&(me==="xml"&&(H.uri="http://www.w3.org/XML/1998/namespace"),me!=="xmlns"&&(H.uri=Q[me||""]))}var Z=oe.indexOf(":");Z>0?(me=L.prefix=oe.slice(0,Z),ee=L.localName=oe.slice(Z+1)):(me=null,ee=L.localName=oe);var P=L.uri=Q[me||""];if(B.startElement(P,ee,oe,L),L.closed){if(B.endElement(P,ee,oe),z)for(me in z)B.endPrefixMapping(me)}else return L.currentNSMap=Q,L.localNSMap=z,!0}function C(L,B,Q,oe,z){if(/^(?:script|textarea)$/i.test(Q)){var H=L.indexOf("</"+Q+">",B),N=L.substring(B+1,H);if(/[&<]/.test(N))return/^script$/i.test(Q)?(z.characters(N,0,N.length),H):(N=N.replace(/&#?\w+;/g,oe),z.characters(N,0,N.length),H)}return B+1}function R(L,B,Q,oe){var z=oe[Q];return z==null&&(z=L.lastIndexOf("</"+Q+">"),z<B&&(z=L.lastIndexOf("</"+Q)),oe[Q]=z),z<B}function I(L,B){for(var Q in L)B[Q]=L[Q]}function _(L,B,Q,oe){var z=L.charAt(B+2);switch(z){case"-":if(L.charAt(B+3)==="-"){var H=L.indexOf("-->",B+4);return H>B?(Q.comment(L,B+4,H-B-4),H+3):(oe.error("Unclosed comment"),-1)}else return-1;default:if(L.substr(B+3,6)=="CDATA["){var H=L.indexOf("]]>",B+9);return Q.startCDATA(),Q.characters(L,B+9,H-B-9),Q.endCDATA(),H+3}var N=$(L,B),X=N.length;if(X>1&&/!doctype/i.test(N[0][0])){var me=N[1][0],ee=!1,ie=!1;X>3&&(/^public$/i.test(N[2][0])?(ee=N[3][0],ie=X>4&&N[4][0]):/^system$/i.test(N[2][0])&&(ie=N[3][0]));var re=N[X-1];return Q.startDTD(me,ee,ie),Q.endDTD(),re.index+re[0].length}}return-1}function F(L,B,Q){var oe=L.indexOf("?>",B);if(oe){var z=L.substring(B,oe).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return z?(z[0].length,Q.processingInstruction(z[1],z[2]),oe+2):-1}return-1}function M(){this.attributeNames={}}M.prototype={setTagName:function(L){if(!n.test(L))throw new Error("invalid tagName:"+L);this.tagName=L},addValue:function(L,B,Q){if(!n.test(L))throw new Error("invalid attribute:"+L);this.attributeNames[L]=this.length,this[this.length++]={qName:L,value:B,offset:Q}},length:0,getLocalName:function(L){return this[L].localName},getLocator:function(L){return this[L].locator},getQName:function(L){return this[L].qName},getURI:function(L){return this[L].uri},getValue:function(L){return this[L].value}};function $(L,B){var Q,oe=[],z=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(z.lastIndex=B,z.exec(L);Q=z.exec(L);)if(oe.push(Q),Q[1])return oe}return Ro.XMLReader=x,Ro.ParseError=b,Ro}var ys={},lh;function ch(){if(lh)return ys;lh=1;function r(A,E){for(var U in A)E[U]=A[U]}function s(A,E){var U=A.prototype;if(!(U instanceof E)){let K=function(){};K.prototype=E.prototype,K=new K,r(U,K),A.prototype=U=K}U.constructor!=A&&(typeof A!="function"&&console.error("unknow Class:"+A),U.constructor=A)}var n="http://www.w3.org/1999/xhtml",o={},c=o.ELEMENT_NODE=1,l=o.ATTRIBUTE_NODE=2,d=o.TEXT_NODE=3,f=o.CDATA_SECTION_NODE=4,p=o.ENTITY_REFERENCE_NODE=5,h=o.ENTITY_NODE=6,w=o.PROCESSING_INSTRUCTION_NODE=7,b=o.COMMENT_NODE=8,x=o.DOCUMENT_NODE=9,v=o.DOCUMENT_TYPE_NODE=10,k=o.DOCUMENT_FRAGMENT_NODE=11,g=o.NOTATION_NODE=12,S={},C={};S.INDEX_SIZE_ERR=(C[1]="Index size error",1),S.DOMSTRING_SIZE_ERR=(C[2]="DOMString size error",2);var R=S.HIERARCHY_REQUEST_ERR=(C[3]="Hierarchy request error",3);S.WRONG_DOCUMENT_ERR=(C[4]="Wrong document",4),S.INVALID_CHARACTER_ERR=(C[5]="Invalid character",5),S.NO_DATA_ALLOWED_ERR=(C[6]="No data allowed",6),S.NO_MODIFICATION_ALLOWED_ERR=(C[7]="No modification allowed",7);var I=S.NOT_FOUND_ERR=(C[8]="Not found",8);S.NOT_SUPPORTED_ERR=(C[9]="Not supported",9);var _=S.INUSE_ATTRIBUTE_ERR=(C[10]="Attribute in use",10);S.INVALID_STATE_ERR=(C[11]="Invalid state",11),S.SYNTAX_ERR=(C[12]="Syntax error",12),S.INVALID_MODIFICATION_ERR=(C[13]="Invalid modification",13),S.NAMESPACE_ERR=(C[14]="Invalid namespace",14),S.INVALID_ACCESS_ERR=(C[15]="Invalid access",15);function F(A,E){if(E instanceof Error)var U=E;else U=this,Error.call(this,C[A]),this.message=C[A],Error.captureStackTrace&&Error.captureStackTrace(this,F);return U.code=A,E&&(this.message=this.message+": "+E),U}F.prototype=Error.prototype,r(S,F);function M(){}M.prototype={length:0,item:function(A){return this[A]||null},toString:function(A,E){for(var U=[],K=0;K<this.length;K++)q(this[K],U,A,E);return U.join("")}};function $(A,E){this._node=A,this._refresh=E,L(this)}function L(A){var E=A._node._inc||A._node.ownerDocument._inc;if(A._inc!=E){var U=A._refresh(A._node);J(A,"length",U.length),r(U,A),A._inc=E}}$.prototype.item=function(A){return L(this),this[A]},s($,M);function B(){}function Q(A,E){for(var U=A.length;U--;)if(A[U]===E)return U}function oe(A,E,U,K){if(K?E[Q(E,K)]=U:E[E.length++]=U,A){U.ownerElement=A;var pe=A.ownerDocument;pe&&(K&&re(pe,A,K),ie(pe,A,U))}}function z(A,E,U){var K=Q(E,U);if(K>=0){for(var pe=E.length-1;K<pe;)E[K]=E[++K];if(E.length=pe,A){var Ee=A.ownerDocument;Ee&&(re(Ee,A,U),U.ownerElement=null)}}else throw F(I,new Error(A.tagName+"@"+U))}B.prototype={length:0,item:M.prototype.item,getNamedItem:function(A){for(var E=this.length;E--;){var U=this[E];if(U.nodeName==A)return U}},setNamedItem:function(A){var E=A.ownerElement;if(E&&E!=this._ownerElement)throw new F(_);var U=this.getNamedItem(A.nodeName);return oe(this._ownerElement,this,A,U),U},setNamedItemNS:function(A){var E=A.ownerElement,U;if(E&&E!=this._ownerElement)throw new F(_);return U=this.getNamedItemNS(A.namespaceURI,A.localName),oe(this._ownerElement,this,A,U),U},removeNamedItem:function(A){var E=this.getNamedItem(A);return z(this._ownerElement,this,E),E},removeNamedItemNS:function(A,E){var U=this.getNamedItemNS(A,E);return z(this._ownerElement,this,U),U},getNamedItemNS:function(A,E){for(var U=this.length;U--;){var K=this[U];if(K.localName==E&&K.namespaceURI==A)return K}return null}};function H(A){if(this._features={},A)for(var E in A)this._features=A[E]}H.prototype={hasFeature:function(A,E){var U=this._features[A.toLowerCase()];return!!(U&&(!E||E in U))},createDocument:function(A,E,U){var K=new ee;if(K.implementation=this,K.childNodes=new M,K.doctype=U,U&&K.appendChild(U),E){var pe=K.createElementNS(A,E);K.appendChild(pe)}return K},createDocumentType:function(A,E,U){var K=new De;return K.name=A,K.nodeName=A,K.publicId=E,K.systemId=U,K}};function N(){}N.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(A,E){return W(this,A,E)},replaceChild:function(A,E){this.insertBefore(A,E),E&&this.removeChild(E)},removeChild:function(A){return P(this,A)},appendChild:function(A){return this.insertBefore(A,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(A){return ae(this.ownerDocument||this,this,A)},normalize:function(){for(var A=this.firstChild;A;){var E=A.nextSibling;E&&E.nodeType==d&&A.nodeType==d?(this.removeChild(E),A.appendData(E.data)):(A.normalize(),A=E)}},isSupported:function(A,E){return this.ownerDocument.implementation.hasFeature(A,E)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(A){for(var E=this;E;){var U=E._nsMap;if(U){for(var K in U)if(U[K]==A)return K}E=E.nodeType==l?E.ownerDocument:E.parentNode}return null},lookupNamespaceURI:function(A){for(var E=this;E;){var U=E._nsMap;if(U&&A in U)return U[A];E=E.nodeType==l?E.ownerDocument:E.parentNode}return null},isDefaultNamespace:function(A){var E=this.lookupPrefix(A);return E==null}};function X(A){return A=="<"&&"&lt;"||A==">"&&"&gt;"||A=="&"&&"&amp;"||A=='"'&&"&quot;"||"&#"+A.charCodeAt()+";"}r(o,N),r(o,N.prototype);function me(A,E){if(E(A))return!0;if(A=A.firstChild)do if(me(A,E))return!0;while(A=A.nextSibling)}function ee(){}function ie(A,E,U){A&&A._inc++;var K=U.namespaceURI;K=="http://www.w3.org/2000/xmlns/"&&(E._nsMap[U.prefix?U.localName:""]=U.value)}function re(A,E,U,K){A&&A._inc++;var pe=U.namespaceURI;pe=="http://www.w3.org/2000/xmlns/"&&delete E._nsMap[U.prefix?U.localName:""]}function Z(A,E,U){if(A&&A._inc){A._inc++;var K=E.childNodes;if(U)K[K.length++]=U;else{for(var pe=E.firstChild,Ee=0;pe;)K[Ee++]=pe,pe=pe.nextSibling;K.length=Ee}}}function P(A,E){var U=E.previousSibling,K=E.nextSibling;return U?U.nextSibling=K:A.firstChild=K,K?K.previousSibling=U:A.lastChild=U,Z(A.ownerDocument,A),E}function W(A,E,U){var K=E.parentNode;if(K&&K.removeChild(E),E.nodeType===k){var pe=E.firstChild;if(pe==null)return E;var Ee=E.lastChild}else pe=Ee=E;var ve=U?U.previousSibling:A.lastChild;pe.previousSibling=ve,Ee.nextSibling=U,ve?ve.nextSibling=pe:A.firstChild=pe,U==null?A.lastChild=Ee:U.previousSibling=Ee;do pe.parentNode=A;while(pe!==Ee&&(pe=pe.nextSibling));return Z(A.ownerDocument||A,A),E.nodeType==k&&(E.firstChild=E.lastChild=null),E}function ye(A,E){var U=E.parentNode;if(U){var K=A.lastChild;U.removeChild(E);var K=A.lastChild}var K=A.lastChild;return E.parentNode=A,E.previousSibling=K,E.nextSibling=null,K?K.nextSibling=E:A.firstChild=E,A.lastChild=E,Z(A.ownerDocument,A,E),E}ee.prototype={nodeName:"#document",nodeType:x,doctype:null,documentElement:null,_inc:1,insertBefore:function(A,E){if(A.nodeType==k){for(var U=A.firstChild;U;){var K=U.nextSibling;this.insertBefore(U,E),U=K}return A}return this.documentElement==null&&A.nodeType==c&&(this.documentElement=A),W(this,A,E),A.ownerDocument=this,A},removeChild:function(A){return this.documentElement==A&&(this.documentElement=null),P(this,A)},importNode:function(A,E){return te(this,A,E)},getElementById:function(A){var E=null;return me(this.documentElement,function(U){if(U.nodeType==c&&U.getAttribute("id")==A)return E=U,!0}),E},getElementsByClassName:function(A){var E=new RegExp("(^|\\s)"+A+"(\\s|$)");return new $(this,function(U){var K=[];return me(U.documentElement,function(pe){pe!==U&&pe.nodeType==c&&E.test(pe.getAttribute("class"))&&K.push(pe)}),K})},createElement:function(A){var E=new he;E.ownerDocument=this,E.nodeName=A,E.tagName=A,E.childNodes=new M;var U=E.attributes=new B;return U._ownerElement=E,E},createDocumentFragment:function(){var A=new j;return A.ownerDocument=this,A.childNodes=new M,A},createTextNode:function(A){var E=new be;return E.ownerDocument=this,E.appendData(A),E},createComment:function(A){var E=new xe;return E.ownerDocument=this,E.appendData(A),E},createCDATASection:function(A){var E=new Ne;return E.ownerDocument=this,E.appendData(A),E},createProcessingInstruction:function(A,E){var U=new ue;return U.ownerDocument=this,U.tagName=U.target=A,U.nodeValue=U.data=E,U},createAttribute:function(A){var E=new fe;return E.ownerDocument=this,E.name=A,E.nodeName=A,E.localName=A,E.specified=!0,E},createEntityReference:function(A){var E=new Ve;return E.ownerDocument=this,E.nodeName=A,E},createElementNS:function(A,E){var U=new he,K=E.split(":"),pe=U.attributes=new B;return U.childNodes=new M,U.ownerDocument=this,U.nodeName=E,U.tagName=E,U.namespaceURI=A,K.length==2?(U.prefix=K[0],U.localName=K[1]):U.localName=E,pe._ownerElement=U,U},createAttributeNS:function(A,E){var U=new fe,K=E.split(":");return U.ownerDocument=this,U.nodeName=E,U.name=E,U.namespaceURI=A,U.specified=!0,K.length==2?(U.prefix=K[0],U.localName=K[1]):U.localName=E,U}},s(ee,N);function he(){this._nsMap={}}he.prototype={nodeType:c,hasAttribute:function(A){return this.getAttributeNode(A)!=null},getAttribute:function(A){var E=this.getAttributeNode(A);return E&&E.value||""},getAttributeNode:function(A){return this.attributes.getNamedItem(A)},setAttribute:function(A,E){var U=this.ownerDocument.createAttribute(A);U.value=U.nodeValue=""+E,this.setAttributeNode(U)},removeAttribute:function(A){var E=this.getAttributeNode(A);E&&this.removeAttributeNode(E)},appendChild:function(A){return A.nodeType===k?this.insertBefore(A,null):ye(this,A)},setAttributeNode:function(A){return this.attributes.setNamedItem(A)},setAttributeNodeNS:function(A){return this.attributes.setNamedItemNS(A)},removeAttributeNode:function(A){return this.attributes.removeNamedItem(A.nodeName)},removeAttributeNS:function(A,E){var U=this.getAttributeNodeNS(A,E);U&&this.removeAttributeNode(U)},hasAttributeNS:function(A,E){return this.getAttributeNodeNS(A,E)!=null},getAttributeNS:function(A,E){var U=this.getAttributeNodeNS(A,E);return U&&U.value||""},setAttributeNS:function(A,E,U){var K=this.ownerDocument.createAttributeNS(A,E);K.value=K.nodeValue=""+U,this.setAttributeNode(K)},getAttributeNodeNS:function(A,E){return this.attributes.getNamedItemNS(A,E)},getElementsByTagName:function(A){return new $(this,function(E){var U=[];return me(E,function(K){K!==E&&K.nodeType==c&&(A==="*"||K.tagName==A)&&U.push(K)}),U})},getElementsByTagNameNS:function(A,E){return new $(this,function(U){var K=[];return me(U,function(pe){pe!==U&&pe.nodeType===c&&(A==="*"||pe.namespaceURI===A)&&(E==="*"||pe.localName==E)&&K.push(pe)}),K})}},ee.prototype.getElementsByTagName=he.prototype.getElementsByTagName,ee.prototype.getElementsByTagNameNS=he.prototype.getElementsByTagNameNS,s(he,N);function fe(){}fe.prototype.nodeType=l,s(fe,N);function Ae(){}Ae.prototype={data:"",substringData:function(A,E){return this.data.substring(A,A+E)},appendData:function(A){A=this.data+A,this.nodeValue=this.data=A,this.length=A.length},insertData:function(A,E){this.replaceData(A,0,E)},appendChild:function(A){throw new Error(C[R])},deleteData:function(A,E){this.replaceData(A,E,"")},replaceData:function(A,E,U){var K=this.data.substring(0,A),pe=this.data.substring(A+E);U=K+U+pe,this.nodeValue=this.data=U,this.length=U.length}},s(Ae,N);function be(){}be.prototype={nodeName:"#text",nodeType:d,splitText:function(A){var E=this.data,U=E.substring(A);E=E.substring(0,A),this.data=this.nodeValue=E,this.length=E.length;var K=this.ownerDocument.createTextNode(U);return this.parentNode&&this.parentNode.insertBefore(K,this.nextSibling),K}},s(be,Ae);function xe(){}xe.prototype={nodeName:"#comment",nodeType:b},s(xe,Ae);function Ne(){}Ne.prototype={nodeName:"#cdata-section",nodeType:f},s(Ne,Ae);function De(){}De.prototype.nodeType=v,s(De,N);function $e(){}$e.prototype.nodeType=g,s($e,N);function Ye(){}Ye.prototype.nodeType=h,s(Ye,N);function Ve(){}Ve.prototype.nodeType=p,s(Ve,N);function j(){}j.prototype.nodeName="#document-fragment",j.prototype.nodeType=k,s(j,N);function ue(){}ue.prototype.nodeType=w,s(ue,N);function ce(){}ce.prototype.serializeToString=function(A,E,U){return V.call(A,E,U)},N.prototype.toString=V;function V(A,E){var U=[],K=this.nodeType==9&&this.documentElement||this,pe=K.prefix,Ee=K.namespaceURI;if(Ee&&pe==null){var pe=K.lookupPrefix(Ee);if(pe==null)var ve=[{namespace:Ee,prefix:null}]}return q(this,U,A,E,ve),U.join("")}function D(A,E,U){var K=A.prefix||"",pe=A.namespaceURI;if(!K&&!pe||K==="xml"&&pe==="http://www.w3.org/XML/1998/namespace"||pe=="http://www.w3.org/2000/xmlns/")return!1;for(var Ee=U.length;Ee--;){var ve=U[Ee];if(ve.prefix==K)return ve.namespace!=pe}return!0}function q(A,E,U,K,pe){if(K)if(A=K(A),A){if(typeof A=="string"){E.push(A);return}}else return;switch(A.nodeType){case c:pe||(pe=[]),pe.length;var Ee=A.attributes,ve=Ee.length,Qe=A.firstChild,ke=A.tagName;U=n===A.namespaceURI||U,E.push("<",ke);for(var Te=0;Te<ve;Te++){var Oe=Ee.item(Te);Oe.prefix=="xmlns"?pe.push({prefix:Oe.localName,namespace:Oe.value}):Oe.nodeName=="xmlns"&&pe.push({prefix:"",namespace:Oe.value})}for(var Te=0;Te<ve;Te++){var Oe=Ee.item(Te);if(D(Oe,U,pe)){var Re=Oe.prefix||"",We=Oe.namespaceURI,yt=Re?" xmlns:"+Re:" xmlns";E.push(yt,'="',We,'"'),pe.push({prefix:Re,namespace:We})}q(Oe,E,U,K,pe)}if(D(A,U,pe)){var Re=A.prefix||"",We=A.namespaceURI;if(We){var yt=Re?" xmlns:"+Re:" xmlns";E.push(yt,'="',We,'"'),pe.push({prefix:Re,namespace:We})}}if(Qe||U&&!/^(?:meta|link|img|br|hr|input)$/i.test(ke)){if(E.push(">"),U&&/^script$/i.test(ke))for(;Qe;)Qe.data?E.push(Qe.data):q(Qe,E,U,K,pe),Qe=Qe.nextSibling;else for(;Qe;)q(Qe,E,U,K,pe),Qe=Qe.nextSibling;E.push("</",ke,">")}else E.push("/>");return;case x:case k:for(var Qe=A.firstChild;Qe;)q(Qe,E,U,K,pe),Qe=Qe.nextSibling;return;case l:return E.push(" ",A.name,'="',A.value.replace(/[<&"]/g,X),'"');case d:return E.push(A.data.replace(/[<&]/g,X).replace(/]]>/g,"]]&gt;"));case f:return E.push("<![CDATA[",A.data,"]]>");case b:return E.push("<!--",A.data,"-->");case v:var ot=A.publicId,Je=A.systemId;if(E.push("<!DOCTYPE ",A.name),ot)E.push(" PUBLIC ",ot),Je&&Je!="."&&E.push(" ",Je),E.push(">");else if(Je&&Je!=".")E.push(" SYSTEM ",Je,">");else{var bt=A.internalSubset;bt&&E.push(" [",bt,"]"),E.push(">")}return;case w:return E.push("<?",A.target," ",A.data,"?>");case p:return E.push("&",A.nodeName,";");default:E.push("??",A.nodeName)}}function te(A,E,U){var K;switch(E.nodeType){case c:K=E.cloneNode(!1),K.ownerDocument=A;case k:break;case l:U=!0;break}if(K||(K=E.cloneNode(!1)),K.ownerDocument=A,K.parentNode=null,U)for(var pe=E.firstChild;pe;)K.appendChild(te(A,pe,U)),pe=pe.nextSibling;return K}function ae(A,E,U){var K=new E.constructor;for(var pe in E){var Ee=E[pe];typeof Ee!="object"&&Ee!=K[pe]&&(K[pe]=Ee)}switch(E.childNodes&&(K.childNodes=new M),K.ownerDocument=A,K.nodeType){case c:var ve=E.attributes,ke=K.attributes=new B,Te=ve.length;ke._ownerElement=K;for(var Oe=0;Oe<Te;Oe++)K.setAttributeNode(ae(A,ve.item(Oe),!0));break;case l:U=!0}if(U)for(var Re=E.firstChild;Re;)K.appendChild(ae(A,Re,U)),Re=Re.nextSibling;return K}function J(A,E,U){A[E]=U}try{if(Object.defineProperty){let A=function(E){switch(E.nodeType){case c:case k:var U=[];for(E=E.firstChild;E;)E.nodeType!==7&&E.nodeType!==8&&U.push(A(E)),E=E.nextSibling;return U.join("");default:return E.nodeValue}};Object.defineProperty($.prototype,"length",{get:function(){return L(this),this.$$length}}),Object.defineProperty(N.prototype,"textContent",{get:function(){return A(this)},set:function(E){switch(this.nodeType){case c:case k:for(;this.firstChild;)this.removeChild(this.firstChild);(E||String(E))&&this.appendChild(this.ownerDocument.createTextNode(E));break;default:this.data=E,this.value=E,this.nodeValue=E}}}),J=function(E,U,K){E["$$"+U]=K}}}catch{}return ys.Node=N,ys.DOMException=F,ys.DOMImplementation=H,ys.XMLSerializer=ce,ys}var uh;function Qx(){if(uh)return gs;uh=1;function r(x){this.options=x||{locator:{}}}r.prototype.parseFromString=function(x,v){var k=this.options,g=new h,S=k.domBuilder||new n,C=k.errorHandler,R=k.locator,I=k.xmlns||{},_=/\/x?html?$/.test(v),F=_?f.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return R&&S.setDocumentLocator(R),g.errorHandler=s(C,S,R),g.domBuilder=k.domBuilder||S,_&&(I[""]="http://www.w3.org/1999/xhtml"),I.xml=I.xml||"http://www.w3.org/XML/1998/namespace",x&&typeof x=="string"?g.parse(x,I,F):g.errorHandler.error("invalid doc source"),S.doc};function s(x,v,k){if(!x){if(v instanceof n)return v;x=v}var g={},S=x instanceof Function;k=k||{};function C(R){var I=x[R];!I&&S&&(I=x.length==2?function(_){x(R,_)}:x),g[R]=I&&function(_){I("[xmldom "+R+"]	"+_+c(k))}||function(){}}return C("warning"),C("error"),C("fatalError"),g}function n(){this.cdata=!1}function o(x,v){v.lineNumber=x.lineNumber,v.columnNumber=x.columnNumber}n.prototype={startDocument:function(){this.doc=new b().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(x,v,k,g){var S=this.doc,C=S.createElementNS(x,k||v),R=g.length;d(this,C),this.currentElement=C,this.locator&&o(this.locator,C);for(var I=0;I<R;I++){var x=g.getURI(I),_=g.getValue(I),k=g.getQName(I),F=S.createAttributeNS(x,k);this.locator&&o(g.getLocator(I),F),F.value=F.nodeValue=_,C.setAttributeNode(F)}},endElement:function(x,v,k){var g=this.currentElement;g.tagName,this.currentElement=g.parentNode},startPrefixMapping:function(x,v){},endPrefixMapping:function(x){},processingInstruction:function(x,v){var k=this.doc.createProcessingInstruction(x,v);this.locator&&o(this.locator,k),d(this,k)},ignorableWhitespace:function(x,v,k){},characters:function(x,v,k){if(x=l.apply(this,arguments),x){if(this.cdata)var g=this.doc.createCDATASection(x);else var g=this.doc.createTextNode(x);this.currentElement?this.currentElement.appendChild(g):/^\s*$/.test(x)&&this.doc.appendChild(g),this.locator&&o(this.locator,g)}},skippedEntity:function(x){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(x){(this.locator=x)&&(x.lineNumber=0)},comment:function(x,v,k){x=l.apply(this,arguments);var g=this.doc.createComment(x);this.locator&&o(this.locator,g),d(this,g)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(x,v,k){var g=this.doc.implementation;if(g&&g.createDocumentType){var S=g.createDocumentType(x,v,k);this.locator&&o(this.locator,S),d(this,S)}},warning:function(x){console.warn("[xmldom warning]	"+x,c(this.locator))},error:function(x){console.error("[xmldom error]	"+x,c(this.locator))},fatalError:function(x){throw new w(x,this.locator)}};function c(x){if(x)return`
@`+(x.systemId||"")+"#[line:"+x.lineNumber+",col:"+x.columnNumber+"]"}function l(x,v,k){return typeof x=="string"?x.substr(v,k):x.length>=v+k||v?new java.lang.String(x,v,k)+"":x}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(x){n.prototype[x]=function(){return null}});function d(x,v){x.currentElement?x.currentElement.appendChild(v):x.doc.appendChild(v)}var f=Gx(),p=Kx(),h=p.XMLReader,w=p.ParseError,b=gs.DOMImplementation=ch().DOMImplementation;return gs.XMLSerializer=ch().XMLSerializer,gs.DOMParser=r,gs.__DOMHandler=n,gs}var Xx=Qx();const Zx={},Yx={},Jx={},ew={};function tw(r){const n=new Xx.DOMParser().parseFromString(r,"application/xml"),o=M=>n.getElementsByTagName(M)[0]?.textContent?.trim()||void 0,c=M=>Array.from(n.getElementsByTagName(M)).map($=>$.textContent?.trim()||"").filter(Boolean),l=M=>{const $=n.getElementsByTagName("meta"),L=[];for(let B=0;B<$.length;B++){const Q=$[B];if(Q.getAttribute("property")===M){const oe=Q.textContent?.trim();oe&&L.push(oe)}}return L},d=o("dc:title")||l("schema:title")[0],f=o("dc:creator")||l("schema:creator")[0],p=o("dc:publisher")||l("schema:publisher")[0],h=o("dc:date")||l("schema:date")[0],w=o("dc:language")||l("schema:language")[0],b=o("dc:rights")||l("schema:rights")[0],x=o("dc:description")||l("schema:description")[0],v=c("dc:subject").concat(l("schema:subject")),k=c("dc:identifier").concat(l("schema:identifier")),g=l("schema:accessMode").concat(c("dcterms:accessMode"),c("schema:accessMode")),S=l("schema:accessibilityFeature").concat(c("dcterms:accessibilityFeature"),c("schema:accessibilityFeature")),C=l("schema:accessibilityHazard").concat(c("dcterms:accessibilityHazard"),c("schema:accessibilityHazard")),R=l("schema:accessibilitySummary")[0]||o("schema:accessibilitySummary")||o("dcterms:accessibilitySummary"),I=l("schema:accessModeSufficient").concat(c("schema:accessModeSufficient"),c("dcterms:accessModeSufficient")),_=l("schema:accessibilityConformsTo").concat(c("dcterms:conformsTo"),c("schema:accessibilityConformsTo")),F=l("schema:accessibilityCertification")[0]||o("dcterms:certifiedBy")||o("schema:accessibilityCertification");return{title:d,author:f,publisher:p,publicationDate:h,language:w,rights:b,description:x,subjects:v.length?v:void 0,identifiers:k.length?k:void 0,accessModes:g.length?g:void 0,accessibilityFeatures:S.length?S:void 0,hazards:C.length?C:void 0,accessibilitySummary:R,accessModesSufficient:I.length?I:void 0,certificationConformsTo:_.length?_:void 0,certification:F}}function rw(r){const s=(r.accessibilityFeature||[]).map(d=>Zx[d]||d).join(", "),n=(r.accessibilityHazard||[]).map(d=>Yx[d]||d).join(", "),o=(r.accessMode||[]).map(d=>Jx[d]||d).join(", "),c=(r.accessibilityConformsTo||[]).map(d=>ew[d]||d).join(", ");let l="";return s&&(l+=`Features: ${s}. `),n&&(l+=`Hazards: ${n}. `),o&&(l+=`Access Modes: ${o}. `),c&&(l+=`Conforms to: ${c}. `),r.accessibilitySummary&&(l+=`Summary: ${r.accessibilitySummary}`),l.trim()}function nw(r){const s=tw(r),n=rw(s);return{...s,accessibilityFeedback:n,opfRaw:r}}function To(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Hl={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var dh;function sw(){return dh||(dh=1,(function(r,s){(function(n){r.exports=n()})(function(){return(function n(o,c,l){function d(h,w){if(!c[h]){if(!o[h]){var b=typeof To=="function"&&To;if(!w&&b)return b(h,!0);if(f)return f(h,!0);var x=new Error("Cannot find module '"+h+"'");throw x.code="MODULE_NOT_FOUND",x}var v=c[h]={exports:{}};o[h][0].call(v.exports,function(k){var g=o[h][1][k];return d(g||k)},v,v.exports,n,o,c,l)}return c[h].exports}for(var f=typeof To=="function"&&To,p=0;p<l.length;p++)d(l[p]);return d})({1:[function(n,o,c){var l=n("./utils"),d=n("./support"),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c.encode=function(p){for(var h,w,b,x,v,k,g,S=[],C=0,R=p.length,I=R,_=l.getTypeOf(p)!=="string";C<p.length;)I=R-C,b=_?(h=p[C++],w=C<R?p[C++]:0,C<R?p[C++]:0):(h=p.charCodeAt(C++),w=C<R?p.charCodeAt(C++):0,C<R?p.charCodeAt(C++):0),x=h>>2,v=(3&h)<<4|w>>4,k=1<I?(15&w)<<2|b>>6:64,g=2<I?63&b:64,S.push(f.charAt(x)+f.charAt(v)+f.charAt(k)+f.charAt(g));return S.join("")},c.decode=function(p){var h,w,b,x,v,k,g=0,S=0,C="data:";if(p.substr(0,C.length)===C)throw new Error("Invalid base64 input, it looks like a data url.");var R,I=3*(p=p.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(p.charAt(p.length-1)===f.charAt(64)&&I--,p.charAt(p.length-2)===f.charAt(64)&&I--,I%1!=0)throw new Error("Invalid base64 input, bad content length.");for(R=d.uint8array?new Uint8Array(0|I):new Array(0|I);g<p.length;)h=f.indexOf(p.charAt(g++))<<2|(x=f.indexOf(p.charAt(g++)))>>4,w=(15&x)<<4|(v=f.indexOf(p.charAt(g++)))>>2,b=(3&v)<<6|(k=f.indexOf(p.charAt(g++))),R[S++]=h,v!==64&&(R[S++]=w),k!==64&&(R[S++]=b);return R}},{"./support":30,"./utils":32}],2:[function(n,o,c){var l=n("./external"),d=n("./stream/DataWorker"),f=n("./stream/Crc32Probe"),p=n("./stream/DataLengthProbe");function h(w,b,x,v,k){this.compressedSize=w,this.uncompressedSize=b,this.crc32=x,this.compression=v,this.compressedContent=k}h.prototype={getContentWorker:function(){var w=new d(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new p("data_length")),b=this;return w.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),w},getCompressedWorker:function(){return new d(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(w,b,x){return w.pipe(new f).pipe(new p("uncompressedSize")).pipe(b.compressWorker(x)).pipe(new p("compressedSize")).withStreamInfo("compression",b)},o.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,o,c){var l=n("./stream/GenericWorker");c.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},c.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,o,c){var l=n("./utils"),d=(function(){for(var f,p=[],h=0;h<256;h++){f=h;for(var w=0;w<8;w++)f=1&f?3988292384^f>>>1:f>>>1;p[h]=f}return p})();o.exports=function(f,p){return f!==void 0&&f.length?l.getTypeOf(f)!=="string"?(function(h,w,b,x){var v=d,k=x+b;h^=-1;for(var g=x;g<k;g++)h=h>>>8^v[255&(h^w[g])];return-1^h})(0|p,f,f.length,0):(function(h,w,b,x){var v=d,k=x+b;h^=-1;for(var g=x;g<k;g++)h=h>>>8^v[255&(h^w.charCodeAt(g))];return-1^h})(0|p,f,f.length,0):0}},{"./utils":32}],5:[function(n,o,c){c.base64=!1,c.binary=!1,c.dir=!1,c.createFolders=!0,c.date=null,c.compression=null,c.compressionOptions=null,c.comment=null,c.unixPermissions=null,c.dosPermissions=null},{}],6:[function(n,o,c){var l=null;l=typeof Promise<"u"?Promise:n("lie"),o.exports={Promise:l}},{lie:37}],7:[function(n,o,c){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",d=n("pako"),f=n("./utils"),p=n("./stream/GenericWorker"),h=l?"uint8array":"array";function w(b,x){p.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=x,this.meta={}}c.magic="\b\0",f.inherits(w,p),w.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(f.transformTo(h,b.data),!1)},w.prototype.flush=function(){p.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},w.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this._pako=null},w.prototype._createPako=function(){this._pako=new d[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(x){b.push({data:x,meta:b.meta})}},c.compressWorker=function(b){return new w("Deflate",b)},c.uncompressWorker=function(){return new w("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,o,c){function l(v,k){var g,S="";for(g=0;g<k;g++)S+=String.fromCharCode(255&v),v>>>=8;return S}function d(v,k,g,S,C,R){var I,_,F=v.file,M=v.compression,$=R!==h.utf8encode,L=f.transformTo("string",R(F.name)),B=f.transformTo("string",h.utf8encode(F.name)),Q=F.comment,oe=f.transformTo("string",R(Q)),z=f.transformTo("string",h.utf8encode(Q)),H=B.length!==F.name.length,N=z.length!==Q.length,X="",me="",ee="",ie=F.dir,re=F.date,Z={crc32:0,compressedSize:0,uncompressedSize:0};k&&!g||(Z.crc32=v.crc32,Z.compressedSize=v.compressedSize,Z.uncompressedSize=v.uncompressedSize);var P=0;k&&(P|=8),$||!H&&!N||(P|=2048);var W=0,ye=0;ie&&(W|=16),C==="UNIX"?(ye=798,W|=(function(fe,Ae){var be=fe;return fe||(be=Ae?16893:33204),(65535&be)<<16})(F.unixPermissions,ie)):(ye=20,W|=(function(fe){return 63&(fe||0)})(F.dosPermissions)),I=re.getUTCHours(),I<<=6,I|=re.getUTCMinutes(),I<<=5,I|=re.getUTCSeconds()/2,_=re.getUTCFullYear()-1980,_<<=4,_|=re.getUTCMonth()+1,_<<=5,_|=re.getUTCDate(),H&&(me=l(1,1)+l(w(L),4)+B,X+="up"+l(me.length,2)+me),N&&(ee=l(1,1)+l(w(oe),4)+z,X+="uc"+l(ee.length,2)+ee);var he="";return he+=`
\0`,he+=l(P,2),he+=M.magic,he+=l(I,2),he+=l(_,2),he+=l(Z.crc32,4),he+=l(Z.compressedSize,4),he+=l(Z.uncompressedSize,4),he+=l(L.length,2),he+=l(X.length,2),{fileRecord:b.LOCAL_FILE_HEADER+he+L+X,dirRecord:b.CENTRAL_FILE_HEADER+l(ye,2)+he+l(oe.length,2)+"\0\0\0\0"+l(W,4)+l(S,4)+L+X+oe}}var f=n("../utils"),p=n("../stream/GenericWorker"),h=n("../utf8"),w=n("../crc32"),b=n("../signature");function x(v,k,g,S){p.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=k,this.zipPlatform=g,this.encodeFileName=S,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}f.inherits(x,p),x.prototype.push=function(v){var k=v.meta.percent||0,g=this.entriesCount,S=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,p.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:g?(k+100*(g-S-1))/g:100}}))},x.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var k=this.streamFiles&&!v.file.dir;if(k){var g=d(v,k,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(v){this.accumulate=!1;var k=this.streamFiles&&!v.file.dir,g=d(v,k,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),k)this.push({data:(function(S){return b.DATA_DESCRIPTOR+l(S.crc32,4)+l(S.compressedSize,4)+l(S.uncompressedSize,4)})(v),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var v=this.bytesWritten,k=0;k<this.dirRecords.length;k++)this.push({data:this.dirRecords[k],meta:{percent:100}});var g=this.bytesWritten-v,S=(function(C,R,I,_,F){var M=f.transformTo("string",F(_));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(C,2)+l(C,2)+l(R,4)+l(I,4)+l(M.length,2)+M})(this.dirRecords.length,g,v,this.zipComment,this.encodeFileName);this.push({data:S,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(v){this._sources.push(v);var k=this;return v.on("data",function(g){k.processChunk(g)}),v.on("end",function(){k.closedSource(k.previous.streamInfo),k._sources.length?k.prepareNextSource():k.end()}),v.on("error",function(g){k.error(g)}),this},x.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},x.prototype.error=function(v){var k=this._sources;if(!p.prototype.error.call(this,v))return!1;for(var g=0;g<k.length;g++)try{k[g].error(v)}catch{}return!0},x.prototype.lock=function(){p.prototype.lock.call(this);for(var v=this._sources,k=0;k<v.length;k++)v[k].lock()},o.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,o,c){var l=n("../compressions"),d=n("./ZipFileWorker");c.generateWorker=function(f,p,h){var w=new d(p.streamFiles,h,p.platform,p.encodeFileName),b=0;try{f.forEach(function(x,v){b++;var k=(function(R,I){var _=R||I,F=l[_];if(!F)throw new Error(_+" is not a valid compression method !");return F})(v.options.compression,p.compression),g=v.options.compressionOptions||p.compressionOptions||{},S=v.dir,C=v.date;v._compressWorker(k,g).withStreamInfo("file",{name:x,dir:S,date:C,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(w)}),w.entriesCount=b}catch(x){w.error(x)}return w}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,o,c){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var d=new l;for(var f in this)typeof this[f]!="function"&&(d[f]=this[f]);return d}}(l.prototype=n("./object")).loadAsync=n("./load"),l.support=n("./support"),l.defaults=n("./defaults"),l.version="3.10.1",l.loadAsync=function(d,f){return new l().loadAsync(d,f)},l.external=n("./external"),o.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,o,c){var l=n("./utils"),d=n("./external"),f=n("./utf8"),p=n("./zipEntries"),h=n("./stream/Crc32Probe"),w=n("./nodejsUtils");function b(x){return new d.Promise(function(v,k){var g=x.decompressed.getContentWorker().pipe(new h);g.on("error",function(S){k(S)}).on("end",function(){g.streamInfo.crc32!==x.decompressed.crc32?k(new Error("Corrupted zip : CRC32 mismatch")):v()}).resume()})}o.exports=function(x,v){var k=this;return v=l.extend(v||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:f.utf8decode}),w.isNode&&w.isStream(x)?d.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",x,!0,v.optimizedBinaryString,v.base64).then(function(g){var S=new p(v);return S.load(g),S}).then(function(g){var S=[d.Promise.resolve(g)],C=g.files;if(v.checkCRC32)for(var R=0;R<C.length;R++)S.push(b(C[R]));return d.Promise.all(S)}).then(function(g){for(var S=g.shift(),C=S.files,R=0;R<C.length;R++){var I=C[R],_=I.fileNameStr,F=l.resolve(I.fileNameStr);k.file(F,I.decompressed,{binary:!0,optimizedBinaryString:!0,date:I.date,dir:I.dir,comment:I.fileCommentStr.length?I.fileCommentStr:null,unixPermissions:I.unixPermissions,dosPermissions:I.dosPermissions,createFolders:v.createFolders}),I.dir||(k.file(F).unsafeOriginalName=_)}return S.zipComment.length&&(k.comment=S.zipComment),k})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,o,c){var l=n("../utils"),d=n("../stream/GenericWorker");function f(p,h){d.call(this,"Nodejs stream input adapter for "+p),this._upstreamEnded=!1,this._bindStream(h)}l.inherits(f,d),f.prototype._bindStream=function(p){var h=this;(this._stream=p).pause(),p.on("data",function(w){h.push({data:w,meta:{percent:0}})}).on("error",function(w){h.isPaused?this.generatedError=w:h.error(w)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},f.prototype.pause=function(){return!!d.prototype.pause.call(this)&&(this._stream.pause(),!0)},f.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},o.exports=f},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,o,c){var l=n("readable-stream").Readable;function d(f,p,h){l.call(this,p),this._helper=f;var w=this;f.on("data",function(b,x){w.push(b)||w._helper.pause(),h&&h(x)}).on("error",function(b){w.emit("error",b)}).on("end",function(){w.push(null)})}n("../utils").inherits(d,l),d.prototype._read=function(){this._helper.resume()},o.exports=d},{"../utils":32,"readable-stream":16}],14:[function(n,o,c){o.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,d){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,d);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,d)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var d=new Buffer(l);return d.fill(0),d},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(n,o,c){function l(F,M,$){var L,B=f.getTypeOf(M),Q=f.extend($||{},w);Q.date=Q.date||new Date,Q.compression!==null&&(Q.compression=Q.compression.toUpperCase()),typeof Q.unixPermissions=="string"&&(Q.unixPermissions=parseInt(Q.unixPermissions,8)),Q.unixPermissions&&16384&Q.unixPermissions&&(Q.dir=!0),Q.dosPermissions&&16&Q.dosPermissions&&(Q.dir=!0),Q.dir&&(F=C(F)),Q.createFolders&&(L=S(F))&&R.call(this,L,!0);var oe=B==="string"&&Q.binary===!1&&Q.base64===!1;$&&$.binary!==void 0||(Q.binary=!oe),(M instanceof b&&M.uncompressedSize===0||Q.dir||!M||M.length===0)&&(Q.base64=!1,Q.binary=!0,M="",Q.compression="STORE",B="string");var z=null;z=M instanceof b||M instanceof p?M:k.isNode&&k.isStream(M)?new g(F,M):f.prepareContent(F,M,Q.binary,Q.optimizedBinaryString,Q.base64);var H=new x(F,z,Q);this.files[F]=H}var d=n("./utf8"),f=n("./utils"),p=n("./stream/GenericWorker"),h=n("./stream/StreamHelper"),w=n("./defaults"),b=n("./compressedObject"),x=n("./zipObject"),v=n("./generate"),k=n("./nodejsUtils"),g=n("./nodejs/NodejsStreamInputAdapter"),S=function(F){F.slice(-1)==="/"&&(F=F.substring(0,F.length-1));var M=F.lastIndexOf("/");return 0<M?F.substring(0,M):""},C=function(F){return F.slice(-1)!=="/"&&(F+="/"),F},R=function(F,M){return M=M!==void 0?M:w.createFolders,F=C(F),this.files[F]||l.call(this,F,null,{dir:!0,createFolders:M}),this.files[F]};function I(F){return Object.prototype.toString.call(F)==="[object RegExp]"}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(F){var M,$,L;for(M in this.files)L=this.files[M],($=M.slice(this.root.length,M.length))&&M.slice(0,this.root.length)===this.root&&F($,L)},filter:function(F){var M=[];return this.forEach(function($,L){F($,L)&&M.push(L)}),M},file:function(F,M,$){if(arguments.length!==1)return F=this.root+F,l.call(this,F,M,$),this;if(I(F)){var L=F;return this.filter(function(Q,oe){return!oe.dir&&L.test(Q)})}var B=this.files[this.root+F];return B&&!B.dir?B:null},folder:function(F){if(!F)return this;if(I(F))return this.filter(function(B,Q){return Q.dir&&F.test(B)});var M=this.root+F,$=R.call(this,M),L=this.clone();return L.root=$.name,L},remove:function(F){F=this.root+F;var M=this.files[F];if(M||(F.slice(-1)!=="/"&&(F+="/"),M=this.files[F]),M&&!M.dir)delete this.files[F];else for(var $=this.filter(function(B,Q){return Q.name.slice(0,F.length)===F}),L=0;L<$.length;L++)delete this.files[$[L].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(F){var M,$={};try{if(($=f.extend(F||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=$.type.toLowerCase(),$.compression=$.compression.toUpperCase(),$.type==="binarystring"&&($.type="string"),!$.type)throw new Error("No output type specified.");f.checkSupport($.type),$.platform!=="darwin"&&$.platform!=="freebsd"&&$.platform!=="linux"&&$.platform!=="sunos"||($.platform="UNIX"),$.platform==="win32"&&($.platform="DOS");var L=$.comment||this.comment||"";M=v.generateWorker(this,$,L)}catch(B){(M=new p("error")).error(B)}return new h(M,$.type||"string",$.mimeType)},generateAsync:function(F,M){return this.generateInternalStream(F).accumulate(M)},generateNodeStream:function(F,M){return(F=F||{}).type||(F.type="nodebuffer"),this.generateInternalStream(F).toNodejsStream(M)}};o.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,o,c){o.exports=n("stream")},{stream:void 0}],17:[function(n,o,c){var l=n("./DataReader");function d(f){l.call(this,f);for(var p=0;p<this.data.length;p++)f[p]=255&f[p]}n("../utils").inherits(d,l),d.prototype.byteAt=function(f){return this.data[this.zero+f]},d.prototype.lastIndexOfSignature=function(f){for(var p=f.charCodeAt(0),h=f.charCodeAt(1),w=f.charCodeAt(2),b=f.charCodeAt(3),x=this.length-4;0<=x;--x)if(this.data[x]===p&&this.data[x+1]===h&&this.data[x+2]===w&&this.data[x+3]===b)return x-this.zero;return-1},d.prototype.readAndCheckSignature=function(f){var p=f.charCodeAt(0),h=f.charCodeAt(1),w=f.charCodeAt(2),b=f.charCodeAt(3),x=this.readData(4);return p===x[0]&&h===x[1]&&w===x[2]&&b===x[3]},d.prototype.readData=function(f){if(this.checkOffset(f),f===0)return[];var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},o.exports=d},{"../utils":32,"./DataReader":18}],18:[function(n,o,c){var l=n("../utils");function d(f){this.data=f,this.length=f.length,this.index=0,this.zero=0}d.prototype={checkOffset:function(f){this.checkIndex(this.index+f)},checkIndex:function(f){if(this.length<this.zero+f||f<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+f+"). Corrupted zip ?")},setIndex:function(f){this.checkIndex(f),this.index=f},skip:function(f){this.setIndex(this.index+f)},byteAt:function(){},readInt:function(f){var p,h=0;for(this.checkOffset(f),p=this.index+f-1;p>=this.index;p--)h=(h<<8)+this.byteAt(p);return this.index+=f,h},readString:function(f){return l.transformTo("string",this.readData(f))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var f=this.readInt(4);return new Date(Date.UTC(1980+(f>>25&127),(f>>21&15)-1,f>>16&31,f>>11&31,f>>5&63,(31&f)<<1))}},o.exports=d},{"../utils":32}],19:[function(n,o,c){var l=n("./Uint8ArrayReader");function d(f){l.call(this,f)}n("../utils").inherits(d,l),d.prototype.readData=function(f){this.checkOffset(f);var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},o.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,o,c){var l=n("./DataReader");function d(f){l.call(this,f)}n("../utils").inherits(d,l),d.prototype.byteAt=function(f){return this.data.charCodeAt(this.zero+f)},d.prototype.lastIndexOfSignature=function(f){return this.data.lastIndexOf(f)-this.zero},d.prototype.readAndCheckSignature=function(f){return f===this.readData(4)},d.prototype.readData=function(f){this.checkOffset(f);var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},o.exports=d},{"../utils":32,"./DataReader":18}],21:[function(n,o,c){var l=n("./ArrayReader");function d(f){l.call(this,f)}n("../utils").inherits(d,l),d.prototype.readData=function(f){if(this.checkOffset(f),f===0)return new Uint8Array(0);var p=this.data.subarray(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},o.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(n,o,c){var l=n("../utils"),d=n("../support"),f=n("./ArrayReader"),p=n("./StringReader"),h=n("./NodeBufferReader"),w=n("./Uint8ArrayReader");o.exports=function(b){var x=l.getTypeOf(b);return l.checkSupport(x),x!=="string"||d.uint8array?x==="nodebuffer"?new h(b):d.uint8array?new w(l.transformTo("uint8array",b)):new f(l.transformTo("array",b)):new p(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,o,c){c.LOCAL_FILE_HEADER="PK",c.CENTRAL_FILE_HEADER="PK",c.CENTRAL_DIRECTORY_END="PK",c.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",c.ZIP64_CENTRAL_DIRECTORY_END="PK",c.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,o,c){var l=n("./GenericWorker"),d=n("../utils");function f(p){l.call(this,"ConvertWorker to "+p),this.destType=p}d.inherits(f,l),f.prototype.processChunk=function(p){this.push({data:d.transformTo(this.destType,p.data),meta:p.meta})},o.exports=f},{"../utils":32,"./GenericWorker":28}],25:[function(n,o,c){var l=n("./GenericWorker"),d=n("../crc32");function f(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(f,l),f.prototype.processChunk=function(p){this.streamInfo.crc32=d(p.data,this.streamInfo.crc32||0),this.push(p)},o.exports=f},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,o,c){var l=n("../utils"),d=n("./GenericWorker");function f(p){d.call(this,"DataLengthProbe for "+p),this.propName=p,this.withStreamInfo(p,0)}l.inherits(f,d),f.prototype.processChunk=function(p){if(p){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+p.data.length}d.prototype.processChunk.call(this,p)},o.exports=f},{"../utils":32,"./GenericWorker":28}],27:[function(n,o,c){var l=n("../utils"),d=n("./GenericWorker");function f(p){d.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,p.then(function(w){h.dataIsReady=!0,h.data=w,h.max=w&&w.length||0,h.type=l.getTypeOf(w),h.isPaused||h._tickAndRepeat()},function(w){h.error(w)})}l.inherits(f,d),f.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this.data=null},f.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},f.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},f.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var p=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,h);break;case"uint8array":p=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":p=this.data.slice(this.index,h)}return this.index=h,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},o.exports=f},{"../utils":32,"./GenericWorker":28}],28:[function(n,o,c){function l(d){this.name=d||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(d){this.emit("data",d)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(d){this.emit("error",d)}return!0},error:function(d){return!this.isFinished&&(this.isPaused?this.generatedError=d:(this.isFinished=!0,this.emit("error",d),this.previous&&this.previous.error(d),this.cleanUp()),!0)},on:function(d,f){return this._listeners[d].push(f),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(d,f){if(this._listeners[d])for(var p=0;p<this._listeners[d].length;p++)this._listeners[d][p].call(this,f)},pipe:function(d){return d.registerPrevious(this)},registerPrevious:function(d){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=d.streamInfo,this.mergeStreamInfo(),this.previous=d;var f=this;return d.on("data",function(p){f.processChunk(p)}),d.on("end",function(){f.end()}),d.on("error",function(p){f.error(p)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var d=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),d=!0),this.previous&&this.previous.resume(),!d},flush:function(){},processChunk:function(d){this.push(d)},withStreamInfo:function(d,f){return this.extraStreamInfo[d]=f,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var d in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,d)&&(this.streamInfo[d]=this.extraStreamInfo[d])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var d="Worker "+this.name;return this.previous?this.previous+" -> "+d:d}},o.exports=l},{}],29:[function(n,o,c){var l=n("../utils"),d=n("./ConvertWorker"),f=n("./GenericWorker"),p=n("../base64"),h=n("../support"),w=n("../external"),b=null;if(h.nodestream)try{b=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function x(k,g){return new w.Promise(function(S,C){var R=[],I=k._internalType,_=k._outputType,F=k._mimeType;k.on("data",function(M,$){R.push(M),g&&g($)}).on("error",function(M){R=[],C(M)}).on("end",function(){try{var M=(function($,L,B){switch($){case"blob":return l.newBlob(l.transformTo("arraybuffer",L),B);case"base64":return p.encode(L);default:return l.transformTo($,L)}})(_,(function($,L){var B,Q=0,oe=null,z=0;for(B=0;B<L.length;B++)z+=L[B].length;switch($){case"string":return L.join("");case"array":return Array.prototype.concat.apply([],L);case"uint8array":for(oe=new Uint8Array(z),B=0;B<L.length;B++)oe.set(L[B],Q),Q+=L[B].length;return oe;case"nodebuffer":return Buffer.concat(L);default:throw new Error("concat : unsupported type '"+$+"'")}})(I,R),F);S(M)}catch($){C($)}R=[]}).resume()})}function v(k,g,S){var C=g;switch(g){case"blob":case"arraybuffer":C="uint8array";break;case"base64":C="string"}try{this._internalType=C,this._outputType=g,this._mimeType=S,l.checkSupport(C),this._worker=k.pipe(new d(C)),k.lock()}catch(R){this._worker=new f("error"),this._worker.error(R)}}v.prototype={accumulate:function(k){return x(this,k)},on:function(k,g){var S=this;return k==="data"?this._worker.on(k,function(C){g.call(S,C.data,C.meta)}):this._worker.on(k,function(){l.delay(g,arguments,S)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(k){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},k)}},o.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,o,c){if(c.base64=!0,c.array=!0,c.string=!0,c.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",c.nodebuffer=typeof Buffer<"u",c.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")c.blob=!1;else{var l=new ArrayBuffer(0);try{c.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);d.append(l),c.blob=d.getBlob("application/zip").size===0}catch{c.blob=!1}}}try{c.nodestream=!!n("readable-stream").Readable}catch{c.nodestream=!1}},{"readable-stream":16}],31:[function(n,o,c){for(var l=n("./utils"),d=n("./support"),f=n("./nodejsUtils"),p=n("./stream/GenericWorker"),h=new Array(256),w=0;w<256;w++)h[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;h[254]=h[254]=1;function b(){p.call(this,"utf-8 decode"),this.leftOver=null}function x(){p.call(this,"utf-8 encode")}c.utf8encode=function(v){return d.nodebuffer?f.newBufferFrom(v,"utf-8"):(function(k){var g,S,C,R,I,_=k.length,F=0;for(R=0;R<_;R++)(64512&(S=k.charCodeAt(R)))==55296&&R+1<_&&(64512&(C=k.charCodeAt(R+1)))==56320&&(S=65536+(S-55296<<10)+(C-56320),R++),F+=S<128?1:S<2048?2:S<65536?3:4;for(g=d.uint8array?new Uint8Array(F):new Array(F),R=I=0;I<F;R++)(64512&(S=k.charCodeAt(R)))==55296&&R+1<_&&(64512&(C=k.charCodeAt(R+1)))==56320&&(S=65536+(S-55296<<10)+(C-56320),R++),S<128?g[I++]=S:(S<2048?g[I++]=192|S>>>6:(S<65536?g[I++]=224|S>>>12:(g[I++]=240|S>>>18,g[I++]=128|S>>>12&63),g[I++]=128|S>>>6&63),g[I++]=128|63&S);return g})(v)},c.utf8decode=function(v){return d.nodebuffer?l.transformTo("nodebuffer",v).toString("utf-8"):(function(k){var g,S,C,R,I=k.length,_=new Array(2*I);for(g=S=0;g<I;)if((C=k[g++])<128)_[S++]=C;else if(4<(R=h[C]))_[S++]=65533,g+=R-1;else{for(C&=R===2?31:R===3?15:7;1<R&&g<I;)C=C<<6|63&k[g++],R--;1<R?_[S++]=65533:C<65536?_[S++]=C:(C-=65536,_[S++]=55296|C>>10&1023,_[S++]=56320|1023&C)}return _.length!==S&&(_.subarray?_=_.subarray(0,S):_.length=S),l.applyFromCharCode(_)})(v=l.transformTo(d.uint8array?"uint8array":"array",v))},l.inherits(b,p),b.prototype.processChunk=function(v){var k=l.transformTo(d.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(d.uint8array){var g=k;(k=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),k.set(g,this.leftOver.length)}else k=this.leftOver.concat(k);this.leftOver=null}var S=(function(R,I){var _;for((I=I||R.length)>R.length&&(I=R.length),_=I-1;0<=_&&(192&R[_])==128;)_--;return _<0||_===0?I:_+h[R[_]]>I?_:I})(k),C=k;S!==k.length&&(d.uint8array?(C=k.subarray(0,S),this.leftOver=k.subarray(S,k.length)):(C=k.slice(0,S),this.leftOver=k.slice(S,k.length))),this.push({data:c.utf8decode(C),meta:v.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:c.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},c.Utf8DecodeWorker=b,l.inherits(x,p),x.prototype.processChunk=function(v){this.push({data:c.utf8encode(v.data),meta:v.meta})},c.Utf8EncodeWorker=x},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,o,c){var l=n("./support"),d=n("./base64"),f=n("./nodejsUtils"),p=n("./external");function h(g){return g}function w(g,S){for(var C=0;C<g.length;++C)S[C]=255&g.charCodeAt(C);return S}n("setimmediate"),c.newBlob=function(g,S){c.checkSupport("blob");try{return new Blob([g],{type:S})}catch{try{var C=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return C.append(g),C.getBlob(S)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(g,S,C){var R=[],I=0,_=g.length;if(_<=C)return String.fromCharCode.apply(null,g);for(;I<_;)S==="array"||S==="nodebuffer"?R.push(String.fromCharCode.apply(null,g.slice(I,Math.min(I+C,_)))):R.push(String.fromCharCode.apply(null,g.subarray(I,Math.min(I+C,_)))),I+=C;return R.join("")},stringifyByChar:function(g){for(var S="",C=0;C<g.length;C++)S+=String.fromCharCode(g[C]);return S},applyCanBeUsed:{uint8array:(function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,f.allocBuffer(1)).length===1}catch{return!1}})()}};function x(g){var S=65536,C=c.getTypeOf(g),R=!0;if(C==="uint8array"?R=b.applyCanBeUsed.uint8array:C==="nodebuffer"&&(R=b.applyCanBeUsed.nodebuffer),R)for(;1<S;)try{return b.stringifyByChunk(g,C,S)}catch{S=Math.floor(S/2)}return b.stringifyByChar(g)}function v(g,S){for(var C=0;C<g.length;C++)S[C]=g[C];return S}c.applyFromCharCode=x;var k={};k.string={string:h,array:function(g){return w(g,new Array(g.length))},arraybuffer:function(g){return k.string.uint8array(g).buffer},uint8array:function(g){return w(g,new Uint8Array(g.length))},nodebuffer:function(g){return w(g,f.allocBuffer(g.length))}},k.array={string:x,array:h,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return f.newBufferFrom(g)}},k.arraybuffer={string:function(g){return x(new Uint8Array(g))},array:function(g){return v(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:h,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return f.newBufferFrom(new Uint8Array(g))}},k.uint8array={string:x,array:function(g){return v(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:h,nodebuffer:function(g){return f.newBufferFrom(g)}},k.nodebuffer={string:x,array:function(g){return v(g,new Array(g.length))},arraybuffer:function(g){return k.nodebuffer.uint8array(g).buffer},uint8array:function(g){return v(g,new Uint8Array(g.length))},nodebuffer:h},c.transformTo=function(g,S){if(S=S||"",!g)return S;c.checkSupport(g);var C=c.getTypeOf(S);return k[C][g](S)},c.resolve=function(g){for(var S=g.split("/"),C=[],R=0;R<S.length;R++){var I=S[R];I==="."||I===""&&R!==0&&R!==S.length-1||(I===".."?C.pop():C.push(I))}return C.join("/")},c.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":l.nodebuffer&&f.isBuffer(g)?"nodebuffer":l.uint8array&&g instanceof Uint8Array?"uint8array":l.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},c.checkSupport=function(g){if(!l[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},c.MAX_VALUE_16BITS=65535,c.MAX_VALUE_32BITS=-1,c.pretty=function(g){var S,C,R="";for(C=0;C<(g||"").length;C++)R+="\\x"+((S=g.charCodeAt(C))<16?"0":"")+S.toString(16).toUpperCase();return R},c.delay=function(g,S,C){setImmediate(function(){g.apply(C||null,S||[])})},c.inherits=function(g,S){function C(){}C.prototype=S.prototype,g.prototype=new C},c.extend=function(){var g,S,C={};for(g=0;g<arguments.length;g++)for(S in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],S)&&C[S]===void 0&&(C[S]=arguments[g][S]);return C},c.prepareContent=function(g,S,C,R,I){return p.Promise.resolve(S).then(function(_){return l.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader<"u"?new p.Promise(function(F,M){var $=new FileReader;$.onload=function(L){F(L.target.result)},$.onerror=function(L){M(L.target.error)},$.readAsArrayBuffer(_)}):_}).then(function(_){var F=c.getTypeOf(_);return F?(F==="arraybuffer"?_=c.transformTo("uint8array",_):F==="string"&&(I?_=d.decode(_):C&&R!==!0&&(_=(function(M){return w(M,l.uint8array?new Uint8Array(M.length):new Array(M.length))})(_))),_):p.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,o,c){var l=n("./reader/readerFor"),d=n("./utils"),f=n("./signature"),p=n("./zipEntry"),h=n("./support");function w(b){this.files=[],this.loadOptions=b}w.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var x=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+d.pretty(x)+", expected "+d.pretty(b)+")")}},isSignature:function(b,x){var v=this.reader.index;this.reader.setIndex(b);var k=this.reader.readString(4)===x;return this.reader.setIndex(v),k},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),x=h.uint8array?"uint8array":"array",v=d.transformTo(x,b);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,x,v,k=this.zip64EndOfCentralSize-44;0<k;)b=this.reader.readInt(2),x=this.reader.readInt(4),v=this.reader.readData(x),this.zip64ExtensibleData[b]={id:b,length:x,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,x;for(b=0;b<this.files.length;b++)x=this.files[b],this.reader.setIndex(x.localHeaderOffset),this.checkSignature(f.LOCAL_FILE_HEADER),x.readLocalPart(this.reader),x.handleUTF8(),x.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(f.CENTRAL_FILE_HEADER);)(b=new p({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(f.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,f.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var x=b;if(this.checkSignature(f.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===d.MAX_VALUE_16BITS||this.diskWithCentralDirStart===d.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===d.MAX_VALUE_16BITS||this.centralDirRecords===d.MAX_VALUE_16BITS||this.centralDirSize===d.MAX_VALUE_32BITS||this.centralDirOffset===d.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,f.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var k=x-v;if(0<k)this.isSignature(x,f.CENTRAL_FILE_HEADER)||(this.reader.zero=k);else if(k<0)throw new Error("Corrupted zip: missing "+Math.abs(k)+" bytes.")},prepareReader:function(b){this.reader=l(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},o.exports=w},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,o,c){var l=n("./reader/readerFor"),d=n("./utils"),f=n("./compressedObject"),p=n("./crc32"),h=n("./utf8"),w=n("./compressions"),b=n("./support");function x(v,k){this.options=v,this.loadOptions=k}x.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(v){var k,g;if(v.skip(22),this.fileNameLength=v.readInt(2),g=v.readInt(2),this.fileName=v.readData(this.fileNameLength),v.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((k=(function(S){for(var C in w)if(Object.prototype.hasOwnProperty.call(w,C)&&w[C].magic===S)return w[C];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+d.pretty(this.compressionMethod)+" unknown (inner file : "+d.transformTo("string",this.fileName)+")");this.decompressed=new f(this.compressedSize,this.uncompressedSize,this.crc32,k,v.readData(this.compressedSize))},readCentralPart:function(v){this.versionMadeBy=v.readInt(2),v.skip(2),this.bitFlag=v.readInt(2),this.compressionMethod=v.readString(2),this.date=v.readDate(),this.crc32=v.readInt(4),this.compressedSize=v.readInt(4),this.uncompressedSize=v.readInt(4);var k=v.readInt(2);if(this.extraFieldsLength=v.readInt(2),this.fileCommentLength=v.readInt(2),this.diskNumberStart=v.readInt(2),this.internalFileAttributes=v.readInt(2),this.externalFileAttributes=v.readInt(4),this.localHeaderOffset=v.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");v.skip(k),this.readExtraFields(v),this.parseZIP64ExtraField(v),this.fileComment=v.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var v=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),v==0&&(this.dosPermissions=63&this.externalFileAttributes),v==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var v=l(this.extraFields[1].value);this.uncompressedSize===d.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===d.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===d.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===d.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(v){var k,g,S,C=v.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});v.index+4<C;)k=v.readInt(2),g=v.readInt(2),S=v.readData(g),this.extraFields[k]={id:k,length:g,value:S};v.setIndex(C)},handleUTF8:function(){var v=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var k=this.findExtraFieldUnicodePath();if(k!==null)this.fileNameStr=k;else{var g=d.transformTo(v,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var S=this.findExtraFieldUnicodeComment();if(S!==null)this.fileCommentStr=S;else{var C=d.transformTo(v,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(C)}}},findExtraFieldUnicodePath:function(){var v=this.extraFields[28789];if(v){var k=l(v.value);return k.readInt(1)!==1||p(this.fileName)!==k.readInt(4)?null:h.utf8decode(k.readData(v.length-5))}return null},findExtraFieldUnicodeComment:function(){var v=this.extraFields[25461];if(v){var k=l(v.value);return k.readInt(1)!==1||p(this.fileComment)!==k.readInt(4)?null:h.utf8decode(k.readData(v.length-5))}return null}},o.exports=x},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,o,c){function l(k,g,S){this.name=k,this.dir=S.dir,this.date=S.date,this.comment=S.comment,this.unixPermissions=S.unixPermissions,this.dosPermissions=S.dosPermissions,this._data=g,this._dataBinary=S.binary,this.options={compression:S.compression,compressionOptions:S.compressionOptions}}var d=n("./stream/StreamHelper"),f=n("./stream/DataWorker"),p=n("./utf8"),h=n("./compressedObject"),w=n("./stream/GenericWorker");l.prototype={internalStream:function(k){var g=null,S="string";try{if(!k)throw new Error("No output type specified.");var C=(S=k.toLowerCase())==="string"||S==="text";S!=="binarystring"&&S!=="text"||(S="string"),g=this._decompressWorker();var R=!this._dataBinary;R&&!C&&(g=g.pipe(new p.Utf8EncodeWorker)),!R&&C&&(g=g.pipe(new p.Utf8DecodeWorker))}catch(I){(g=new w("error")).error(I)}return new d(g,S,"")},async:function(k,g){return this.internalStream(k).accumulate(g)},nodeStream:function(k,g){return this.internalStream(k||"nodebuffer").toNodejsStream(g)},_compressWorker:function(k,g){if(this._data instanceof h&&this._data.compression.magic===k.magic)return this._data.getCompressedWorker();var S=this._decompressWorker();return this._dataBinary||(S=S.pipe(new p.Utf8EncodeWorker)),h.createWorkerFrom(S,k,g)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof w?this._data:new f(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],x=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},v=0;v<b.length;v++)l.prototype[b[v]]=x;o.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,o,c){(function(l){var d,f,p=l.MutationObserver||l.WebKitMutationObserver;if(p){var h=0,w=new p(k),b=l.document.createTextNode("");w.observe(b,{characterData:!0}),d=function(){b.data=h=++h%2}}else if(l.setImmediate||l.MessageChannel===void 0)d="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var g=l.document.createElement("script");g.onreadystatechange=function(){k(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},l.document.documentElement.appendChild(g)}:function(){setTimeout(k,0)};else{var x=new l.MessageChannel;x.port1.onmessage=k,d=function(){x.port2.postMessage(0)}}var v=[];function k(){var g,S;f=!0;for(var C=v.length;C;){for(S=v,v=[],g=-1;++g<C;)S[g]();C=v.length}f=!1}o.exports=function(g){v.push(g)!==1||f||d()}}).call(this,typeof jo<"u"?jo:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,o,c){var l=n("immediate");function d(){}var f={},p=["REJECTED"],h=["FULFILLED"],w=["PENDING"];function b(C){if(typeof C!="function")throw new TypeError("resolver must be a function");this.state=w,this.queue=[],this.outcome=void 0,C!==d&&g(this,C)}function x(C,R,I){this.promise=C,typeof R=="function"&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),typeof I=="function"&&(this.onRejected=I,this.callRejected=this.otherCallRejected)}function v(C,R,I){l(function(){var _;try{_=R(I)}catch(F){return f.reject(C,F)}_===C?f.reject(C,new TypeError("Cannot resolve promise with itself")):f.resolve(C,_)})}function k(C){var R=C&&C.then;if(C&&(typeof C=="object"||typeof C=="function")&&typeof R=="function")return function(){R.apply(C,arguments)}}function g(C,R){var I=!1;function _($){I||(I=!0,f.reject(C,$))}function F($){I||(I=!0,f.resolve(C,$))}var M=S(function(){R(F,_)});M.status==="error"&&_(M.value)}function S(C,R){var I={};try{I.value=C(R),I.status="success"}catch(_){I.status="error",I.value=_}return I}(o.exports=b).prototype.finally=function(C){if(typeof C!="function")return this;var R=this.constructor;return this.then(function(I){return R.resolve(C()).then(function(){return I})},function(I){return R.resolve(C()).then(function(){throw I})})},b.prototype.catch=function(C){return this.then(null,C)},b.prototype.then=function(C,R){if(typeof C!="function"&&this.state===h||typeof R!="function"&&this.state===p)return this;var I=new this.constructor(d);return this.state!==w?v(I,this.state===h?C:R,this.outcome):this.queue.push(new x(I,C,R)),I},x.prototype.callFulfilled=function(C){f.resolve(this.promise,C)},x.prototype.otherCallFulfilled=function(C){v(this.promise,this.onFulfilled,C)},x.prototype.callRejected=function(C){f.reject(this.promise,C)},x.prototype.otherCallRejected=function(C){v(this.promise,this.onRejected,C)},f.resolve=function(C,R){var I=S(k,R);if(I.status==="error")return f.reject(C,I.value);var _=I.value;if(_)g(C,_);else{C.state=h,C.outcome=R;for(var F=-1,M=C.queue.length;++F<M;)C.queue[F].callFulfilled(R)}return C},f.reject=function(C,R){C.state=p,C.outcome=R;for(var I=-1,_=C.queue.length;++I<_;)C.queue[I].callRejected(R);return C},b.resolve=function(C){return C instanceof this?C:f.resolve(new this(d),C)},b.reject=function(C){var R=new this(d);return f.reject(R,C)},b.all=function(C){var R=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=C.length,_=!1;if(!I)return this.resolve([]);for(var F=new Array(I),M=0,$=-1,L=new this(d);++$<I;)B(C[$],$);return L;function B(Q,oe){R.resolve(Q).then(function(z){F[oe]=z,++M!==I||_||(_=!0,f.resolve(L,F))},function(z){_||(_=!0,f.reject(L,z))})}},b.race=function(C){var R=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=C.length,_=!1;if(!I)return this.resolve([]);for(var F=-1,M=new this(d);++F<I;)$=C[F],R.resolve($).then(function(L){_||(_=!0,f.resolve(M,L))},function(L){_||(_=!0,f.reject(M,L))});var $;return M}},{immediate:36}],38:[function(n,o,c){var l={};(0,n("./lib/utils/common").assign)(l,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),o.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,o,c){var l=n("./zlib/deflate"),d=n("./utils/common"),f=n("./utils/strings"),p=n("./zlib/messages"),h=n("./zlib/zstream"),w=Object.prototype.toString,b=0,x=-1,v=0,k=8;function g(C){if(!(this instanceof g))return new g(C);this.options=d.assign({level:x,method:k,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},C||{});var R=this.options;R.raw&&0<R.windowBits?R.windowBits=-R.windowBits:R.gzip&&0<R.windowBits&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var I=l.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(I!==b)throw new Error(p[I]);if(R.header&&l.deflateSetHeader(this.strm,R.header),R.dictionary){var _;if(_=typeof R.dictionary=="string"?f.string2buf(R.dictionary):w.call(R.dictionary)==="[object ArrayBuffer]"?new Uint8Array(R.dictionary):R.dictionary,(I=l.deflateSetDictionary(this.strm,_))!==b)throw new Error(p[I]);this._dict_set=!0}}function S(C,R){var I=new g(R);if(I.push(C,!0),I.err)throw I.msg||p[I.err];return I.result}g.prototype.push=function(C,R){var I,_,F=this.strm,M=this.options.chunkSize;if(this.ended)return!1;_=R===~~R?R:R===!0?4:0,typeof C=="string"?F.input=f.string2buf(C):w.call(C)==="[object ArrayBuffer]"?F.input=new Uint8Array(C):F.input=C,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new d.Buf8(M),F.next_out=0,F.avail_out=M),(I=l.deflate(F,_))!==1&&I!==b)return this.onEnd(I),!(this.ended=!0);F.avail_out!==0&&(F.avail_in!==0||_!==4&&_!==2)||(this.options.to==="string"?this.onData(f.buf2binstring(d.shrinkBuf(F.output,F.next_out))):this.onData(d.shrinkBuf(F.output,F.next_out)))}while((0<F.avail_in||F.avail_out===0)&&I!==1);return _===4?(I=l.deflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===b):_!==2||(this.onEnd(b),!(F.avail_out=0))},g.prototype.onData=function(C){this.chunks.push(C)},g.prototype.onEnd=function(C){C===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=C,this.msg=this.strm.msg},c.Deflate=g,c.deflate=S,c.deflateRaw=function(C,R){return(R=R||{}).raw=!0,S(C,R)},c.gzip=function(C,R){return(R=R||{}).gzip=!0,S(C,R)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,o,c){var l=n("./zlib/inflate"),d=n("./utils/common"),f=n("./utils/strings"),p=n("./zlib/constants"),h=n("./zlib/messages"),w=n("./zlib/zstream"),b=n("./zlib/gzheader"),x=Object.prototype.toString;function v(g){if(!(this instanceof v))return new v(g);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},g||{});var S=this.options;S.raw&&0<=S.windowBits&&S.windowBits<16&&(S.windowBits=-S.windowBits,S.windowBits===0&&(S.windowBits=-15)),!(0<=S.windowBits&&S.windowBits<16)||g&&g.windowBits||(S.windowBits+=32),15<S.windowBits&&S.windowBits<48&&(15&S.windowBits)==0&&(S.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var C=l.inflateInit2(this.strm,S.windowBits);if(C!==p.Z_OK)throw new Error(h[C]);this.header=new b,l.inflateGetHeader(this.strm,this.header)}function k(g,S){var C=new v(S);if(C.push(g,!0),C.err)throw C.msg||h[C.err];return C.result}v.prototype.push=function(g,S){var C,R,I,_,F,M,$=this.strm,L=this.options.chunkSize,B=this.options.dictionary,Q=!1;if(this.ended)return!1;R=S===~~S?S:S===!0?p.Z_FINISH:p.Z_NO_FLUSH,typeof g=="string"?$.input=f.binstring2buf(g):x.call(g)==="[object ArrayBuffer]"?$.input=new Uint8Array(g):$.input=g,$.next_in=0,$.avail_in=$.input.length;do{if($.avail_out===0&&($.output=new d.Buf8(L),$.next_out=0,$.avail_out=L),(C=l.inflate($,p.Z_NO_FLUSH))===p.Z_NEED_DICT&&B&&(M=typeof B=="string"?f.string2buf(B):x.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,C=l.inflateSetDictionary(this.strm,M)),C===p.Z_BUF_ERROR&&Q===!0&&(C=p.Z_OK,Q=!1),C!==p.Z_STREAM_END&&C!==p.Z_OK)return this.onEnd(C),!(this.ended=!0);$.next_out&&($.avail_out!==0&&C!==p.Z_STREAM_END&&($.avail_in!==0||R!==p.Z_FINISH&&R!==p.Z_SYNC_FLUSH)||(this.options.to==="string"?(I=f.utf8border($.output,$.next_out),_=$.next_out-I,F=f.buf2string($.output,I),$.next_out=_,$.avail_out=L-_,_&&d.arraySet($.output,$.output,I,_,0),this.onData(F)):this.onData(d.shrinkBuf($.output,$.next_out)))),$.avail_in===0&&$.avail_out===0&&(Q=!0)}while((0<$.avail_in||$.avail_out===0)&&C!==p.Z_STREAM_END);return C===p.Z_STREAM_END&&(R=p.Z_FINISH),R===p.Z_FINISH?(C=l.inflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===p.Z_OK):R!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),!($.avail_out=0))},v.prototype.onData=function(g){this.chunks.push(g)},v.prototype.onEnd=function(g){g===p.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},c.Inflate=v,c.inflate=k,c.inflateRaw=function(g,S){return(S=S||{}).raw=!0,k(g,S)},c.ungzip=k},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,o,c){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";c.assign=function(p){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var w=h.shift();if(w){if(typeof w!="object")throw new TypeError(w+"must be non-object");for(var b in w)w.hasOwnProperty(b)&&(p[b]=w[b])}}return p},c.shrinkBuf=function(p,h){return p.length===h?p:p.subarray?p.subarray(0,h):(p.length=h,p)};var d={arraySet:function(p,h,w,b,x){if(h.subarray&&p.subarray)p.set(h.subarray(w,w+b),x);else for(var v=0;v<b;v++)p[x+v]=h[w+v]},flattenChunks:function(p){var h,w,b,x,v,k;for(h=b=0,w=p.length;h<w;h++)b+=p[h].length;for(k=new Uint8Array(b),h=x=0,w=p.length;h<w;h++)v=p[h],k.set(v,x),x+=v.length;return k}},f={arraySet:function(p,h,w,b,x){for(var v=0;v<b;v++)p[x+v]=h[w+v]},flattenChunks:function(p){return[].concat.apply([],p)}};c.setTyped=function(p){p?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,c.assign(c,d)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,f))},c.setTyped(l)},{}],42:[function(n,o,c){var l=n("./common"),d=!0,f=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{f=!1}for(var p=new l.Buf8(256),h=0;h<256;h++)p[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function w(b,x){if(x<65537&&(b.subarray&&f||!b.subarray&&d))return String.fromCharCode.apply(null,l.shrinkBuf(b,x));for(var v="",k=0;k<x;k++)v+=String.fromCharCode(b[k]);return v}p[254]=p[254]=1,c.string2buf=function(b){var x,v,k,g,S,C=b.length,R=0;for(g=0;g<C;g++)(64512&(v=b.charCodeAt(g)))==55296&&g+1<C&&(64512&(k=b.charCodeAt(g+1)))==56320&&(v=65536+(v-55296<<10)+(k-56320),g++),R+=v<128?1:v<2048?2:v<65536?3:4;for(x=new l.Buf8(R),g=S=0;S<R;g++)(64512&(v=b.charCodeAt(g)))==55296&&g+1<C&&(64512&(k=b.charCodeAt(g+1)))==56320&&(v=65536+(v-55296<<10)+(k-56320),g++),v<128?x[S++]=v:(v<2048?x[S++]=192|v>>>6:(v<65536?x[S++]=224|v>>>12:(x[S++]=240|v>>>18,x[S++]=128|v>>>12&63),x[S++]=128|v>>>6&63),x[S++]=128|63&v);return x},c.buf2binstring=function(b){return w(b,b.length)},c.binstring2buf=function(b){for(var x=new l.Buf8(b.length),v=0,k=x.length;v<k;v++)x[v]=b.charCodeAt(v);return x},c.buf2string=function(b,x){var v,k,g,S,C=x||b.length,R=new Array(2*C);for(v=k=0;v<C;)if((g=b[v++])<128)R[k++]=g;else if(4<(S=p[g]))R[k++]=65533,v+=S-1;else{for(g&=S===2?31:S===3?15:7;1<S&&v<C;)g=g<<6|63&b[v++],S--;1<S?R[k++]=65533:g<65536?R[k++]=g:(g-=65536,R[k++]=55296|g>>10&1023,R[k++]=56320|1023&g)}return w(R,k)},c.utf8border=function(b,x){var v;for((x=x||b.length)>b.length&&(x=b.length),v=x-1;0<=v&&(192&b[v])==128;)v--;return v<0||v===0?x:v+p[b[v]]>x?v:x}},{"./common":41}],43:[function(n,o,c){o.exports=function(l,d,f,p){for(var h=65535&l|0,w=l>>>16&65535|0,b=0;f!==0;){for(f-=b=2e3<f?2e3:f;w=w+(h=h+d[p++]|0)|0,--b;);h%=65521,w%=65521}return h|w<<16|0}},{}],44:[function(n,o,c){o.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,o,c){var l=(function(){for(var d,f=[],p=0;p<256;p++){d=p;for(var h=0;h<8;h++)d=1&d?3988292384^d>>>1:d>>>1;f[p]=d}return f})();o.exports=function(d,f,p,h){var w=l,b=h+p;d^=-1;for(var x=h;x<b;x++)d=d>>>8^w[255&(d^f[x])];return-1^d}},{}],46:[function(n,o,c){var l,d=n("../utils/common"),f=n("./trees"),p=n("./adler32"),h=n("./crc32"),w=n("./messages"),b=0,x=4,v=0,k=-2,g=-1,S=4,C=2,R=8,I=9,_=286,F=30,M=19,$=2*_+1,L=15,B=3,Q=258,oe=Q+B+1,z=42,H=113,N=1,X=2,me=3,ee=4;function ie(j,ue){return j.msg=w[ue],ue}function re(j){return(j<<1)-(4<j?9:0)}function Z(j){for(var ue=j.length;0<=--ue;)j[ue]=0}function P(j){var ue=j.state,ce=ue.pending;ce>j.avail_out&&(ce=j.avail_out),ce!==0&&(d.arraySet(j.output,ue.pending_buf,ue.pending_out,ce,j.next_out),j.next_out+=ce,ue.pending_out+=ce,j.total_out+=ce,j.avail_out-=ce,ue.pending-=ce,ue.pending===0&&(ue.pending_out=0))}function W(j,ue){f._tr_flush_block(j,0<=j.block_start?j.block_start:-1,j.strstart-j.block_start,ue),j.block_start=j.strstart,P(j.strm)}function ye(j,ue){j.pending_buf[j.pending++]=ue}function he(j,ue){j.pending_buf[j.pending++]=ue>>>8&255,j.pending_buf[j.pending++]=255&ue}function fe(j,ue){var ce,V,D=j.max_chain_length,q=j.strstart,te=j.prev_length,ae=j.nice_match,J=j.strstart>j.w_size-oe?j.strstart-(j.w_size-oe):0,A=j.window,E=j.w_mask,U=j.prev,K=j.strstart+Q,pe=A[q+te-1],Ee=A[q+te];j.prev_length>=j.good_match&&(D>>=2),ae>j.lookahead&&(ae=j.lookahead);do if(A[(ce=ue)+te]===Ee&&A[ce+te-1]===pe&&A[ce]===A[q]&&A[++ce]===A[q+1]){q+=2,ce++;do;while(A[++q]===A[++ce]&&A[++q]===A[++ce]&&A[++q]===A[++ce]&&A[++q]===A[++ce]&&A[++q]===A[++ce]&&A[++q]===A[++ce]&&A[++q]===A[++ce]&&A[++q]===A[++ce]&&q<K);if(V=Q-(K-q),q=K-Q,te<V){if(j.match_start=ue,ae<=(te=V))break;pe=A[q+te-1],Ee=A[q+te]}}while((ue=U[ue&E])>J&&--D!=0);return te<=j.lookahead?te:j.lookahead}function Ae(j){var ue,ce,V,D,q,te,ae,J,A,E,U=j.w_size;do{if(D=j.window_size-j.lookahead-j.strstart,j.strstart>=U+(U-oe)){for(d.arraySet(j.window,j.window,U,U,0),j.match_start-=U,j.strstart-=U,j.block_start-=U,ue=ce=j.hash_size;V=j.head[--ue],j.head[ue]=U<=V?V-U:0,--ce;);for(ue=ce=U;V=j.prev[--ue],j.prev[ue]=U<=V?V-U:0,--ce;);D+=U}if(j.strm.avail_in===0)break;if(te=j.strm,ae=j.window,J=j.strstart+j.lookahead,A=D,E=void 0,E=te.avail_in,A<E&&(E=A),ce=E===0?0:(te.avail_in-=E,d.arraySet(ae,te.input,te.next_in,E,J),te.state.wrap===1?te.adler=p(te.adler,ae,E,J):te.state.wrap===2&&(te.adler=h(te.adler,ae,E,J)),te.next_in+=E,te.total_in+=E,E),j.lookahead+=ce,j.lookahead+j.insert>=B)for(q=j.strstart-j.insert,j.ins_h=j.window[q],j.ins_h=(j.ins_h<<j.hash_shift^j.window[q+1])&j.hash_mask;j.insert&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[q+B-1])&j.hash_mask,j.prev[q&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=q,q++,j.insert--,!(j.lookahead+j.insert<B)););}while(j.lookahead<oe&&j.strm.avail_in!==0)}function be(j,ue){for(var ce,V;;){if(j.lookahead<oe){if(Ae(j),j.lookahead<oe&&ue===b)return N;if(j.lookahead===0)break}if(ce=0,j.lookahead>=B&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+B-1])&j.hash_mask,ce=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),ce!==0&&j.strstart-ce<=j.w_size-oe&&(j.match_length=fe(j,ce)),j.match_length>=B)if(V=f._tr_tally(j,j.strstart-j.match_start,j.match_length-B),j.lookahead-=j.match_length,j.match_length<=j.max_lazy_match&&j.lookahead>=B){for(j.match_length--;j.strstart++,j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+B-1])&j.hash_mask,ce=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart,--j.match_length!=0;);j.strstart++}else j.strstart+=j.match_length,j.match_length=0,j.ins_h=j.window[j.strstart],j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+1])&j.hash_mask;else V=f._tr_tally(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++;if(V&&(W(j,!1),j.strm.avail_out===0))return N}return j.insert=j.strstart<B-1?j.strstart:B-1,ue===x?(W(j,!0),j.strm.avail_out===0?me:ee):j.last_lit&&(W(j,!1),j.strm.avail_out===0)?N:X}function xe(j,ue){for(var ce,V,D;;){if(j.lookahead<oe){if(Ae(j),j.lookahead<oe&&ue===b)return N;if(j.lookahead===0)break}if(ce=0,j.lookahead>=B&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+B-1])&j.hash_mask,ce=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),j.prev_length=j.match_length,j.prev_match=j.match_start,j.match_length=B-1,ce!==0&&j.prev_length<j.max_lazy_match&&j.strstart-ce<=j.w_size-oe&&(j.match_length=fe(j,ce),j.match_length<=5&&(j.strategy===1||j.match_length===B&&4096<j.strstart-j.match_start)&&(j.match_length=B-1)),j.prev_length>=B&&j.match_length<=j.prev_length){for(D=j.strstart+j.lookahead-B,V=f._tr_tally(j,j.strstart-1-j.prev_match,j.prev_length-B),j.lookahead-=j.prev_length-1,j.prev_length-=2;++j.strstart<=D&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+B-1])&j.hash_mask,ce=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),--j.prev_length!=0;);if(j.match_available=0,j.match_length=B-1,j.strstart++,V&&(W(j,!1),j.strm.avail_out===0))return N}else if(j.match_available){if((V=f._tr_tally(j,0,j.window[j.strstart-1]))&&W(j,!1),j.strstart++,j.lookahead--,j.strm.avail_out===0)return N}else j.match_available=1,j.strstart++,j.lookahead--}return j.match_available&&(V=f._tr_tally(j,0,j.window[j.strstart-1]),j.match_available=0),j.insert=j.strstart<B-1?j.strstart:B-1,ue===x?(W(j,!0),j.strm.avail_out===0?me:ee):j.last_lit&&(W(j,!1),j.strm.avail_out===0)?N:X}function Ne(j,ue,ce,V,D){this.good_length=j,this.max_lazy=ue,this.nice_length=ce,this.max_chain=V,this.func=D}function De(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*$),this.dyn_dtree=new d.Buf16(2*(2*F+1)),this.bl_tree=new d.Buf16(2*(2*M+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(L+1),this.heap=new d.Buf16(2*_+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*_+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $e(j){var ue;return j&&j.state?(j.total_in=j.total_out=0,j.data_type=C,(ue=j.state).pending=0,ue.pending_out=0,ue.wrap<0&&(ue.wrap=-ue.wrap),ue.status=ue.wrap?z:H,j.adler=ue.wrap===2?0:1,ue.last_flush=b,f._tr_init(ue),v):ie(j,k)}function Ye(j){var ue=$e(j);return ue===v&&(function(ce){ce.window_size=2*ce.w_size,Z(ce.head),ce.max_lazy_match=l[ce.level].max_lazy,ce.good_match=l[ce.level].good_length,ce.nice_match=l[ce.level].nice_length,ce.max_chain_length=l[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=B-1,ce.match_available=0,ce.ins_h=0})(j.state),ue}function Ve(j,ue,ce,V,D,q){if(!j)return k;var te=1;if(ue===g&&(ue=6),V<0?(te=0,V=-V):15<V&&(te=2,V-=16),D<1||I<D||ce!==R||V<8||15<V||ue<0||9<ue||q<0||S<q)return ie(j,k);V===8&&(V=9);var ae=new De;return(j.state=ae).strm=j,ae.wrap=te,ae.gzhead=null,ae.w_bits=V,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=D+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+B-1)/B),ae.window=new d.Buf8(2*ae.w_size),ae.head=new d.Buf16(ae.hash_size),ae.prev=new d.Buf16(ae.w_size),ae.lit_bufsize=1<<D+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new d.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=ue,ae.strategy=q,ae.method=ce,Ye(j)}l=[new Ne(0,0,0,0,function(j,ue){var ce=65535;for(ce>j.pending_buf_size-5&&(ce=j.pending_buf_size-5);;){if(j.lookahead<=1){if(Ae(j),j.lookahead===0&&ue===b)return N;if(j.lookahead===0)break}j.strstart+=j.lookahead,j.lookahead=0;var V=j.block_start+ce;if((j.strstart===0||j.strstart>=V)&&(j.lookahead=j.strstart-V,j.strstart=V,W(j,!1),j.strm.avail_out===0)||j.strstart-j.block_start>=j.w_size-oe&&(W(j,!1),j.strm.avail_out===0))return N}return j.insert=0,ue===x?(W(j,!0),j.strm.avail_out===0?me:ee):(j.strstart>j.block_start&&(W(j,!1),j.strm.avail_out),N)}),new Ne(4,4,8,4,be),new Ne(4,5,16,8,be),new Ne(4,6,32,32,be),new Ne(4,4,16,16,xe),new Ne(8,16,32,32,xe),new Ne(8,16,128,128,xe),new Ne(8,32,128,256,xe),new Ne(32,128,258,1024,xe),new Ne(32,258,258,4096,xe)],c.deflateInit=function(j,ue){return Ve(j,ue,R,15,8,0)},c.deflateInit2=Ve,c.deflateReset=Ye,c.deflateResetKeep=$e,c.deflateSetHeader=function(j,ue){return j&&j.state?j.state.wrap!==2?k:(j.state.gzhead=ue,v):k},c.deflate=function(j,ue){var ce,V,D,q;if(!j||!j.state||5<ue||ue<0)return j?ie(j,k):k;if(V=j.state,!j.output||!j.input&&j.avail_in!==0||V.status===666&&ue!==x)return ie(j,j.avail_out===0?-5:k);if(V.strm=j,ce=V.last_flush,V.last_flush=ue,V.status===z)if(V.wrap===2)j.adler=0,ye(V,31),ye(V,139),ye(V,8),V.gzhead?(ye(V,(V.gzhead.text?1:0)+(V.gzhead.hcrc?2:0)+(V.gzhead.extra?4:0)+(V.gzhead.name?8:0)+(V.gzhead.comment?16:0)),ye(V,255&V.gzhead.time),ye(V,V.gzhead.time>>8&255),ye(V,V.gzhead.time>>16&255),ye(V,V.gzhead.time>>24&255),ye(V,V.level===9?2:2<=V.strategy||V.level<2?4:0),ye(V,255&V.gzhead.os),V.gzhead.extra&&V.gzhead.extra.length&&(ye(V,255&V.gzhead.extra.length),ye(V,V.gzhead.extra.length>>8&255)),V.gzhead.hcrc&&(j.adler=h(j.adler,V.pending_buf,V.pending,0)),V.gzindex=0,V.status=69):(ye(V,0),ye(V,0),ye(V,0),ye(V,0),ye(V,0),ye(V,V.level===9?2:2<=V.strategy||V.level<2?4:0),ye(V,3),V.status=H);else{var te=R+(V.w_bits-8<<4)<<8;te|=(2<=V.strategy||V.level<2?0:V.level<6?1:V.level===6?2:3)<<6,V.strstart!==0&&(te|=32),te+=31-te%31,V.status=H,he(V,te),V.strstart!==0&&(he(V,j.adler>>>16),he(V,65535&j.adler)),j.adler=1}if(V.status===69)if(V.gzhead.extra){for(D=V.pending;V.gzindex<(65535&V.gzhead.extra.length)&&(V.pending!==V.pending_buf_size||(V.gzhead.hcrc&&V.pending>D&&(j.adler=h(j.adler,V.pending_buf,V.pending-D,D)),P(j),D=V.pending,V.pending!==V.pending_buf_size));)ye(V,255&V.gzhead.extra[V.gzindex]),V.gzindex++;V.gzhead.hcrc&&V.pending>D&&(j.adler=h(j.adler,V.pending_buf,V.pending-D,D)),V.gzindex===V.gzhead.extra.length&&(V.gzindex=0,V.status=73)}else V.status=73;if(V.status===73)if(V.gzhead.name){D=V.pending;do{if(V.pending===V.pending_buf_size&&(V.gzhead.hcrc&&V.pending>D&&(j.adler=h(j.adler,V.pending_buf,V.pending-D,D)),P(j),D=V.pending,V.pending===V.pending_buf_size)){q=1;break}q=V.gzindex<V.gzhead.name.length?255&V.gzhead.name.charCodeAt(V.gzindex++):0,ye(V,q)}while(q!==0);V.gzhead.hcrc&&V.pending>D&&(j.adler=h(j.adler,V.pending_buf,V.pending-D,D)),q===0&&(V.gzindex=0,V.status=91)}else V.status=91;if(V.status===91)if(V.gzhead.comment){D=V.pending;do{if(V.pending===V.pending_buf_size&&(V.gzhead.hcrc&&V.pending>D&&(j.adler=h(j.adler,V.pending_buf,V.pending-D,D)),P(j),D=V.pending,V.pending===V.pending_buf_size)){q=1;break}q=V.gzindex<V.gzhead.comment.length?255&V.gzhead.comment.charCodeAt(V.gzindex++):0,ye(V,q)}while(q!==0);V.gzhead.hcrc&&V.pending>D&&(j.adler=h(j.adler,V.pending_buf,V.pending-D,D)),q===0&&(V.status=103)}else V.status=103;if(V.status===103&&(V.gzhead.hcrc?(V.pending+2>V.pending_buf_size&&P(j),V.pending+2<=V.pending_buf_size&&(ye(V,255&j.adler),ye(V,j.adler>>8&255),j.adler=0,V.status=H)):V.status=H),V.pending!==0){if(P(j),j.avail_out===0)return V.last_flush=-1,v}else if(j.avail_in===0&&re(ue)<=re(ce)&&ue!==x)return ie(j,-5);if(V.status===666&&j.avail_in!==0)return ie(j,-5);if(j.avail_in!==0||V.lookahead!==0||ue!==b&&V.status!==666){var ae=V.strategy===2?(function(J,A){for(var E;;){if(J.lookahead===0&&(Ae(J),J.lookahead===0)){if(A===b)return N;break}if(J.match_length=0,E=f._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++,E&&(W(J,!1),J.strm.avail_out===0))return N}return J.insert=0,A===x?(W(J,!0),J.strm.avail_out===0?me:ee):J.last_lit&&(W(J,!1),J.strm.avail_out===0)?N:X})(V,ue):V.strategy===3?(function(J,A){for(var E,U,K,pe,Ee=J.window;;){if(J.lookahead<=Q){if(Ae(J),J.lookahead<=Q&&A===b)return N;if(J.lookahead===0)break}if(J.match_length=0,J.lookahead>=B&&0<J.strstart&&(U=Ee[K=J.strstart-1])===Ee[++K]&&U===Ee[++K]&&U===Ee[++K]){pe=J.strstart+Q;do;while(U===Ee[++K]&&U===Ee[++K]&&U===Ee[++K]&&U===Ee[++K]&&U===Ee[++K]&&U===Ee[++K]&&U===Ee[++K]&&U===Ee[++K]&&K<pe);J.match_length=Q-(pe-K),J.match_length>J.lookahead&&(J.match_length=J.lookahead)}if(J.match_length>=B?(E=f._tr_tally(J,1,J.match_length-B),J.lookahead-=J.match_length,J.strstart+=J.match_length,J.match_length=0):(E=f._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++),E&&(W(J,!1),J.strm.avail_out===0))return N}return J.insert=0,A===x?(W(J,!0),J.strm.avail_out===0?me:ee):J.last_lit&&(W(J,!1),J.strm.avail_out===0)?N:X})(V,ue):l[V.level].func(V,ue);if(ae!==me&&ae!==ee||(V.status=666),ae===N||ae===me)return j.avail_out===0&&(V.last_flush=-1),v;if(ae===X&&(ue===1?f._tr_align(V):ue!==5&&(f._tr_stored_block(V,0,0,!1),ue===3&&(Z(V.head),V.lookahead===0&&(V.strstart=0,V.block_start=0,V.insert=0))),P(j),j.avail_out===0))return V.last_flush=-1,v}return ue!==x?v:V.wrap<=0?1:(V.wrap===2?(ye(V,255&j.adler),ye(V,j.adler>>8&255),ye(V,j.adler>>16&255),ye(V,j.adler>>24&255),ye(V,255&j.total_in),ye(V,j.total_in>>8&255),ye(V,j.total_in>>16&255),ye(V,j.total_in>>24&255)):(he(V,j.adler>>>16),he(V,65535&j.adler)),P(j),0<V.wrap&&(V.wrap=-V.wrap),V.pending!==0?v:1)},c.deflateEnd=function(j){var ue;return j&&j.state?(ue=j.state.status)!==z&&ue!==69&&ue!==73&&ue!==91&&ue!==103&&ue!==H&&ue!==666?ie(j,k):(j.state=null,ue===H?ie(j,-3):v):k},c.deflateSetDictionary=function(j,ue){var ce,V,D,q,te,ae,J,A,E=ue.length;if(!j||!j.state||(q=(ce=j.state).wrap)===2||q===1&&ce.status!==z||ce.lookahead)return k;for(q===1&&(j.adler=p(j.adler,ue,E,0)),ce.wrap=0,E>=ce.w_size&&(q===0&&(Z(ce.head),ce.strstart=0,ce.block_start=0,ce.insert=0),A=new d.Buf8(ce.w_size),d.arraySet(A,ue,E-ce.w_size,ce.w_size,0),ue=A,E=ce.w_size),te=j.avail_in,ae=j.next_in,J=j.input,j.avail_in=E,j.next_in=0,j.input=ue,Ae(ce);ce.lookahead>=B;){for(V=ce.strstart,D=ce.lookahead-(B-1);ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[V+B-1])&ce.hash_mask,ce.prev[V&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=V,V++,--D;);ce.strstart=V,ce.lookahead=B-1,Ae(ce)}return ce.strstart+=ce.lookahead,ce.block_start=ce.strstart,ce.insert=ce.lookahead,ce.lookahead=0,ce.match_length=ce.prev_length=B-1,ce.match_available=0,j.next_in=ae,j.input=J,j.avail_in=te,ce.wrap=q,v},c.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,o,c){o.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,o,c){o.exports=function(l,d){var f,p,h,w,b,x,v,k,g,S,C,R,I,_,F,M,$,L,B,Q,oe,z,H,N,X;f=l.state,p=l.next_in,N=l.input,h=p+(l.avail_in-5),w=l.next_out,X=l.output,b=w-(d-l.avail_out),x=w+(l.avail_out-257),v=f.dmax,k=f.wsize,g=f.whave,S=f.wnext,C=f.window,R=f.hold,I=f.bits,_=f.lencode,F=f.distcode,M=(1<<f.lenbits)-1,$=(1<<f.distbits)-1;e:do{I<15&&(R+=N[p++]<<I,I+=8,R+=N[p++]<<I,I+=8),L=_[R&M];t:for(;;){if(R>>>=B=L>>>24,I-=B,(B=L>>>16&255)===0)X[w++]=65535&L;else{if(!(16&B)){if((64&B)==0){L=_[(65535&L)+(R&(1<<B)-1)];continue t}if(32&B){f.mode=12;break e}l.msg="invalid literal/length code",f.mode=30;break e}Q=65535&L,(B&=15)&&(I<B&&(R+=N[p++]<<I,I+=8),Q+=R&(1<<B)-1,R>>>=B,I-=B),I<15&&(R+=N[p++]<<I,I+=8,R+=N[p++]<<I,I+=8),L=F[R&$];r:for(;;){if(R>>>=B=L>>>24,I-=B,!(16&(B=L>>>16&255))){if((64&B)==0){L=F[(65535&L)+(R&(1<<B)-1)];continue r}l.msg="invalid distance code",f.mode=30;break e}if(oe=65535&L,I<(B&=15)&&(R+=N[p++]<<I,(I+=8)<B&&(R+=N[p++]<<I,I+=8)),v<(oe+=R&(1<<B)-1)){l.msg="invalid distance too far back",f.mode=30;break e}if(R>>>=B,I-=B,(B=w-b)<oe){if(g<(B=oe-B)&&f.sane){l.msg="invalid distance too far back",f.mode=30;break e}if(H=C,(z=0)===S){if(z+=k-B,B<Q){for(Q-=B;X[w++]=C[z++],--B;);z=w-oe,H=X}}else if(S<B){if(z+=k+S-B,(B-=S)<Q){for(Q-=B;X[w++]=C[z++],--B;);if(z=0,S<Q){for(Q-=B=S;X[w++]=C[z++],--B;);z=w-oe,H=X}}}else if(z+=S-B,B<Q){for(Q-=B;X[w++]=C[z++],--B;);z=w-oe,H=X}for(;2<Q;)X[w++]=H[z++],X[w++]=H[z++],X[w++]=H[z++],Q-=3;Q&&(X[w++]=H[z++],1<Q&&(X[w++]=H[z++]))}else{for(z=w-oe;X[w++]=X[z++],X[w++]=X[z++],X[w++]=X[z++],2<(Q-=3););Q&&(X[w++]=X[z++],1<Q&&(X[w++]=X[z++]))}break}}break}}while(p<h&&w<x);p-=Q=I>>3,R&=(1<<(I-=Q<<3))-1,l.next_in=p,l.next_out=w,l.avail_in=p<h?h-p+5:5-(p-h),l.avail_out=w<x?x-w+257:257-(w-x),f.hold=R,f.bits=I}},{}],49:[function(n,o,c){var l=n("../utils/common"),d=n("./adler32"),f=n("./crc32"),p=n("./inffast"),h=n("./inftrees"),w=1,b=2,x=0,v=-2,k=1,g=852,S=592;function C(z){return(z>>>24&255)+(z>>>8&65280)+((65280&z)<<8)+((255&z)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function I(z){var H;return z&&z.state?(H=z.state,z.total_in=z.total_out=H.total=0,z.msg="",H.wrap&&(z.adler=1&H.wrap),H.mode=k,H.last=0,H.havedict=0,H.dmax=32768,H.head=null,H.hold=0,H.bits=0,H.lencode=H.lendyn=new l.Buf32(g),H.distcode=H.distdyn=new l.Buf32(S),H.sane=1,H.back=-1,x):v}function _(z){var H;return z&&z.state?((H=z.state).wsize=0,H.whave=0,H.wnext=0,I(z)):v}function F(z,H){var N,X;return z&&z.state?(X=z.state,H<0?(N=0,H=-H):(N=1+(H>>4),H<48&&(H&=15)),H&&(H<8||15<H)?v:(X.window!==null&&X.wbits!==H&&(X.window=null),X.wrap=N,X.wbits=H,_(z))):v}function M(z,H){var N,X;return z?(X=new R,(z.state=X).window=null,(N=F(z,H))!==x&&(z.state=null),N):v}var $,L,B=!0;function Q(z){if(B){var H;for($=new l.Buf32(512),L=new l.Buf32(32),H=0;H<144;)z.lens[H++]=8;for(;H<256;)z.lens[H++]=9;for(;H<280;)z.lens[H++]=7;for(;H<288;)z.lens[H++]=8;for(h(w,z.lens,0,288,$,0,z.work,{bits:9}),H=0;H<32;)z.lens[H++]=5;h(b,z.lens,0,32,L,0,z.work,{bits:5}),B=!1}z.lencode=$,z.lenbits=9,z.distcode=L,z.distbits=5}function oe(z,H,N,X){var me,ee=z.state;return ee.window===null&&(ee.wsize=1<<ee.wbits,ee.wnext=0,ee.whave=0,ee.window=new l.Buf8(ee.wsize)),X>=ee.wsize?(l.arraySet(ee.window,H,N-ee.wsize,ee.wsize,0),ee.wnext=0,ee.whave=ee.wsize):(X<(me=ee.wsize-ee.wnext)&&(me=X),l.arraySet(ee.window,H,N-X,me,ee.wnext),(X-=me)?(l.arraySet(ee.window,H,N-X,X,0),ee.wnext=X,ee.whave=ee.wsize):(ee.wnext+=me,ee.wnext===ee.wsize&&(ee.wnext=0),ee.whave<ee.wsize&&(ee.whave+=me))),0}c.inflateReset=_,c.inflateReset2=F,c.inflateResetKeep=I,c.inflateInit=function(z){return M(z,15)},c.inflateInit2=M,c.inflate=function(z,H){var N,X,me,ee,ie,re,Z,P,W,ye,he,fe,Ae,be,xe,Ne,De,$e,Ye,Ve,j,ue,ce,V,D=0,q=new l.Buf8(4),te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!z||!z.state||!z.output||!z.input&&z.avail_in!==0)return v;(N=z.state).mode===12&&(N.mode=13),ie=z.next_out,me=z.output,Z=z.avail_out,ee=z.next_in,X=z.input,re=z.avail_in,P=N.hold,W=N.bits,ye=re,he=Z,ue=x;e:for(;;)switch(N.mode){case k:if(N.wrap===0){N.mode=13;break}for(;W<16;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if(2&N.wrap&&P===35615){q[N.check=0]=255&P,q[1]=P>>>8&255,N.check=f(N.check,q,2,0),W=P=0,N.mode=2;break}if(N.flags=0,N.head&&(N.head.done=!1),!(1&N.wrap)||(((255&P)<<8)+(P>>8))%31){z.msg="incorrect header check",N.mode=30;break}if((15&P)!=8){z.msg="unknown compression method",N.mode=30;break}if(W-=4,j=8+(15&(P>>>=4)),N.wbits===0)N.wbits=j;else if(j>N.wbits){z.msg="invalid window size",N.mode=30;break}N.dmax=1<<j,z.adler=N.check=1,N.mode=512&P?10:12,W=P=0;break;case 2:for(;W<16;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if(N.flags=P,(255&N.flags)!=8){z.msg="unknown compression method",N.mode=30;break}if(57344&N.flags){z.msg="unknown header flags set",N.mode=30;break}N.head&&(N.head.text=P>>8&1),512&N.flags&&(q[0]=255&P,q[1]=P>>>8&255,N.check=f(N.check,q,2,0)),W=P=0,N.mode=3;case 3:for(;W<32;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}N.head&&(N.head.time=P),512&N.flags&&(q[0]=255&P,q[1]=P>>>8&255,q[2]=P>>>16&255,q[3]=P>>>24&255,N.check=f(N.check,q,4,0)),W=P=0,N.mode=4;case 4:for(;W<16;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}N.head&&(N.head.xflags=255&P,N.head.os=P>>8),512&N.flags&&(q[0]=255&P,q[1]=P>>>8&255,N.check=f(N.check,q,2,0)),W=P=0,N.mode=5;case 5:if(1024&N.flags){for(;W<16;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}N.length=P,N.head&&(N.head.extra_len=P),512&N.flags&&(q[0]=255&P,q[1]=P>>>8&255,N.check=f(N.check,q,2,0)),W=P=0}else N.head&&(N.head.extra=null);N.mode=6;case 6:if(1024&N.flags&&(re<(fe=N.length)&&(fe=re),fe&&(N.head&&(j=N.head.extra_len-N.length,N.head.extra||(N.head.extra=new Array(N.head.extra_len)),l.arraySet(N.head.extra,X,ee,fe,j)),512&N.flags&&(N.check=f(N.check,X,fe,ee)),re-=fe,ee+=fe,N.length-=fe),N.length))break e;N.length=0,N.mode=7;case 7:if(2048&N.flags){if(re===0)break e;for(fe=0;j=X[ee+fe++],N.head&&j&&N.length<65536&&(N.head.name+=String.fromCharCode(j)),j&&fe<re;);if(512&N.flags&&(N.check=f(N.check,X,fe,ee)),re-=fe,ee+=fe,j)break e}else N.head&&(N.head.name=null);N.length=0,N.mode=8;case 8:if(4096&N.flags){if(re===0)break e;for(fe=0;j=X[ee+fe++],N.head&&j&&N.length<65536&&(N.head.comment+=String.fromCharCode(j)),j&&fe<re;);if(512&N.flags&&(N.check=f(N.check,X,fe,ee)),re-=fe,ee+=fe,j)break e}else N.head&&(N.head.comment=null);N.mode=9;case 9:if(512&N.flags){for(;W<16;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if(P!==(65535&N.check)){z.msg="header crc mismatch",N.mode=30;break}W=P=0}N.head&&(N.head.hcrc=N.flags>>9&1,N.head.done=!0),z.adler=N.check=0,N.mode=12;break;case 10:for(;W<32;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}z.adler=N.check=C(P),W=P=0,N.mode=11;case 11:if(N.havedict===0)return z.next_out=ie,z.avail_out=Z,z.next_in=ee,z.avail_in=re,N.hold=P,N.bits=W,2;z.adler=N.check=1,N.mode=12;case 12:if(H===5||H===6)break e;case 13:if(N.last){P>>>=7&W,W-=7&W,N.mode=27;break}for(;W<3;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}switch(N.last=1&P,W-=1,3&(P>>>=1)){case 0:N.mode=14;break;case 1:if(Q(N),N.mode=20,H!==6)break;P>>>=2,W-=2;break e;case 2:N.mode=17;break;case 3:z.msg="invalid block type",N.mode=30}P>>>=2,W-=2;break;case 14:for(P>>>=7&W,W-=7&W;W<32;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if((65535&P)!=(P>>>16^65535)){z.msg="invalid stored block lengths",N.mode=30;break}if(N.length=65535&P,W=P=0,N.mode=15,H===6)break e;case 15:N.mode=16;case 16:if(fe=N.length){if(re<fe&&(fe=re),Z<fe&&(fe=Z),fe===0)break e;l.arraySet(me,X,ee,fe,ie),re-=fe,ee+=fe,Z-=fe,ie+=fe,N.length-=fe;break}N.mode=12;break;case 17:for(;W<14;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if(N.nlen=257+(31&P),P>>>=5,W-=5,N.ndist=1+(31&P),P>>>=5,W-=5,N.ncode=4+(15&P),P>>>=4,W-=4,286<N.nlen||30<N.ndist){z.msg="too many length or distance symbols",N.mode=30;break}N.have=0,N.mode=18;case 18:for(;N.have<N.ncode;){for(;W<3;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}N.lens[te[N.have++]]=7&P,P>>>=3,W-=3}for(;N.have<19;)N.lens[te[N.have++]]=0;if(N.lencode=N.lendyn,N.lenbits=7,ce={bits:N.lenbits},ue=h(0,N.lens,0,19,N.lencode,0,N.work,ce),N.lenbits=ce.bits,ue){z.msg="invalid code lengths set",N.mode=30;break}N.have=0,N.mode=19;case 19:for(;N.have<N.nlen+N.ndist;){for(;Ne=(D=N.lencode[P&(1<<N.lenbits)-1])>>>16&255,De=65535&D,!((xe=D>>>24)<=W);){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if(De<16)P>>>=xe,W-=xe,N.lens[N.have++]=De;else{if(De===16){for(V=xe+2;W<V;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if(P>>>=xe,W-=xe,N.have===0){z.msg="invalid bit length repeat",N.mode=30;break}j=N.lens[N.have-1],fe=3+(3&P),P>>>=2,W-=2}else if(De===17){for(V=xe+3;W<V;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}W-=xe,j=0,fe=3+(7&(P>>>=xe)),P>>>=3,W-=3}else{for(V=xe+7;W<V;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}W-=xe,j=0,fe=11+(127&(P>>>=xe)),P>>>=7,W-=7}if(N.have+fe>N.nlen+N.ndist){z.msg="invalid bit length repeat",N.mode=30;break}for(;fe--;)N.lens[N.have++]=j}}if(N.mode===30)break;if(N.lens[256]===0){z.msg="invalid code -- missing end-of-block",N.mode=30;break}if(N.lenbits=9,ce={bits:N.lenbits},ue=h(w,N.lens,0,N.nlen,N.lencode,0,N.work,ce),N.lenbits=ce.bits,ue){z.msg="invalid literal/lengths set",N.mode=30;break}if(N.distbits=6,N.distcode=N.distdyn,ce={bits:N.distbits},ue=h(b,N.lens,N.nlen,N.ndist,N.distcode,0,N.work,ce),N.distbits=ce.bits,ue){z.msg="invalid distances set",N.mode=30;break}if(N.mode=20,H===6)break e;case 20:N.mode=21;case 21:if(6<=re&&258<=Z){z.next_out=ie,z.avail_out=Z,z.next_in=ee,z.avail_in=re,N.hold=P,N.bits=W,p(z,he),ie=z.next_out,me=z.output,Z=z.avail_out,ee=z.next_in,X=z.input,re=z.avail_in,P=N.hold,W=N.bits,N.mode===12&&(N.back=-1);break}for(N.back=0;Ne=(D=N.lencode[P&(1<<N.lenbits)-1])>>>16&255,De=65535&D,!((xe=D>>>24)<=W);){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if(Ne&&(240&Ne)==0){for($e=xe,Ye=Ne,Ve=De;Ne=(D=N.lencode[Ve+((P&(1<<$e+Ye)-1)>>$e)])>>>16&255,De=65535&D,!($e+(xe=D>>>24)<=W);){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}P>>>=$e,W-=$e,N.back+=$e}if(P>>>=xe,W-=xe,N.back+=xe,N.length=De,Ne===0){N.mode=26;break}if(32&Ne){N.back=-1,N.mode=12;break}if(64&Ne){z.msg="invalid literal/length code",N.mode=30;break}N.extra=15&Ne,N.mode=22;case 22:if(N.extra){for(V=N.extra;W<V;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}N.length+=P&(1<<N.extra)-1,P>>>=N.extra,W-=N.extra,N.back+=N.extra}N.was=N.length,N.mode=23;case 23:for(;Ne=(D=N.distcode[P&(1<<N.distbits)-1])>>>16&255,De=65535&D,!((xe=D>>>24)<=W);){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if((240&Ne)==0){for($e=xe,Ye=Ne,Ve=De;Ne=(D=N.distcode[Ve+((P&(1<<$e+Ye)-1)>>$e)])>>>16&255,De=65535&D,!($e+(xe=D>>>24)<=W);){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}P>>>=$e,W-=$e,N.back+=$e}if(P>>>=xe,W-=xe,N.back+=xe,64&Ne){z.msg="invalid distance code",N.mode=30;break}N.offset=De,N.extra=15&Ne,N.mode=24;case 24:if(N.extra){for(V=N.extra;W<V;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}N.offset+=P&(1<<N.extra)-1,P>>>=N.extra,W-=N.extra,N.back+=N.extra}if(N.offset>N.dmax){z.msg="invalid distance too far back",N.mode=30;break}N.mode=25;case 25:if(Z===0)break e;if(fe=he-Z,N.offset>fe){if((fe=N.offset-fe)>N.whave&&N.sane){z.msg="invalid distance too far back",N.mode=30;break}Ae=fe>N.wnext?(fe-=N.wnext,N.wsize-fe):N.wnext-fe,fe>N.length&&(fe=N.length),be=N.window}else be=me,Ae=ie-N.offset,fe=N.length;for(Z<fe&&(fe=Z),Z-=fe,N.length-=fe;me[ie++]=be[Ae++],--fe;);N.length===0&&(N.mode=21);break;case 26:if(Z===0)break e;me[ie++]=N.length,Z--,N.mode=21;break;case 27:if(N.wrap){for(;W<32;){if(re===0)break e;re--,P|=X[ee++]<<W,W+=8}if(he-=Z,z.total_out+=he,N.total+=he,he&&(z.adler=N.check=N.flags?f(N.check,me,he,ie-he):d(N.check,me,he,ie-he)),he=Z,(N.flags?P:C(P))!==N.check){z.msg="incorrect data check",N.mode=30;break}W=P=0}N.mode=28;case 28:if(N.wrap&&N.flags){for(;W<32;){if(re===0)break e;re--,P+=X[ee++]<<W,W+=8}if(P!==(4294967295&N.total)){z.msg="incorrect length check",N.mode=30;break}W=P=0}N.mode=29;case 29:ue=1;break e;case 30:ue=-3;break e;case 31:return-4;case 32:default:return v}return z.next_out=ie,z.avail_out=Z,z.next_in=ee,z.avail_in=re,N.hold=P,N.bits=W,(N.wsize||he!==z.avail_out&&N.mode<30&&(N.mode<27||H!==4))&&oe(z,z.output,z.next_out,he-z.avail_out)?(N.mode=31,-4):(ye-=z.avail_in,he-=z.avail_out,z.total_in+=ye,z.total_out+=he,N.total+=he,N.wrap&&he&&(z.adler=N.check=N.flags?f(N.check,me,he,z.next_out-he):d(N.check,me,he,z.next_out-he)),z.data_type=N.bits+(N.last?64:0)+(N.mode===12?128:0)+(N.mode===20||N.mode===15?256:0),(ye==0&&he===0||H===4)&&ue===x&&(ue=-5),ue)},c.inflateEnd=function(z){if(!z||!z.state)return v;var H=z.state;return H.window&&(H.window=null),z.state=null,x},c.inflateGetHeader=function(z,H){var N;return z&&z.state?(2&(N=z.state).wrap)==0?v:((N.head=H).done=!1,x):v},c.inflateSetDictionary=function(z,H){var N,X=H.length;return z&&z.state?(N=z.state).wrap!==0&&N.mode!==11?v:N.mode===11&&d(1,H,X,0)!==N.check?-3:oe(z,H,X,X)?(N.mode=31,-4):(N.havedict=1,x):v},c.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,o,c){var l=n("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];o.exports=function(w,b,x,v,k,g,S,C){var R,I,_,F,M,$,L,B,Q,oe=C.bits,z=0,H=0,N=0,X=0,me=0,ee=0,ie=0,re=0,Z=0,P=0,W=null,ye=0,he=new l.Buf16(16),fe=new l.Buf16(16),Ae=null,be=0;for(z=0;z<=15;z++)he[z]=0;for(H=0;H<v;H++)he[b[x+H]]++;for(me=oe,X=15;1<=X&&he[X]===0;X--);if(X<me&&(me=X),X===0)return k[g++]=20971520,k[g++]=20971520,C.bits=1,0;for(N=1;N<X&&he[N]===0;N++);for(me<N&&(me=N),z=re=1;z<=15;z++)if(re<<=1,(re-=he[z])<0)return-1;if(0<re&&(w===0||X!==1))return-1;for(fe[1]=0,z=1;z<15;z++)fe[z+1]=fe[z]+he[z];for(H=0;H<v;H++)b[x+H]!==0&&(S[fe[b[x+H]]++]=H);if($=w===0?(W=Ae=S,19):w===1?(W=d,ye-=257,Ae=f,be-=257,256):(W=p,Ae=h,-1),z=N,M=g,ie=H=P=0,_=-1,F=(Z=1<<(ee=me))-1,w===1&&852<Z||w===2&&592<Z)return 1;for(;;){for(L=z-ie,Q=S[H]<$?(B=0,S[H]):S[H]>$?(B=Ae[be+S[H]],W[ye+S[H]]):(B=96,0),R=1<<z-ie,N=I=1<<ee;k[M+(P>>ie)+(I-=R)]=L<<24|B<<16|Q|0,I!==0;);for(R=1<<z-1;P&R;)R>>=1;if(R!==0?(P&=R-1,P+=R):P=0,H++,--he[z]==0){if(z===X)break;z=b[x+S[H]]}if(me<z&&(P&F)!==_){for(ie===0&&(ie=me),M+=N,re=1<<(ee=z-ie);ee+ie<X&&!((re-=he[ee+ie])<=0);)ee++,re<<=1;if(Z+=1<<ee,w===1&&852<Z||w===2&&592<Z)return 1;k[_=P&F]=me<<24|ee<<16|M-g|0}}return P!==0&&(k[M+P]=z-ie<<24|64<<16|0),C.bits=me,0}},{"../utils/common":41}],51:[function(n,o,c){o.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,o,c){var l=n("../utils/common"),d=0,f=1;function p(D){for(var q=D.length;0<=--q;)D[q]=0}var h=0,w=29,b=256,x=b+1+w,v=30,k=19,g=2*x+1,S=15,C=16,R=7,I=256,_=16,F=17,M=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=new Array(2*(x+2));p(oe);var z=new Array(2*v);p(z);var H=new Array(512);p(H);var N=new Array(256);p(N);var X=new Array(w);p(X);var me,ee,ie,re=new Array(v);function Z(D,q,te,ae,J){this.static_tree=D,this.extra_bits=q,this.extra_base=te,this.elems=ae,this.max_length=J,this.has_stree=D&&D.length}function P(D,q){this.dyn_tree=D,this.max_code=0,this.stat_desc=q}function W(D){return D<256?H[D]:H[256+(D>>>7)]}function ye(D,q){D.pending_buf[D.pending++]=255&q,D.pending_buf[D.pending++]=q>>>8&255}function he(D,q,te){D.bi_valid>C-te?(D.bi_buf|=q<<D.bi_valid&65535,ye(D,D.bi_buf),D.bi_buf=q>>C-D.bi_valid,D.bi_valid+=te-C):(D.bi_buf|=q<<D.bi_valid&65535,D.bi_valid+=te)}function fe(D,q,te){he(D,te[2*q],te[2*q+1])}function Ae(D,q){for(var te=0;te|=1&D,D>>>=1,te<<=1,0<--q;);return te>>>1}function be(D,q,te){var ae,J,A=new Array(S+1),E=0;for(ae=1;ae<=S;ae++)A[ae]=E=E+te[ae-1]<<1;for(J=0;J<=q;J++){var U=D[2*J+1];U!==0&&(D[2*J]=Ae(A[U]++,U))}}function xe(D){var q;for(q=0;q<x;q++)D.dyn_ltree[2*q]=0;for(q=0;q<v;q++)D.dyn_dtree[2*q]=0;for(q=0;q<k;q++)D.bl_tree[2*q]=0;D.dyn_ltree[2*I]=1,D.opt_len=D.static_len=0,D.last_lit=D.matches=0}function Ne(D){8<D.bi_valid?ye(D,D.bi_buf):0<D.bi_valid&&(D.pending_buf[D.pending++]=D.bi_buf),D.bi_buf=0,D.bi_valid=0}function De(D,q,te,ae){var J=2*q,A=2*te;return D[J]<D[A]||D[J]===D[A]&&ae[q]<=ae[te]}function $e(D,q,te){for(var ae=D.heap[te],J=te<<1;J<=D.heap_len&&(J<D.heap_len&&De(q,D.heap[J+1],D.heap[J],D.depth)&&J++,!De(q,ae,D.heap[J],D.depth));)D.heap[te]=D.heap[J],te=J,J<<=1;D.heap[te]=ae}function Ye(D,q,te){var ae,J,A,E,U=0;if(D.last_lit!==0)for(;ae=D.pending_buf[D.d_buf+2*U]<<8|D.pending_buf[D.d_buf+2*U+1],J=D.pending_buf[D.l_buf+U],U++,ae===0?fe(D,J,q):(fe(D,(A=N[J])+b+1,q),(E=$[A])!==0&&he(D,J-=X[A],E),fe(D,A=W(--ae),te),(E=L[A])!==0&&he(D,ae-=re[A],E)),U<D.last_lit;);fe(D,I,q)}function Ve(D,q){var te,ae,J,A=q.dyn_tree,E=q.stat_desc.static_tree,U=q.stat_desc.has_stree,K=q.stat_desc.elems,pe=-1;for(D.heap_len=0,D.heap_max=g,te=0;te<K;te++)A[2*te]!==0?(D.heap[++D.heap_len]=pe=te,D.depth[te]=0):A[2*te+1]=0;for(;D.heap_len<2;)A[2*(J=D.heap[++D.heap_len]=pe<2?++pe:0)]=1,D.depth[J]=0,D.opt_len--,U&&(D.static_len-=E[2*J+1]);for(q.max_code=pe,te=D.heap_len>>1;1<=te;te--)$e(D,A,te);for(J=K;te=D.heap[1],D.heap[1]=D.heap[D.heap_len--],$e(D,A,1),ae=D.heap[1],D.heap[--D.heap_max]=te,D.heap[--D.heap_max]=ae,A[2*J]=A[2*te]+A[2*ae],D.depth[J]=(D.depth[te]>=D.depth[ae]?D.depth[te]:D.depth[ae])+1,A[2*te+1]=A[2*ae+1]=J,D.heap[1]=J++,$e(D,A,1),2<=D.heap_len;);D.heap[--D.heap_max]=D.heap[1],(function(Ee,ve){var ke,Te,Oe,Re,We,yt,Qe=ve.dyn_tree,ot=ve.max_code,Je=ve.stat_desc.static_tree,bt=ve.stat_desc.has_stree,ct=ve.stat_desc.extra_bits,Ct=ve.stat_desc.extra_base,Tt=ve.stat_desc.max_length,qt=0;for(Re=0;Re<=S;Re++)Ee.bl_count[Re]=0;for(Qe[2*Ee.heap[Ee.heap_max]+1]=0,ke=Ee.heap_max+1;ke<g;ke++)Tt<(Re=Qe[2*Qe[2*(Te=Ee.heap[ke])+1]+1]+1)&&(Re=Tt,qt++),Qe[2*Te+1]=Re,ot<Te||(Ee.bl_count[Re]++,We=0,Ct<=Te&&(We=ct[Te-Ct]),yt=Qe[2*Te],Ee.opt_len+=yt*(Re+We),bt&&(Ee.static_len+=yt*(Je[2*Te+1]+We)));if(qt!==0){do{for(Re=Tt-1;Ee.bl_count[Re]===0;)Re--;Ee.bl_count[Re]--,Ee.bl_count[Re+1]+=2,Ee.bl_count[Tt]--,qt-=2}while(0<qt);for(Re=Tt;Re!==0;Re--)for(Te=Ee.bl_count[Re];Te!==0;)ot<(Oe=Ee.heap[--ke])||(Qe[2*Oe+1]!==Re&&(Ee.opt_len+=(Re-Qe[2*Oe+1])*Qe[2*Oe],Qe[2*Oe+1]=Re),Te--)}})(D,q),be(A,pe,D.bl_count)}function j(D,q,te){var ae,J,A=-1,E=q[1],U=0,K=7,pe=4;for(E===0&&(K=138,pe=3),q[2*(te+1)+1]=65535,ae=0;ae<=te;ae++)J=E,E=q[2*(ae+1)+1],++U<K&&J===E||(U<pe?D.bl_tree[2*J]+=U:J!==0?(J!==A&&D.bl_tree[2*J]++,D.bl_tree[2*_]++):U<=10?D.bl_tree[2*F]++:D.bl_tree[2*M]++,A=J,pe=(U=0)===E?(K=138,3):J===E?(K=6,3):(K=7,4))}function ue(D,q,te){var ae,J,A=-1,E=q[1],U=0,K=7,pe=4;for(E===0&&(K=138,pe=3),ae=0;ae<=te;ae++)if(J=E,E=q[2*(ae+1)+1],!(++U<K&&J===E)){if(U<pe)for(;fe(D,J,D.bl_tree),--U!=0;);else J!==0?(J!==A&&(fe(D,J,D.bl_tree),U--),fe(D,_,D.bl_tree),he(D,U-3,2)):U<=10?(fe(D,F,D.bl_tree),he(D,U-3,3)):(fe(D,M,D.bl_tree),he(D,U-11,7));A=J,pe=(U=0)===E?(K=138,3):J===E?(K=6,3):(K=7,4)}}p(re);var ce=!1;function V(D,q,te,ae){he(D,(h<<1)+(ae?1:0),3),(function(J,A,E,U){Ne(J),ye(J,E),ye(J,~E),l.arraySet(J.pending_buf,J.window,A,E,J.pending),J.pending+=E})(D,q,te)}c._tr_init=function(D){ce||((function(){var q,te,ae,J,A,E=new Array(S+1);for(J=ae=0;J<w-1;J++)for(X[J]=ae,q=0;q<1<<$[J];q++)N[ae++]=J;for(N[ae-1]=J,J=A=0;J<16;J++)for(re[J]=A,q=0;q<1<<L[J];q++)H[A++]=J;for(A>>=7;J<v;J++)for(re[J]=A<<7,q=0;q<1<<L[J]-7;q++)H[256+A++]=J;for(te=0;te<=S;te++)E[te]=0;for(q=0;q<=143;)oe[2*q+1]=8,q++,E[8]++;for(;q<=255;)oe[2*q+1]=9,q++,E[9]++;for(;q<=279;)oe[2*q+1]=7,q++,E[7]++;for(;q<=287;)oe[2*q+1]=8,q++,E[8]++;for(be(oe,x+1,E),q=0;q<v;q++)z[2*q+1]=5,z[2*q]=Ae(q,5);me=new Z(oe,$,b+1,x,S),ee=new Z(z,L,0,v,S),ie=new Z(new Array(0),B,0,k,R)})(),ce=!0),D.l_desc=new P(D.dyn_ltree,me),D.d_desc=new P(D.dyn_dtree,ee),D.bl_desc=new P(D.bl_tree,ie),D.bi_buf=0,D.bi_valid=0,xe(D)},c._tr_stored_block=V,c._tr_flush_block=function(D,q,te,ae){var J,A,E=0;0<D.level?(D.strm.data_type===2&&(D.strm.data_type=(function(U){var K,pe=4093624447;for(K=0;K<=31;K++,pe>>>=1)if(1&pe&&U.dyn_ltree[2*K]!==0)return d;if(U.dyn_ltree[18]!==0||U.dyn_ltree[20]!==0||U.dyn_ltree[26]!==0)return f;for(K=32;K<b;K++)if(U.dyn_ltree[2*K]!==0)return f;return d})(D)),Ve(D,D.l_desc),Ve(D,D.d_desc),E=(function(U){var K;for(j(U,U.dyn_ltree,U.l_desc.max_code),j(U,U.dyn_dtree,U.d_desc.max_code),Ve(U,U.bl_desc),K=k-1;3<=K&&U.bl_tree[2*Q[K]+1]===0;K--);return U.opt_len+=3*(K+1)+5+5+4,K})(D),J=D.opt_len+3+7>>>3,(A=D.static_len+3+7>>>3)<=J&&(J=A)):J=A=te+5,te+4<=J&&q!==-1?V(D,q,te,ae):D.strategy===4||A===J?(he(D,2+(ae?1:0),3),Ye(D,oe,z)):(he(D,4+(ae?1:0),3),(function(U,K,pe,Ee){var ve;for(he(U,K-257,5),he(U,pe-1,5),he(U,Ee-4,4),ve=0;ve<Ee;ve++)he(U,U.bl_tree[2*Q[ve]+1],3);ue(U,U.dyn_ltree,K-1),ue(U,U.dyn_dtree,pe-1)})(D,D.l_desc.max_code+1,D.d_desc.max_code+1,E+1),Ye(D,D.dyn_ltree,D.dyn_dtree)),xe(D),ae&&Ne(D)},c._tr_tally=function(D,q,te){return D.pending_buf[D.d_buf+2*D.last_lit]=q>>>8&255,D.pending_buf[D.d_buf+2*D.last_lit+1]=255&q,D.pending_buf[D.l_buf+D.last_lit]=255&te,D.last_lit++,q===0?D.dyn_ltree[2*te]++:(D.matches++,q--,D.dyn_ltree[2*(N[te]+b+1)]++,D.dyn_dtree[2*W(q)]++),D.last_lit===D.lit_bufsize-1},c._tr_align=function(D){he(D,2,3),fe(D,I,oe),(function(q){q.bi_valid===16?(ye(q,q.bi_buf),q.bi_buf=0,q.bi_valid=0):8<=q.bi_valid&&(q.pending_buf[q.pending++]=255&q.bi_buf,q.bi_buf>>=8,q.bi_valid-=8)})(D)}},{"../utils/common":41}],53:[function(n,o,c){o.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,o,c){(function(l){(function(d,f){if(!d.setImmediate){var p,h,w,b,x=1,v={},k=!1,g=d.document,S=Object.getPrototypeOf&&Object.getPrototypeOf(d);S=S&&S.setTimeout?S:d,p={}.toString.call(d.process)==="[object process]"?function(_){process.nextTick(function(){R(_)})}:(function(){if(d.postMessage&&!d.importScripts){var _=!0,F=d.onmessage;return d.onmessage=function(){_=!1},d.postMessage("","*"),d.onmessage=F,_}})()?(b="setImmediate$"+Math.random()+"$",d.addEventListener?d.addEventListener("message",I,!1):d.attachEvent("onmessage",I),function(_){d.postMessage(b+_,"*")}):d.MessageChannel?((w=new MessageChannel).port1.onmessage=function(_){R(_.data)},function(_){w.port2.postMessage(_)}):g&&"onreadystatechange"in g.createElement("script")?(h=g.documentElement,function(_){var F=g.createElement("script");F.onreadystatechange=function(){R(_),F.onreadystatechange=null,h.removeChild(F),F=null},h.appendChild(F)}):function(_){setTimeout(R,0,_)},S.setImmediate=function(_){typeof _!="function"&&(_=new Function(""+_));for(var F=new Array(arguments.length-1),M=0;M<F.length;M++)F[M]=arguments[M+1];var $={callback:_,args:F};return v[x]=$,p(x),x++},S.clearImmediate=C}function C(_){delete v[_]}function R(_){if(k)setTimeout(R,0,_);else{var F=v[_];if(F){k=!0;try{(function(M){var $=M.callback,L=M.args;switch(L.length){case 0:$();break;case 1:$(L[0]);break;case 2:$(L[0],L[1]);break;case 3:$(L[0],L[1],L[2]);break;default:$.apply(f,L)}})(F)}finally{C(_),k=!1}}}}function I(_){_.source===d&&typeof _.data=="string"&&_.data.indexOf(b)===0&&R(+_.data.slice(b.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof jo<"u"?jo:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Hl)),Hl.exports}var iw=sw();const bp=oc(iw);async function ow(r){const s=await bp.loadAsync(r),n=await s.file("META-INF/container.xml")?.async("string");if(!n)throw new Error("container.xml not found in EPUB");const o=n.match(/full-path="([^"]+\.opf)"/);if(!o)throw new Error("OPF path not found in container.xml");const c=o[1],l=await s.file(c)?.async("string");if(!l)throw new Error(`OPF file not found at ${c}`);return l}async function aw(r){const s=await bp.loadAsync(r),n=await s.file("META-INF/container.xml")?.async("string");if(!n)return null;const o=n.match(/full-path="([^"]+\.opf)"/);if(!o)return null;const c=o[1],l=await s.file(c)?.async("string");if(!l)return null;const d=c.substring(0,c.lastIndexOf("/")+1),f=k=>d+k;let p=null,h=null;const w=l.match(/<meta[^>]+name=["']cover["'][^>]+content=["']([^"']+)["'][^>]*>/i);if(w&&(p=w[1]),!p){const k=l.match(/<item[^>]+properties=["'][^"']*cover-image[^"']*["'][^>]+id=["']([^"']+)["'][^>]*href=["']([^"']+)["'][^>]+media-type=["']([^"']+)["'][^>]*>/i);k&&(p=k[1],h=k[2],k[3])}if(!p){const k=l.match(/<item[^>]+id=["']([^"']*cover[^"']*)["'][^>]*href=["']([^"']+)["'][^>]+media-type=["']([^"']+)["'][^>]*>/i);k&&(p=k[1],h=k[2],k[3])}if(p&&!h){const k=new RegExp(`<item[^>]+id=["']${p}["'][^>]+href=["']([^"']+)["'][^>]+media-type=["']([^"']+)["'][^>]*>`,"i"),g=l.match(k);g&&(h=g[1],g[2])}if(!h){const k=l.match(/<item[^>]+href=["']([^"']+)["'][^>]+media-type=["'](image\/(jpeg|png|gif|jpg))["'][^>]*>/i);k&&(h=k[1],k[2])}if(!h){const k=l.match(/<spine[\s\S]*?<itemref[^>]+idref=["']([^"']+)["'][^>]*>/i);if(k){const g=k[1],S=new RegExp(`<item[^>]+id=["']${g}["'][^>]+href=["']([^"']+)["'][^>]+media-type=["']application/xhtml+xml["'][^>]*>`,"i"),C=l.match(S);if(C){const R=C[1],I=f(R),_=s.file(I);if(_){const M=(await _.async("string")).match(/<img[^>]+src=["']([^"']+)["'][^>]*>/i);M&&(h=M[1],h.endsWith(".png")||h.endsWith(".jpg")||h.endsWith(".jpeg")||h.endsWith(".gif"))}}}}if(!h)return null;const b=f(h),x=s.file(b);if(!x)return null;const v=await x.async("blob");return await new Promise((k,g)=>{const S=new FileReader;S.onloadend=()=>k(S.result),S.onerror=g,S.readAsDataURL(v)})}const ci={isLoading:!1,message:"",error:null},lw=r=>{if(r)return typeof r=="string"?r:r.name},cw=({onCatalogImportSuccess:r})=>{const[s,n]=T.useState(ci),[o,c]=T.useState(0),l=T.useCallback(()=>{c(f=>f+1)},[]),d=T.useCallback(async(f,p="Untitled Book",h,w="file",b,x,v,k,g)=>{let S=null;if(k&&(S=await Ff(k)),(v||(p.toLowerCase().endsWith(".pdf")?"PDF":"EPUB"))==="PDF"){n({isLoading:!0,message:"Saving PDF to library...",error:null});try{const _=p.replace(/\.(pdf)$/i,""),F=h||"Unknown Author";!S&&w==="file"&&(S=await If(_,F));const M=new Uint8Array(f).slice(0,5);if(!(M[0]===37&&M[1]===80&&M[2]===68&&M[3]===70&&M[4]===45)||!f||f instanceof ArrayBuffer&&f.byteLength<1e3)return n({isLoading:!1,message:"",error:"Downloaded file is not a valid PDF or is empty. Import aborted."}),{success:!1};let L=S;L&&typeof L=="string"&&!/^data:image\/(png|jpeg|jpg);base64,/.test(L)&&(L=null);let B={};w==="catalog"&&g&&(B={summary:g.summary,publisher:g.publisher,publicationDate:g.publicationDate,subjects:g.subjects,coverImage:L||(g.coverImage?await Ff(g.coverImage):null)}),w==="catalog"&&!B.coverImage&&(L=await If(_,F),B={...B,coverImage:L});const Q=x||p,oe={title:_,author:F,coverImage:B.coverImage||L,epubData:f,format:"PDF",providerName:b,providerId:Q,description:B.summary,publisher:lw(B.publisher),publicationDate:B.publicationDate,subjects:B.subjects};if(Q){const z=await st.findBookByIdentifier(Q);if(z)return n(ci),{success:!1,bookRecord:oe,existingBook:z}}return await st.saveBook(oe),n({isLoading:!1,message:"Import successful!",error:null}),l(),setTimeout(()=>n(ci),2e3),{success:!0}}catch(_){ne.error("Error saving PDF:",_);const F=_ instanceof Error?_.message:"Failed to save the PDF file to the library.";return n({isLoading:!1,message:"",error:F}),{success:!1}}}n({isLoading:!0,message:"Extracting EPUB metadata...",error:null});let R,I;try{try{R=await ow(f)}catch(M){ne.error("[processAndSaveBook] Failed to extract OPF XML:",M),n({isLoading:!1,message:"",error:"Failed to extract EPUB metadata (OPF not found). Importing with minimal info."})}if(R)try{I=nw(R)}catch(M){ne.error("[processAndSaveBook] Failed to parse OPF metadata:",M),n({isLoading:!1,message:"",error:"Failed to parse EPUB metadata. Importing with minimal info."})}if(n(M=>({...M,message:"Extracting cover..."})),!S)try{S=await aw(f)}catch(M){ne.error("[processAndSaveBook] Failed to extract cover image:",M)}const _=x||I?.identifiers?.[0],F={title:I?.title||p,author:I?.author||h||"Unknown Author",coverImage:S,epubData:f,publisher:I?.publisher,publicationDate:I?.publicationDate,providerId:_,providerName:b,description:I?.description,subjects:I?.subjects,format:"EPUB",language:I?.language,rights:I?.rights,identifiers:I?.identifiers,opfRaw:R,accessModes:I?.accessModes,accessModesSufficient:I?.accessModesSufficient,accessibilityFeatures:I?.accessibilityFeatures,hazards:I?.hazards,accessibilitySummary:I?.accessibilitySummary,certificationConformsTo:Array.isArray(I?.certificationConformsTo)?I?.certificationConformsTo:typeof I?.certificationConformsTo=="string"?[I.certificationConformsTo]:void 0,certification:I?.certification,accessibilityFeedback:I?.accessibilityFeedback};if(_){const M=await st.findBookByIdentifier(_);if(M)return n(ci),{success:!1,bookRecord:F,existingBook:M}}return n(M=>({...M,message:"Saving to library..."})),await st.saveBook(F),n({isLoading:!1,message:"Import successful!",error:null}),l(),setTimeout(()=>n(ci),2e3),w==="catalog"&&r(),{success:!0}}catch(_){ne.error("Error processing EPUB:",_);let F="Failed to import the EPUB file. It might be corrupted or in an unsupported format.";return _ instanceof Error&&_.message.includes("File is not a zip")&&(F="The provided file is not a valid EPUB (it's not a zip archive). Please try a different file."),n({isLoading:!1,message:"",error:F}),{success:!1}}},[l,r]);return{importStatus:s,setImportStatus:n,libraryRefreshFlag:o,processAndSaveBook:d}},uw={state:"idle",message:""},dw=({tokenClient:r,confirm:s})=>{const[n,o]=T.useState(uw),[c,l]=T.useState([]),[d,f]=T.useState(""),[p,h]=T.useState(!1),w=T.useCallback(async()=>{const k=await st.getAllBooks(),g=k.map(F=>{const M={...F};return delete M.epubData,M}),S=JSON.parse(localStorage.getItem("ebook-catalogs")||"[]"),C=JSON.parse(localStorage.getItem("ebook-reader-settings-global")||"{}"),R={},I={},_={};return k.forEach(F=>{F.id&&(R[F.id]=JSON.parse(localStorage.getItem(`ebook-reader-bookmarks-${F.id}`)||"[]"),I[F.id]=JSON.parse(localStorage.getItem(`ebook-reader-citations-${F.id}`)||"[]"),_[F.id]=localStorage.getItem(`ebook-reader-pos-${F.id}`))}),{payload:{library:g,catalogs:S,bookmarks:R,citations:I,positions:_,settings:C},booksWithData:k}},[]),b=T.useCallback(async()=>{if(!r){l([]),f("");return}h(!0);try{const k=await Zv();l(k);const g=k.find(S=>S.isLatest);!d&&g?.id?f(g.id):d&&!k.some(S=>S.id===d)&&f(g?.id||"")}catch(k){ne.warn("Failed to load Drive snapshots",k),l([]),f("")}finally{h(!1)}},[d,r]),x=T.useCallback(async()=>{if(r){o({state:"syncing",message:"Gathering local data..."});try{const{payload:k,booksWithData:g}=await w();o({state:"syncing",message:"Uploading to Google Drive... This may take a while."}),await Xv(k,g,S=>{o({state:"syncing",message:S})}),localStorage.setItem("ebook-reader-last-sync",new Date().toISOString()),await b(),o({state:"success",message:"Library successfully uploaded!"})}catch(k){ne.error("Upload failed:",k),o({state:"error",message:k instanceof Error?k.message:"An unknown error occurred."})}}},[w,b,r]),v=T.useCallback(async()=>{if(!(!r||!await s({message:`DANGER: This will replace your entire local library with the version from Google Drive.

Any local books or changes not uploaded to Drive will be permanently lost.

Are you absolutely sure you want to continue?`,title:"Dangerous Operation",confirmLabel:"Yes, replace",cancelLabel:"Cancel"}))){o({state:"syncing",message:"Downloading from Google Drive..."});try{const g=await Yv(S=>{o({state:"syncing",message:S})},d||void 0);if(!g)throw new Error("No data found in Google Drive.");o({state:"syncing",message:"Clearing local library..."}),await st.clearAllBooks(),Object.keys(localStorage).filter(S=>S.startsWith("ebook-reader-")).forEach(S=>localStorage.removeItem(S)),o({state:"syncing",message:"Importing downloaded library..."}),localStorage.setItem("ebook-catalogs",JSON.stringify(g.payload.catalogs||[])),localStorage.setItem("ebook-reader-settings-global",JSON.stringify(g.payload.settings||{}));for(const S of g.booksWithData)if(await st.saveBook(S),S.id){const C=S.id;g.payload.bookmarks[C]&&localStorage.setItem(`ebook-reader-bookmarks-${C}`,JSON.stringify(g.payload.bookmarks[C])),g.payload.citations[C]&&localStorage.setItem(`ebook-reader-citations-${C}`,JSON.stringify(g.payload.citations[C]));const R=g.payload.positions[C];R&&localStorage.setItem(`ebook-reader-pos-${C}`,R)}localStorage.setItem("ebook-reader-last-sync",new Date().toISOString()),o({state:"success",message:"Library successfully downloaded! Reloading app..."}),setTimeout(()=>window.location.reload(),2e3)}catch(g){ne.error("Download failed:",g),o({state:"error",message:g instanceof Error?g.message:"An unknown error occurred."})}}},[s,d,r]);return{syncStatus:n,setSyncStatus:o,driveSnapshots:c,selectedSnapshotId:d,setSelectedSnapshotId:f,isLoadingSnapshots:p,refreshDriveSnapshots:b,handleUploadToDrive:x,handleDownloadFromDrive:v}},fw=new Fg({defaultOptions:{queries:{staleTime:300*1e3,gcTime:600*1e3,retry:1,refetchOnWindowFocus:!0,refetchOnMount:!1,throwOnError:!1},mutations:{retry:1,throwOnError:!1}}}),hw=()=>{const{addCatalog:r}=rp(),s=fp(),n=jc(),{tokenClient:o}=Ec(),c=mc(),l=pc(),[d,f]=T.useState(()=>{try{return JSON.parse(localStorage.getItem("ebook-reader-settings-global")||"{}").citationFormat||"apa"}catch{return"apa"}});T.useEffect(()=>{const q=()=>{try{const te=JSON.parse(localStorage.getItem("ebook-reader-settings-global")||"{}");f(te.citationFormat||"apa")}catch{}};return window.addEventListener("storage",q),()=>window.removeEventListener("storage",q)},[]);const[p,h]=T.useState("library"),[w,b]=T.useState(null),[x,v]=T.useState(null),[k,g]=T.useState(null),[S,C]=T.useState([]),[R,I]=T.useState(!0),[_,F]=T.useState(!1),[M,$]=T.useState(!1),[L,B]=T.useState(!1),[Q,oe]=T.useState(null),z=T.useCallback(()=>{oe(null),h("library")},[]),{importStatus:H,setImportStatus:N,libraryRefreshFlag:X,processAndSaveBook:me}=cw({onCatalogImportSuccess:z}),{credentialPrompt:ee,setCredentialPrompt:ie,handleImportFromCatalog:re,handleCredentialSubmit:Z,handleOpenAuthLink:P,handleRetryAfterProviderLogin:W,showNetworkDebug:ye,setShowNetworkDebug:he}=qx({processAndSaveBook:me,setImportStatus:N,setActiveOpdsSource:g,setCurrentView:h,pushToast:s.pushToast}),{syncStatus:fe,setSyncStatus:Ae,driveSnapshots:be,selectedSnapshotId:xe,setSelectedSnapshotId:Ne,isLoadingSnapshots:De,refreshDriveSnapshots:$e,handleUploadToDrive:Ye,handleDownloadFromDrive:Ve}=dw({tokenClient:o,confirm:n});T.useEffect(()=>{_&&$e()},[_,$e]),T.useEffect(()=>{st.init();const q=setTimeout(()=>{I(!1)},2500);return()=>clearTimeout(q)},[]),ux({shortcuts:[{key:"?",description:"Show keyboard shortcuts",category:"global",action:()=>B(!0)},{key:"Escape",description:"Close active modal or return to library",category:"global",action:()=>{L?B(!1):_?F(!1):M?$(!1):ee.isOpen?ie(q=>({...q,isOpen:!1})):p==="bookDetail"&&h("library")}}],enabled:!R}),T.useEffect(()=>{new URLSearchParams(l.search).get("autoOpen")==="first"&&(async()=>{try{const ae=await st.getAllBooks();if(!ae||ae.length===0)return;const J=ae[0];if(!J||!J.id)return;(J.format||"EPUB")==="PDF"?c(`/pdf/${J.id}`):(b(J.id),h("reader"))}catch(ae){ne.warn("Auto-open failed",ae)}})()},[l.search,c]);const j=T.useCallback((q,te)=>{try{return r(te,q,"2"),s.pushToast(`Successfully added catalog: ${te}`,4e3),ne.info("[App] Auto-imported OPDS catalog from registry",{importUrl:q,catalogName:te}),h("library"),window.focus(),!0}catch(ae){return s.pushToast(`Failed to add catalog: ${te}`,6e3),ne.error("[App] Failed to import OPDS catalog from registry",{importUrl:q,catalogName:te,error:ae}),!1}},[r,s]);T.useEffect(()=>{const q=new URLSearchParams(l.search),te=q.get("import"),ae=q.get("name");if(te&&ae){j(te,ae);const J=new URL(window.location.href);J.searchParams.delete("import"),J.searchParams.delete("name"),window.history.replaceState({},document.title,J.toString())}},[l.search,j]),T.useEffect(()=>{const q=te=>{if(te.key==="mebooks-import-catalog"&&te.newValue)try{const{importUrl:ae,catalogName:J,timestamp:A}=JSON.parse(te.newValue);if(Date.now()-A<5e3){const E=j(ae,J);localStorage.setItem("mebooks-import-response",JSON.stringify({success:E,catalogName:J,timestamp:Date.now()})),localStorage.removeItem("mebooks-import-catalog")}}catch(ae){ne.error("[App] Failed to process cross-tab import message",{error:ae})}if(te.key==="mebooks-ping"&&te.newValue)try{const{timestamp:ae}=JSON.parse(te.newValue);Date.now()-ae<2e3&&(localStorage.setItem("mebooks-pong",JSON.stringify({timestamp:Date.now(),version:"1.0.0"})),localStorage.removeItem("mebooks-ping"))}catch(ae){ne.error("[App] Failed to process ping message",{error:ae})}};return window.addEventListener("storage",q),()=>window.removeEventListener("storage",q)},[j]);const ue=T.useCallback((q,te,ae="EPUB")=>{b(q),ae==="PDF"?(v(null),c(`/pdf/${q}`)):(v(te),h("reader"))},[c]),ce=T.useCallback(()=>{b(null),h("library"),v(null),c("/")},[c]),V=T.useCallback((q,te,ae)=>{oe({book:q,source:te,catalogName:ae}),h("bookDetail")},[]),D=T.useCallback(()=>{h("about")},[]);return a.jsxs("div",{className:"min-h-screen bg-slate-900 font-sans",children:[a.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-sky-500 focus:text-white focus:rounded-md focus:font-semibold focus:shadow-lg",children:"Skip to main content"}),a.jsx(Ix,{isVisible:R}),!R&&a.jsx("main",{id:"main-content",children:a.jsx(Hx,{currentView:p,selectedBookId:w,coverAnimationData:x,onCloseReader:ce,detailViewData:Q,onReturnToLibrary:z,onReadBook:ue,onImportFromCatalog:re,onOpenBook:ue,onShowBookDetail:V,syncStatus:fe,processAndSaveBook:me,activeOpdsSource:k,setActiveOpdsSource:g,catalogNavPath:S,setCatalogNavPath:C,onOpenCloudSyncModal:()=>F(!0),onOpenLocalStorageModal:()=>$(!0),onShowAbout:D,importStatus:H,setImportStatus:N,libraryRefreshFlag:X,userCitationFormat:d})}),a.jsx(Lx,{isCloudSyncModalOpen:_,onCloseCloudSyncModal:()=>F(!1),onUploadToDrive:Ye,onDownloadFromDrive:Ve,driveSnapshots:be,selectedSnapshotId:xe,onSelectSnapshotId:Ne,onRefreshSnapshots:$e,isLoadingSnapshots:De,syncStatus:fe,setSyncStatus:Ae,isLocalStorageModalOpen:M,onCloseLocalStorageModal:()=>$(!1),credentialPrompt:ee,onCloseCredentialPrompt:()=>ie({isOpen:!1,host:null,pendingHref:null,pendingBook:null,pendingCatalogName:void 0,authDocument:null}),onCredentialSubmit:Z,onOpenAuthLink:P,onRetryAfterProviderLogin:W,showNetworkDebug:ye,onCloseNetworkDebug:()=>he(!1),onOpenNetworkDebug:()=>he(!0),isShortcutHelpOpen:L,onCloseShortcutHelp:()=>B(!1)}),a.jsx(nh,{message:H.isLoading?H.message:H.error||null,politeness:H.error?"assertive":"polite"}),a.jsx(nh,{message:fe.state!=="idle"?fe.message:null,politeness:fe.state==="error"?"assertive":"polite"})]})},pw=()=>a.jsxs(Bg,{client:fw,children:[a.jsx(zg,{children:({reset:r})=>a.jsx(Q0,{children:a.jsxs(q0,{children:[a.jsx(Jl,{path:"/pdf/:id",element:a.jsx(vs,{onReset:()=>{r(),window.location.replace("/")},fallbackMessage:"There was an error loading the PDF viewer.",children:a.jsx(mw,{})})}),a.jsx(Jl,{path:"/*",element:a.jsx(vs,{onReset:()=>{r(),window.location.reload()},fallbackMessage:"There was an error loading the application.",children:a.jsx(hw,{})})})]})})}),a.jsx(Yg,{initialIsOpen:!1})]}),mw=()=>{const r=mc();return a.jsx(wp,{onClose:()=>r("/")})},kp=document.getElementById("root");if(!kp)throw new Error("Could not find root element to mount to");const gw=pg.createRoot(kp);gw.render(a.jsx(dt.StrictMode,{children:a.jsx(_x,{children:a.jsx(bx,{children:a.jsx(kx,{children:a.jsx(pw,{})})})})}));export{oc as g,a as j,T as r};
